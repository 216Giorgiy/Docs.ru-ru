---
title: "Устранение неполадок Core ASP.NET в IIS"
author: guardrex
description: "Сведения для диагностики проблем с развертыванием IIS ASP.NET Core."
manager: wpickett
ms.author: riande
ms.custom: mvc
ms.date: 03/13/2017
ms.prod: asp.net-core
ms.technology: aspnet
ms.topic: article
uid: host-and-deploy/iis/troubleshoot
ms.openlocfilehash: c68070a9cba5667504d1ad4927b02b73f83e6573
ms.sourcegitcommit: a510f38930abc84c4b302029d019a34dfe76823b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/30/2018
---
# <a name="troubleshoot-aspnet-core-on-iis"></a>Устранение неполадок Core ASP.NET в IIS

Автор [Люк Латэм](https://github.com/guardrex) (Luke Latham)

Для диагностики проблем с развертыванием служб IIS:

* Изучите выходные данные браузера.
* Просмотрите системный **приложения** с помощью средства **Просмотр событий**.
* Включите ведение журнала `stdout`. Журнал **модуля ASP.NET Core** находится по пути, указанном в атрибуте *stdoutLogFile* элемента `<aspNetCore>` в файле *web.config*. Все папки по пути, указанному в значении этого атрибута, должны существовать в развертывании. Задать *stdoutLogEnabled* для `true`. Приложения, использующие `Microsoft.NET.Sdk.Web` пакет SDK для создания *web.config* файла по умолчанию *stdoutLogEnabled* параметру `false`, вручную предоставить *web.config* файл или измените его так, чтобы включить `stdout` ведения журнала.

Используйте сведения из этих трех источников с [распространенные ошибки ссылается раздел](xref:host-and-deploy/azure-iis-errors-reference) для определения проблемы. Выполните советов по устранению неполадок для решения проблемы.

Некоторые распространенные ошибки не приводятся в браузере, журнале приложений и журнале модуля ASP.NET Core, пока не будут достигнуты значения *startupTimeLimit* (по умолчанию 120 секунд) и *startupRetryCount* (по умолчанию 2). Поэтому прежде чем делать вывод о том, что модулю не удалось запустить процесс приложения, подождите шесть минут.

Один из простых способов определить, правильно ли работает приложение, — запустить его непосредственно в Kestrel. Если приложение опубликовано как [развертывания зависит от framework](/dotnet/core/deploying/#framework-dependent-deployments-fdd), выполнение `dotnet <assembly_name>.dll` в папку развертывания, который является физический путь приложения IIS. Если приложение опубликовано как [автономное развертывание](/dotnet/core/deploying/#self-contained-deployments-scd), запустите приложение в исполняемый файл непосредственно из командной строки, `<assembly_name>.exe`, в папку развертывания. Если Kestrel прослушивает порт по умолчанию 5000, приложение должно находиться в `http://localhost:5000/`. Если приложение обычно отвечает Kestrel адрес конечной точки, проблема скорее всего, конфигурации обратного прокси-сервера и меньшей вероятностью в приложении, связанные с.

Является одним из способов определения правильности работы обратного прокси-сервера для выполнения простой статический файл запрос для таблицы стилей, скрипта или образ из статических файлов приложения в *wwwroot* с помощью [промежуточного слоя статических файлов](xref:fundamentals/static-files). Если приложение может обрабатывать статические файлы, но не удается установить представления MVC и других конечных точек, проблема заключается в меньшей вероятностью связанные с конфигурацией обратного прокси-сервера и скорее всего, в приложении (например для маршрутизации MVC или 500 Внутренняя ошибка сервера).

При Kestrel обычно запускается под IIS, но приложение не будет выполняться в системе после успешного запуска локально, переменной среды можно временно добавляется в *web.config* для задания `ASPNETCORE_ENVIRONMENT` для `Development`. До тех пор, пока среда не переопределено в запуске приложения, установив переменную среды позволяет [страницы разработчик исключений](xref:fundamentals/error-handling) для отображения при запуске приложения. Новое значение переменной среды для `ASPNETCORE_ENVIRONMENT` таким образом рекомендуется только для промежуточного хранения и тестирование серверов, которые не показываются в Интернет. Не забудьте удалить переменную среды из *web.config* файла после завершения. Дополнительные сведения о задании переменные среды посредством *web.config*, в разделе [переменных среды дочерний элемент элемента aspNetCore](xref:host-and-deploy/aspnet-core-module#setting-environment-variables).

В большинстве случаев включение журнала приложений помогает находить и устранять проблемы, связанные с приложением или обратным прокси-сервером. Дополнительные сведения см. в статье, посвященной [ведению журналов](xref:fundamentals/logging/index).

Совет по устранению неполадок относится к приложениям, которые не смогут работать после обновления, либо Core .NET SDK в версиях машины или пакет разработки в приложении. В некоторых случаях в результате важного обновления несогласованные версии пакетов могут привести к нарушению работы приложения. Большая часть этих проблем можно устранить путем:

* Удаление `bin` и `obj` папки в проекте.
* Очистка пакета кэширует на `%UserProfile%\.nuget\packages\` и `%LocalAppData%\Nuget\v3-cache`.
* Восстановление и построить проект заново.
* Подтверждает, что предыдущего развертывания на сервере полностью удалено до повторного развертывания приложения.

> [!TIP]
> Чтобы очистить кэш пакета удобно для выполнения `dotnet nuget locals all --clear` из командной строки.
> 
> Очистка кэша пакета можно также с помощью [nuget.exe](https://www.nuget.org/downloads) средство и выполнения команды `nuget locals all -clear`. *NuGet.exe* не объединенной установки с Windows 10 и должны быть получены отдельно на веб-сайте NuGet.
<!--
> [!TIP]
> A convenient way to clear package caches is to:
>
> * Obtain the *NuGet.exe* tool from [NuGet.org](https://www.nuget.org/).
> * Add the path to *NuGet.exe* to the system PATH.
> * Execute `nuget locals all -clear` from a command prompt.
>
> Alternatively, execute `dotnet nuget locals all --clear` from a command prompt without obtaining *NuGet.exe*. -->

## <a name="additional-resources"></a>Дополнительные ресурсы

* [Справочник по общим ошибкам для службы приложений Azure и служб IIS с ASP.NET Core](xref:host-and-deploy/azure-iis-errors-reference)
* [Справочник по конфигурации модуля ASP.NET Core](xref:host-and-deploy/aspnet-core-module)
