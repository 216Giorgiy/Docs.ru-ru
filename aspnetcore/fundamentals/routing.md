---
title: "Маршрутизация в ASP.NET Core"
author: ardalis
description: 
keywords: ASP.NET Core
ms.author: riande
manager: wpickett
ms.date: 10/14/2016
ms.topic: article
ms.assetid: bbbcf9e4-3c4c-4f50-b91e-175fe9cae4e2
ms.technology: aspnet
ms.prod: asp.net-core
uid: fundamentals/routing
ms.openlocfilehash: 98756e2c5b336aabcf5155d929160b616baaf2ee
ms.sourcegitcommit: 0b6c8e6d81d2b3c161cd375036eecbace46a9707
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2017
---
# <a name="routing-in-aspnet-core"></a><span data-ttu-id="aabe0-103">Маршрутизация в ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="aabe0-103">Routing in ASP.NET Core</span></span>

<span data-ttu-id="aabe0-104">По [Nowak Райана](https://github.com/rynowak), [Стив Смит](http://ardalis.com), и [Рик Андерсон](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="aabe0-104">By [Ryan Nowak](https://github.com/rynowak), [Steve Smith](http://ardalis.com), and [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

<span data-ttu-id="aabe0-105">Функции маршрутизации отвечает за сопоставление входящего запроса к обработчику маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-105">Routing functionality is responsible for mapping an incoming request to a route handler.</span></span> <span data-ttu-id="aabe0-106">Маршруты определяются в приложении ASP.NET и настроить при запуске приложения.</span><span class="sxs-lookup"><span data-stu-id="aabe0-106">Routes are defined in the ASP.NET app and configured when the app starts up.</span></span> <span data-ttu-id="aabe0-107">Маршрут при необходимости можно извлечь значения из URL-адреса, содержащиеся в запросе, а затем эти значения могут использоваться для обработки запроса.</span><span class="sxs-lookup"><span data-stu-id="aabe0-107">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="aabe0-108">Используя данные о маршруте из приложения ASP.NET, функции маршрутизации также могут создавать URL-адреса, которые сопоставляются обработчики маршрутов.</span><span class="sxs-lookup"><span data-stu-id="aabe0-108">Using route information from the ASP.NET app, the routing functionality is also able to generate URLs that map to route handlers.</span></span> <span data-ttu-id="aabe0-109">Таким образом маршрутизации можно найти обработчик маршрутов на основе URL-адрес или URL-адрес, соответствующий заданным маршрутом обработчика, на основе сведений обработчик маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-109">Therefore, routing can find a route handler based on a URL, or the URL corresponding to a given route handler based on route handler information.</span></span>

>[!IMPORTANT]
> <span data-ttu-id="aabe0-110">В этом документе рассматриваются низкого уровня ASP.NET Core маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="aabe0-110">This document covers the low level ASP.NET Core routing.</span></span> <span data-ttu-id="aabe0-111">Для маршрутизации ASP.NET Core MVC, в разделе [маршрутизации действия контроллера](../mvc/controllers/routing.md)</span><span class="sxs-lookup"><span data-stu-id="aabe0-111">For ASP.NET Core MVC routing, see [Routing to Controller Actions](../mvc/controllers/routing.md)</span></span>

[<span data-ttu-id="aabe0-112">Просмотреть или скачать образец кода</span><span class="sxs-lookup"><span data-stu-id="aabe0-112">View or download sample code</span></span>](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/routing/sample)

## <a name="routing-basics"></a><span data-ttu-id="aabe0-113">Основы маршрутизации</span><span class="sxs-lookup"><span data-stu-id="aabe0-113">Routing basics</span></span>

<span data-ttu-id="aabe0-114">Использует маршрутизации *маршруты* (реализации [IRouter](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.routing.irouter)) для:</span><span class="sxs-lookup"><span data-stu-id="aabe0-114">Routing uses *routes* (implementations of [IRouter](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.routing.irouter)) to:</span></span>

* <span data-ttu-id="aabe0-115">сопоставить входящие запросы на *маршрутизации обработчиков*</span><span class="sxs-lookup"><span data-stu-id="aabe0-115">map incoming requests to *route handlers*</span></span>

* <span data-ttu-id="aabe0-116">Создание URL-адреса, используемые в ответах</span><span class="sxs-lookup"><span data-stu-id="aabe0-116">generate URLs used in responses</span></span>

<span data-ttu-id="aabe0-117">Как правило приложение имеет одну коллекцию маршрутов.</span><span class="sxs-lookup"><span data-stu-id="aabe0-117">Generally, an app has a single collection of routes.</span></span> <span data-ttu-id="aabe0-118">При получении запроса, коллекцию маршрутов обрабатываются в порядке.</span><span class="sxs-lookup"><span data-stu-id="aabe0-118">When a request arrives, the route collection is processed in order.</span></span> <span data-ttu-id="aabe0-119">Входящий запрос ищет маршрут, соответствующий URL-адрес запроса путем вызова `RouteAsync` метод на всех доступных маршрутов в семействе маршрутов.</span><span class="sxs-lookup"><span data-stu-id="aabe0-119">The incoming request looks for a route that matches the request URL by calling the `RouteAsync` method on each available route in the route collection.</span></span> <span data-ttu-id="aabe0-120">Напротив ответ маршрутизацию для формирования URL-адреса (например, для перенаправления или ссылки) на основании информации маршрута и таким образом избежать необходимости жестко URL-адреса, что обеспечивает удобство поддержки.</span><span class="sxs-lookup"><span data-stu-id="aabe0-120">By contrast, a response can use routing to generate URLs (for example, for redirection or links) based on route information, and thus avoid having to hard-code URLs, which helps maintainability.</span></span>

<span data-ttu-id="aabe0-121">Маршрутизация подключен к [по промежуточного слоя](middleware.md) продаж по `RouterMiddleware` класса.</span><span class="sxs-lookup"><span data-stu-id="aabe0-121">Routing is connected to the [middleware](middleware.md) pipeline by the `RouterMiddleware` class.</span></span> <span data-ttu-id="aabe0-122">[ASP.NET MVC](../mvc/overview.md) добавляет маршрутизации для конвейера по промежуточного слоя в процессе его настройки.</span><span class="sxs-lookup"><span data-stu-id="aabe0-122">[ASP.NET MVC](../mvc/overview.md) adds routing to the middleware pipeline as part of its configuration.</span></span> <span data-ttu-id="aabe0-123">Дополнительные сведения об использовании маршрутизации в качестве автономного компонента см. в разделе [с помощью маршрутизации-по промежуточного слоя](#using-routing-middleware).</span><span class="sxs-lookup"><span data-stu-id="aabe0-123">To learn about using routing as a standalone component, see [using-routing-middleware](#using-routing-middleware).</span></span>

<a name=url-matching-ref></a>

### <a name="url-matching"></a><span data-ttu-id="aabe0-124">URL-адрес соответствует</span><span class="sxs-lookup"><span data-stu-id="aabe0-124">URL matching</span></span>

<span data-ttu-id="aabe0-125">URL-адрес соответствует — это процесс, с которой маршрутизации отправляет входящий запрос на *обработчик*.</span><span class="sxs-lookup"><span data-stu-id="aabe0-125">URL matching is the process by which routing dispatches an incoming request to a *handler*.</span></span> <span data-ttu-id="aabe0-126">Этот процесс обычно основывается на данных в URL-адрес, но можно расширить, добавив считать все данные в запросе.</span><span class="sxs-lookup"><span data-stu-id="aabe0-126">This process is generally based on data in the URL path, but can be extended to consider any data in the request.</span></span> <span data-ttu-id="aabe0-127">Возможность отправки запросов для разделения обработчики — ключ к масштабированию размера и сложности приложения.</span><span class="sxs-lookup"><span data-stu-id="aabe0-127">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an application.</span></span>

<span data-ttu-id="aabe0-128">Введите входящие запросы `RouterMiddleware`, который вызывает `RouteAsync` метод для каждого маршрута в последовательности.</span><span class="sxs-lookup"><span data-stu-id="aabe0-128">Incoming requests enter the `RouterMiddleware`, which calls the `RouteAsync` method on each route in sequence.</span></span> <span data-ttu-id="aabe0-129">`IRouter` Выбирает экземпляр ли *обработки* запроса, задав `RouteContext` `Handler` в ненулевое значение `RequestDelegate`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-129">The `IRouter` instance chooses whether to *handle* the request by setting the `RouteContext` `Handler` to a non-null `RequestDelegate`.</span></span> <span data-ttu-id="aabe0-130">Если маршрут задает обработчик для запроса, обработка останавливается и обработчик маршрута будет вызываться для обработки запроса.</span><span class="sxs-lookup"><span data-stu-id="aabe0-130">If a route sets a handler for the request, route processing stops and the handler will be invoked to process the request.</span></span> <span data-ttu-id="aabe0-131">Если обработчик не найден для запроса, проверяются все маршруты, по промежуточного слоя вызывает *Далее* и вызывается следующее по промежуточного слоя в конвейере.</span><span class="sxs-lookup"><span data-stu-id="aabe0-131">If all routes are tried and no handler is found for the request, the middleware calls *next* and the next middleware in the request pipeline is invoked.</span></span>

<span data-ttu-id="aabe0-132">Основной входных данных для `RouteAsync` — `RouteContext` `HttpContext` связанный с текущим запросом.</span><span class="sxs-lookup"><span data-stu-id="aabe0-132">The primary input to `RouteAsync` is the `RouteContext` `HttpContext` associated with the current request.</span></span> <span data-ttu-id="aabe0-133">`RouteContext.Handler` И `RouteContext` `RouteData` выходов, будет установлено после того, соответствует маршрут.</span><span class="sxs-lookup"><span data-stu-id="aabe0-133">The `RouteContext.Handler` and `RouteContext` `RouteData` are outputs that will be set after a route matches.</span></span>

<span data-ttu-id="aabe0-134">Соответствие во время `RouteAsync` также задать свойства `RouteContext.RouteData` с учетом обработки запросов, выполненные соответствующими значениями.</span><span class="sxs-lookup"><span data-stu-id="aabe0-134">A match during `RouteAsync` will also set the properties of the `RouteContext.RouteData` to appropriate values based on the request processing done so far.</span></span> <span data-ttu-id="aabe0-135">Если маршрут соответствует запросу, `RouteContext.RouteData` будет содержать состояние важные сведения о *результат*.</span><span class="sxs-lookup"><span data-stu-id="aabe0-135">If a route matches a request, the `RouteContext.RouteData` will contain important state information about the *result*.</span></span>

<span data-ttu-id="aabe0-136">`RouteData``Values` представляет собой словарь *значения маршрута* , произведенного из маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-136">`RouteData` `Values` is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="aabe0-137">Эти значения обычно определяется маркирование URL-адрес и может использоваться для получения входных данных пользователя или для проведения дальнейшей диспетчеризации внутри приложения.</span><span class="sxs-lookup"><span data-stu-id="aabe0-137">These values are usually determined by tokenizing the URL, and can be used to accept user input, or to make further dispatching decisions inside the application.</span></span>

<span data-ttu-id="aabe0-138">`RouteData``DataTokens` является набором свойств дополнительные данные, связанные с сопоставленного маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-138">`RouteData` `DataTokens`  is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="aabe0-139">`DataTokens`предоставляются для поддержки связывание состояние, в котором обнаружено соответствие данных со всех маршрутов, поэтому приложение может принять решение позже исходя какой маршрут.</span><span class="sxs-lookup"><span data-stu-id="aabe0-139">`DataTokens` are provided to support associating state data with each route so the application can make decisions later based on which route matched.</span></span> <span data-ttu-id="aabe0-140">Эти значения, определяемые разработчиком и выполните **не** влияют на поведение маршрутизации каким-либо образом.</span><span class="sxs-lookup"><span data-stu-id="aabe0-140">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="aabe0-141">Кроме того значения, помещается в маркеры данных могут быть любого типа, в отличие от значений маршрута, которые должны быть легко могут быть преобразованы в строки и обратно.</span><span class="sxs-lookup"><span data-stu-id="aabe0-141">Additionally, values stashed in data tokens can be of any type, in contrast to route values, which must be easily convertible to and from strings.</span></span>

<span data-ttu-id="aabe0-142">`RouteData``Routers` — список маршрутов, которые участвуют в согласовании запрос успешно.</span><span class="sxs-lookup"><span data-stu-id="aabe0-142">`RouteData` `Routers` is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="aabe0-143">Маршруты могут быть вложенными друг в друга и `Routers` свойство отражает путь через логическое дерево маршруты, которые привели к совпадению.</span><span class="sxs-lookup"><span data-stu-id="aabe0-143">Routes can be nested inside one another, and the `Routers` property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="aabe0-144">Как правило, первый элемент в `Routers` представляет коллекцию маршрутов и должен использоваться для создания URL-адресов.</span><span class="sxs-lookup"><span data-stu-id="aabe0-144">Generally the first item in `Routers` is the route collection, and should be used for URL generation.</span></span> <span data-ttu-id="aabe0-145">Последний элемент в `Routers` является обработчик маршрутов, который соответствует.</span><span class="sxs-lookup"><span data-stu-id="aabe0-145">The last item in `Routers` is the route handler that matched.</span></span>

### <a name="url-generation"></a><span data-ttu-id="aabe0-146">Создание URL-адреса</span><span class="sxs-lookup"><span data-stu-id="aabe0-146">URL generation</span></span>

<span data-ttu-id="aabe0-147">Создание URL-адрес — это процесс, с которых маршрутизация можно создавать на основе набора значений маршрута пути URL.</span><span class="sxs-lookup"><span data-stu-id="aabe0-147">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="aabe0-148">Это обеспечивает логическое разделение обработчиков и URL-адреса, которые обращаются к этим.</span><span class="sxs-lookup"><span data-stu-id="aabe0-148">This allows for a logical separation between your handlers and the URLs that access them.</span></span>

<span data-ttu-id="aabe0-149">Создания URL-адресов следует аналогичный итеративный процесс, но запускается пользователем или framework кода, вызывающего `GetVirtualPath` метод коллекции маршрутов.</span><span class="sxs-lookup"><span data-stu-id="aabe0-149">URL generation follows a similar iterative process, but starts with user or framework code calling into the `GetVirtualPath` method of the route collection.</span></span> <span data-ttu-id="aabe0-150">Каждый *маршрута* будет иметь его `GetVirtualPath` метод, вызываемый в последовательности до ненулевой `VirtualPathData` возвращается.</span><span class="sxs-lookup"><span data-stu-id="aabe0-150">Each *route* will then have its `GetVirtualPath` method called in sequence until a non-null `VirtualPathData` is returned.</span></span>

<span data-ttu-id="aabe0-151">Основной входные данные для `GetVirtualPath` являются:</span><span class="sxs-lookup"><span data-stu-id="aabe0-151">The primary inputs to `GetVirtualPath` are:</span></span>

* <span data-ttu-id="aabe0-152">`VirtualPathContext` `HttpContext`</span><span class="sxs-lookup"><span data-stu-id="aabe0-152">`VirtualPathContext` `HttpContext`</span></span>

* <span data-ttu-id="aabe0-153">`VirtualPathContext` `Values`</span><span class="sxs-lookup"><span data-stu-id="aabe0-153">`VirtualPathContext` `Values`</span></span>

* <span data-ttu-id="aabe0-154">`VirtualPathContext` `AmbientValues`</span><span class="sxs-lookup"><span data-stu-id="aabe0-154">`VirtualPathContext` `AmbientValues`</span></span>

<span data-ttu-id="aabe0-155">Маршруты в основном используют значения маршрута, предоставляемые `Values` и `AmbientValues` решаете, где можно создать URL-адрес и какие значения следует включить.</span><span class="sxs-lookup"><span data-stu-id="aabe0-155">Routes primarily use the route values provided by the `Values` and `AmbientValues` to decide where it is possible to generate a URL and what values to include.</span></span> <span data-ttu-id="aabe0-156">`AmbientValues` Представляют набор значений маршрута, которые были созданы из поиска соответствий текущего запроса с системы маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="aabe0-156">The `AmbientValues` are the set of route values that were produced from matching the current request with the routing system.</span></span> <span data-ttu-id="aabe0-157">Напротив `Values` значения маршрута, определяющие способ создания нужный URL-адреса для текущей операции.</span><span class="sxs-lookup"><span data-stu-id="aabe0-157">In contrast, `Values` are the route values that specify how to generate the desired URL for the current operation.</span></span> <span data-ttu-id="aabe0-158">`HttpContext` Предоставляется в случае, если маршрут должен получать служб или дополнительные данные, связанные с текущим контекстом.</span><span class="sxs-lookup"><span data-stu-id="aabe0-158">The `HttpContext` is provided in case a route needs to get services or additional data associated with the current context.</span></span>

<span data-ttu-id="aabe0-159">Совет: Можно рассматривать `Values` как набор переопределения для `AmbientValues`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-159">Tip: Think of `Values` as being a set of overrides for the `AmbientValues`.</span></span> <span data-ttu-id="aabe0-160">Создание URL-адрес пытается повторно использовать значения маршрута из текущего запроса для упрощения создания URL-адресов для ссылок с помощью того же маршрута и значения маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-160">URL generation tries to reuse route values from the current request to make it easy to generate URLs for links using the same route or route values.</span></span>

<span data-ttu-id="aabe0-161">Выходные данные `GetVirtualPath` — `VirtualPathData`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-161">The output of `GetVirtualPath` is a `VirtualPathData`.</span></span> <span data-ttu-id="aabe0-162">`VirtualPathData`является параллельное `RouteData`; он содержит `VirtualPath` выходной URL-адрес, а также некоторые дополнительные свойства, которые должны быть настроены с маршрутом.</span><span class="sxs-lookup"><span data-stu-id="aabe0-162">`VirtualPathData` is a parallel of `RouteData`; it contains the `VirtualPath` for the output URL as well as the some additional properties that should be set by the route.</span></span>

<span data-ttu-id="aabe0-163">`VirtualPathData` `VirtualPath` Свойство содержит *виртуальный путь* созданный маршрут.</span><span class="sxs-lookup"><span data-stu-id="aabe0-163">The `VirtualPathData` `VirtualPath` property contains the *virtual path* produced by the route.</span></span> <span data-ttu-id="aabe0-164">В зависимости от потребностей необходимо обработать дополнительные пути.</span><span class="sxs-lookup"><span data-stu-id="aabe0-164">Depending on your needs you may need to process the path further.</span></span> <span data-ttu-id="aabe0-165">Для экземпляра Если нужно отобразить созданный URL-адрес в формате HTML необходимо добавить базовый путь приложения.</span><span class="sxs-lookup"><span data-stu-id="aabe0-165">For instance, if you want to render the generated URL in HTML you need to prepend the base path of the application.</span></span>

<span data-ttu-id="aabe0-166">`VirtualPathData` `Router` Является ссылкой на маршрут, который успешно создал URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="aabe0-166">The `VirtualPathData` `Router` is a reference to the route that successfully generated the URL.</span></span>

<span data-ttu-id="aabe0-167">`VirtualPathData` `DataTokens` Свойства представляет собой словарь дополнительные данные, относящиеся к маршрута, созданный URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="aabe0-167">The `VirtualPathData` `DataTokens` properties is a dictionary of additional data related to the route that generated the URL.</span></span> <span data-ttu-id="aabe0-168">Это параллельный из `RouteData.DataTokens`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-168">This is the parallel of `RouteData.DataTokens`.</span></span>

### <a name="creating-routes"></a><span data-ttu-id="aabe0-169">Создание маршрутов</span><span class="sxs-lookup"><span data-stu-id="aabe0-169">Creating routes</span></span>

<span data-ttu-id="aabe0-170">Служба маршрутизации предоставляет `Route` класс как стандартную реализацию `IRouter`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-170">Routing provides the `Route` class as the standard implementation of `IRouter`.</span></span> <span data-ttu-id="aabe0-171">`Route`использует *шаблон маршрута* синтаксис для определения шаблонов, которые будут сравниваться с URL-адрес при `RouteAsync` вызывается.</span><span class="sxs-lookup"><span data-stu-id="aabe0-171">`Route` uses the *route template* syntax to define patterns that will match against the URL path when `RouteAsync` is called.</span></span> <span data-ttu-id="aabe0-172">`Route`будет использовать один и тот же шаблон маршрута для создания URL-адреса при `GetVirtualPath` вызывается.</span><span class="sxs-lookup"><span data-stu-id="aabe0-172">`Route` will use the same route template to generate a URL when `GetVirtualPath` is called.</span></span>

<span data-ttu-id="aabe0-173">Большинство приложений будет создать маршруты, вызвав `MapRoute` или одну из подобных методов расширения, определенные в `IRouteBuilder`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-173">Most applications will create routes by calling `MapRoute` or one of the similar extension methods defined on `IRouteBuilder`.</span></span> <span data-ttu-id="aabe0-174">Все эти методы будет создан экземпляр `Route` и добавьте его в коллекцию маршрутов.</span><span class="sxs-lookup"><span data-stu-id="aabe0-174">All of these methods will create an instance of `Route` and add it to the route collection.</span></span>

<span data-ttu-id="aabe0-175">Примечание: `MapRoute` не принимает параметр обработчика маршрута — он только добавляет маршруты, которые будут проводиться `DefaultHandler`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-175">Note: `MapRoute` doesn't take a route handler parameter - it only adds routes that will be handled by the `DefaultHandler`.</span></span> <span data-ttu-id="aabe0-176">Так как обработчик по умолчанию является `IRouter`, он может принять решение не обрабатывает запрос.</span><span class="sxs-lookup"><span data-stu-id="aabe0-176">Since the default handler is an `IRouter`, it may decide not to handle the request.</span></span> <span data-ttu-id="aabe0-177">Например ASP.NET MVC обычно настраивается, обработчик по умолчанию, который обрабатывает только запросы, которые соответствуют доступных контроллера и действия.</span><span class="sxs-lookup"><span data-stu-id="aabe0-177">For example, ASP.NET MVC is typically configured as a default handler that only handles requests that match an available controller and action.</span></span> <span data-ttu-id="aabe0-178">Дополнительные сведения о маршрутизации в MVC см. в разделе [маршрутизации для действий контроллеров](../mvc/controllers/routing.md).</span><span class="sxs-lookup"><span data-stu-id="aabe0-178">To learn more about routing to MVC, see [Routing to Controller Actions](../mvc/controllers/routing.md).</span></span>

<span data-ttu-id="aabe0-179">Это пример `MapRoute` вызов, используемый типичное определение маршрута ASP.NET MVC:</span><span class="sxs-lookup"><span data-stu-id="aabe0-179">This is an example of a `MapRoute` call used by a typical ASP.NET MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="aabe0-180">Этот шаблон будет соответствовать пути URL-адрес, например `/Products/Details/17` и извлечение значений маршрута `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-180">This template will match a URL path like `/Products/Details/17` and extract the route values `{ controller = Products, action = Details, id = 17 }`.</span></span> <span data-ttu-id="aabe0-181">Значения маршрута, определяются разделение на сегменты URL-адрес и сопоставления каждый сегмент *направления параметра* в шаблоне маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-181">The route values are determined by splitting the URL path into segments, and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="aabe0-182">Параметры маршрута являются именованными.</span><span class="sxs-lookup"><span data-stu-id="aabe0-182">Route parameters are named.</span></span> <span data-ttu-id="aabe0-183">Они определяются, заключив в фигурные скобки имя параметра `{ }`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-183">They are defined by enclosing the parameter name in braces `{ }`.</span></span>

<span data-ttu-id="aabe0-184">Выше шаблон может также соответствовать URL-адрес `/` и приведет к получению значения `{ controller = Home, action = Index }`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-184">The template above could also match the URL path `/` and would produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="aabe0-185">Это происходит потому, что `{controller}` и `{action}` маршрут иметь значения по умолчанию и `id` маршрута параметр является необязательным.</span><span class="sxs-lookup"><span data-stu-id="aabe0-185">This happens because the `{controller}` and `{action}` route parameters have default values, and the `id` route parameter is optional.</span></span> <span data-ttu-id="aabe0-186">Знак равенства `=` знак за которым следует значение после значения по умолчанию для параметра определяет имя параметра маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-186">An equals `=` sign followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="aabe0-187">Знак вопроса `?` после имени параметра маршрута определяет параметр необязательным.</span><span class="sxs-lookup"><span data-stu-id="aabe0-187">A question mark `?` after the route parameter name defines the parameter as optional.</span></span> <span data-ttu-id="aabe0-188">Направления параметра со значением по умолчанию *всегда* образует значение маршрута, если этот маршрут соответствует — необязательные параметры не дает значение маршрута в случае отсутствия нет соответствующий сегмент пути URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="aabe0-188">Route parameters with a default value *always* produce a route value when the route matches - optional parameters will not produce a route value if there was no corresponding URL path segment.</span></span>

<span data-ttu-id="aabe0-189">В разделе [ссылка на шаблон для маршрута](#route-template-reference) подробное описание функции шаблона маршрута и синтаксис.</span><span class="sxs-lookup"><span data-stu-id="aabe0-189">See [route-template-reference](#route-template-reference) for a thorough description of route template features and syntax.</span></span>

<span data-ttu-id="aabe0-190">Данный пример включает *маршрутизации ограничение*:</span><span class="sxs-lookup"><span data-stu-id="aabe0-190">This example includes a *route constraint*:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="aabe0-191">Этот шаблон будет соответствовать пути URL-адрес, например `/Products/Details/17`, но не `/Products/Details/Apples`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-191">This template will match a URL path like `/Products/Details/17`, but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="aabe0-192">Определение параметра маршрута `{id:int}` определяет *маршрутизации ограничение* для `id` направления параметра.</span><span class="sxs-lookup"><span data-stu-id="aabe0-192">The route parameter definition `{id:int}` defines a *route constraint* for the `id` route parameter.</span></span> <span data-ttu-id="aabe0-193">Ограничения маршрута реализовать `IRouteConstraint` и проверять значения маршрута, чтобы проверить их.</span><span class="sxs-lookup"><span data-stu-id="aabe0-193">Route constraints implement `IRouteConstraint` and inspect route values to verify them.</span></span> <span data-ttu-id="aabe0-194">В этом примере значение маршрута `id` должен допускать преобразование в целое число.</span><span class="sxs-lookup"><span data-stu-id="aabe0-194">In this example the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="aabe0-195">В разделе [ссылка для ограничения маршрута](#route-constraint-reference) более подробное описание ограничения маршрута, предоставляемых платформой.</span><span class="sxs-lookup"><span data-stu-id="aabe0-195">See [route-constraint-reference](#route-constraint-reference) for a more detailed explanation of route constraints that are provided by the framework.</span></span>

<span data-ttu-id="aabe0-196">Дополнительные перегрузки `MapRoute` примите значения для `constraints`, `dataTokens`, и `defaults`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-196">Additional overloads of `MapRoute` accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="aabe0-197">Эти дополнительные параметры `MapRoute` определяются как тип `object`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-197">These additional parameters of `MapRoute` are defined as type `object`.</span></span> <span data-ttu-id="aabe0-198">Типичное использование этих параметров является передача объект анонимно типизированных маршрутов имена свойств анонимного типа сопоставления имен параметров.</span><span class="sxs-lookup"><span data-stu-id="aabe0-198">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="aabe0-199">Следующие два примера создайте эквивалентные маршруты:</span><span class="sxs-lookup"><span data-stu-id="aabe0-199">The following two examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="aabe0-200">Совет: Встроенный синтаксис для определения ограничений и значений по умолчанию может быть более удобным для простой маршрутов.</span><span class="sxs-lookup"><span data-stu-id="aabe0-200">Tip: The inline syntax for defining constraints and defaults can be more convenient for simple routes.</span></span> <span data-ttu-id="aabe0-201">Однако есть функции, такие как маркеры данных, которые не поддерживаются встроенный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="aabe0-201">However, there are features such as data tokens which are not supported by inline syntax.</span></span>

<span data-ttu-id="aabe0-202">В этом примере показаны некоторые дополнительные возможности:</span><span class="sxs-lookup"><span data-stu-id="aabe0-202">This example demonstrates a few more features:</span></span>

```csharp
routes.MapRoute(
  name: "blog",
  template: "Blog/{*article}",
  defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="aabe0-203">Этот шаблон будет соответствовать пути URL-адрес, например `/Blog/All-About-Routing/Introduction` и будет извлекать значения `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-203">This template will match a URL path like `/Blog/All-About-Routing/Introduction` and will extract the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="aabe0-204">Значения маршрута по умолчанию для `controller` и `action` создаются в маршруте, даже если в шаблоне нет соответствующих параметров маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-204">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="aabe0-205">Значения по умолчанию, могут быть указаны в шаблоне маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-205">Default values can be specified in the route template.</span></span> <span data-ttu-id="aabe0-206">`article` Маршрут параметр определен как *универсальным* , внешний вид звездочка `*` перед именем параметра маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-206">The `article` route parameter is defined as a *catch-all* by the appearance of an asterisk `*` before the route parameter name.</span></span> <span data-ttu-id="aabe0-207">Параметры маршрута универсальным захватить остаток URL-адрес и также может совпасть с пустой строкой.</span><span class="sxs-lookup"><span data-stu-id="aabe0-207">Catch-all route parameters capture the remainder of the URL path, and can also match the empty string.</span></span>

<span data-ttu-id="aabe0-208">В этом примере добавляется маркеры ограничений и данные маршрута:</span><span class="sxs-lookup"><span data-stu-id="aabe0-208">This example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="aabe0-209">Этот шаблон будет соответствовать пути URL-адрес, например `/Products/5` и будет извлекать значения `{ controller = Products, action = Details, id = 5 }` и маркеры данных `{ locale = en-US }`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-209">This template will match a URL path like `/Products/5` and will extract the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Локальные токены Windows](routing/_static/tokens.png)

<a name=id1></a>

### <a name="url-generation"></a><span data-ttu-id="aabe0-211">Создание URL-адреса</span><span class="sxs-lookup"><span data-stu-id="aabe0-211">URL generation</span></span>

<span data-ttu-id="aabe0-212">`Route` Класс также может выполнять создания URL-адресов, объединяя набор значений маршрута с его шаблоном маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-212">The `Route` class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="aabe0-213">Это логически обратный процесс сопоставления URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="aabe0-213">This is logically the reverse process of matching the URL path.</span></span>

<span data-ttu-id="aabe0-214">Совет: Чтобы лучше понять создания URL-адресов, представьте себе какой URL-адрес, необходимо создать и затем подумайте о том, как шаблон маршрута будет соответствовать этот URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="aabe0-214">Tip: To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="aabe0-215">Какие значения будут получены?</span><span class="sxs-lookup"><span data-stu-id="aabe0-215">What values would be produced?</span></span> <span data-ttu-id="aabe0-216">Это эквивалентно грубого о принципах создания URL-адресов в `Route` класса.</span><span class="sxs-lookup"><span data-stu-id="aabe0-216">This is the rough equivalent of how URL generation works in the `Route` class.</span></span>

<span data-ttu-id="aabe0-217">В этом примере используется базовый стиль маршрут ASP.NET MVC:</span><span class="sxs-lookup"><span data-stu-id="aabe0-217">This example uses a basic ASP.NET MVC style route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="aabe0-218">С помощью значения маршрута `{ controller = Products, action = List }`, URL-адрес будет создать этот маршрут `/Products/List`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-218">With the route values `{ controller = Products, action = List }`, this route will generate the URL `/Products/List`.</span></span> <span data-ttu-id="aabe0-219">Значения маршрута, заменяются на соответствующие параметры маршрута для формирования URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="aabe0-219">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="aabe0-220">Поскольку `id` не является обязательной направления параметра, то это не проблема, что значение не указано.</span><span class="sxs-lookup"><span data-stu-id="aabe0-220">Since `id` is an optional route parameter, it's no problem that it doesn't have a value.</span></span>

<span data-ttu-id="aabe0-221">С помощью значения маршрута `{ controller = Home, action = Index }`, URL-адрес будет создать этот маршрут `/`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-221">With the route values `{ controller = Home, action = Index }`, this route will generate the URL `/`.</span></span> <span data-ttu-id="aabe0-222">Значения маршрута, которые были указаны соответствуют значениям по умолчанию, и сегменты, соответствующий эти значения можно безопасно пропустить.</span><span class="sxs-lookup"><span data-stu-id="aabe0-222">The route values that were provided match the default values so the segments corresponding to those values can be safely omitted.</span></span> <span data-ttu-id="aabe0-223">Обратите внимание, что URL-адресов обоих созданных приема-передачи с этим определением маршрута будет создавать одинаковые значения маршрута, которые были использованы для создания URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="aabe0-223">Note that both URLs generated would round-trip with this route definition and produce the same route values that were used to generate the URL.</span></span>

<span data-ttu-id="aabe0-224">Совет: Следует использовать приложения с помощью ASP.NET MVC `UrlHelper` для создания URL-адресов, а не вызывают непосредственно маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="aabe0-224">Tip: An app using ASP.NET MVC should use `UrlHelper` to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="aabe0-225">Дополнительные сведения о процессе создания URL-адреса см. в разделе [ссылка URL-адрес формирования](#url-generation-reference).</span><span class="sxs-lookup"><span data-stu-id="aabe0-225">For more details about the URL generation process, see [url-generation-reference](#url-generation-reference).</span></span>

## <a name="using-routing-middleware"></a><span data-ttu-id="aabe0-226">С помощью маршрутизации по промежуточного слоя</span><span class="sxs-lookup"><span data-stu-id="aabe0-226">Using Routing Middleware</span></span>

<span data-ttu-id="aabe0-227">Добавьте пакет NuGet «Microsoft.AspNetCore.Routing».</span><span class="sxs-lookup"><span data-stu-id="aabe0-227">Add the NuGet package "Microsoft.AspNetCore.Routing".</span></span>

<span data-ttu-id="aabe0-228">Добавить маршрут в контейнер службы в *файла Startup.cs*:</span><span class="sxs-lookup"><span data-stu-id="aabe0-228">Add routing to the service container in *Startup.cs*:</span></span>

<span data-ttu-id="aabe0-229">[!code-csharp[Main](../fundamentals/routing/sample/RoutingSample/Startup.cs?highlight=3&start=11&end=14)]</span><span class="sxs-lookup"><span data-stu-id="aabe0-229">[!code-csharp[Main](../fundamentals/routing/sample/RoutingSample/Startup.cs?highlight=3&start=11&end=14)]</span></span>

<span data-ttu-id="aabe0-230">Необходимо настроить маршруты в `Configure` метод `Startup` класса.</span><span class="sxs-lookup"><span data-stu-id="aabe0-230">Routes must be configured in the `Configure` method in the `Startup` class.</span></span> <span data-ttu-id="aabe0-231">В следующем примере использует эти API-интерфейсы:</span><span class="sxs-lookup"><span data-stu-id="aabe0-231">The sample below uses these APIs:</span></span>

* `RouteBuilder`
* `Build`
* <span data-ttu-id="aabe0-232">`MapGet`Соответствует только HTTP-запросы GET</span><span class="sxs-lookup"><span data-stu-id="aabe0-232">`MapGet`  Matches only HTTP GET requests</span></span>
* `UseRouter`

<!-- literal_block {"xml:space": "preserve", "source": "fundamentals/routing/sample/RoutingSample/Startup.cs", "ids": [], "linenos": false, "highlight_args": {"linenostart": 1}} -->

```csharp
public void Configure(IApplicationBuilder app, ILoggerFactory loggerFactory)
{
    var trackPackageRouteHandler = new RouteHandler(context =>
    {
        var routeValues = context.GetRouteData().Values;
        return context.Response.WriteAsync(
            $"Hello! Route values: {string.Join(", ", routeValues)}");
    });

    var routeBuilder = new RouteBuilder(app, trackPackageRouteHandler);

    routeBuilder.MapRoute(
        "Track Package Route",
        "package/{operation:regex(^(track|create|detonate)$)}/{id:int}");

    routeBuilder.MapGet("hello/{name}", context =>
    {
        var name = context.GetRouteValue("name");
        // This is the route handler when HTTP GET "hello/<anything>"  matches
        // To match HTTP GET "hello/<anything>/<anything>,
        // use routeBuilder.MapGet("hello/{*name}"
        return context.Response.WriteAsync($"Hi, {name}!");
    });

    var routes = routeBuilder.Build();
    app.UseRouter(routes);
}
```

<span data-ttu-id="aabe0-233">В таблице ниже показаны ответы с заданным URI.</span><span class="sxs-lookup"><span data-stu-id="aabe0-233">The table below shows the responses with the given URIs.</span></span>

| <span data-ttu-id="aabe0-234">URI</span><span class="sxs-lookup"><span data-stu-id="aabe0-234">URI</span></span> | <span data-ttu-id="aabe0-235">Ответ</span><span class="sxs-lookup"><span data-stu-id="aabe0-235">Response</span></span>  |
| ------- | -------- |
| <span data-ttu-id="aabe0-236">/Package/CREATE/3</span><span class="sxs-lookup"><span data-stu-id="aabe0-236">/package/create/3</span></span>  | <span data-ttu-id="aabe0-237">Hello!</span><span class="sxs-lookup"><span data-stu-id="aabe0-237">Hello!</span></span> <span data-ttu-id="aabe0-238">Значения маршрута: [операции создания], [идентификатор 3]</span><span class="sxs-lookup"><span data-stu-id="aabe0-238">Route values: [operation, create], [id, 3]</span></span> |
| <span data-ttu-id="aabe0-239">/ пакета и отслеживание/3</span><span class="sxs-lookup"><span data-stu-id="aabe0-239">/package/track/-3</span></span>  | <span data-ttu-id="aabe0-240">Hello!</span><span class="sxs-lookup"><span data-stu-id="aabe0-240">Hello!</span></span> <span data-ttu-id="aabe0-241">Значения маршрута: [операция, отслеживать] [идентификатор -3]</span><span class="sxs-lookup"><span data-stu-id="aabe0-241">Route values: [operation, track], [id, -3]</span></span> |
| <span data-ttu-id="aabe0-242">пакет, отслеживать/3 /</span><span class="sxs-lookup"><span data-stu-id="aabe0-242">/package/track/-3/</span></span> | <span data-ttu-id="aabe0-243">Hello!</span><span class="sxs-lookup"><span data-stu-id="aabe0-243">Hello!</span></span> <span data-ttu-id="aabe0-244">Значения маршрута: [операция, отслеживать] [идентификатор -3]</span><span class="sxs-lookup"><span data-stu-id="aabe0-244">Route values: [operation, track], [id, -3]</span></span>  |
| <span data-ttu-id="aabe0-245">/ Package/отслеживания /</span><span class="sxs-lookup"><span data-stu-id="aabe0-245">/package/track/</span></span> | <span data-ttu-id="aabe0-246">\<Переход в совпадение ></span><span class="sxs-lookup"><span data-stu-id="aabe0-246">\<Fall through, no match></span></span> |
| <span data-ttu-id="aabe0-247">ПОЛУЧИТЬ /hello/Joe</span><span class="sxs-lookup"><span data-stu-id="aabe0-247">GET /hello/Joe</span></span> | <span data-ttu-id="aabe0-248">Здравствуйте, Joe!</span><span class="sxs-lookup"><span data-stu-id="aabe0-248">Hi, Joe!</span></span> |
| <span data-ttu-id="aabe0-249">POST /hello/Joe</span><span class="sxs-lookup"><span data-stu-id="aabe0-249">POST /hello/Joe</span></span> | <span data-ttu-id="aabe0-250">\<Переход к следующему, соответствует только HTTP GET ></span><span class="sxs-lookup"><span data-stu-id="aabe0-250">\<Fall through, matches HTTP GET only></span></span> |
| <span data-ttu-id="aabe0-251">ПОЛУЧИТЬ /hello/Joe/Smith</span><span class="sxs-lookup"><span data-stu-id="aabe0-251">GET /hello/Joe/Smith</span></span> | <span data-ttu-id="aabe0-252">\<Переход в совпадение ></span><span class="sxs-lookup"><span data-stu-id="aabe0-252">\<Fall through, no match></span></span> |

<span data-ttu-id="aabe0-253">Если вы настраиваете один маршрут, вызовите `app.UseRouter` передав `IRouter` экземпляра.</span><span class="sxs-lookup"><span data-stu-id="aabe0-253">If you are configuring a single route, call `app.UseRouter` passing in an `IRouter` instance.</span></span> <span data-ttu-id="aabe0-254">Не требуется вызывать `RouteBuilder`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-254">You won't need to call `RouteBuilder`.</span></span>

<span data-ttu-id="aabe0-255">Платформа предоставляет набор методов для создания маршрутов, таких как:</span><span class="sxs-lookup"><span data-stu-id="aabe0-255">The framework provides a set of extension methods for creating routes such as:</span></span>

* `MapRoute`
* `MapGet`
* `MapPost`
* `MapPut`
* `MapDelete`
* `MapVerb`

<span data-ttu-id="aabe0-256">Некоторые из этих методов, таких как `MapGet` требуют `RequestDelegate` должны быть предоставлены.</span><span class="sxs-lookup"><span data-stu-id="aabe0-256">Some of these methods such as `MapGet` require a `RequestDelegate` to be provided.</span></span> <span data-ttu-id="aabe0-257">`RequestDelegate` Будет использоваться в качестве *обработчика маршрута* при этот маршрут соответствует.</span><span class="sxs-lookup"><span data-stu-id="aabe0-257">The `RequestDelegate` will be used as the *route handler* when the route matches.</span></span> <span data-ttu-id="aabe0-258">Другие методы в этом семействе позволяют настраивать конвейера по промежуточного слоя, который будет использоваться в качестве обработчика маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-258">Other methods in this family allow configuring a middleware pipeline which will be used as the route handler.</span></span> <span data-ttu-id="aabe0-259">Если *карты* метод не принимает обработчик, таких как `MapRoute`, то будет использоваться `DefaultHandler`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-259">If the *Map* method doesn't accept a handler, such as `MapRoute`, then it will use the `DefaultHandler`.</span></span>

<span data-ttu-id="aabe0-260">`Map[Verb]` Методы использования ограничений для ограничения маршрута HTTP-команда в имя метода.</span><span class="sxs-lookup"><span data-stu-id="aabe0-260">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="aabe0-261">Например, в разделе [MapGet](https://github.com/aspnet/Routing/blob/1.0.0/src/Microsoft.AspNetCore.Routing/RequestDelegateRouteBuilderExtensions.cs#L85-L88) и [MapVerb](https://github.com/aspnet/Routing/blob/1.0.0/src/Microsoft.AspNetCore.Routing/RequestDelegateRouteBuilderExtensions.cs#L156-L180).</span><span class="sxs-lookup"><span data-stu-id="aabe0-261">For example, see [MapGet](https://github.com/aspnet/Routing/blob/1.0.0/src/Microsoft.AspNetCore.Routing/RequestDelegateRouteBuilderExtensions.cs#L85-L88) and [MapVerb](https://github.com/aspnet/Routing/blob/1.0.0/src/Microsoft.AspNetCore.Routing/RequestDelegateRouteBuilderExtensions.cs#L156-L180).</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="aabe0-262">Ссылка на шаблон маршрута</span><span class="sxs-lookup"><span data-stu-id="aabe0-262">Route Template Reference</span></span>

<span data-ttu-id="aabe0-263">Токены внутри фигурных скобок (`{ }`) определяют *направления параметров* которой будет привязан расстановке маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-263">Tokens within curly braces (`{ }`) define *route parameters* which will be bound if the route is matched.</span></span> <span data-ttu-id="aabe0-264">Можно определить более одного параметра маршрута в сегменте маршрута, но они должны быть разделены литеральное значение.</span><span class="sxs-lookup"><span data-stu-id="aabe0-264">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="aabe0-265">Например `{controller=Home}{action=Index}` будет допустимым маршрута, так как нет литерального значения между `{controller}` и `{action}`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-265">For example `{controller=Home}{action=Index}` would not be a valid route, since there is no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="aabe0-266">Эти параметры маршрута должен иметь имя и может быть указан дополнительные атрибуты.</span><span class="sxs-lookup"><span data-stu-id="aabe0-266">These route parameters must have a name, and may have additional attributes specified.</span></span>

<span data-ttu-id="aabe0-267">Литеральный текст, отличные от параметров маршрута (например, `{id}`) и разделитель пути `/` должны соответствовать тексту в URL-АДРЕСЕ.</span><span class="sxs-lookup"><span data-stu-id="aabe0-267">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="aabe0-268">Совпадений текста без учета регистра и основан на декодированное представление пути URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="aabe0-268">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="aabe0-269">Сопоставляемый параметр разделитель литерала маршрута `{` или `}`, экранировать его повторяя символ (`{{` или `}}`).</span><span class="sxs-lookup"><span data-stu-id="aabe0-269">To match the literal route parameter delimiter `{` or  `}`, escape it by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="aabe0-270">Шаблоны URL-адресов, которые пытаются записать имя файла с расширением необязательно иметь дополнительные соображения.</span><span class="sxs-lookup"><span data-stu-id="aabe0-270">URL patterns that attempt to capture a filename with an optional file extension have additional considerations.</span></span> <span data-ttu-id="aabe0-271">Например, с помощью шаблона `files/{filename}.{ext?}` — Если оба `filename` и `ext` существует, оба значения будут заполнены.</span><span class="sxs-lookup"><span data-stu-id="aabe0-271">For example, using the template `files/{filename}.{ext?}` - When both `filename` and `ext` exist, both values will be populated.</span></span> <span data-ttu-id="aabe0-272">Если только `filename` существует в URL-адрес маршрута совпадений, так как завершающие период `.` является необязательным.</span><span class="sxs-lookup"><span data-stu-id="aabe0-272">If only `filename` exists in the URL, the route matches because the trailing period `.` is  optional.</span></span> <span data-ttu-id="aabe0-273">Следующие URL-адреса будет соответствовать этому маршруту:</span><span class="sxs-lookup"><span data-stu-id="aabe0-273">The following URLs would match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile.`
* `/files/myFile`

<span data-ttu-id="aabe0-274">Можно использовать `*` символ в качестве префикса для параметра маршрута для привязки к остальная часть URI - это называется *универсальным* параметра.</span><span class="sxs-lookup"><span data-stu-id="aabe0-274">You can use the `*` character as a prefix to a route parameter to bind to the rest of the URI - this is called a *catch-all* parameter.</span></span> <span data-ttu-id="aabe0-275">Например `blog/{*slug}` будет соответствовать любой URI, который запущен с `/blog` и любое значение, следующий за ним (которого будет назначаться `slug` маршрутизации значение).</span><span class="sxs-lookup"><span data-stu-id="aabe0-275">For example, `blog/{*slug}` would match any URI that started with `/blog` and had any value following it (which would be assigned to the `slug` route value).</span></span> <span data-ttu-id="aabe0-276">Параметры универсальным также может совпасть с пустой строкой.</span><span class="sxs-lookup"><span data-stu-id="aabe0-276">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="aabe0-277">Возможно, параметры маршрута *значения по умолчанию*назначенной, указав значение по умолчанию после имени параметра, разделенные `=`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-277">Route parameters may have *default values*, designated by specifying the default after the parameter name, separated by an `=`.</span></span> <span data-ttu-id="aabe0-278">Например `{controller=Home}` обычно определяются `Home` как значение по умолчанию для `controller`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-278">For example, `{controller=Home}` would define `Home` as the default value for `controller`.</span></span> <span data-ttu-id="aabe0-279">Значение по умолчанию используется в том случае, если значение не присутствуют в URL-адрес для параметра.</span><span class="sxs-lookup"><span data-stu-id="aabe0-279">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="aabe0-280">Помимо значения по умолчанию параметров маршрута может быть необязательным (указан путем добавления `?` в конец имени параметра, как `id?`).</span><span class="sxs-lookup"><span data-stu-id="aabe0-280">In addition to default values, route parameters may be optional (specified by appending a `?` to the end of the parameter name, as in `id?`).</span></span> <span data-ttu-id="aabe0-281">Разница между необязательный и «имеет значение по умолчанию», параметр маршрута со значением по умолчанию всегда возвращает значение, указывающее; Необязательный параметр имеет значение только в том случае, если таковой имеется.</span><span class="sxs-lookup"><span data-stu-id="aabe0-281">The difference between optional and "has default" is that a route parameter with a default value always produces a value; an optional parameter has a value only when one is provided.</span></span>

<span data-ttu-id="aabe0-282">Параметры маршрута также могут иметь ограничения, которые должны соответствовать значения маршрута, связанного с URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="aabe0-282">Route parameters may also have constraints, which must match the route value bound from the URL.</span></span> <span data-ttu-id="aabe0-283">Добавление двоеточия `:` и имя ограничения после указывает имя параметра маршрута *встроенное ограничение* для параметра маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-283">Adding a colon `:` and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="aabe0-284">Если ограничение требует аргументы, те, предоставляемых заключены в круглые скобки `( )` после имени ограничения.</span><span class="sxs-lookup"><span data-stu-id="aabe0-284">If the constraint requires arguments those are provided enclosed in parentheses `( )` after the constraint name.</span></span> <span data-ttu-id="aabe0-285">Несколько встроенных ограничений, которые можно задать путем добавления другого двоеточие `:` и имя ограничения.</span><span class="sxs-lookup"><span data-stu-id="aabe0-285">Multiple inline constraints can be specified by appending another colon `:` and constraint name.</span></span> <span data-ttu-id="aabe0-286">Имя ограничения передается `IInlineConstraintResolver` службы для создания экземпляра `IRouteConstraint` для использования при обработке URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="aabe0-286">The constraint name is passed to the `IInlineConstraintResolver` service to create an instance of `IRouteConstraint` to use in URL processing.</span></span> <span data-ttu-id="aabe0-287">Например, шаблон маршрута `blog/{article:minlength(10)}` указывает `minlength` ограничение с аргументом `10`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-287">For example, the route template `blog/{article:minlength(10)}` specifies the `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="aabe0-288">Дополнительные ограничения маршрута описание и список ограничений, которые предоставляет платформа см. в разделе [ссылка для ограничения маршрута](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="aabe0-288">For more description route constraints, and a listing of the constraints provided by the framework, see [route-constraint-reference](#route-constraint-reference).</span></span>

<span data-ttu-id="aabe0-289">В следующей таблице продемонстрированы некоторые шаблоны маршрута и их поведение.</span><span class="sxs-lookup"><span data-stu-id="aabe0-289">The following table demonstrates some route templates and their behavior.</span></span>

| <span data-ttu-id="aabe0-290">Шаблон маршрута</span><span class="sxs-lookup"><span data-stu-id="aabe0-290">Route Template</span></span> | <span data-ttu-id="aabe0-291">Пример сопоставления URL-адреса</span><span class="sxs-lookup"><span data-stu-id="aabe0-291">Example Matching URL</span></span> | <span data-ttu-id="aabe0-292">Примечания</span><span class="sxs-lookup"><span data-stu-id="aabe0-292">Notes</span></span> |
| -------- | -------- | ------- |
| <span data-ttu-id="aabe0-293">hello</span><span class="sxs-lookup"><span data-stu-id="aabe0-293">hello</span></span>  | <span data-ttu-id="aabe0-294">/Hello</span><span class="sxs-lookup"><span data-stu-id="aabe0-294">/hello</span></span>  | <span data-ttu-id="aabe0-295">Соответствует только один путь`/hello`</span><span class="sxs-lookup"><span data-stu-id="aabe0-295">Only matches the single path `/hello`</span></span> |
| <span data-ttu-id="aabe0-296">{Страницы = Home}</span><span class="sxs-lookup"><span data-stu-id="aabe0-296">{Page=Home}</span></span> | / | <span data-ttu-id="aabe0-297">Соответствует и задает `Page` для`Home`</span><span class="sxs-lookup"><span data-stu-id="aabe0-297">Matches and sets `Page` to `Home`</span></span> |
| <span data-ttu-id="aabe0-298">{Страницы = Home}</span><span class="sxs-lookup"><span data-stu-id="aabe0-298">{Page=Home}</span></span>  | <span data-ttu-id="aabe0-299">Или обратитесь в службу</span><span class="sxs-lookup"><span data-stu-id="aabe0-299">/Contact</span></span>  | <span data-ttu-id="aabe0-300">Соответствует и задает `Page` для`Contact`</span><span class="sxs-lookup"><span data-stu-id="aabe0-300">Matches and sets `Page` to `Contact`</span></span> |
| <span data-ttu-id="aabe0-301">{controller} / {action} / {id}?</span><span class="sxs-lookup"><span data-stu-id="aabe0-301">{controller}/{action}/{id?}</span></span> | <span data-ttu-id="aabe0-302">/ / Список продуктов</span><span class="sxs-lookup"><span data-stu-id="aabe0-302">/Products/List</span></span> | <span data-ttu-id="aabe0-303">Сопоставляет `Products` контроллера и `List` действие</span><span class="sxs-lookup"><span data-stu-id="aabe0-303">Maps to `Products` controller and `List`  action</span></span> |
| <span data-ttu-id="aabe0-304">{controller} / {action} / {id}?</span><span class="sxs-lookup"><span data-stu-id="aabe0-304">{controller}/{action}/{id?}</span></span> | <span data-ttu-id="aabe0-305">/ Продукты/подробности/123</span><span class="sxs-lookup"><span data-stu-id="aabe0-305">/Products/Details/123</span></span>  |  <span data-ttu-id="aabe0-306">Сопоставляет `Products` контроллера и `Details` действие.</span><span class="sxs-lookup"><span data-stu-id="aabe0-306">Maps to `Products` controller and  `Details` action.</span></span>  <span data-ttu-id="aabe0-307">`id`значение 123</span><span class="sxs-lookup"><span data-stu-id="aabe0-307">`id` set to 123</span></span> |
| <span data-ttu-id="aabe0-308">{контроллера = Home} / {action = индекс} / {id}?</span><span class="sxs-lookup"><span data-stu-id="aabe0-308">{controller=Home}/{action=Index}/{id?}</span></span> | /  |  <span data-ttu-id="aabe0-309">Сопоставляет `Home` контроллера и `Index` метода. `id` учитывается.</span><span class="sxs-lookup"><span data-stu-id="aabe0-309">Maps to `Home` controller and `Index`  method; `id` is ignored.</span></span> |

<span data-ttu-id="aabe0-310">С помощью шаблона обычно является самым простым подходом к маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="aabe0-310">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="aabe0-311">Ограничения по умолчанию можно также указать за пределами шаблона маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-311">Constraints and defaults can also be specified outside the route template.</span></span>

<span data-ttu-id="aabe0-312">Совет: Включить [ведение журнала](logging.md) для просмотра как встроенных реализаций маршрутизации, такие как `Route`, соответствовать запросам.</span><span class="sxs-lookup"><span data-stu-id="aabe0-312">Tip: Enable [Logging](logging.md) to see how the built in routing implementations, such as `Route`, match requests.</span></span>

## <a name="route-constraint-reference"></a><span data-ttu-id="aabe0-313">Ссылка на ограничения маршрута</span><span class="sxs-lookup"><span data-stu-id="aabe0-313">Route Constraint Reference</span></span>

<span data-ttu-id="aabe0-314">Ограничения маршрута выполняемую при `Route` имеет соответствует синтаксис входящего URL-адреса и размечается URL-адрес в значения маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-314">Route constraints execute when a `Route` has matched the syntax of the incoming URL and tokenized the URL path into route values.</span></span> <span data-ttu-id="aabe0-315">Ограничения маршрута обычно проверить значение маршрута, связанные через шаблон маршрута и внесите простой Да/Нет принятия решений о того, является ли значение допустимым.</span><span class="sxs-lookup"><span data-stu-id="aabe0-315">Route constraints generally inspect the route value associated via the route template and make a simple yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="aabe0-316">Некоторые ограничения маршрута используйте данные вне значения маршрута необходимо учитывать, можно ли отправить запрос.</span><span class="sxs-lookup"><span data-stu-id="aabe0-316">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="aabe0-317">Например `HttpMethodRouteConstraint` может принять или отклонить запрос на основе его команд HTTP.</span><span class="sxs-lookup"><span data-stu-id="aabe0-317">For example, the `HttpMethodRouteConstraint` can accept or reject a request based on its HTTP verb.</span></span>

>[!WARNING]
> <span data-ttu-id="aabe0-318">Старайтесь не использовать ограничения для **проверку входных данных**, так как при этом, введено недопустимое приведет к 404 (не найдено) вместо 400 с соответствующее сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="aabe0-318">Avoid using constraints for **input validation**, because doing so means that invalid input will result in a 404 (Not Found) instead of a 400 with an appropriate error message.</span></span> <span data-ttu-id="aabe0-319">Ограничения маршрута должна быть использована для **устранения неоднозначности** между похожие маршруты не будет выполнять проверку входных данных для определенного маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-319">Route constraints should be used to **disambiguate** between similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="aabe0-320">В следующей таблице продемонстрированы некоторые ограничения маршрута и их ожидаемого поведения.</span><span class="sxs-lookup"><span data-stu-id="aabe0-320">The following table demonstrates some route constraints and their expected behavior.</span></span>

| <span data-ttu-id="aabe0-321">ограничение</span><span class="sxs-lookup"><span data-stu-id="aabe0-321">constraint</span></span> | <span data-ttu-id="aabe0-322">Пример</span><span class="sxs-lookup"><span data-stu-id="aabe0-322">Example</span></span> | <span data-ttu-id="aabe0-323">Пример совпадений</span><span class="sxs-lookup"><span data-stu-id="aabe0-323">Example Matches</span></span> | <span data-ttu-id="aabe0-324">Примечания</span><span class="sxs-lookup"><span data-stu-id="aabe0-324">Notes</span></span> |
| --------   | ------- | ------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="aabe0-325">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="aabe0-325">`123456789`, `-123456789`</span></span>  | <span data-ttu-id="aabe0-326">Соответствует любому целому</span><span class="sxs-lookup"><span data-stu-id="aabe0-326">Matches any integer</span></span> |
| `bool`  | `{active:bool}` | <span data-ttu-id="aabe0-327">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="aabe0-327">`true`, `FALSE`</span></span> | <span data-ttu-id="aabe0-328">Соответствует `true` или `false` (без учета регистра)</span><span class="sxs-lookup"><span data-stu-id="aabe0-328">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="aabe0-329">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="aabe0-329">`2016-12-31`, `2016-12-31 7:32pm`</span></span>  | <span data-ttu-id="aabe0-330">Соответствует допустимым `DateTime` значение (в инвариантный язык и региональные параметры — см. предупреждение)</span><span class="sxs-lookup"><span data-stu-id="aabe0-330">Matches a valid `DateTime` value (in the invariant culture - see warning)</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="aabe0-331">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="aabe0-331">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="aabe0-332">Соответствует допустимым `decimal` значение (в инвариантный язык и региональные параметры — см. предупреждение)</span><span class="sxs-lookup"><span data-stu-id="aabe0-332">Matches a valid `decimal` value (in the invariant culture - see warning)</span></span> |
| `double`  | `{weight:double}` | <span data-ttu-id="aabe0-333">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="aabe0-333">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="aabe0-334">Соответствует допустимым `double` значение (в инвариантный язык и региональные параметры — см. предупреждение)</span><span class="sxs-lookup"><span data-stu-id="aabe0-334">Matches a valid `double` value (in the invariant culture - see warning)</span></span> |
| `float`  | `{weight:float}` | <span data-ttu-id="aabe0-335">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="aabe0-335">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="aabe0-336">Соответствует допустимым `float` значение (в инвариантный язык и региональные параметры — см. предупреждение)</span><span class="sxs-lookup"><span data-stu-id="aabe0-336">Matches a valid `float` value (in the invariant culture - see warning)</span></span> |
| `guid`  | `{id:guid}` | <span data-ttu-id="aabe0-337">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="aabe0-337">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="aabe0-338">Соответствует допустимым `Guid` значение</span><span class="sxs-lookup"><span data-stu-id="aabe0-338">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="aabe0-339">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="aabe0-339">`123456789`, `-123456789`</span></span> | <span data-ttu-id="aabe0-340">Соответствует допустимым `long` значение</span><span class="sxs-lookup"><span data-stu-id="aabe0-340">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="aabe0-341">Строка должна быть менее 4 символов</span><span class="sxs-lookup"><span data-stu-id="aabe0-341">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="aabe0-342">Строка должна быть не более 8 символов.</span><span class="sxs-lookup"><span data-stu-id="aabe0-342">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="aabe0-343">Строка должна быть ровно 12 символов</span><span class="sxs-lookup"><span data-stu-id="aabe0-343">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="aabe0-344">Строка должна быть 8 и более 16 символов</span><span class="sxs-lookup"><span data-stu-id="aabe0-344">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="aabe0-345">Целое значение должно быть по крайней мере 18</span><span class="sxs-lookup"><span data-stu-id="aabe0-345">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` |  `91` | <span data-ttu-id="aabe0-346">Целое значение должно быть не более 120</span><span class="sxs-lookup"><span data-stu-id="aabe0-346">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="aabe0-347">Целое значение должно быть по крайней мере 18, но не более 120</span><span class="sxs-lookup"><span data-stu-id="aabe0-347">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="aabe0-348">Строка должен состоять из одного или нескольких символов алфавита (`a`-`z`, без учета регистра)</span><span class="sxs-lookup"><span data-stu-id="aabe0-348">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="aabe0-349">Строка должна соответствовать регулярному выражению (см. Советы по определение регулярного выражения)</span><span class="sxs-lookup"><span data-stu-id="aabe0-349">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required`  | `{name:required}` | `Rick` |  <span data-ttu-id="aabe0-350">Принудительно обеспечивает, что значение не параметра присутствует во время создания URL-адресов</span><span class="sxs-lookup"><span data-stu-id="aabe0-350">Used to enforce that a non-parameter value is present during URL generation</span></span> |

>[!WARNING]
> <span data-ttu-id="aabe0-351">Ограничения маршрута, позволяющие проверить URL-адрес можно преобразовать в тип CLR (например, `int` или `DateTime`) всегда использовать инвариантный язык и региональные параметры — они предполагают нелокализуемые URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="aabe0-351">Route constraints that verify the URL can be converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture - they assume the URL is non-localizable.</span></span> <span data-ttu-id="aabe0-352">Ограничения маршрута, предоставленные платформой, не изменяйте значения, хранящиеся в значения маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-352">The framework-provided route constraints do not modify the values stored in route values.</span></span> <span data-ttu-id="aabe0-353">Все значения маршрута, извлеченными из URL-адрес будет храниться в виде строк.</span><span class="sxs-lookup"><span data-stu-id="aabe0-353">All route values parsed from the URL will be stored as strings.</span></span> <span data-ttu-id="aabe0-354">Например [ограничения маршрута Float](https://github.com/aspnet/Routing/blob/1.0.0/src/Microsoft.AspNetCore.Routing/Constraints/FloatRouteConstraint.cs#L44-L60) будет предпринята попытка преобразовать значение маршрут в float, но преобразованное значение используется только для проверки может быть преобразована в значение с плавающей запятой.</span><span class="sxs-lookup"><span data-stu-id="aabe0-354">For example, the [Float route constraint](https://github.com/aspnet/Routing/blob/1.0.0/src/Microsoft.AspNetCore.Routing/Constraints/FloatRouteConstraint.cs#L44-L60) will attempt to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="aabe0-355">Регулярные выражения</span><span class="sxs-lookup"><span data-stu-id="aabe0-355">Regular expressions</span></span> 

<span data-ttu-id="aabe0-356">Платформа ASP.NET Core добавляет `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` конструктору регулярного выражения.</span><span class="sxs-lookup"><span data-stu-id="aabe0-356">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="aabe0-357">В разделе [перечисление RegexOptions](https://msdn.microsoft.com/library/system.text.regularexpressions.regexoptions(v=vs.110).aspx) описание этих членов.</span><span class="sxs-lookup"><span data-stu-id="aabe0-357">See [RegexOptions Enumeration](https://msdn.microsoft.com/library/system.text.regularexpressions.regexoptions(v=vs.110).aspx) for a description of these members.</span></span>

<span data-ttu-id="aabe0-358">Регулярные выражения Используйте разделители и маркеров, аналогичны выполняемым службой маршрутизации и в языке C#.</span><span class="sxs-lookup"><span data-stu-id="aabe0-358">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="aabe0-359">Необходимо экранировать токены регулярного выражения.</span><span class="sxs-lookup"><span data-stu-id="aabe0-359">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="aabe0-360">Например, чтобы использовать регулярное выражение `^\d{3}-\d{2}-\d{4}$` в маршрутизации, она должна иметь `\` символов, введенных в качестве `\\` в C# исходный файл для экранирования `\` строка escape-символ (если используется [verbatim строковые литералы](https://msdn.microsoft.com/library/aa691090(v=vs.71).aspx)).</span><span class="sxs-lookup"><span data-stu-id="aabe0-360">For example, to use the regular expression `^\d{3}-\d{2}-\d{4}$` in Routing, it needs to have the `\` characters typed in as `\\` in the C# source file to escape the `\` string escape character (unless using [verbatim string literals](https://msdn.microsoft.com/library/aa691090(v=vs.71).aspx)).</span></span> <span data-ttu-id="aabe0-361">`{` , `}` , "[" И "]" символы следует экранировать путем удвоения их escape-символы-разделители параметров службы маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="aabe0-361">The `{` , `}` , '[' and ']' characters need to be escaped by doubling them to escape the Routing parameter delimiter characters.</span></span>  <span data-ttu-id="aabe0-362">В следующей таблице показаны регулярного выражения и escape-версии.</span><span class="sxs-lookup"><span data-stu-id="aabe0-362">The table below shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="aabe0-363">Выражение</span><span class="sxs-lookup"><span data-stu-id="aabe0-363">Expression</span></span>               | <span data-ttu-id="aabe0-364">Бумага для заметок</span><span class="sxs-lookup"><span data-stu-id="aabe0-364">Note</span></span> |
| ----------------- | ------------ | 
| `^\d{3}-\d{2}-\d{4}$` | <span data-ttu-id="aabe0-365">Регулярное выражение</span><span class="sxs-lookup"><span data-stu-id="aabe0-365">Regular expression</span></span> |
| `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` | <span data-ttu-id="aabe0-366">Escape-последовательность</span><span class="sxs-lookup"><span data-stu-id="aabe0-366">Escaped</span></span>  |
| `^[a-z]{2}$` | <span data-ttu-id="aabe0-367">Регулярное выражение</span><span class="sxs-lookup"><span data-stu-id="aabe0-367">Regular expression</span></span> |
| `^[[a-z]]{{2}}$` | <span data-ttu-id="aabe0-368">Escape-последовательность</span><span class="sxs-lookup"><span data-stu-id="aabe0-368">Escaped</span></span>  |

<span data-ttu-id="aabe0-369">Регулярные выражения, используемые в маршрутизации часто начинается с `^` (совпадение начальной позиции строки) буквы и заканчиваться `$` символ (конечное положение строки совпадают).</span><span class="sxs-lookup"><span data-stu-id="aabe0-369">Regular expressions used in routing will often start with the `^` character (match starting position of the string) and end with the `$` character (match ending position of the string).</span></span> <span data-ttu-id="aabe0-370">`^` И `$` символов убедитесь, что соответствует регулярному выражению значение параметра всем маршруте.</span><span class="sxs-lookup"><span data-stu-id="aabe0-370">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="aabe0-371">Без `^` и `$` символов регулярных выражений будет соответствовать любой подстроке внутри строки, который часто не требуется.</span><span class="sxs-lookup"><span data-stu-id="aabe0-371">Without the `^` and `$` characters the regular expression will match any sub-string within the string, which is often not what you want.</span></span> <span data-ttu-id="aabe0-372">В следующей таблице показаны некоторые примеры и объясняется, почему они совпадают, или не соответствует.</span><span class="sxs-lookup"><span data-stu-id="aabe0-372">The table below shows some examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="aabe0-373">Выражение</span><span class="sxs-lookup"><span data-stu-id="aabe0-373">Expression</span></span>               | <span data-ttu-id="aabe0-374">Строка</span><span class="sxs-lookup"><span data-stu-id="aabe0-374">String</span></span> | <span data-ttu-id="aabe0-375">Соответствие</span><span class="sxs-lookup"><span data-stu-id="aabe0-375">Match</span></span> | <span data-ttu-id="aabe0-376">Комментарий</span><span class="sxs-lookup"><span data-stu-id="aabe0-376">Comment</span></span> |
| ----------------- | ------------ |  ------------ |  ------------ | 
| `[a-z]{2}` | <span data-ttu-id="aabe0-377">hello</span><span class="sxs-lookup"><span data-stu-id="aabe0-377">hello</span></span> | <span data-ttu-id="aabe0-378">да</span><span class="sxs-lookup"><span data-stu-id="aabe0-378">yes</span></span> | <span data-ttu-id="aabe0-379">совпадений подстрок</span><span class="sxs-lookup"><span data-stu-id="aabe0-379">substring matches</span></span> |
| `[a-z]{2}` | <span data-ttu-id="aabe0-380">123abc456</span><span class="sxs-lookup"><span data-stu-id="aabe0-380">123abc456</span></span> | <span data-ttu-id="aabe0-381">да</span><span class="sxs-lookup"><span data-stu-id="aabe0-381">yes</span></span> | <span data-ttu-id="aabe0-382">совпадений подстрок</span><span class="sxs-lookup"><span data-stu-id="aabe0-382">substring matches</span></span> |
| `[a-z]{2}` | <span data-ttu-id="aabe0-383">mz</span><span class="sxs-lookup"><span data-stu-id="aabe0-383">mz</span></span> | <span data-ttu-id="aabe0-384">да</span><span class="sxs-lookup"><span data-stu-id="aabe0-384">yes</span></span> | <span data-ttu-id="aabe0-385">соответствует выражению</span><span class="sxs-lookup"><span data-stu-id="aabe0-385">matches expression</span></span> |
| `[a-z]{2}` | <span data-ttu-id="aabe0-386">MZ</span><span class="sxs-lookup"><span data-stu-id="aabe0-386">MZ</span></span> | <span data-ttu-id="aabe0-387">да</span><span class="sxs-lookup"><span data-stu-id="aabe0-387">yes</span></span> | <span data-ttu-id="aabe0-388">без учета регистра</span><span class="sxs-lookup"><span data-stu-id="aabe0-388">not case sensitive</span></span> |
| `^[a-z]{2}$` |  <span data-ttu-id="aabe0-389">hello</span><span class="sxs-lookup"><span data-stu-id="aabe0-389">hello</span></span> | <span data-ttu-id="aabe0-390">Нет</span><span class="sxs-lookup"><span data-stu-id="aabe0-390">no</span></span> | <span data-ttu-id="aabe0-391">в разделе `^` и `$` выше</span><span class="sxs-lookup"><span data-stu-id="aabe0-391">see `^` and `$` above</span></span> |
| `^[a-z]{2}$` |  <span data-ttu-id="aabe0-392">123abc456</span><span class="sxs-lookup"><span data-stu-id="aabe0-392">123abc456</span></span> | <span data-ttu-id="aabe0-393">Нет</span><span class="sxs-lookup"><span data-stu-id="aabe0-393">no</span></span> | <span data-ttu-id="aabe0-394">в разделе `^` и `$` выше</span><span class="sxs-lookup"><span data-stu-id="aabe0-394">see `^` and `$` above</span></span> |

<span data-ttu-id="aabe0-395">Ссылаться на [регулярные выражения .NET Framework](https://msdn.microsoft.com/library/hs600312(v=vs.110).aspx) Дополнительные сведения о синтаксисе регулярных выражений.</span><span class="sxs-lookup"><span data-stu-id="aabe0-395">Refer to [.NET Framework Regular Expressions](https://msdn.microsoft.com/library/hs600312(v=vs.110).aspx) for more information on regular expression syntax.</span></span>

<span data-ttu-id="aabe0-396">Ограничение параметра с известным набором возможных значений, используйте регулярные выражения.</span><span class="sxs-lookup"><span data-stu-id="aabe0-396">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="aabe0-397">Например `{action:regex(^(list|get|create)$)}` соответствует только `action` маршрутизации значение `list`, `get`, или `create`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-397">For example `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="aabe0-398">При передаче в словарь ограничения, строка «^ (список | get | создать) $» соответствует.</span><span class="sxs-lookup"><span data-stu-id="aabe0-398">If passed into the constraints dictionary, the string "^(list|get|create)$" would be equivalent.</span></span> <span data-ttu-id="aabe0-399">Ограничения, передаваемые в словаре ограничения (не inline внутри шаблона), которые не соответствуют одному из известных ограничений также рассматриваются как регулярные выражения.</span><span class="sxs-lookup"><span data-stu-id="aabe0-399">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="url-generation-reference"></a><span data-ttu-id="aabe0-400">Создание URL-ссылки</span><span class="sxs-lookup"><span data-stu-id="aabe0-400">URL Generation Reference</span></span>

<span data-ttu-id="aabe0-401">В приведенном ниже примере показано, как создать ссылку на заданный словарь значений маршрута маршрут и `RouteCollection`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-401">The example below shows how to generate a link to a route given a dictionary of route values and a `RouteCollection`.</span></span>

<span data-ttu-id="aabe0-402">[!code-csharp[Main](../fundamentals/routing/sample/RoutingSample/Startup.cs?range=45-59)]</span><span class="sxs-lookup"><span data-stu-id="aabe0-402">[!code-csharp[Main](../fundamentals/routing/sample/RoutingSample/Startup.cs?range=45-59)]</span></span>

<span data-ttu-id="aabe0-403">`VirtualPath` Создан в конце в предыдущем примере является `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-403">The `VirtualPath` generated at the end of the sample above is `/package/create/123`.</span></span>

<span data-ttu-id="aabe0-404">Второй параметр для `VirtualPathContext` конструктор — это совокупность *окружения значения*.</span><span class="sxs-lookup"><span data-stu-id="aabe0-404">The second parameter to the `VirtualPathContext` constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="aabe0-405">Окружения значения более удобного, ограничивая количество значений, которые разработчик должен указать в определенном контексте запроса.</span><span class="sxs-lookup"><span data-stu-id="aabe0-405">Ambient values provide convenience by limiting the number of values a developer must specify within a certain request context.</span></span> <span data-ttu-id="aabe0-406">Текущие значения маршрута из текущего запроса считаются окружения значения для генерации ссылок.</span><span class="sxs-lookup"><span data-stu-id="aabe0-406">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="aabe0-407">Например, в приложении ASP.NET MVC в `About` действие `HomeController`, не требуется задать значение маршрута контроллера для связи с `Index` действия (внешнее значение `Home` будет использоваться).</span><span class="sxs-lookup"><span data-stu-id="aabe0-407">For example, in an ASP.NET MVC app if you are in the `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action (the ambient value of `Home` will be used).</span></span>

<span data-ttu-id="aabe0-408">Окружения значения, не соответствующие параметру учитываются и окружения значения также игнорируются, явно предоставленные значение переопределяет, отсчитываемого слева направо в URL-АДРЕСЕ.</span><span class="sxs-lookup"><span data-stu-id="aabe0-408">Ambient values that don't match a parameter are ignored, and ambient values are also ignored when an explicitly-provided value overrides it, going from left to right in the URL.</span></span>

<span data-ttu-id="aabe0-409">Значения, которые предоставляются явно, но которого не совпадают, ничего добавляются к строке запроса.</span><span class="sxs-lookup"><span data-stu-id="aabe0-409">Values that are explicitly provided but which don't match anything are added to the query string.</span></span> <span data-ttu-id="aabe0-410">В следующей таблице показаны результат, при использовании шаблона маршрута `{controller}/{action}/{id?}`.</span><span class="sxs-lookup"><span data-stu-id="aabe0-410">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="aabe0-411">Значения окружающей среды</span><span class="sxs-lookup"><span data-stu-id="aabe0-411">Ambient Values</span></span> | <span data-ttu-id="aabe0-412">Явные значения</span><span class="sxs-lookup"><span data-stu-id="aabe0-412">Explicit Values</span></span> | <span data-ttu-id="aabe0-413">Результат</span><span class="sxs-lookup"><span data-stu-id="aabe0-413">Result</span></span> |
| -------------   | -------------- | ------ |
| <span data-ttu-id="aabe0-414">контроллер = «Главная»</span><span class="sxs-lookup"><span data-stu-id="aabe0-414">controller="Home"</span></span> | <span data-ttu-id="aabe0-415">Действие = «About»</span><span class="sxs-lookup"><span data-stu-id="aabe0-415">action="About"</span></span> | `/Home/About` |
| <span data-ttu-id="aabe0-416">контроллер = «Главная»</span><span class="sxs-lookup"><span data-stu-id="aabe0-416">controller="Home"</span></span> | <span data-ttu-id="aabe0-417">контроллер = действие «заказ» = «О»</span><span class="sxs-lookup"><span data-stu-id="aabe0-417">controller="Order",action="About"</span></span> | `/Order/About` |
| <span data-ttu-id="aabe0-418">контроллер = «Home» color = «Red»</span><span class="sxs-lookup"><span data-stu-id="aabe0-418">controller="Home",color="Red"</span></span> | <span data-ttu-id="aabe0-419">Действие = «About»</span><span class="sxs-lookup"><span data-stu-id="aabe0-419">action="About"</span></span> | `/Home/About` |
| <span data-ttu-id="aabe0-420">контроллер = «Главная»</span><span class="sxs-lookup"><span data-stu-id="aabe0-420">controller="Home"</span></span> | <span data-ttu-id="aabe0-421">Действие = цвет «Азот» = «Red»</span><span class="sxs-lookup"><span data-stu-id="aabe0-421">action="About",color="Red"</span></span> | `/Home/About?color=Red`

<span data-ttu-id="aabe0-422">Если маршрут имеет значение по умолчанию, не соответствующие параметру, явно указано, значение должно соответствовать значение по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="aabe0-422">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value.</span></span> <span data-ttu-id="aabe0-423">Пример:</span><span class="sxs-lookup"><span data-stu-id="aabe0-423">For example:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
  defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="aabe0-424">Когда указаны соответствующие значения для контроллера и действия, компоновки только создает ссылку для данного маршрута.</span><span class="sxs-lookup"><span data-stu-id="aabe0-424">Link generation would only generate a link for this route when the matching values for controller and action are provided.</span></span>
