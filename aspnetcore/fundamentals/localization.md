---
title: "Глобализация и локализация в ASP.NET Core"
author: rick-anderson
description: "Узнайте, как ASP.NET Core предоставляет службы и по промежуточного слоя для локализация содержимого на разных языках и региональных параметров."
keywords: "ASP.NET Core, локализации, языка и региональных параметров, язык, файл ресурсов, глобализации, локализации, языковой стандарт"
ms.author: riande
manager: wpickett
ms.date: 01/14/2017
ms.topic: article
ms.assetid: 7f275a09-f118-41c9-88d1-8de52d6a5aa1
ms.technology: aspnet
ms.prod: asp.net-core
uid: fundamentals/localization
ms.openlocfilehash: 9ff2fb92c81719c7278d70b5df5387f1244195bf
ms.sourcegitcommit: e7f01a649f240b6b57118c53314ab82f7f36f2eb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2017
---
# <a name="globalization-and-localization-in-aspnet-core"></a><span data-ttu-id="e3c9a-104">Глобализация и локализация в ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="e3c9a-104">Globalization and localization in ASP.NET Core</span></span>

<span data-ttu-id="e3c9a-105">По [Рик Андерсон](https://twitter.com/RickAndMSFT), [Бауден Дэмьен](https://twitter.com/damien_bod), [Bart Calixto](https://twitter.com/bartmax), [Надим Афана](https://twitter.com/NadeemAfana), и [Ateya Hisham Bin](https://twitter.com/hishambinateya)</span><span class="sxs-lookup"><span data-stu-id="e3c9a-105">By [Rick Anderson](https://twitter.com/RickAndMSFT), [Damien Bowden](https://twitter.com/damien_bod), [Bart Calixto](https://twitter.com/bartmax), [Nadeem Afana](https://twitter.com/NadeemAfana), and [Hisham Bin Ateya](https://twitter.com/hishambinateya)</span></span>

<span data-ttu-id="e3c9a-106">Создание многоязычных веб-сайта с помощью ASP.NET Core позволит узла для достижения более широкую аудиторию.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-106">Creating a multilingual website with ASP.NET Core will allow your site to reach a wider audience.</span></span> <span data-ttu-id="e3c9a-107">ASP.NET Core предоставляет службы и ПО промежуточного слоя для локализации на разные языки и для разных региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-107">ASP.NET Core provides services and middleware for localizing into different languages and cultures.</span></span>

<span data-ttu-id="e3c9a-108">Включает в себя интернационализации [глобализации](https://docs.microsoft.com/dotnet/api/system.globalization) и [локализации](https://docs.microsoft.com/dotnet/standard/globalization-localization/localization).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-108">Internationalization involves [Globalization](https://docs.microsoft.com/dotnet/api/system.globalization) and [Localization](https://docs.microsoft.com/dotnet/standard/globalization-localization/localization).</span></span> <span data-ttu-id="e3c9a-109">Глобализация — это процесс разработки приложений, которые поддерживают разные культуры.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-109">Globalization is the process of designing apps that support different cultures.</span></span> <span data-ttu-id="e3c9a-110">Глобализация добавляет поддержку для ввода, отображения и вывода определенного набора языковых сценариев, относящихся к конкретным регионам.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-110">Globalization adds support for input, display, and output of a defined set of language scripts that relate to specific geographic areas.</span></span>

<span data-ttu-id="e3c9a-111">Локализация — это процесс адаптации глобализованное приложение, которое уже обработана возможности локализации для определенного языка и региональных параметров или языкового стандарта.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-111">Localization is the process of adapting a globalized app, which you have already processed for localizability, to a particular culture/locale.</span></span>  <span data-ttu-id="e3c9a-112">Дополнительные сведения см. **глобализации и локализации условия** в конце этого документа.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-112">For more information see **Globalization and localization terms** near the end of this document.</span></span>

<span data-ttu-id="e3c9a-113">Локализация приложений включает следующие этапы:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-113">App localization involves the following:</span></span>

1. <span data-ttu-id="e3c9a-114">Сделать локализуемого содержимого приложения</span><span class="sxs-lookup"><span data-stu-id="e3c9a-114">Make the app's content localizable</span></span>

2. <span data-ttu-id="e3c9a-115">Укажите локализованные ресурсы для языков и региональных параметров, поддерживаемых</span><span class="sxs-lookup"><span data-stu-id="e3c9a-115">Provide localized resources for the languages and cultures you support</span></span>

3. <span data-ttu-id="e3c9a-116">Реализовать стратегию, чтобы выбрать язык и региональные параметры для каждого запроса</span><span class="sxs-lookup"><span data-stu-id="e3c9a-116">Implement a strategy to select the language/culture for each request</span></span>

## <a name="make-the-apps-content-localizable"></a><span data-ttu-id="e3c9a-117">Сделать локализуемого содержимого приложения</span><span class="sxs-lookup"><span data-stu-id="e3c9a-117">Make the app's content localizable</span></span>

<span data-ttu-id="e3c9a-118">Представленные в ASP.NET Core `IStringLocalizer` и `IStringLocalizer<T>` были разработана для повышения производительности при разработке локализованных приложений.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-118">Introduced in ASP.NET Core, `IStringLocalizer` and `IStringLocalizer<T>` were architected to improve productivity when developing localized apps.</span></span> <span data-ttu-id="e3c9a-119">`IStringLocalizer`использует [ResourceManager](https://docs.microsoft.com/dotnet/api/system.resources.resourcemanager) и [ResourceReader](https://docs.microsoft.com/dotnet/api/system.resources.resourcereader) для предоставления ресурсов, связанных с языком и региональными параметрами, во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-119">`IStringLocalizer` uses the [ResourceManager](https://docs.microsoft.com/dotnet/api/system.resources.resourcemanager) and [ResourceReader](https://docs.microsoft.com/dotnet/api/system.resources.resourcereader) to provide culture-specific resources at run time.</span></span> <span data-ttu-id="e3c9a-120">Простой интерфейс имеет индекс и `IEnumerable` для возвращения локализованные строки.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-120">The simple interface has an indexer and an `IEnumerable` for returning localized strings.</span></span> <span data-ttu-id="e3c9a-121">`IStringLocalizer`не требуется хранить строки языка по умолчанию в файле ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-121">`IStringLocalizer` doesn't require you to store the default language strings in a resource file.</span></span> <span data-ttu-id="e3c9a-122">Можно разрабатывать приложения, предназначенные для локализации и не требуется создавать файлы ресурсов на раннем этапе разработки.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-122">You can develop an app targeted for localization and not need to create resource files early in development.</span></span> <span data-ttu-id="e3c9a-123">В следующем примере кода показано, как программы-оболочки для строки «О Title» для локализации.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-123">The code below shows how to wrap the string "About Title" for localization.</span></span>

[!code-csharp[Main](localization/sample/Localization/Controllers/AboutController.cs)]

<span data-ttu-id="e3c9a-124">В представленном выше коде `IStringLocalizer<T>` реализацию поступают из [внедрения зависимостей](dependency-injection.md).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-124">In the code above, the `IStringLocalizer<T>` implementation comes from [Dependency Injection](dependency-injection.md).</span></span> <span data-ttu-id="e3c9a-125">Если локализованное значение атрибута «О Title» не найден, то ключу индексатора возвращается, то есть строка «О Title».</span><span class="sxs-lookup"><span data-stu-id="e3c9a-125">If the localized value of "About Title" is not found, then the indexer key is returned, that is, the string "About Title".</span></span> <span data-ttu-id="e3c9a-126">Можно оставить значение по умолчанию язык строковых литералов в приложении и помещать их в локализатора, так что можно сосредоточиться на разработке приложений.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-126">You can leave the default language literal strings in the app and wrap them in the localizer, so that you can focus on developing the app.</span></span> <span data-ttu-id="e3c9a-127">Разработка приложения с языком по умолчанию и подготовить его к этапу локализации без предварительного создания файла ресурсов по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-127">You develop your app with your default language and prepare it for the localization step without first creating a default resource file.</span></span> <span data-ttu-id="e3c9a-128">Кроме того можно использовать традиционный подход и укажите ключ для извлечения языковую строку по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-128">Alternatively, you can use the traditional approach and provide a key to retrieve the default language string.</span></span> <span data-ttu-id="e3c9a-129">Для многих разработчиков нового рабочего процесса не было язык по умолчанию *.resx* файл и просто обернуть строковые литералы можно снизить издержки локализация приложения.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-129">For many developers the new workflow of not having a default language *.resx* file and simply wrapping the string literals can reduce the overhead of localizing an app.</span></span> <span data-ttu-id="e3c9a-130">Другим разработчикам использовать традиционные рабочий процесс как его можно упростить его для работы с более строковые литералы и упростить обновление локализованные строки.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-130">Other developers will prefer the traditional work flow as it can make it easier to work with longer string literals and make it easier to update localized strings.</span></span>

<span data-ttu-id="e3c9a-131">Используйте `IHtmlLocalizer<T>` реализации для ресурсов, содержащие HTML.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-131">Use the `IHtmlLocalizer<T>` implementation for resources that contain HTML.</span></span> <span data-ttu-id="e3c9a-132">`IHtmlLocalizer`Кодирует строку ресурса форматируемые аргументы HTML, но кодировка HTML не собственно строкой ресурса.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-132">`IHtmlLocalizer` HTML encodes arguments that are formatted in the resource string, but does not HTML encode the resource string itself.</span></span> <span data-ttu-id="e3c9a-133">В примере выделен под только значение `name` параметр — в кодировке HTML.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-133">In the sample highlighted below, only the value of `name` parameter is HTML encoded.</span></span>

[!code-csharp[Main](../fundamentals/localization/sample/Localization/Controllers/BookController.cs?highlight=3,5,20&start=1&end=24)]

<span data-ttu-id="e3c9a-134">Примечание: Обычно требуется только локализовать текст и не HTML.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-134">Note: You generally want to only localize text and not HTML.</span></span>

<span data-ttu-id="e3c9a-135">На самом низком уровне, вы можете получить `IStringLocalizerFactory` из [внедрения зависимости](dependency-injection.md):</span><span class="sxs-lookup"><span data-stu-id="e3c9a-135">At the lowest level, you can get `IStringLocalizerFactory` out of [Dependency Injection](dependency-injection.md):</span></span>

[!code-csharp[Main](localization/sample/Localization/Controllers/TestController.cs?start=9&end=26&highlight=7-13)]

<span data-ttu-id="e3c9a-136">Приведенный выше код демонстрирует каждого из двух фабрику создания методов.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-136">The code above demonstrates each of the two factory create methods.</span></span>

<span data-ttu-id="e3c9a-137">Можно секционировать локализованные строки контроллером области, или только один контейнер.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-137">You can partition your localized strings by controller, area, or have just one container.</span></span> <span data-ttu-id="e3c9a-138">В примере приложения пустой класс с именем `SharedResource` используется для общих ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-138">In the sample app, a dummy class named `SharedResource` is used for shared resources.</span></span>

[!code-csharp[Main](localization/sample/Localization/Resources/SharedResource.cs)]

<span data-ttu-id="e3c9a-139">Некоторые разработчики используют `Startup` класс, содержащий глобальные или общих строк.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-139">Some developers use the `Startup` class to contain global or shared strings.</span></span>  <span data-ttu-id="e3c9a-140">В приведенном ниже примере `InfoController` и `SharedResource` локализаторам используются:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-140">In the sample below, the `InfoController` and the `SharedResource` localizers are used:</span></span>

[!code-csharp[Main](localization/sample/Localization/Controllers/InfoController.cs?range=9-26)]

## <a name="view-localization"></a><span data-ttu-id="e3c9a-141">Представление локализации</span><span class="sxs-lookup"><span data-stu-id="e3c9a-141">View localization</span></span>

<span data-ttu-id="e3c9a-142">`IViewLocalizer` Служба предоставляет локализованные строки для [представление](https://docs.microsoft.com/aspnet/core).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-142">The `IViewLocalizer` service provides localized strings for a [view](https://docs.microsoft.com/aspnet/core).</span></span> <span data-ttu-id="e3c9a-143">`ViewLocalizer` Класс реализует этот интерфейс и находит расположение ресурса из пути файла представления.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-143">The `ViewLocalizer` class implements this interface and finds the resource location from the view file path.</span></span> <span data-ttu-id="e3c9a-144">Ниже показано, как использовать реализацию по умолчанию `IViewLocalizer`:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-144">The following code shows how to use the default implementation of `IViewLocalizer`:</span></span>

[!code-HTML[Main](localization/sample/Localization/Views/Home/About.cshtml)]

<span data-ttu-id="e3c9a-145">Реализация по умолчанию `IViewLocalizer` находит файл ресурсов на основе имени файла этого представления.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-145">The default implementation of `IViewLocalizer` finds the resource file based on the view's file name.</span></span> <span data-ttu-id="e3c9a-146">Нет возможности использовать файл общих ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-146">There is no option to use a global shared resource file.</span></span> <span data-ttu-id="e3c9a-147">`ViewLocalizer`реализует с помощью локализатора `IHtmlLocalizer`, поэтому Razor не HTML кодирования локализованные строки.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-147">`ViewLocalizer` implements the localizer using `IHtmlLocalizer`, so Razor doesn't HTML encode the localized string.</span></span> <span data-ttu-id="e3c9a-148">Можно параметризировать строки ресурсов и `IViewLocalizer` будет HTML кодирования параметров, но не строки ресурса.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-148">You can parameterize resource strings and `IViewLocalizer` will HTML encode the parameters, but not the resource string.</span></span> <span data-ttu-id="e3c9a-149">Рассмотрим следующую разметку Razor.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-149">Consider the following Razor markup:</span></span>

```cshtml
@Localizer["<i>Hello</i> <b>{0}!</b>", UserManager.GetUserName(User)]
```

<span data-ttu-id="e3c9a-150">Файл ресурсов может содержать следующие элементы.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-150">A French resource file could contain the following:</span></span>

| <span data-ttu-id="e3c9a-151">Ключ</span><span class="sxs-lookup"><span data-stu-id="e3c9a-151">Key</span></span> | <span data-ttu-id="e3c9a-152">Значение</span><span class="sxs-lookup"><span data-stu-id="e3c9a-152">Value</span></span> |
| ----- | ------ |
| `<i>Hello</i> <b>{0}!</b>` | `<i>Bonjour</i> <b>{0} !</b> ` |

<span data-ttu-id="e3c9a-153">Отображенное представление будет содержать HTML-разметку из файла ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-153">The rendered view would contain the HTML markup from the resource file.</span></span>

<span data-ttu-id="e3c9a-154">Примечания.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-154">Notes:</span></span>
- <span data-ttu-id="e3c9a-155">Представление локализации требуется пакет NuGet «Localization.AspNetCore.TagHelpers».</span><span class="sxs-lookup"><span data-stu-id="e3c9a-155">View localization requires the "Localization.AspNetCore.TagHelpers" NuGet package.</span></span>
- <span data-ttu-id="e3c9a-156">Как правило, требуется только локализовать текст и не HTML.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-156">You generally want to only localize text and not HTML.</span></span>

<span data-ttu-id="e3c9a-157">Использование файла общего ресурса в виде, вставки `IHtmlLocalizer<T>`:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-157">To use a shared resource file in a view, inject `IHtmlLocalizer<T>`:</span></span>

[!code-HTML[Main](../fundamentals/localization/sample/Localization/Views/Test/About.cshtml?highlight=5,12)]

## <a name="dataannotations-localization"></a><span data-ttu-id="e3c9a-158">Локализация DataAnnotations</span><span class="sxs-lookup"><span data-stu-id="e3c9a-158">DataAnnotations localization</span></span>

<span data-ttu-id="e3c9a-159">Сообщения об ошибках DataAnnotations локализованы с `IStringLocalizer<T>`.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-159">DataAnnotations error messages are localized with `IStringLocalizer<T>`.</span></span> <span data-ttu-id="e3c9a-160">С помощью параметра `ResourcesPath = "Resources"`, сообщения об ошибках в `RegisterViewModel` могут храниться в одном из следующих путей:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-160">Using the option `ResourcesPath = "Resources"`, the error messages in `RegisterViewModel` can be stored in either of the following paths:</span></span>

* <span data-ttu-id="e3c9a-161">Resources/ViewModels.Account.RegisterViewModel.fr.resx</span><span class="sxs-lookup"><span data-stu-id="e3c9a-161">Resources/ViewModels.Account.RegisterViewModel.fr.resx</span></span>
* <span data-ttu-id="e3c9a-162">Resources/ViewModels/Account/RegisterViewModel.fr.resx</span><span class="sxs-lookup"><span data-stu-id="e3c9a-162">Resources/ViewModels/Account/RegisterViewModel.fr.resx</span></span>

[!code-csharp[Main](localization/sample/Localization/ViewModels/Account/RegisterViewModel.cs?start=9&end=26)]

<span data-ttu-id="e3c9a-163">В ASP.NET Core MVC 1.1.0 и более поздней версии, не относящееся к проверке атрибутов локализованы.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-163">In ASP.NET Core MVC 1.1.0 and higher, non-validation attributes are localized.</span></span> <span data-ttu-id="e3c9a-164">ASP.NET Core MVC 1.0 **не** поиск локализованных строк для атрибутов без проверки.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-164">ASP.NET Core MVC 1.0 does **not** look up localized strings for non-validation attributes.</span></span>

<a name=one-resource-string-multiple-classes></a>
### <a name="using-one-resource-string-for-multiple-classes"></a><span data-ttu-id="e3c9a-165">Используя одну строку ресурса для нескольких классов</span><span class="sxs-lookup"><span data-stu-id="e3c9a-165">Using one resource string for multiple classes</span></span>

<span data-ttu-id="e3c9a-166">Ниже показано, как использовать одну строку ресурса для проверки атрибутов с несколькими классами:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-166">The following code shows how to use one resource string for validation attributes with multiple classes:</span></span>

```csharp
public void ConfigureServices(IServiceCollection services)
{
    services.AddMvc()
        .AddDataAnnotationsLocalization(options => {
            options.DataAnnotationLocalizerProvider = (type, factory) =>
                factory.Create(typeof(SharedResource));
        });
}
```

<span data-ttu-id="e3c9a-167">В предыдущем коде `SharedResource` является класс, соответствующий resx, в которых хранятся сообщения проверки.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-167">In the preceeding code, `SharedResource` is the class corresponding to the resx where your validation messages are stored.</span></span> <span data-ttu-id="e3c9a-168">При таком подходе DataAnnotations будет использовать только `SharedResource`, вместо того чтобы ресурсов для каждого класса.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-168">With this approach,  DataAnnotations will only use `SharedResource`, rather than the resource for each class.</span></span> 

## <a name="provide-localized-resources-for-the-languages-and-cultures-you-support"></a><span data-ttu-id="e3c9a-169">Укажите локализованные ресурсы для языков и региональных параметров, поддерживаемых</span><span class="sxs-lookup"><span data-stu-id="e3c9a-169">Provide localized resources for the languages and cultures you support</span></span>  

### <a name="supportedcultures-and-supporteduicultures"></a><span data-ttu-id="e3c9a-170">SupportedCultures и SupportedUICultures</span><span class="sxs-lookup"><span data-stu-id="e3c9a-170">SupportedCultures and SupportedUICultures</span></span>

<span data-ttu-id="e3c9a-171">ASP.NET Core позволяет задать два значения языка и региональных параметров, `SupportedCultures` и `SupportedUICultures`.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-171">ASP.NET Core allows you to specify two culture values, `SupportedCultures` and `SupportedUICultures`.</span></span> <span data-ttu-id="e3c9a-172">[CultureInfo](https://docs.microsoft.com/dotnet/api/system.globalization.cultureinfo) для объекта `SupportedCultures` определяет результаты функции, зависящие от языка и региональных параметров, такие как дата, время, числа и денежных единиц.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-172">The [CultureInfo](https://docs.microsoft.com/dotnet/api/system.globalization.cultureinfo) object for `SupportedCultures` determines the results of culture-dependent functions, such as date, time, number, and currency formatting.</span></span> <span data-ttu-id="e3c9a-173">`SupportedCultures`также определяет порядок сортировки текста, правила регистра и сравнения строк.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-173">`SupportedCultures` also determines the sorting order of text, casing conventions, and string comparisons.</span></span> <span data-ttu-id="e3c9a-174">В разделе [CultureInfo.CurrentCulture](https://docs.microsoft.com/dotnet/api/system.stringcomparer.currentculture#System_StringComparer_CurrentCulture) для получения дополнительных сведений о как сервер получает язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-174">See [CultureInfo.CurrentCulture](https://docs.microsoft.com/dotnet/api/system.stringcomparer.currentculture#System_StringComparer_CurrentCulture) for more info on how the server gets the Culture.</span></span> <span data-ttu-id="e3c9a-175">`SupportedUICultures` Определяет, что означает строк (из *.resx* файлы) поиск которого выполняется [ResourceManager](https://docs.microsoft.com/dotnet/api/system.resources.resourcemanager).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-175">The `SupportedUICultures` determines which translates strings (from *.resx* files) are looked up by the [ResourceManager](https://docs.microsoft.com/dotnet/api/system.resources.resourcemanager).</span></span> <span data-ttu-id="e3c9a-176">`ResourceManager` Просто выполняет поиск строк, связанных с языком и региональными параметрами, определяется `CurrentUICulture`.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-176">The `ResourceManager` simply looks up culture-specific strings that is determined by `CurrentUICulture`.</span></span> <span data-ttu-id="e3c9a-177">Каждый поток в .NET имеет `CurrentCulture` и `CurrentUICulture` объектов.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-177">Every thread in .NET has `CurrentCulture` and `CurrentUICulture` objects.</span></span> <span data-ttu-id="e3c9a-178">ASP.NET Core проверяет эти значения при подготовке к просмотру функции, зависящие от языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-178">ASP.NET Core inspects these values when rendering culture-dependent functions.</span></span> <span data-ttu-id="e3c9a-179">Например, если язык и региональные параметры текущего потока имеет значение «en US» (английский, США) `DateTime.Now.ToLongDateString()` отображает «Четверг, февраль 18 2016", но если `CurrentCulture` имеет значение для «es-ES» (испанский, Испания) выходные данные будут «jueves de febrero 18 de 2016".</span><span class="sxs-lookup"><span data-stu-id="e3c9a-179">For example, if the current thread's culture is set to "en-US" (English, United States), `DateTime.Now.ToLongDateString()` displays "Thursday, February 18, 2016", but if `CurrentCulture` is set to "es-ES" (Spanish, Spain) the output will be "jueves, 18 de febrero de 2016".</span></span>

## <a name="working-with-resource-files"></a><span data-ttu-id="e3c9a-180">Работа с файлами ресурсов</span><span class="sxs-lookup"><span data-stu-id="e3c9a-180">Working with resource files</span></span>

<span data-ttu-id="e3c9a-181">Файл ресурсов — это механизм полезен для разделения локализуемые строки из кода.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-181">A resource file is a useful mechanism for separating localizable strings from code.</span></span> <span data-ttu-id="e3c9a-182">Переведенные строки для языка не по умолчанию изолированы *.resx* файлы ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-182">Translated strings for the non-default language are isolated *.resx* resource files.</span></span> <span data-ttu-id="e3c9a-183">Например, может потребоваться создать файл ресурсов для испанского языка с именем *Welcome.es.resx* содержащий перевода строки.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-183">For example, you might want to create Spanish resource file named *Welcome.es.resx* containing translated strings.</span></span> <span data-ttu-id="e3c9a-184">«es» — это код языка для испанского языка.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-184">"es" is the language code for Spanish.</span></span> <span data-ttu-id="e3c9a-185">Чтобы создать этот файл ресурсов в Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-185">To create this resource file in Visual Studio:</span></span>

1. <span data-ttu-id="e3c9a-186">В **обозревателе решений**, щелкните правой кнопкой мыши папку, которая будет содержать файл ресурсов > **добавить** > **новый элемент**.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-186">In **Solution Explorer**, right click on the folder which will contain the resource file > **Add** > **New Item**.</span></span>

    ![Вложенные контекстного меню: В обозревателе решений контекстное меню открыт для ресурсов.](localization/_static/newi.png)

2. <span data-ttu-id="e3c9a-189">В **поиск установленных шаблонов** введите «resource» и имя файла.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-189">In the **Search installed templates** box, enter "resource" and name the file.</span></span>

    ![Диалоговое окно ''Добавление нового элемента''](localization/_static/res.png)

3. <span data-ttu-id="e3c9a-191">Введите значение ключа (собственную строку) в **имя** столбец и переведенных строк в **значение** столбца.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-191">Enter the key value (native string) in the **Name** column and the translated string in the **Value** column.</span></span>

    ![Welcome.es.resx (файл приветствия ресурсов для испанского языка) с слово Hello в столбце «имя» и слово Hola (Hello на испанском языке) в столбце значений](localization/_static/hola.png)

    <span data-ttu-id="e3c9a-193">Visual Studio отображает *Welcome.es.resx* файла.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-193">Visual Studio shows the *Welcome.es.resx* file.</span></span>

    ![В обозревателе решений файл ресурсов приветствия испанский (es)](localization/_static/se.png)

<a name="error"></a>

<span data-ttu-id="e3c9a-195">При использовании предварительной версии Visual Studio 2017 г. версия 15,3 появится индикатор ошибки в редакторе ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-195">If you are using Visual Studio 2017 Preview version 15.3, you'll get an error indicator in the resource editor.</span></span> <span data-ttu-id="e3c9a-196">Удалить *ResXFileCodeGenerator* значение из *пользовательский инструмент* сетку свойств, чтобы предотвратить это сообщение об ошибке:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-196">Remove the *ResXFileCodeGenerator*  value from the *Custom Tool*  properties grid to prevent this error message:</span></span>

![RESX-редактор](localization/_static/err.png)

<span data-ttu-id="e3c9a-198">Кроме того эту ошибку можно игнорировать.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-198">Alternatively, you can ignore this error.</span></span> <span data-ttu-id="e3c9a-199">Мы надеемся устранить эту проблему в следующем выпуске.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-199">We hope to fix this in the next release.</span></span>

## <a name="resource-file-naming"></a><span data-ttu-id="e3c9a-200">Имя файла ресурсов</span><span class="sxs-lookup"><span data-stu-id="e3c9a-200">Resource file naming</span></span>

<span data-ttu-id="e3c9a-201">Ресурсы были указаны полное имя типа класса минус имя сборки.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-201">Resources are named for the full type name of their class minus the assembly name.</span></span> <span data-ttu-id="e3c9a-202">Например, французским ресурсов в проекте, в основной сборке `LocalizationWebsite.Web.dll` для класса `LocalizationWebsite.Web.Startup` будет называться *Startup.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-202">For example, a French resource in a project whose main assembly is `LocalizationWebsite.Web.dll` for the class `LocalizationWebsite.Web.Startup` would be named *Startup.fr.resx*.</span></span> <span data-ttu-id="e3c9a-203">Ресурс для класса `LocalizationWebsite.Web.Controllers.HomeController` будет называться *Controllers.HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-203">A resource for the class `LocalizationWebsite.Web.Controllers.HomeController` would be named *Controllers.HomeController.fr.resx*.</span></span> <span data-ttu-id="e3c9a-204">Если пространство имен для целевого класса не соответствует имени сборки необходимо будет полное имя типа.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-204">If your targeted class's namespace is not the same as the assembly name you will need the full type name.</span></span> <span data-ttu-id="e3c9a-205">Например, в образце проекта для типа ресурса `ExtraNamespace.Tools` будет называться *ExtraNamespace.Tools.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-205">For example, in the sample project a resource for the type `ExtraNamespace.Tools` would be named *ExtraNamespace.Tools.fr.resx*.</span></span>

<span data-ttu-id="e3c9a-206">В образце проекта `ConfigureServices` метода задает `ResourcesPath` на «Ресурсы», поэтому относительный путь проекта для контроллера home файл ресурсов — *Resources/Controllers.HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-206">In the sample project, the `ConfigureServices` method sets the `ResourcesPath` to "Resources", so the project relative path for the home controller's French resource file is *Resources/Controllers.HomeController.fr.resx*.</span></span> <span data-ttu-id="e3c9a-207">Кроме того можно использовать папки для организации файлов ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-207">Alternatively, you can use folders to organize resource files.</span></span> <span data-ttu-id="e3c9a-208">Для контроллера home, путь будет иметь *Resources/Controllers/HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-208">For the home controller, the path would be *Resources/Controllers/HomeController.fr.resx*.</span></span> <span data-ttu-id="e3c9a-209">Если вы не используете `ResourcesPath` параметр *.resx* файл перейдет в базовом каталоге проекта.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-209">If you don't use the `ResourcesPath` option, the *.resx* file would go in the project base directory.</span></span> <span data-ttu-id="e3c9a-210">Файл ресурсов для `HomeController` будет называться *Controllers.HomeController.fr.resx*.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-210">The resource file for `HomeController` would be named *Controllers.HomeController.fr.resx*.</span></span> <span data-ttu-id="e3c9a-211">Вариант с использованием точки или путь соглашение об именовании зависит способ упорядочения файлов ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-211">The choice of using the dot or path naming convention depends on how you want to organize your resource files.</span></span>

| <span data-ttu-id="e3c9a-212">Имя ресурса</span><span class="sxs-lookup"><span data-stu-id="e3c9a-212">Resource name</span></span> | <span data-ttu-id="e3c9a-213">Точка, имен пути</span><span class="sxs-lookup"><span data-stu-id="e3c9a-213">Dot or path naming</span></span> |
| ------------   | ------------- |
| <span data-ttu-id="e3c9a-214">Resources/Controllers.HomeController.fr.resx</span><span class="sxs-lookup"><span data-stu-id="e3c9a-214">Resources/Controllers.HomeController.fr.resx</span></span> | <span data-ttu-id="e3c9a-215">Точка</span><span class="sxs-lookup"><span data-stu-id="e3c9a-215">Dot</span></span>  |
| <span data-ttu-id="e3c9a-216">Resources/Controllers/HomeController.fr.resx</span><span class="sxs-lookup"><span data-stu-id="e3c9a-216">Resources/Controllers/HomeController.fr.resx</span></span>  | <span data-ttu-id="e3c9a-217">Путь</span><span class="sxs-lookup"><span data-stu-id="e3c9a-217">Path</span></span> |
|    |     |

<span data-ttu-id="e3c9a-218">Файлы ресурсов с помощью `@inject IViewLocalizer` в представлений Razor выполнить той же модели.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-218">Resource files using `@inject IViewLocalizer` in Razor views follow a similar pattern.</span></span> <span data-ttu-id="e3c9a-219">Файл ресурсов для представления может называться именования точку или путь именования.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-219">The resource file for a view can be named using either dot naming or path naming.</span></span> <span data-ttu-id="e3c9a-220">Файлы ресурсов представления Razor имитируют путь к файлу их связанного представления.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-220">Razor view resource files mimic the path of their associated view file.</span></span> <span data-ttu-id="e3c9a-221">При условии, что мы устанавливаем `ResourcesPath` «Ресурсы», файл ресурсов, связанных с *Views/Home/About.cshtml* представление может быть одно из следующих:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-221">Assuming we set the `ResourcesPath` to "Resources", the French resource file associated with the *Views/Home/About.cshtml* view could be either of the following:</span></span>

* <span data-ttu-id="e3c9a-222">Resources/Views/Home/About.fr.resx</span><span class="sxs-lookup"><span data-stu-id="e3c9a-222">Resources/Views/Home/About.fr.resx</span></span>

* <span data-ttu-id="e3c9a-223">Resources/Views.Home.About.fr.resx</span><span class="sxs-lookup"><span data-stu-id="e3c9a-223">Resources/Views.Home.About.fr.resx</span></span>

<span data-ttu-id="e3c9a-224">Если вы не используете `ResourcesPath` параметр *.resx* -файле для представления будет находиться в той же папке, что и представление.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-224">If you don't use the `ResourcesPath` option, the *.resx* file for a view would be located in the same folder as the view.</span></span>

<span data-ttu-id="e3c9a-225">Если удалить обозначение «.fr» язык и региональные параметры и язык и региональные параметры, задать французский (с помощью файлов cookie или другого механизма), чтение файла ресурсов по умолчанию и строки локализованы.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-225">If you remove the ".fr" culture designator AND you have the culture set to French (via cookie or other mechanism), the default resource file is read and strings are localized.</span></span> <span data-ttu-id="e3c9a-226">Диспетчер ресурсов назначает ресурсов по умолчанию или откат, если ничего не удовлетворяет требованиям вашего запрошенного языка и региональных параметров выполняется обслуживаться файла *.resx без обозначение языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-226">The Resource manager designates a default or fallback resource, when nothing meets your requested culture you're served the *.resx file without a culture designator.</span></span> <span data-ttu-id="e3c9a-227">Если вы хотите просто возвращается ключ, если отсутствует ресурс для запрошенной культуры не должен иметь файл ресурсов по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-227">If you want to just return the key when missing a resource for the requested culture you must not have a default resource file.</span></span>

### <a name="generating-resource-files-with-visual-studio"></a><span data-ttu-id="e3c9a-228">Создание файлов ресурсов с помощью Visual Studio</span><span class="sxs-lookup"><span data-stu-id="e3c9a-228">Generating resource files with Visual Studio</span></span>

<span data-ttu-id="e3c9a-229">При создании файла ресурсов в Visual Studio без языка и региональных параметров в имени файла (например, *Welcome.resx*), Visual Studio создаст класс C# с помощью свойства для каждой строки.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-229">If you create a resource file in Visual Studio without a culture in the file name (for example, *Welcome.resx*), Visual Studio will create a C# class with a property for each string.</span></span> <span data-ttu-id="e3c9a-230">Это обычно не нужны с ASP.NET Core; значение по умолчанию обычно не имеют *.resx* файла ресурсов (A *.resx* файл без имени языка и региональных параметров).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-230">That's usually not what you want with ASP.NET Core; you typically don't have a default *.resx* resource file (A *.resx* file without the culture name).</span></span> <span data-ttu-id="e3c9a-231">Мы рекомендуем вам создать *.resx* файл с именем языка и региональных параметров (например *Welcome.fr.resx*).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-231">We suggest you create the *.resx* file with a culture name (for example *Welcome.fr.resx*).</span></span> <span data-ttu-id="e3c9a-232">При создании *.resx* файл с именем языка и региональных параметров, Visual Studio не создаст файл класса.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-232">When you create a *.resx* file with a culture name, Visual Studio will not generate the class file.</span></span> <span data-ttu-id="e3c9a-233">Мы полагаем, что многие разработчики будут **не** создать файл ресурсов языка по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-233">We anticipate that many developers will **not** create a default language resource file.</span></span>

### <a name="adding-other-cultures"></a><span data-ttu-id="e3c9a-234">Добавление других языков и региональных параметров</span><span class="sxs-lookup"><span data-stu-id="e3c9a-234">Adding Other Cultures</span></span>

<span data-ttu-id="e3c9a-235">Каждой комбинации языка и региональных параметров (отличных от языка по умолчанию) требуется отдельный файл ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-235">Each language and culture combination (other than the default language) requires a unique resource file.</span></span> <span data-ttu-id="e3c9a-236">Создание файлов ресурсов для разных языков и региональных параметров путем создания новых файлов ресурсов, в которых языковые коды ISO являются частью имени файла (например, **en-us**, **fr-ca**, и  **en-gb**).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-236">You create resource files for different cultures and locales by creating new resource files in which the ISO language codes are part of the file name (for example, **en-us**, **fr-ca**, and **en-gb**).</span></span> <span data-ttu-id="e3c9a-237">Эти коды ISO помещаются между именем файла и *.resx* файл с расширением, как и в *Welcome.es MX.resx* (Испанский/Мексика).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-237">These ISO codes are placed between the file name and the *.resx* file name extension, as in *Welcome.es-MX.resx* (Spanish/Mexico).</span></span> <span data-ttu-id="e3c9a-238">Чтобы указать язык, удалите код страны (`MX` в предыдущем примере).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-238">To specify a culturally neutral language, remove the country code (`MX` in the preceding example).</span></span> <span data-ttu-id="e3c9a-239">Имя файла ресурсов нейтральным испанский — *Welcome.es.resx*.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-239">The culturally neutral Spanish resource file name is *Welcome.es.resx*.</span></span>

## <a name="implement-a-strategy-to-select-the-languageculture-for-each-request"></a><span data-ttu-id="e3c9a-240">Реализовать стратегию, чтобы выбрать язык и региональные параметры для каждого запроса</span><span class="sxs-lookup"><span data-stu-id="e3c9a-240">Implement a strategy to select the language/culture for each request</span></span>  

### <a name="configuring-localization"></a><span data-ttu-id="e3c9a-241">Настройка локализации</span><span class="sxs-lookup"><span data-stu-id="e3c9a-241">Configuring localization</span></span>

<span data-ttu-id="e3c9a-242">Локализация настраивается в `ConfigureServices` метод:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-242">Localization is configured in the `ConfigureServices` method:</span></span>

[!code-csharp[Main](localization/sample/Localization/Program.cs?name=snippet1)]

* <span data-ttu-id="e3c9a-243">`AddLocalization`Добавляет службы локализации в контейнере службы.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-243">`AddLocalization` Adds the localization services to the services container.</span></span> <span data-ttu-id="e3c9a-244">Приведенный выше также задает путь к ресурсам «Ресурсы».</span><span class="sxs-lookup"><span data-stu-id="e3c9a-244">The code above also sets the resources path to "Resources".</span></span>

* <span data-ttu-id="e3c9a-245">`AddViewLocalization`Добавлена поддержка локализованных Просмотр файлов.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-245">`AddViewLocalization` Adds support for localized view files.</span></span> <span data-ttu-id="e3c9a-246">В этом представлении Образец локализации основан на суффикса файла представления.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-246">In this sample view localization is based on the view file suffix.</span></span> <span data-ttu-id="e3c9a-247">Например «fr» в *Index.fr.cshtml* файла.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-247">For example "fr" in the *Index.fr.cshtml* file.</span></span>

* <span data-ttu-id="e3c9a-248">`AddDataAnnotationsLocalization`Добавляет поддержку для локализации `DataAnnotations` проверки сообщений через `IStringLocalizer` абстрактные классы.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-248">`AddDataAnnotationsLocalization` Adds support for localized `DataAnnotations` validation messages through `IStringLocalizer` abstractions.</span></span>

### <a name="localization-middleware"></a><span data-ttu-id="e3c9a-249">Локализация по промежуточного слоя</span><span class="sxs-lookup"><span data-stu-id="e3c9a-249">Localization middleware</span></span>

<span data-ttu-id="e3c9a-250">Текущий язык и региональные параметры в запросе задается в локализации [по промежуточного слоя](middleware.md).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-250">The current culture on a request is set in the localization [Middleware](middleware.md).</span></span> <span data-ttu-id="e3c9a-251">По промежуточного слоя локализации включено в `Configure` метод *Program.cs* файла.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-251">The localization middleware is enabled in the `Configure` method of *Program.cs* file.</span></span> <span data-ttu-id="e3c9a-252">Обратите внимание, что по промежуточного слоя локализации должен быть настроен перед любое по промежуточного слоя, который может проверить запрос языка и региональных параметров (например, `app.UseMvcWithDefaultRoute()`).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-252">Note, the localization middleware must be configured before any middleware which might check the request culture (for example, `app.UseMvcWithDefaultRoute()`).</span></span>

[!code-csharp[Main](localization/sample/Localization/Program.cs?name=snippet2)]

<span data-ttu-id="e3c9a-253">`UseRequestLocalization`Инициализирует `RequestLocalizationOptions` объекта.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-253">`UseRequestLocalization` initializes a `RequestLocalizationOptions` object.</span></span> <span data-ttu-id="e3c9a-254">При каждом запросе списка из `RequestCultureProvider` в `RequestLocalizationOptions` перечисляется и используется первый поставщик, успешно можно определить запрос языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-254">On every request the list of `RequestCultureProvider` in the `RequestLocalizationOptions` is enumerated and the first provider that can successfully determine the request culture is used.</span></span> <span data-ttu-id="e3c9a-255">Поставщики по умолчанию берутся из `RequestLocalizationOptions` класса:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-255">The default providers come from the `RequestLocalizationOptions` class:</span></span>

1. `QueryStringRequestCultureProvider`
2. `CookieRequestCultureProvider`
3. `AcceptLanguageHeaderRequestCultureProvider`

<span data-ttu-id="e3c9a-256">Список по умолчанию передается от более свойственных наименее конкретным.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-256">The default list goes from most specific to least specific.</span></span> <span data-ttu-id="e3c9a-257">Далее в этой статье мы рассмотрим, как можно изменить порядок и даже добавить поставщик пользовательского языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-257">Later in the article we'll see how you can change the order and even add a custom culture provider.</span></span> <span data-ttu-id="e3c9a-258">Если ни один из поставщиков можно определить запрос языка и региональных параметров, `DefaultRequestCulture` используется.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-258">If none of the providers can determine the request culture, the `DefaultRequestCulture` is used.</span></span>

### <a name="querystringrequestcultureprovider"></a><span data-ttu-id="e3c9a-259">QueryStringRequestCultureProvider</span><span class="sxs-lookup"><span data-stu-id="e3c9a-259">QueryStringRequestCultureProvider</span></span>

<span data-ttu-id="e3c9a-260">Некоторые приложения будет использовать строку запроса для задания [culture и Uiculture](https://msdn.microsoft.com/library/system.globalization.cultureinfo.aspx).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-260">Some apps will use a query string to set the [culture and UI culture](https://msdn.microsoft.com/library/system.globalization.cultureinfo.aspx).</span></span> <span data-ttu-id="e3c9a-261">Для приложений, использующих файлы cookie или подход заголовок Accept-Language добавив строку запроса URL-адрес полезен для отладки и тестирования кода.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-261">For apps that use the cookie or Accept-Language header approach, adding a query string to the URL is useful for debugging and testing code.</span></span> <span data-ttu-id="e3c9a-262">По умолчанию `QueryStringRequestCultureProvider` регистрируется как первый Поставщик локализации в `RequestCultureProvider` списка.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-262">By default, the `QueryStringRequestCultureProvider` is registered as the first localization provider in the `RequestCultureProvider` list.</span></span> <span data-ttu-id="e3c9a-263">Запрос передан в строковых параметров `culture` и `ui-culture`.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-263">You pass the query string parameters `culture` and `ui-culture`.</span></span> <span data-ttu-id="e3c9a-264">Следующий пример присваивает Испанский/Мексика определенного языка и региональных параметров (язык и регион):</span><span class="sxs-lookup"><span data-stu-id="e3c9a-264">The following example sets the specific culture (language and region) to Spanish/Mexico:</span></span>

   `http://localhost:5000/?culture=es-MX&ui-culture=es-MX`

<span data-ttu-id="e3c9a-265">Если передается только в одном из двух (`culture` или `ui-culture`), поставщика строка запроса будет оба значения с помощью тот, который передается в.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-265">If you only pass in one of the two (`culture` or `ui-culture`), the query string provider will set both values using the one you passed in.</span></span> <span data-ttu-id="e3c9a-266">Например, задание только культуры установит оба `Culture` и `UICulture`:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-266">For example, setting just the culture will set both the `Culture` and the `UICulture`:</span></span>

   `http://localhost:5000/?culture=es-MX`

### <a name="cookierequestcultureprovider"></a><span data-ttu-id="e3c9a-267">CookieRequestCultureProvider</span><span class="sxs-lookup"><span data-stu-id="e3c9a-267">CookieRequestCultureProvider</span></span>

<span data-ttu-id="e3c9a-268">Производственного приложения часто предоставляют механизм для задания языка и региональных параметров с cookie ASP.NET Core языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-268">Production apps will often provide a mechanism to set the culture with the ASP.NET Core culture cookie.</span></span> <span data-ttu-id="e3c9a-269">Используйте `MakeCookieValue` метод для создания файла cookie.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-269">Use the `MakeCookieValue`  method to create a cookie.</span></span>

<span data-ttu-id="e3c9a-270">`CookieRequestCultureProvider` `DefaultCookieName` Возвращает имя файла cookie по умолчанию, используемое для отслеживания пользователя предпочитаемый язык и региональные параметры сведения.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-270">The `CookieRequestCultureProvider` `DefaultCookieName`  returns the default cookie name used to track the user’s preferred culture information.</span></span> <span data-ttu-id="e3c9a-271">Имя файла cookie по умолчанию — «. AspNetCore.Culture».</span><span class="sxs-lookup"><span data-stu-id="e3c9a-271">The default cookie  name is ".AspNetCore.Culture".</span></span>

<span data-ttu-id="e3c9a-272">Недопустимый формат файла cookie `c=%LANGCODE%|uic=%LANGCODE%`, где `c` — `Culture` и `uic` — `UICulture`, например:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-272">The cookie format is `c=%LANGCODE%|uic=%LANGCODE%`, where `c` is `Culture` and `uic` is `UICulture`, for example:</span></span>

    c=en-UK|uic=en-US

<span data-ttu-id="e3c9a-273">Если задано только один язык и региональные параметры и язык и региональные параметры пользовательского интерфейса, язык и региональные параметры и язык и региональные параметры пользовательского интерфейса будет использоваться указанного языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-273">If you only specify one of culture info and UI culture, the specified culture will be used for both culture info and UI culture.</span></span>

### <a name="the-accept-language-http-header"></a><span data-ttu-id="e3c9a-274">Заголовок HTTP Accept-Language</span><span class="sxs-lookup"><span data-stu-id="e3c9a-274">The Accept-Language HTTP header</span></span>

<span data-ttu-id="e3c9a-275">[Заголовка Accept-Language](https://www.w3.org/International/questions/qa-accept-lang-locales) можно задать в большинстве браузеров и изначально не предназначен для указания языка пользователя.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-275">The [Accept-Language header](https://www.w3.org/International/questions/qa-accept-lang-locales) is settable in most browsers and was originally intended to specify the user's language.</span></span> <span data-ttu-id="e3c9a-276">Этот параметр указывает, что браузер задал для отправки или унаследованы от операционной системы.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-276">This setting indicates what the browser has been set to send or has inherited from the underlying operating system.</span></span> <span data-ttu-id="e3c9a-277">Заголовок HTTP Accept-Language из запрос браузера не непогрешимыми способ определить язык пользователя (в разделе [настройках языка в браузере](https://www.w3.org/International/questions/qa-lang-priorities.en.php)).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-277">The Accept-Language HTTP header from a browser request is not an infallible way to detect the user's preferred language (see [Setting language preferences in a browser](https://www.w3.org/International/questions/qa-lang-priorities.en.php)).</span></span> <span data-ttu-id="e3c9a-278">Рабочее приложение должно включать способом для пользователя для настройки собственного языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-278">A production app should include a way for a user to customize their choice of culture.</span></span>

### <a name="setting-the-accept-language-http-header-in-ie"></a><span data-ttu-id="e3c9a-279">Задание заголовка HTTP Accept-Language в IE</span><span class="sxs-lookup"><span data-stu-id="e3c9a-279">Setting the Accept-Language HTTP header in IE</span></span>

1. <span data-ttu-id="e3c9a-280">Щелкните значок шестеренки, коснитесь **обозревателя**.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-280">From the gear icon, tap **Internet Options**.</span></span>

2. <span data-ttu-id="e3c9a-281">Коснитесь **языков**.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-281">Tap **Languages**.</span></span>

    ![Параметры Интернета](localization/_static/lang.png)

3. <span data-ttu-id="e3c9a-283">Коснитесь **задавать настройки языка**.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-283">Tap **Set Language Preferences**.</span></span>

4. <span data-ttu-id="e3c9a-284">Коснитесь **добавить язык**.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-284">Tap **Add a language**.</span></span>

5. <span data-ttu-id="e3c9a-285">Добавьте язык.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-285">Add the language.</span></span>

6. <span data-ttu-id="e3c9a-286">Коснитесь язык, а затем **вверх**.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-286">Tap the language, then tap **Move Up**.</span></span>

### <a name="using-a-custom-provider"></a><span data-ttu-id="e3c9a-287">С помощью пользовательского поставщика</span><span class="sxs-lookup"><span data-stu-id="e3c9a-287">Using a custom provider</span></span>

<span data-ttu-id="e3c9a-288">Предположим, что нужно позволить клиентам хранить их языка и региональных параметров в базах данных.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-288">Suppose you want to let your customers store their language and culture in your databases.</span></span> <span data-ttu-id="e3c9a-289">Можно написать поставщика для поиска этих значений для пользователя.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-289">You could write a provider to look up these values for the user.</span></span> <span data-ttu-id="e3c9a-290">Следующий код демонстрирует добавление настраиваемого поставщика:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-290">The following code shows how to add a custom provider:</span></span>

```csharp
private const string enUSCulture = "en-US";

services.Configure<RequestLocalizationOptions>(options =>
{
    var supportedCultures = new[]
    {
        new CultureInfo(enUSCulture),
        new CultureInfo("fr")
    };

    options.DefaultRequestCulture = new RequestCulture(culture: enUSCulture, uiCulture: enUSCulture);
    options.SupportedCultures = supportedCultures;
    options.SupportedUICultures = supportedCultures;

    options.RequestCultureProviders.Insert(0, new CustomRequestCultureProvider(async context =>
    {
        // My custom request culture logic
        return new ProviderCultureResult("en");
    }));
});
```

<span data-ttu-id="e3c9a-291">Используйте `RequestLocalizationOptions` для добавления или удаления поставщиков локализации.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-291">Use `RequestLocalizationOptions` to add or remove localization providers.</span></span>

### <a name="setting-the-culture-programmatically"></a><span data-ttu-id="e3c9a-292">Программная установка языка и региональных параметров</span><span class="sxs-lookup"><span data-stu-id="e3c9a-292">Setting the culture programmatically</span></span>

<span data-ttu-id="e3c9a-293">В этом примере **Localization.StarterWeb** проект на [GitHub](https://github.com/aspnet/entropy) содержится пользовательский Интерфейс, чтобы задать `Culture`.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-293">This sample **Localization.StarterWeb** project on [GitHub](https://github.com/aspnet/entropy) contains UI to set the `Culture`.</span></span> <span data-ttu-id="e3c9a-294">*Views/Shared/_SelectLanguagePartial.cshtml* файла можно выбрать из списка поддерживаемых языков и региональных параметров языка и региональных параметров:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-294">The *Views/Shared/_SelectLanguagePartial.cshtml* file allows you to select the culture from the list of supported cultures:</span></span>

[!code-HTML[Main](localization/sample/Localization/Views/Shared/_SelectLanguagePartial.cshtml)]

<span data-ttu-id="e3c9a-295">*Views/Shared/_SelectLanguagePartial.cshtml* добавляется файл `footer` раздел файла разметки, она будет доступна во всех представлениях:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-295">The *Views/Shared/_SelectLanguagePartial.cshtml* file is added to the `footer` section of the layout file so it will be available to all views:</span></span>

[!code-HTML[Main](localization/sample/Localization/Views/Shared/_Layout.cshtml?range=43-56&highlight=10)]

<span data-ttu-id="e3c9a-296">`SetLanguage` Метод задает язык и региональные параметры cookie.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-296">The `SetLanguage` method sets the culture cookie.</span></span>

[!code-csharp[Main](localization/sample/Localization/Controllers/HomeController.cs?range=57-67)]

<span data-ttu-id="e3c9a-297">Не удается подключить *_SelectLanguagePartial.cshtml* на примеры кода для данного проекта.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-297">You can't plug in the *_SelectLanguagePartial.cshtml* to sample code for this project.</span></span> <span data-ttu-id="e3c9a-298">**Localization.StarterWeb** проект на [GitHub](https://github.com/aspnet/entropy) содержится код для потока `RequestLocalizationOptions` для Razor, частичная через [внедрения зависимостей](dependency-injection.md) контейнера.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-298">The **Localization.StarterWeb** project on [GitHub](https://github.com/aspnet/entropy) has code to flow the `RequestLocalizationOptions` to a Razor partial through the [Dependency Injection](dependency-injection.md) container.</span></span>

## <a name="globalization-and-localization-terms"></a><span data-ttu-id="e3c9a-299">Глобализация и локализация условия</span><span class="sxs-lookup"><span data-stu-id="e3c9a-299">Globalization and localization terms</span></span>

<span data-ttu-id="e3c9a-300">Процесс локализации приложения необходимо также основные сведения о соответствующей кодировки, обычно используемые в разработке современного программного обеспечения и понимания проблем, связанных с ними.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-300">The process of localizing your app also requires a basic understanding of relevant character sets commonly used in modern software development and an understanding of the issues associated with them.</span></span> <span data-ttu-id="e3c9a-301">Несмотря на то, что все компьютеры сохранения текста в виде чисел (коды), разных систем хранения тот же текст, с помощью различных чисел.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-301">Although all computers store text as numbers (codes), different systems store the same text using different numbers.</span></span> <span data-ttu-id="e3c9a-302">Процесс локализации ссылается на перевод пользовательского интерфейса (UI) приложения для определенного языка и региональных параметров или языкового стандарта.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-302">The localization process refers to translating the app user interface (UI) for a specific culture/locale.</span></span>

<span data-ttu-id="e3c9a-303">[Локализуемость](https://docs.microsoft.com/dotnet/standard/globalization-localization/localizability-review) — это промежуточный процесс для проверки того, что международное приложение готово к локализации.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-303">[Localizability](https://docs.microsoft.com/dotnet/standard/globalization-localization/localizability-review) is an intermediate process for verifying that a globalized app is ready for localization.</span></span>

<span data-ttu-id="e3c9a-304">[RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) формат имя языка и региональных параметров является "<languagecode2>-< код_страны_или_региона2 >», где <languagecode2> является кодом языка, а < код_страны_или_региона2 > — код региона.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-304">The [RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) format for the culture name is "<languagecode2>-<country/regioncode2>", where <languagecode2> is the language code and <country/regioncode2> is the subculture code.</span></span> <span data-ttu-id="e3c9a-305">Например `es-CL` испанский (Чили) `en-US` для английского языка (США) и `en-AU` для английского языка (Австралия).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-305">For example, `es-CL` for Spanish (Chile), `en-US` for English (United States), and `en-AU` for English (Australia).</span></span> <span data-ttu-id="e3c9a-306">[RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) представляет собой сочетание ISO 639, кода двух букв нижнего регистра, языка и региональных параметров, связанных с языком и ISO 3166, код страны или региона на прописных букв, связанные с страны или региона.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-306">[RFC 4646](https://www.ietf.org/rfc/rfc4646.txt) is a combination of an ISO 639 two-letter lowercase culture code associated with a language and an ISO 3166 two-letter uppercase subculture code associated with a country or region.</span></span>  <span data-ttu-id="e3c9a-307">В разделе [имя языка и региональных параметров языка](https://msdn.microsoft.com/library/ee825488(v=cs.20).aspx).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-307">See [Language Culture Name](https://msdn.microsoft.com/library/ee825488(v=cs.20).aspx).</span></span>

<span data-ttu-id="e3c9a-308">Интернационализация часто называют «I18N».</span><span class="sxs-lookup"><span data-stu-id="e3c9a-308">Internationalization is often abbreviated to "I18N".</span></span> <span data-ttu-id="e3c9a-309">Сокращение принимает первую и последнюю буквы и количеством букв между ними, поэтому 18 означает количество буквы между первым «I» и последнего «N».</span><span class="sxs-lookup"><span data-stu-id="e3c9a-309">The abbreviation takes the first and last letters and the number of letters between them, so 18 stands for the number of letters between the first "I" and the last "N".</span></span> <span data-ttu-id="e3c9a-310">То же самое происходит (G11N) глобализации и локализации (L10N).</span><span class="sxs-lookup"><span data-stu-id="e3c9a-310">The same applies to Globalization (G11N), and Localization (L10N).</span></span>

<span data-ttu-id="e3c9a-311">Условия:</span><span class="sxs-lookup"><span data-stu-id="e3c9a-311">Terms:</span></span>

* <span data-ttu-id="e3c9a-312">Глобализация (G11N): Процесс создания приложения поддержки различных языков и регионов.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-312">Globalization (G11N): The process of making an app support different languages and regions.</span></span>
* <span data-ttu-id="e3c9a-313">Локализация (L10N): Процесс настройки приложения для данного языка и региона.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-313">Localization (L10N): The process of customizing an app for a given language and region.</span></span>
* <span data-ttu-id="e3c9a-314">Интернационализация (I18N): Описание глобализации и локализации.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-314">Internationalization (I18N): Describes both globalization and localization.</span></span>
* <span data-ttu-id="e3c9a-315">Культура:, Это язык, возможно, область.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-315">Culture: It is a language and, optionally, a region.</span></span>
* <span data-ttu-id="e3c9a-316">Нейтральный язык и региональные параметры: язык и региональные параметры указанного языка, но не область.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-316">Neutral culture: A culture that has a specified language, but not a region.</span></span> <span data-ttu-id="e3c9a-317">(например «en», «es»)</span><span class="sxs-lookup"><span data-stu-id="e3c9a-317">(for example "en", "es")</span></span>
* <span data-ttu-id="e3c9a-318">Определенного языка и региональных параметров: языка и региональных параметров, который имеет указанный язык и регион.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-318">Specific culture: A culture that has a specified language and region.</span></span> <span data-ttu-id="e3c9a-319">(для, например «en US», «en-GB», «es-CL»)</span><span class="sxs-lookup"><span data-stu-id="e3c9a-319">(for example "en-US", "en-GB", "es-CL")</span></span>
* <span data-ttu-id="e3c9a-320">Родительский язык и региональные параметры: нейтральной культуры, содержащий определенного языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-320">Parent culture: The neutral culture that contains a specific culture.</span></span> <span data-ttu-id="e3c9a-321">(например, «en» является родительского языка и региональных параметров «en US» и «en-GB»)</span><span class="sxs-lookup"><span data-stu-id="e3c9a-321">(for example, "en" is the parent culture of "en-US" and "en-GB")</span></span>
* <span data-ttu-id="e3c9a-322">Язык: Языковой стандарт — совпадает с языком и региональными параметрами.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-322">Locale: A locale is the same as a culture.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="e3c9a-323">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="e3c9a-323">Additional resources</span></span>

* <span data-ttu-id="e3c9a-324">[Проект Localization.StarterWeb](https://github.com/aspnet/entropy) используется в статье.</span><span class="sxs-lookup"><span data-stu-id="e3c9a-324">[Localization.StarterWeb project](https://github.com/aspnet/entropy) used in the article.</span></span>
* [<span data-ttu-id="e3c9a-325">Файлы ресурсов в Visual Studio</span><span class="sxs-lookup"><span data-stu-id="e3c9a-325">Resource Files in Visual Studio</span></span>](https://docs.microsoft.com/cpp/windows/resource-files-visual-studio)
* [<span data-ttu-id="e3c9a-326">Ресурсы в RESX-файлы</span><span class="sxs-lookup"><span data-stu-id="e3c9a-326">Resources in .resx Files</span></span>](https://docs.microsoft.com/dotnet/framework/resources/working-with-resx-files-programmatically)
