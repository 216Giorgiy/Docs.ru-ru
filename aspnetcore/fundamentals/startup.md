---
title: "Запуск приложения в ASP.NET Core"
author: ardalis
description: "Описание класса запуска в ASP.NET Core."
keywords: "ASP.NET Core, запуска, настроить метод, метод ConfigureServices"
ms.author: tdykstra
manager: wpickett
ms.date: 02/29/2017
ms.topic: article
ms.technology: aspnet
ms.prod: asp.net-core
uid: fundamentals/startup
ms.openlocfilehash: 009df1416c822018d6e88912cc77e525c7349c34
ms.sourcegitcommit: 78d28178345a0eea91556e4cd1adad98b1446db8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/22/2017
---
# <a name="application-startup-in-aspnet-core"></a><span data-ttu-id="68ebf-104">Запуск приложения в ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="68ebf-104">Application Startup in ASP.NET Core</span></span>

<span data-ttu-id="68ebf-105">По [Стив Смит](https://ardalis.com/) и [Tom Dykstra](https://github.com/tdykstra/)</span><span class="sxs-lookup"><span data-stu-id="68ebf-105">By [Steve Smith](https://ardalis.com/) and [Tom Dykstra](https://github.com/tdykstra/)</span></span>

<span data-ttu-id="68ebf-106">`Startup` Класс настраивает службы и конвейер обработки запросов приложения.</span><span class="sxs-lookup"><span data-stu-id="68ebf-106">The `Startup` class configures services and the application's request pipeline.</span></span> 

## <a name="the-startup-class"></a><span data-ttu-id="68ebf-107">Класс запуска</span><span class="sxs-lookup"><span data-stu-id="68ebf-107">The Startup class</span></span>

<span data-ttu-id="68ebf-108">Приложения ASP.NET Core требуется `Startup` класса.</span><span class="sxs-lookup"><span data-stu-id="68ebf-108">ASP.NET Core apps require a `Startup` class.</span></span> <span data-ttu-id="68ebf-109">По соглашению `Startup` класс имеет имя «Загрузки».</span><span class="sxs-lookup"><span data-stu-id="68ebf-109">By convention, the `Startup` class is named "Startup".</span></span> <span data-ttu-id="68ebf-110">Укажите имя класса запуска в `Main` программы [WebHostBuilderExtensions](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilderextensions) [ `UseStartup<TStartup>` ](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilderextensions#Microsoft_AspNetCore_Hosting_WebHostBuilderExtensions_UseStartup__1_Microsoft_AspNetCore_Hosting_IWebHostBuilder_) метод.</span><span class="sxs-lookup"><span data-stu-id="68ebf-110">You specify the startup class name in the `Main` program's [WebHostBuilderExtensions](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilderextensions) [`UseStartup<TStartup>`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilderextensions#Microsoft_AspNetCore_Hosting_WebHostBuilderExtensions_UseStartup__1_Microsoft_AspNetCore_Hosting_IWebHostBuilder_) method.</span></span> <span data-ttu-id="68ebf-111">В разделе [размещения](xref:fundamentals/hosting) для получения дополнительных сведений о `WebHostBuilder`, выполняемая перед `Startup`.</span><span class="sxs-lookup"><span data-stu-id="68ebf-111">See [Hosting](xref:fundamentals/hosting) to learn more about `WebHostBuilder`, which runs before `Startup`.</span></span>

<span data-ttu-id="68ebf-112">Можно определить отдельные `Startup` классы для различных сред и соответствующие выбрана одна во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="68ebf-112">You can define separate `Startup` classes for different environments, and the appropriate one will be selected at runtime.</span></span> <span data-ttu-id="68ebf-113">При указании `startupAssembly` в [конфигурации WebHost](https://docs.microsoft.com/aspnet/core/fundamentals/hosting?tabs=aspnetcore2x#configuring-a-host) или параметры, размещение будет загрузить эту сборку для запуска и выполните поиск `Startup` или `Startup[Environment]` типа.</span><span class="sxs-lookup"><span data-stu-id="68ebf-113">If you specify `startupAssembly` in the [WebHost configuration](https://docs.microsoft.com/aspnet/core/fundamentals/hosting?tabs=aspnetcore2x#configuring-a-host) or options, hosting will load that startup assembly and search for a `Startup` or `Startup[Environment]` type.</span></span> <span data-ttu-id="68ebf-114">Класс которого совпадения суффикс имени текущей среде будет иметь приоритет, поэтому, если приложение выполняется в *разработки* среды и включает в себя `Startup` и `StartupDevelopment` класса `StartupDevelopment` класс будет использовать.</span><span class="sxs-lookup"><span data-stu-id="68ebf-114">The class whose name suffix matches the current environment will be prioritized, so if the app is run in the *Development* environment, and includes both a `Startup` and a `StartupDevelopment` class, the `StartupDevelopment` class will be used.</span></span> <span data-ttu-id="68ebf-115">В разделе [FindStartupType](https://github.com/aspnet/Hosting/blob/rel/1.1.0/src/Microsoft.AspNetCore.Hosting/Internal/StartupLoader.cs) в `StartupLoader` и [работа с несколькими средами](environments.md#startup-conventions).</span><span class="sxs-lookup"><span data-stu-id="68ebf-115">See [FindStartupType](https://github.com/aspnet/Hosting/blob/rel/1.1.0/src/Microsoft.AspNetCore.Hosting/Internal/StartupLoader.cs) in `StartupLoader` and [Working with multiple environments](environments.md#startup-conventions).</span></span>

<span data-ttu-id="68ebf-116">Кроме того, можно определить фиксированный `Startup` класс, который будет использоваться независимо от среды, путем вызова `UseStartup<TStartup>`.</span><span class="sxs-lookup"><span data-stu-id="68ebf-116">Alternatively, you can define a fixed `Startup` class that will be used regardless of the environment by calling `UseStartup<TStartup>`.</span></span> <span data-ttu-id="68ebf-117">Этот способ является рекомендуемым.</span><span class="sxs-lookup"><span data-stu-id="68ebf-117">This is the recommended approach.</span></span>

<span data-ttu-id="68ebf-118">`Startup` Конструктор класса могут принимать зависимости, которые обеспечиваются через [внедрения зависимостей](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="68ebf-118">The `Startup` class constructor can accept dependencies that are provided through [dependency injection](xref:fundamentals/dependency-injection).</span></span> <span data-ttu-id="68ebf-119">Общий подход заключается в использовании `IHostingEnvironment` Настройка [конфигурации](xref:fundamentals/configuration) источников.</span><span class="sxs-lookup"><span data-stu-id="68ebf-119">A common approach is to use `IHostingEnvironment` to set up [configuration](xref:fundamentals/configuration) sources.</span></span>

<span data-ttu-id="68ebf-120">`Startup` Класс должен включать `Configure` метода и при необходимости можно включить `ConfigureServices` метода, которые вызываются при запуске приложения.</span><span class="sxs-lookup"><span data-stu-id="68ebf-120">The `Startup` class must include a `Configure` method and can optionally include a `ConfigureServices` method, both of which are called when the application starts.</span></span> <span data-ttu-id="68ebf-121">Класс может также включать [конкретных версий этих методов](xref:fundamentals/environments#startup-conventions).</span><span class="sxs-lookup"><span data-stu-id="68ebf-121">The class can also include [environment-specific versions of these methods](xref:fundamentals/environments#startup-conventions).</span></span> <span data-ttu-id="68ebf-122">`ConfigureServices`, если он имеется, вызывается перед `Configure`.</span><span class="sxs-lookup"><span data-stu-id="68ebf-122">`ConfigureServices`, if present, is called before `Configure`.</span></span>

<span data-ttu-id="68ebf-123">Дополнительные сведения о [обработки исключений во время запуска приложения](xref:fundamentals/error-handling#startup-exception-handling).</span><span class="sxs-lookup"><span data-stu-id="68ebf-123">Learn about [handling exceptions during application startup](xref:fundamentals/error-handling#startup-exception-handling).</span></span>

## <a name="the-configureservices-method"></a><span data-ttu-id="68ebf-124">Метод ConfigureServices</span><span class="sxs-lookup"><span data-stu-id="68ebf-124">The ConfigureServices method</span></span>

<span data-ttu-id="68ebf-125">[ConfigureServices](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.startupbase#Microsoft_AspNetCore_Hosting_StartupBase_ConfigureServices_Microsoft_Extensions_DependencyInjection_IServiceCollection_) является необязательным; но, если вызывается до `Configure` метод с веб-узла.</span><span class="sxs-lookup"><span data-stu-id="68ebf-125">The [ConfigureServices](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.startupbase#Microsoft_AspNetCore_Hosting_StartupBase_ConfigureServices_Microsoft_Extensions_DependencyInjection_IServiceCollection_) method is optional; but if used, it's called before the `Configure` method by the web host.</span></span> <span data-ttu-id="68ebf-126">Веб-узла могут настраивать некоторые службы перед ``Startup`` методы вызываются (см. [размещение](xref:fundamentals/hosting)).</span><span class="sxs-lookup"><span data-stu-id="68ebf-126">The web host may configure some services before ``Startup`` methods are called (see [hosting](xref:fundamentals/hosting)).</span></span> <span data-ttu-id="68ebf-127">По соглашению [параметры конфигурации](xref:fundamentals/configuration) устанавливаются в этом методе.</span><span class="sxs-lookup"><span data-stu-id="68ebf-127">By convention, [Configuration options](xref:fundamentals/configuration) are set in this method.</span></span>

<span data-ttu-id="68ebf-128">Для функций, требующих значительной установки существует `Add[Service]` методы расширения в [IServiceCollection](https://docs.microsoft.com/aspnet/core/api/microsoft.extensions.dependencyinjection.iservicecollection).</span><span class="sxs-lookup"><span data-stu-id="68ebf-128">For features that require substantial setup there are `Add[Service]` extension methods on [IServiceCollection](https://docs.microsoft.com/aspnet/core/api/microsoft.extensions.dependencyinjection.iservicecollection).</span></span> <span data-ttu-id="68ebf-129">В этом примере с помощью шаблона веб-сайта по умолчанию настраивает приложение для использования служб для Entity Framework, удостоверения и MVC:</span><span class="sxs-lookup"><span data-stu-id="68ebf-129">This example from the default web site template configures the app to use services for Entity Framework, Identity, and MVC:</span></span>

[!code-csharp[Main](../common/samples/WebApplication1/Startup.cs?highlight=4,7,11&start=40&end=55)]

<span data-ttu-id="68ebf-130">Добавление служб в контейнер службы делает их доступными в приложении через [внедрения зависимостей](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="68ebf-130">Adding services to the services container makes them available within your application via [dependency injection](xref:fundamentals/dependency-injection).</span></span>

## <a name="services-available-in-startup"></a><span data-ttu-id="68ebf-131">Службы, доступные при запуске</span><span class="sxs-lookup"><span data-stu-id="68ebf-131">Services Available in Startup</span></span>

<span data-ttu-id="68ebf-132">Внедрение зависимостей ASP.NET Core предоставляет службы во время запуска приложения.</span><span class="sxs-lookup"><span data-stu-id="68ebf-132">ASP.NET Core dependency injection provides services during an application's startup.</span></span> <span data-ttu-id="68ebf-133">Можно запросить этих служб, включая соответствующий интерфейс в качестве параметра на ваш `Startup` конструктор класса или его `Configure` метод.</span><span class="sxs-lookup"><span data-stu-id="68ebf-133">You can request these services by including the appropriate interface as a parameter on your `Startup` class's constructor or its `Configure` method.</span></span> <span data-ttu-id="68ebf-134">`ConfigureServices` Метод принимает только `IServiceCollection` параметра (но любой зарегистрированную службу может извлекаться из этой коллекции, так что дополнительные параметры не требуются).</span><span class="sxs-lookup"><span data-stu-id="68ebf-134">The `ConfigureServices` method only takes an `IServiceCollection` parameter (but any registered service can be retrieved from this collection, so additional parameters are not necessary).</span></span>

<span data-ttu-id="68ebf-135">Ниже перечислены некоторые службы, обычно запрашиваемые `Startup` методов:</span><span class="sxs-lookup"><span data-stu-id="68ebf-135">Below are some of the services typically requested by `Startup` methods:</span></span>

* <span data-ttu-id="68ebf-136">В конструкторе: `IHostingEnvironment`,`ILogger<Startup>`</span><span class="sxs-lookup"><span data-stu-id="68ebf-136">In the constructor:  `IHostingEnvironment`, `ILogger<Startup>`</span></span>
* <span data-ttu-id="68ebf-137">В `ConfigureServices`:`IServiceCollection`</span><span class="sxs-lookup"><span data-stu-id="68ebf-137">In `ConfigureServices`:  `IServiceCollection`</span></span>
* <span data-ttu-id="68ebf-138">В `Configure`: `IApplicationBuilder`, `IHostingEnvironment`,`ILoggerFactory`</span><span class="sxs-lookup"><span data-stu-id="68ebf-138">In `Configure`:  `IApplicationBuilder`, `IHostingEnvironment`, `ILoggerFactory`</span></span>

<span data-ttu-id="68ebf-139">Все службы, добавленные ``WebHostBuilder`` ``ConfigureServices`` может запрашиваться метод ``Startup`` конструктор класса или его ``Configure`` метод.</span><span class="sxs-lookup"><span data-stu-id="68ebf-139">Any services added by the ``WebHostBuilder`` ``ConfigureServices`` method may be requested by the ``Startup`` class constructor or its ``Configure`` method.</span></span> <span data-ttu-id="68ebf-140">Используйте `WebHostBuilder` для предоставления любых служб, которые требуются во время `Startup` методы.</span><span class="sxs-lookup"><span data-stu-id="68ebf-140">Use `WebHostBuilder` to provide any services you need during `Startup` methods.</span></span>

## <a name="the-configure-method"></a><span data-ttu-id="68ebf-141">Метод конфигурации</span><span class="sxs-lookup"><span data-stu-id="68ebf-141">The Configure method</span></span>

<span data-ttu-id="68ebf-142">`Configure` Метод используется для указания того, как приложение ASP.NET отвечает на HTTP-запросы.</span><span class="sxs-lookup"><span data-stu-id="68ebf-142">The `Configure` method is used to specify how the ASP.NET application will respond to HTTP requests.</span></span> <span data-ttu-id="68ebf-143">Конвейер запросов настраивается путем добавления [по промежуточного слоя](middleware.md) компонентов `IApplicationBuilder` экземпляра, предоставляемая внедрения зависимостей.</span><span class="sxs-lookup"><span data-stu-id="68ebf-143">The request pipeline is configured by adding [middleware](middleware.md) components to an `IApplicationBuilder` instance that is provided by dependency injection.</span></span>

<span data-ttu-id="68ebf-144">В следующем примере с помощью шаблона веб-сайта по умолчанию используются несколько методов расширения для настройки конвейера с поддержкой [BrowserLink](http://vswebessentials.com/features/browserlink), страницы ошибок, статические файлы, ASP.NET MVC и удостоверений.</span><span class="sxs-lookup"><span data-stu-id="68ebf-144">In the following example from the default web site template, several extension methods are used to configure the pipeline with support for [BrowserLink](http://vswebessentials.com/features/browserlink), error pages, static files, ASP.NET MVC, and Identity.</span></span>

[!code-csharp[Main](../common/samples/WebApplication1/Startup.cs?highlight=8,9,10,14,17,19,21&start=58&end=84)]

<span data-ttu-id="68ebf-145">Каждый `Use` добавляет метод расширения [по промежуточного слоя](xref:fundamentals/middleware) в конвейер обработки запросов.</span><span class="sxs-lookup"><span data-stu-id="68ebf-145">Each `Use` extension method adds a [middleware](xref:fundamentals/middleware) component to the request pipeline.</span></span> <span data-ttu-id="68ebf-146">Например `UseMvc` добавляет метод расширения [маршрутизации](routing.md) по промежуточного слоя в конвейере и настраивает [MVC](xref:mvc/overview) как обработчик по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="68ebf-146">For instance, the `UseMvc` extension method adds the [routing](routing.md) middleware to the request pipeline and configures [MVC](xref:mvc/overview) as the default handler.</span></span>

<span data-ttu-id="68ebf-147">Дополнительные сведения об использовании `IApplicationBuilder`, в разделе [по промежуточного слоя](xref:fundamentals/middleware).</span><span class="sxs-lookup"><span data-stu-id="68ebf-147">For more information about how to use `IApplicationBuilder`, see [Middleware](xref:fundamentals/middleware).</span></span>

<span data-ttu-id="68ebf-148">Дополнительные службы, такие как `IHostingEnvironment` и `ILoggerFactory` также может быть указан в сигнатуре метода в таком случае эти службы будут [введенного](dependency-injection.md) если они доступны.</span><span class="sxs-lookup"><span data-stu-id="68ebf-148">Additional services, like `IHostingEnvironment` and `ILoggerFactory` may also be specified in the method signature, in which case these services will be [injected](dependency-injection.md) if they are available.</span></span> 

## <a name="additional-resources"></a><span data-ttu-id="68ebf-149">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="68ebf-149">Additional Resources</span></span>

* [<span data-ttu-id="68ebf-150">Работа с несколькими средами</span><span class="sxs-lookup"><span data-stu-id="68ebf-150">Working with Multiple Environments</span></span>](xref:fundamentals/environments)
* [<span data-ttu-id="68ebf-151">ПО промежуточного слоя</span><span class="sxs-lookup"><span data-stu-id="68ebf-151">Middleware</span></span>](xref:fundamentals/middleware)
* [<span data-ttu-id="68ebf-152">Ведение журнала</span><span class="sxs-lookup"><span data-stu-id="68ebf-152">Logging</span></span>](xref:fundamentals/logging)
* [<span data-ttu-id="68ebf-153">Конфигурация</span><span class="sxs-lookup"><span data-stu-id="68ebf-153">Configuration</span></span>](xref:fundamentals/configuration)
