---
title: "Частичные представления"
author: ardalis
description: "Использование частичных представлений в ASP.NET Core MVC"
manager: wpickett
ms.author: riande
ms.date: 03/14/2017
ms.prod: asp.net-core
ms.technology: aspnet
ms.topic: article
uid: mvc/views/partial
ms.openlocfilehash: 169948e5d7dc8068463ed61114666148b785b217
ms.sourcegitcommit: a510f38930abc84c4b302029d019a34dfe76823b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/30/2018
---
# <a name="partial-views"></a>Частичные представления

Авторы: [Стив Смит](https://ardalis.com/) (Steve Smith), [Махер Джендуби](https://twitter.com/maherjend) (Maher JENDOUBI) и [Рик Андерсон](https://twitter.com/RickAndMSFT) (Rick Anderson)

В ASP.NET Core MVC поддерживаются частичные представления, которые полезны в том случае, если на веб-страницах есть повторяющиеся части, которые должны использоваться совместно в разных представлениях.

[Просмотреть или скачать образец кода](https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/views/partial/sample) ([как скачивать](xref:tutorials/index#how-to-download-a-sample))

## <a name="what-are-partial-views"></a>Что такое частичные представления

Частичное представление — это представление, которое преобразовывается для просмотра внутри другого представления. Выходные данные HTML, создаваемые при выполнении частичного представления, передаются в вызывающее (родительское) представление. Как и для обычных представлений, для частичных представлений используется расширение имени файла *CSHTML*.

## <a name="when-should-i-use-partial-views"></a>Когда следует использовать частичные представления

Частичные представления — это эффективный способ разбиения больших представлений на более простые компоненты. Они позволяют сократить дублирование содержимого и использовать элементы представлений повторно. Общие элементы макета следует указывать в файле [_Layout.cshtml](layout.md). Повторно используемое содержимое, не относящееся к макету, можно инкапсулировать в частичных представлениях.

Если имеется сложная страница, состоящая из нескольких логических частей, может быть удобнее работать с каждой из них как с отдельным частичным представлением. Каждую часть страницы можно просматривать изолированно от остальных, а представление самой страницы становится гораздо проще, так как оно содержит только общую структуру страницы и вызывает частичные представления с целью преобразования для просмотра.

Совет. Соблюдайте в представлениях [принцип "Не повторяйся"](http://deviq.com/don-t-repeat-yourself/).

## <a name="declaring-partial-views"></a>Объявление частичных представлений

Частичные представления создаются так же, как и любые другие: нужно создать файл *CSHTML* в папке *Views*. Смыслового различия между частичным и обычным представлениями нет — они просто по-разному преобразовываются для просмотра. Например, представление, возвращаемое из объекта `ViewResult`, может применяться как частичное представление. Основное различие между преобразованием обычных и частичных представлений для просмотра заключается в том, что частичные представления не запускают файл *_ViewStart.cshtml* (как это делают обычные представления; дополнительные сведения о файле *_ViewStart.cshtml* см. в статье [Макет](layout.md)).

## <a name="referencing-a-partial-view"></a>Ссылка на частичное представление

Частичное представление может преобразовываться для просмотра из страницы представления несколькими способами. Самый простой способ — использовать метод `Html.Partial`, который возвращает экземпляр `IHtmlString` и на который можно ссылаться путем указания префикса `@` перед вызовом:

[!code-html[Main](partial/sample/src/PartialViewsSample/Views/Home/About.cshtml?range=9)]

Метод `PartialAsync` доступен для частичных представлений, содержащих асинхронный код (хотя использовать код в представлениях, как правило, не рекомендуется):

[!code-html[Main](partial/sample/src/PartialViewsSample/Views/Home/About.cshtml?range=8)]

Преобразовывать частичное представление для просмотра можно с помощью метода `RenderPartial`. Он не возвращает результат, а передает преобразованные выходные данные непосредственно в ответ в потоковом режиме. Так как этот метод не возвращает результат, его необходимо вызывать в блоке кода Razor (при необходимости можно также вызывать `RenderPartialAsync`):

[!code-html[Main](partial/sample/src/PartialViewsSample/Views/Home/About.cshtml?range=10-12)]

Так как методы `RenderPartial` и `RenderPartialAsync` передают результат в потоковом режиме напрямую, в некоторых ситуациях они могут быть эффективнее. Однако в большинстве случаев рекомендуется применять методы `Partial` и `PartialAsync`.

> [!NOTE]
> Если представления должны выполнять код, рекомендованный подход заключается в использовании [компонента представления](view-components.md) вместо частичного представления.

### <a name="partial-view-discovery"></a>Обнаружение частичного представления

Ссылаясь на частичное представление, его расположение можно указывать несколькими способами.

```text
// Uses a view in current folder with this name
// If none is found, searches the Shared folder
@Html.Partial("ViewName")

// A view with this name must be in the same folder
@Html.Partial("ViewName.cshtml")

// Locate the view based on the application root
// Paths that start with "/" or "~/" refer to the application root
@Html.Partial("~/Views/Folder/ViewName.cshtml")
@Html.Partial("/Views/Folder/ViewName.cshtml")

// Locate the view using relative paths
@Html.Partial("../Account/LoginPartial.cshtml")
```

В разных папках представлений могут быть разные частичные представления с одинаковыми именами. При обращении к представлениям по имени (без указания расширения имени файла) представление в каждой папке будет использовать частичное представление из той же папки. Можно также определить частичное представление по умолчанию, поместив его в папку *Shared*. Общее частичное представление будет использоваться всеми представлениями, у которых нет собственного частичного представления. Частичное представление по умолчанию (в папке *Shared*) может переопределяться частичным представлением с тем же именем, которое находится в одной папке с родительским представлением.

Частичные представления могут *объединяться в цепочки*, то есть одно частичное представление может вызывать другое (если при этом не образуется цикл). В каждом обычном или частичном представлении относительные пути всегда указываются относительно данного представления, а не корневого или родительского.

> [!NOTE]
> При объявлении раздела `section` [Razor](razor.md) в частичном представлении он будет недоступен родительским представлениям, то есть он будет ограничен данным частичным представлением.

## <a name="accessing-data-from-partial-views"></a>Доступ к данным из частичных представлений

Когда создается экземпляр частичного представления, он получает копию словаря `ViewData` родительского представления. Изменения, вносимые в данные в частичном представлении, не сохраняются в родительском представлении. Например, изменения объекта `ViewData` в частичном представлении утрачиваются при возврате управления из этого представления.

В частичное представление можно передать экземпляр `ViewDataDictionary`:

```csharp
@Html.Partial("PartialName", customViewData)
   ```

В частичное представление можно также передать модель. Это может быть модель представления страницы, какая-либо ее часть или пользовательский объект. Модель можно передать в метод `Partial`,`PartialAsync`, `RenderPartial` или `RenderPartialAsync`.

```csharp
@Html.Partial("PartialName", viewModel)
   ```

В частичное представление можно передать экземпляр `ViewDataDictionary` и модель представления:

[!code-html[Main](partial/sample/src/PartialViewsSample/Views/Articles/Read.cshtml?range=15-16)]

В приведенной ниже разметке показано представление *Views/Articles/Read.cshtml*, содержащее два частичных представления. Второе частичное представление передает модель и объект `ViewData` в первое частичное представление. Вы можете передать новый словарь `ViewData`, сохранив существующий `ViewData`. Для этого используйте перегрузку конструктора `ViewDataDictionary`, выделенную ниже.

[!code-html[Main](partial/sample/src/PartialViewsSample/Views/Articles/Read.cshtml)]

*Views/Shared/AuthorPartial*:

[!code-html[Main](partial/sample/src/PartialViewsSample/Views/Shared/AuthorPartial.cshtml)]

Частичное представление *ArticleSection*:

[!code-html[Main](partial/sample/src/PartialViewsSample/Views/Articles/ArticleSection.cshtml)]

Во время выполнения частичные представления преобразовываются для просмотра внутри родительского представления, которое само преобразовывается для просмотра в общем макете *_Layout.cshtml*.

![выходные данные частичного представления](partial/_static/output.png)
