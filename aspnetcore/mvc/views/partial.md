---
title: Частичные представления в ASP.NET Core
author: ardalis
description: Сведения о том, что частичное представление — это представление, отображаемое в другом представлении, и о сценариях их использования в приложениях ASP.NET Core.
manager: wpickett
ms.author: riande
ms.date: 03/14/2018
ms.prod: asp.net-core
ms.technology: aspnet
ms.topic: article
uid: mvc/views/partial
ms.openlocfilehash: 3deaaeb666e5443d0784f2ac6977e58e1b25d711
ms.sourcegitcommit: 71b93b42cbce8a9b1a12c4d88391e75a4dfb6162
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2018
ms.locfileid: "30000906"
---
# <a name="partial-views-in-aspnet-core"></a><span data-ttu-id="2de40-103">Частичные представления в ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="2de40-103">Partial Views in ASP.NET Core</span></span>

<span data-ttu-id="2de40-104">Авторы: [Стив Смит](https://ardalis.com/) (Steve Smith), [Махер Джендуби](https://twitter.com/maherjend) (Maher JENDOUBI), [Рик Андерсон](https://twitter.com/RickAndMSFT) (Rick Anderson) и [Скотт Саубер](https://twitter.com/scottsauber) (Scott Sauber)</span><span class="sxs-lookup"><span data-stu-id="2de40-104">By [Steve Smith](https://ardalis.com/), [Maher JENDOUBI](https://twitter.com/maherjend), [Rick Anderson](https://twitter.com/RickAndMSFT), and [Scott Sauber](https://twitter.com/scottsauber)</span></span>

<span data-ttu-id="2de40-105">В ASP.NET Core MVC поддерживаются частичные представления, которые полезны в том случае, если на веб-страницах есть повторяющиеся части, которые должны использоваться совместно в разных представлениях.</span><span class="sxs-lookup"><span data-stu-id="2de40-105">ASP.NET Core MVC supports partial views, which are useful when you have reusable parts of web pages you want to share between different views.</span></span>

<span data-ttu-id="2de40-106">[Просмотреть или скачать образец кода](https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/views/partial/sample) ([как скачивать](xref:tutorials/index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="2de40-106">[View or download sample code](https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/views/partial/sample) ([how to download](xref:tutorials/index#how-to-download-a-sample))</span></span>

## <a name="what-are-partial-views"></a><span data-ttu-id="2de40-107">Что такое частичные представления</span><span class="sxs-lookup"><span data-stu-id="2de40-107">What are Partial Views?</span></span>

<span data-ttu-id="2de40-108">Частичное представление — это представление, которое преобразовывается для просмотра внутри другого представления.</span><span class="sxs-lookup"><span data-stu-id="2de40-108">A partial view is a view that's rendered within another view.</span></span> <span data-ttu-id="2de40-109">Выходные данные HTML, создаваемые при выполнении частичного представления, передаются в вызывающее (родительское) представление.</span><span class="sxs-lookup"><span data-stu-id="2de40-109">The HTML output generated by executing the partial view is rendered into the calling (or parent) view.</span></span> <span data-ttu-id="2de40-110">Как и для обычных представлений, для частичных представлений используется расширение имени файла *CSHTML*.</span><span class="sxs-lookup"><span data-stu-id="2de40-110">Like views, partial views use the *.cshtml* file extension.</span></span>

## <a name="when-should-i-use-partial-views"></a><span data-ttu-id="2de40-111">Когда следует использовать частичные представления</span><span class="sxs-lookup"><span data-stu-id="2de40-111">When Should I Use Partial Views?</span></span>

<span data-ttu-id="2de40-112">Частичные представления — это эффективный способ разбиения больших представлений на более простые компоненты.</span><span class="sxs-lookup"><span data-stu-id="2de40-112">Partial views are an effective way of breaking up large views into smaller components.</span></span> <span data-ttu-id="2de40-113">Они позволяют сократить дублирование содержимого и использовать элементы представлений повторно.</span><span class="sxs-lookup"><span data-stu-id="2de40-113">They can reduce duplication of view content and allow view elements to be reused.</span></span> <span data-ttu-id="2de40-114">Общие элементы макета следует указывать в файле [_Layout.cshtml](layout.md).</span><span class="sxs-lookup"><span data-stu-id="2de40-114">Common layout elements should be specified in [_Layout.cshtml](layout.md).</span></span> <span data-ttu-id="2de40-115">Повторно используемое содержимое, не относящееся к макету, можно инкапсулировать в частичных представлениях.</span><span class="sxs-lookup"><span data-stu-id="2de40-115">Non-layout reusable content can be encapsulated into partial views.</span></span>

<span data-ttu-id="2de40-116">Если имеется сложная страница, состоящая из нескольких логических частей, может быть удобнее работать с каждой из них как с отдельным частичным представлением.</span><span class="sxs-lookup"><span data-stu-id="2de40-116">If you have a complex page made up of several logical pieces, it can be helpful to work with each piece as its own partial view.</span></span> <span data-ttu-id="2de40-117">Каждую часть страницы можно просматривать изолированно от остальных, а представление самой страницы становится гораздо проще, так как оно содержит только общую структуру страницы и вызывает частичные представления с целью преобразования для просмотра.</span><span class="sxs-lookup"><span data-stu-id="2de40-117">Each piece of the page can be viewed in isolation from the rest of the page, and the view for the page itself becomes much simpler since it only contains the overall page structure and calls to render the partial views.</span></span>

<span data-ttu-id="2de40-118">Совет. Соблюдайте в представлениях [принцип "Не повторяйся"](http://deviq.com/don-t-repeat-yourself/).</span><span class="sxs-lookup"><span data-stu-id="2de40-118">Tip: Follow the [Don't Repeat Yourself Principle](http://deviq.com/don-t-repeat-yourself/) in your views.</span></span>

## <a name="declaring-partial-views"></a><span data-ttu-id="2de40-119">Объявление частичных представлений</span><span class="sxs-lookup"><span data-stu-id="2de40-119">Declaring Partial Views</span></span>

<span data-ttu-id="2de40-120">Частичные представления создаются так же, как и любые другие: нужно создать файл *CSHTML* в папке *Views*.</span><span class="sxs-lookup"><span data-stu-id="2de40-120">Partial views are created like any other view: you create a *.cshtml* file within the *Views* folder.</span></span> <span data-ttu-id="2de40-121">Смыслового различия между частичным и обычным представлениями нет — они просто по-разному преобразовываются для просмотра.</span><span class="sxs-lookup"><span data-stu-id="2de40-121">There's no semantic difference between a partial view and a regular view - they're just rendered differently.</span></span> <span data-ttu-id="2de40-122">Например, представление, возвращаемое из объекта `ViewResult`, может применяться как частичное представление.</span><span class="sxs-lookup"><span data-stu-id="2de40-122">You can have a view that's returned directly from a controller's `ViewResult`, and the same view can be used as a partial view.</span></span> <span data-ttu-id="2de40-123">Основное различие между преобразованием обычных и частичных представлений для просмотра заключается в том, что частичные представления не запускают файл *_ViewStart.cshtml* (как это делают обычные представления; дополнительные сведения о файле *_ViewStart.cshtml* см. в статье [Макет](layout.md)).</span><span class="sxs-lookup"><span data-stu-id="2de40-123">The main difference between how a view and a partial view are rendered is that partial views don't run *_ViewStart.cshtml* (while views do - learn more about *_ViewStart.cshtml* in [Layout](layout.md)).</span></span>

## <a name="referencing-a-partial-view"></a><span data-ttu-id="2de40-124">Ссылка на частичное представление</span><span class="sxs-lookup"><span data-stu-id="2de40-124">Referencing a Partial View</span></span>

<span data-ttu-id="2de40-125">Частичное представление может преобразовываться для просмотра из страницы представления несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="2de40-125">From within a view page, there are several ways in which you can render a partial view.</span></span> <span data-ttu-id="2de40-126">Рекомендуется использовать метод `Html.PartialAsync`, который возвращает `IHtmlString` и на который можно ссылаться путем указания префикса `@` перед вызовом:</span><span class="sxs-lookup"><span data-stu-id="2de40-126">The best practice is to use `Html.PartialAsync`, which returns an `IHtmlString` and can be referenced by prefixing the call with `@`:</span></span>

[!code-cshtml[](partial/sample/src/PartialViewsSample/Views/Home/About.cshtml?range=8)]

<span data-ttu-id="2de40-127">Преобразовывать частичное представление для просмотра можно с помощью метода `RenderPartialAsync`.</span><span class="sxs-lookup"><span data-stu-id="2de40-127">You can render a partial view with `RenderPartialAsync`.</span></span> <span data-ttu-id="2de40-128">Он не возвращает результат, а передает преобразованные выходные данные непосредственно в ответ в потоковом режиме.</span><span class="sxs-lookup"><span data-stu-id="2de40-128">This method doesn't return a result; it streams the rendered output directly to the response.</span></span> <span data-ttu-id="2de40-129">Так как этот метод не возвращает результат, его необходимо вызывать в блоке кода Razor:</span><span class="sxs-lookup"><span data-stu-id="2de40-129">Because it doesn't return a result, it must be called within a Razor code block:</span></span>

[!code-cshtml[](partial/sample/src/PartialViewsSample/Views/Home/About.cshtml?range=11-13)]

<span data-ttu-id="2de40-130">Так как метод `RenderPartialAsync` передает результат в потоковом режиме напрямую, в некоторых ситуациях он может быть эффективнее.</span><span class="sxs-lookup"><span data-stu-id="2de40-130">Because it streams the result directly, `RenderPartialAsync` may perform better in some scenarios.</span></span> <span data-ttu-id="2de40-131">Тем не менее рекомендуется использовать `PartialAsync`.</span><span class="sxs-lookup"><span data-stu-id="2de40-131">However, it's recommended you use `PartialAsync`.</span></span>

<span data-ttu-id="2de40-132">Хотя существуют синхронные эквиваленты `Html.PartialAsync` (`Html.Partial`) и `Html.RenderPartialAsync` (`Html.RenderPartial`), не рекомендуется использовать их, поскольку в некоторых случаях возникает взаимоблокировка.</span><span class="sxs-lookup"><span data-stu-id="2de40-132">While there are synchronous equivalents of `Html.PartialAsync` (`Html.Partial`) and `Html.RenderPartialAsync` (`Html.RenderPartial`), use of the synchronous equivalents isn't recommended because there are scenarios where they deadlock.</span></span> <span data-ttu-id="2de40-133">Синхронные методы будут недоступны в будущих версиях.</span><span class="sxs-lookup"><span data-stu-id="2de40-133">The synchronous methods will be unavailable in future versions.</span></span>

> [!NOTE]
> <span data-ttu-id="2de40-134">Если представления должны выполнять код, рекомендованный подход заключается в использовании [компонента представления](view-components.md) вместо частичного представления.</span><span class="sxs-lookup"><span data-stu-id="2de40-134">If your views need to execute code, the recommended pattern is to use a [view component](view-components.md) instead of a partial view.</span></span>

### <a name="partial-view-discovery"></a><span data-ttu-id="2de40-135">Обнаружение частичного представления</span><span class="sxs-lookup"><span data-stu-id="2de40-135">Partial View Discovery</span></span>

<span data-ttu-id="2de40-136">Ссылаясь на частичное представление, его расположение можно указывать несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="2de40-136">When referencing a partial view, you can refer to its location in several ways:</span></span>

```cshtml
// Uses a view in current folder with this name
// If none is found, searches the Shared folder
@await Html.PartialAsync("ViewName")

// A view with this name must be in the same folder
@await Html.PartialAsync("ViewName.cshtml")

// Locate the view based on the application root
// Paths that start with "/" or "~/" refer to the application root
@await Html.PartialAsync("~/Views/Folder/ViewName.cshtml")
@await Html.PartialAsync("/Views/Folder/ViewName.cshtml")

// Locate the view using relative paths
@await Html.PartialAsync("../Account/LoginPartial.cshtml")
```

<span data-ttu-id="2de40-137">В разных папках представлений могут быть разные частичные представления с одинаковыми именами.</span><span class="sxs-lookup"><span data-stu-id="2de40-137">You can have different partial views with the same name in different view folders.</span></span> <span data-ttu-id="2de40-138">При обращении к представлениям по имени (без указания расширения имени файла) представление в каждой папке будет использовать частичное представление из той же папки.</span><span class="sxs-lookup"><span data-stu-id="2de40-138">When referencing the views by name (without file extension), views in each folder will use the partial view in the same folder with them.</span></span> <span data-ttu-id="2de40-139">Можно также определить частичное представление по умолчанию, поместив его в папку *Shared*.</span><span class="sxs-lookup"><span data-stu-id="2de40-139">You can also specify a default partial view to use, placing it in the *Shared* folder.</span></span> <span data-ttu-id="2de40-140">Общее частичное представление будет использоваться всеми представлениями, у которых нет собственного частичного представления.</span><span class="sxs-lookup"><span data-stu-id="2de40-140">The shared partial view will be used by any views that don't have their own version of the partial view.</span></span> <span data-ttu-id="2de40-141">Частичное представление по умолчанию (в папке *Shared*) может переопределяться частичным представлением с тем же именем, которое находится в одной папке с родительским представлением.</span><span class="sxs-lookup"><span data-stu-id="2de40-141">You can have a default partial view (in *Shared*), which is overridden by a partial view with the same name in the same folder as the parent view.</span></span>

<span data-ttu-id="2de40-142">Частичные представления могут *объединяться в цепочки*,</span><span class="sxs-lookup"><span data-stu-id="2de40-142">Partial views can be *chained*.</span></span> <span data-ttu-id="2de40-143">то есть одно частичное представление может вызывать другое (если при этом не образуется цикл).</span><span class="sxs-lookup"><span data-stu-id="2de40-143">That is, a partial view can call another partial view (as long as you don't create a loop).</span></span> <span data-ttu-id="2de40-144">В каждом обычном или частичном представлении относительные пути всегда указываются относительно данного представления, а не корневого или родительского.</span><span class="sxs-lookup"><span data-stu-id="2de40-144">Within each view or partial view, relative paths are always relative to that view, not the root or parent view.</span></span>

> [!NOTE]
> <span data-ttu-id="2de40-145">При объявлении раздела `section` [Razor](razor.md) в частичном представлении он будет недоступен родительским представлениям, то есть он будет ограничен данным частичным представлением.</span><span class="sxs-lookup"><span data-stu-id="2de40-145">If you declare a [Razor](razor.md) `section` in a partial view, it will not be visible to its parent(s); it will be limited to the partial view.</span></span>

## <a name="accessing-data-from-partial-views"></a><span data-ttu-id="2de40-146">Доступ к данным из частичных представлений</span><span class="sxs-lookup"><span data-stu-id="2de40-146">Accessing Data From Partial Views</span></span>

<span data-ttu-id="2de40-147">Когда создается экземпляр частичного представления, он получает копию словаря `ViewData` родительского представления.</span><span class="sxs-lookup"><span data-stu-id="2de40-147">When a partial view is instantiated, it gets a copy of the parent view's `ViewData` dictionary.</span></span> <span data-ttu-id="2de40-148">Изменения, вносимые в данные в частичном представлении, не сохраняются в родительском представлении.</span><span class="sxs-lookup"><span data-stu-id="2de40-148">Updates made to the data within the partial view are not persisted to the parent view.</span></span> <span data-ttu-id="2de40-149">Например, изменения объекта `ViewData` в частичном представлении утрачиваются при возврате управления из этого представления.</span><span class="sxs-lookup"><span data-stu-id="2de40-149">`ViewData` changed in a partial view is lost when the partial view returns.</span></span>

<span data-ttu-id="2de40-150">В частичное представление можно передать экземпляр `ViewDataDictionary`:</span><span class="sxs-lookup"><span data-stu-id="2de40-150">You can pass an instance of `ViewDataDictionary` to the partial view:</span></span>

```cshtml
@await Html.PartialAsync("PartialName", customViewData)
```

<span data-ttu-id="2de40-151">В частичное представление можно также передать модель.</span><span class="sxs-lookup"><span data-stu-id="2de40-151">You can also pass a model into a partial view.</span></span> <span data-ttu-id="2de40-152">Это может быть модель представления страницы или пользовательский объект.</span><span class="sxs-lookup"><span data-stu-id="2de40-152">This can be the page's view model or a custom object.</span></span> <span data-ttu-id="2de40-153">Модель можно передать в метод `PartialAsync` или `RenderPartialAsync`:</span><span class="sxs-lookup"><span data-stu-id="2de40-153">You can pass a model to `PartialAsync` or `RenderPartialAsync`:</span></span>

```cshtml
@await Html.PartialAsync("PartialName", viewModel)
```

<span data-ttu-id="2de40-154">В частичное представление можно передать экземпляр `ViewDataDictionary` и модель представления:</span><span class="sxs-lookup"><span data-stu-id="2de40-154">You can pass an instance of `ViewDataDictionary` and a view model to a partial view:</span></span>

[!code-cshtml[](partial/sample/src/PartialViewsSample/Views/Articles/Read.cshtml?range=15-16)]

<span data-ttu-id="2de40-155">В приведенной ниже разметке показано представление *Views/Articles/Read.cshtml*, содержащее два частичных представления.</span><span class="sxs-lookup"><span data-stu-id="2de40-155">The markup below shows the *Views/Articles/Read.cshtml* view which contains two partial views.</span></span> <span data-ttu-id="2de40-156">Второе частичное представление передает модель и объект `ViewData` в первое частичное представление.</span><span class="sxs-lookup"><span data-stu-id="2de40-156">The second partial view passes in a model and `ViewData` to the partial view.</span></span> <span data-ttu-id="2de40-157">Вы можете передать новый словарь `ViewData`, сохранив существующий `ViewData`. Для этого используйте перегрузку конструктора `ViewDataDictionary`, выделенную ниже.</span><span class="sxs-lookup"><span data-stu-id="2de40-157">You can pass new `ViewData` dictionary while retaining the existing `ViewData` if you use the constructor overload of the `ViewDataDictionary` highlighted below:</span></span>

[!code-cshtml[](partial/sample/src/PartialViewsSample/Views/Articles/Read.cshtml)]

<span data-ttu-id="2de40-158">*Views/Shared/AuthorPartial*:</span><span class="sxs-lookup"><span data-stu-id="2de40-158">*Views/Shared/AuthorPartial*:</span></span>

[!code-cshtml[](partial/sample/src/PartialViewsSample/Views/Shared/AuthorPartial.cshtml)]

<span data-ttu-id="2de40-159">Частичное представление *ArticleSection*:</span><span class="sxs-lookup"><span data-stu-id="2de40-159">The *ArticleSection* partial:</span></span>

[!code-cshtml[](partial/sample/src/PartialViewsSample/Views/Articles/ArticleSection.cshtml)]

<span data-ttu-id="2de40-160">Во время выполнения частичные представления преобразовываются для просмотра внутри родительского представления, которое само преобразовывается для просмотра в общем макете *_Layout.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="2de40-160">At runtime, the partials are rendered into the parent view, which itself is rendered within the shared *_Layout.cshtml*</span></span>

![выходные данные частичного представления](partial/_static/output.png)
