# <a name="prefix-key-vault-configuration-provider-sample-application-aspnet-core-2x"></a>Префикс ключа хранилища конфигурации поставщика образец приложения (ASP.NET Core 2.x)

В этом примере описывается использование поставщика конфигурации хранилища ключей Azure для ASP.NET Core 2.x использовать префиксы имя ключа. Пример 1.x ASP.NET Core см. в разделе [префикса поставщик конфигурации хранилища ключей образец приложения (ASP.NET Core 1.x)](https://github.com/aspnet/Docs/tree/master/aspnetcore/security/key-vault-configuration/samples/key-name-prefix-sample/1.x).

Дополнительные сведения о том, как работает этот пример см. в разделе [конфигурации поставщика хранилища ключей Azure](xref:security/key-vault-configuration) раздела.

## <a name="using-the-sample"></a>Использование образца
1. Создание хранилища ключей и настроить Azure Active Directory (Azure AD) для приложения согласно инструкциям в [приступить к работе с хранилищем ключей Azure](https://azure.microsoft.com/documentation/articles/key-vault-get-started/).
  * Добавьте секретные данные в хранилище ключей с помощью модуля Azure PowerShell, API управления Azure или портала Azure. Секреты создаются как *вручную* или *сертификат* секретные данные. *Сертификат* секретные данные, сертификаты для использования приложений и служб, но не поддерживаются поставщиком конфигурации. Следует использовать *вручную* параметр, чтобы создать секреты пары "имя значение" для использования с поставщиком конфигурации.
    * Используйте иерархическими значениями (разделы конфигурации) `--` (двух дефисов) в качестве разделителя.
    * Пример приложения, создайте два *вручную* секреты с помощью следующих пар имя значение:
      * `5000-AppSecret`: `5.0.0.0_secret_value`
      * `5100-AppSecret`: `5.1.0.0_secret_value`
  * Регистрация примера приложения в Azure Active Directory.
  * Разрешить приложению доступ к хранилища ключей. При использовании `Set-AzureRmKeyVaultAccessPolicy` командлет PowerShell, чтобы разрешить приложению доступ к хранилища ключей, обеспечивают `List` и `Get` доступ к секретной информации с `-PermissionsToKeys list,get`.
2. Обновление приложения *appsettings.json* файл со значениями `Vault`, `ClientId`, и `ClientSecret`.
3. Запустите пример приложения, который получает свои значения конфигурации `IConfigurationRoot` с тем же именем, как имя с префиксом секрета. В этом образце используется префикс версию приложения, что вы указали `PrefixKeyVaultSecretManager` при добавлении поставщика хранилища ключей Azure конфигурации. Значение для `AppSecret` получен с `config["AppSecret"]`.
4. Изменить версию сборки приложения в файле проекта из `5.0.0.0` для `5.1.0.0` и снова запустите приложение. На этот раз секретный возвращаемое значение `5.1.0.0_secret_value`.
