---
title: "Ядро ASP.NET MVC с Entity Framework Core - учебник № 1 по 10"
author: tdykstra
description: 
ms.author: tdykstra
manager: wpickett
ms.date: 03/15/2017
ms.topic: get-started-article
ms.technology: aspnet
ms.prod: asp.net-core
uid: data/ef-mvc/intro
ms.openlocfilehash: c30556368ba24fb38cf3347dd49f171b5246514c
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2018
---
# <a name="getting-started-with-aspnet-core-mvc-and-entity-framework-core-using-visual-studio-1-of-10"></a>Приступая к работе с ASP.NET MVC ядра и Entity Framework Core, с помощью Visual Studio (1, 10)

По [Tom Dykstra](https://github.com/tdykstra) и [Рик Андерсон](https://twitter.com/RickAndMSFT)

Доступна версия страниц Razor этого учебника [здесь](xref:data/ef-rp/intro). Версия учебника по Razor Pages проще в изучении, и в ней рассматриваются дополнительные возможности EF. Корпорация Майкрософт рекомендует следовать [страниц Razor версии этого учебника](xref:data/ef-rp/intro).

Contoso университета примера веб-приложения показано, как создавать веб-приложения ASP.NET MVC 2.0 ядра с помощью основных Entity Framework (EF) 2.0 и Visual Studio 2017 г.

Образец приложения является веб-сайт для вымышленной компании Contoso университета. Он включает функции, такие как допуском студента, создание курса и инструктора назначения. Это первое в серию учебников, в которых объясняется, как создать пример приложения университета Contoso с нуля.

[Загрузить или просмотреть завершенное приложение.](https://github.com/aspnet/Docs/tree/master/aspnetcore/data/ef-mvc/intro/samples/cu-final)

EF Core 2.0 — это последняя версия EF, но еще не определен все возможности EF 6.x. Сведения о том, как выбрать между EF 6.x и EF Core см [EF Core vs. EF6.x](https://docs.microsoft.com/ef/efcore-and-ef6/). При выборе EF 6.x. в разделе [предыдущей версии этого учебника ряда](https://docs.microsoft.com/aspnet/mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application).

> [!NOTE]
> * Версии ASP.NET Core 1.1 этого учебника, см. [VS 2017 г. с обновлением 2 версии этого учебника в формате PDF](https://github.com/aspnet/Docs/blob/master/aspnetcore/data/ef-mvc/intro/_static/efmvc1.1.pdf).
> * Версию этого учебника для Visual Studio 2015 см. в статье [документации по ASP.NET Core для VS 2015 в формате PDF](https://github.com/aspnet/Docs/blob/master/aspnetcore/common/_static/aspnet-core-project-json.pdf).

## <a name="prerequisites"></a>Предварительные требования

[!INCLUDE[install 2.0](../../includes/install2.0.md)]

## <a name="troubleshooting"></a>Устранение неполадок

Если возникли проблемы, не удается устранить, обычно можно найти решения путем сравнения код, чтобы [завершенного проекта](https://github.com/aspnet/Docs/tree/master/aspnetcore/data/ef-mvc/intro/samples/cu-final). Список распространенных ошибок и способы их устранения см. в разделе [раздел "Устранение неполадок" последнего учебника в серии](advanced.md#common-errors). Если вы не нашли нужную информацию существует, можно разместить вопрос StackOverflow.com для [ASP.NET Core](https://stackoverflow.com/questions/tagged/asp.net-core) или [EF Core](https://stackoverflow.com/questions/tagged/entity-framework-core).

> [!TIP] 
> Это серию учебников, 10, каждый из которых строится на выполняемые операции в предыдущих учебниках. Рекомендуется сохранить копию проекта после каждого успешного завершения учебника. Затем, если возникли проблемы, можно начать сначала из предыдущего учебника вместо вернемся к началу весь ряд.

## <a name="the-contoso-university-web-application"></a>Веб-приложение Contoso университета

Приложение, которое вы будете построения в этих учебниках является простой университета веб-сайта.

Пользователи могут просматривать и обновлять студента курса и инструктора сведения. Ниже представлены несколько экранов, которые будут созданы.

![Страница индекса студентов](intro/_static/students-index.png)

![Страница изменения студентов](intro/_static/student-edit.png)

Стиль пользовательского интерфейса этого сайта была сохранена близко к создаваемой с помощью встроенных шаблонов учебника можно сосредоточиться на том, как использовать платформу Entity Framework.

## <a name="create-an-aspnet-core-mvc-web-application"></a>Создать веб-приложение ASP.NET Core MVC

Откройте Visual Studio и создайте новый веб-проекта ASP.NET Core C#, с именем «ContosoUniversity».

* Из **файл** последовательно выберите пункты **Создать > проект**.

* В левой области выберите **установленные > Visual C# > Web**.

* Выберите шаблон проекта **Веб-приложение ASP.NET Core**.

* Введите **ContosoUniversity** как имя и нажмите кнопку **ОК**.

  ![Диалоговое окно создания нового проекта](intro/_static/new-project.png)

* Дождитесь **новый основной веб-приложения ASP.NET (.NET Core)** диалоговое окно для отображения

* Выберите **ASP.NET Core 2.0** и **веб-приложения (Model-View-Controller)** шаблона.

  **Примечание:** упражнений этого учебника требуется ASP.NET 2.0 основных компонентов и Core EF 2.0 или более поздней — убедитесь, что **ASP.NET Core 1.1** не выбрана.

* Убедитесь, что **проверки подлинности** равно **без проверки подлинности**.

* Нажмите кнопку **ОК**.

  ![Диалоговое окно "Новый проект ASP.NET"](intro/_static/new-aspnet.png)

## <a name="set-up-the-site-style"></a>Настройка стиля узла

Несколько простых изменений будет установлен сайт меню, макета и домашнюю страницу.

Откройте *Views/Shared/_Layout.cshtml* и внесите следующие изменения:

* Измените все вхождения «ContosoUniversity» на «Contoso University». Нет трех экземпляров.

* Добавление пунктов меню для **учащихся**, **курсы**, **инструкторов**, и **отделы**и удалите **контакт** меню.

Изменения выделены.

[!code-cshtml[](intro/samples/cu/Views/Shared/_Layout.cshtml?highlight=6,30,36-39,48)]

В *Views/Home/Index.cshtml*, замените содержимое файла следующим кодом, чтобы заменить текст о ASP.NET и MVC на текст об этом приложении:

[!code-cshtml[](intro/samples/cu/Views/Home/Index.cshtml)]

Нажмите CTRL + F5, чтобы запустить проект или **Отладка > Начать без отладки** в меню. Появится домашняя страница с вкладками для страниц, которые можно создать с помощью этих учебников.

![Домашняя страница университета Contoso](intro/_static/home-page.png)

## <a name="entity-framework-core-nuget-packages"></a>Entity Framework Core NuGet пакетов

Добавление поддержка ядра EF в проект, установите поставщик базы данных, которую требуется использовать. В этом учебнике используется SQL Server и поставщик пакет [Microsoft.EntityFrameworkCore.SqlServer](https://www.nuget.org/packages/Microsoft.EntityFrameworkCore.SqlServer/). Этот пакет включен в [Microsoft.AspNetCore.All](xref:fundamentals/metapackage) metapackage, поэтому устанавливать его не требуется.

Этот пакет и его зависимости (`Microsoft.EntityFrameworkCore` и `Microsoft.EntityFrameworkCore.Relational`) обеспечивают поддержку времени выполнения EF. Вы добавите пакет средств далее в [миграций](migrations.md) учебника. 

Сведения о других поставщиков базы данных, которые доступны для Entity Framework Core см. в разделе [базы данных поставщиков](https://docs.microsoft.com/ef/core/providers/).

## <a name="create-the-data-model"></a>Создание модели данных

Затем вы создадите классы сущностей для приложения Contoso университета. Вы начнете с следующие три сущности.

![Схема модели курса регистрации студента данных](intro/_static/data-model-diagram.png)

Имеется отношение "один ко многим" между `Student` и `Enrollment` сущностями, и имеется отношение "один ко многим" между `Course` и `Enrollment` сущности. Другими словами студент может быть зарегистрированы в любое количество курсы и курс может иметь любое количество студентов, зарегистрированных в нем.

В следующих разделах вы создадите класса для каждого из этих сущностей.

### <a name="the-student-entity"></a>Сущность Student

![Схема entity студента](intro/_static/student-entity.png)

В *моделей* папки, создайте файл класса с именем *Student.cs* и замените код шаблона с помощью следующего кода.

[!code-csharp[Main](intro/samples/cu/Models/Student.cs?name=snippet_Intro)]

`ID` Свойство станет столбец первичного ключа таблицы базы данных, соответствующий этому классу. По умолчанию платформа Entity Framework интерпретирует свойство, которое называется `ID` или `classnameID` как первичный ключ.

`Enrollments` Свойство является свойством навигации. Свойства навигации хранения других сущностей, которые относятся к этой сущности. В этом случае `Enrollments` свойство `Student entity` будет содержать все `Enrollment` сущностей, которые относятся к, `Student` сущности. Другими словами, если данная строка студента в базе данных имеет две связанные регистрации строк (которые содержат этого студента значение первичного ключа в столбец внешнего ключа их идентификатором StudentID), который `Student` сущности `Enrollments` свойство навигации будет содержать те два `Enrollment` сущностей.

Если свойство навигации может содержать несколько сущностей (как отношения "многие ко многим" или "один ко многим"), его тип должен быть список, в котором записи могут быть добавлены, удаленные и обновления, такие как `ICollection<T>`. Можно указать `ICollection<T>` или тип, такой как `List<T>` или `HashSet<T>`. При указании `ICollection<T>`, создает EF `HashSet<T>` коллекции по умолчанию.

### <a name="the-enrollment-entity"></a>Сущность регистрации

![Схема entity регистрации](intro/_static/enrollment-entity.png)

В *моделей* папке создайте *«Enrollment.cs» в качестве* и замените существующий код следующим кодом:

[!code-csharp[Main](intro/samples/cu/Models/Enrollment.cs?name=snippet_Intro)]

`EnrollmentID` Свойство будет иметь первичный ключ, использует эту сущность `classnameID` шаблона вместо `ID` сам по себе, как вы видели в `Student` сущности. Обычно следует выбрать один шаблон и использовать его во всей модели данных. Здесь значение варианта иллюстрирует, которые можно использовать либо шаблон. В [более поздней версии учебника](inheritance.md), вы увидите, как с помощью идентификатора без classname для упрощения реализации наследования в модели данных.

`Grade` Свойство `enum`. Знак вопроса после `Grade` объявление типа указывает, что `Grade` свойство имеет значение NULL. Степень, которую имеет значение null отличается от нуля оценку — значение null означает оценку не известен или еще не назначена.

`StudentID` Свойство внешнего ключа, и соответствующее свойство навигации `Student`. `Enrollment` Сущности связан с одним `Student` сущности, поэтому свойство может содержать только один `Student` сущности (в отличие от `Student.Enrollments` свойство навигации вы видели ранее, который может содержать несколько `Enrollment` сущностей).

`CourseID` Свойство внешнего ключа, и соответствующее свойство навигации `Course`. `Enrollment` Сущности связан с одним `Course` сущности.

Entity Framework интерпретирует свойство как свойство внешнего ключа, если он называется `<navigation property name><primary key property name>` (например, `StudentID` для `Student` свойство навигации с момента `Student` первичного ключа сущности является `ID`). Свойства внешнего ключа может также называться просто `<primary key property name>` (например, `CourseID` с момента `Course` первичного ключа сущности является `CourseID`).

### <a name="the-course-entity"></a>Сущность курса

![Схема entity курса](intro/_static/course-entity.png)

В *моделей* папке создайте *Course.cs* и замените существующий код следующим кодом:

[!code-csharp[Main](intro/samples/cu/Models/Course.cs?name=snippet_Intro)]

`Enrollments` Свойство является свойством навигации. Объект `Course` сущности могут быть связаны с любым количеством `Enrollment` сущностей.

Допустим, что больше о `DatabaseGenerated` атрибута в [более поздней версии учебника](complex-data-model.md) этой серии. По сути этот атрибут позволяет ввести первичный ключ для курса вместо формирования базы данных.

## <a name="create-the-database-context"></a>Создать контекст базы данных

Основной класс, который координирует функции в заданной модели данных Entity Framework является класс контекста базы данных. Этот класс создается путем наследования от класса `Microsoft.EntityFrameworkCore.DbContext`. В коде указывается, какие сущности включаются в модель данных. Можно также настроить некоторые параметры поведения Entity Framework. В этом проекте класс с именем `SchoolContext`.

В папку проекта, создайте папку с именем *данные*.

В *данные* папке создайте новый файл класса с именем *SchoolContext.cs*и замените код шаблона с помощью следующего кода:

[!code-csharp[Main](intro/samples/cu/Data/SchoolContext.cs?name=snippet_Intro)]

Этот код создает `DbSet` свойство для каждого набора сущностей. В терминологии Entity Framework набор сущностей обычно соответствует таблице базы данных, а сущность — строке в этой таблице.

Удалось опустил `DbSet<Enrollment>` и `DbSet<Course>` инструкций и он будет работать так же. Платформа Entity Framework будет включать их неявно поскольку `Student` ссылки на сущности `Enrollment` сущности и `Enrollment` ссылки на сущности `Course` сущности.

При создании базы данных, EF создает таблицы, которые имеют имена, то же, что `DbSet` имена свойств. Имена свойств для коллекций, обычно являются множественного числа (учащихся вместо студента), но разработчики не соглашаться ли имена таблиц должны быть имена во множественном числе или нет. Для этих учебников вы переопределить поведение по умолчанию, указав имена таблиц в единственном числе в класс DbContext. Чтобы сделать это, добавьте следующий выделенный код после последнего DbSet свойства.

[!code-csharp[Main](intro/samples/cu/Data/SchoolContext.cs?name=snippet_TableNames&highlight=16-21)]

## <a name="register-the-context-with-dependency-injection"></a>Регистрация контекста с помощью внедрения зависимости

Реализует ASP.NET Core [внедрения зависимостей](../../fundamentals/dependency-injection.md) по умолчанию. Службы (такие как контекст базы данных EF) регистрируются с помощью внедрения зависимости во время запуска приложения. Компоненты, которые требуют этих служб (например, контроллеров MVC) предоставляются этим службам через параметры конструктора. Вы увидите код конструктора контроллера, который возвращает экземпляр контекста далее в этом учебнике.

Чтобы зарегистрировать `SchoolContext` как служба, откройте *файла Startup.cs*и добавьте выделенные строки к `ConfigureServices` метод.

[!code-csharp[Main](intro/samples/cu/Startup.cs?name=snippet_SchoolContext&highlight=3-4)]

Имя строки подключения передается в контекст путем вызова метода на `DbContextOptionsBuilder` объекта. Для локальной разработки [система конфигурации ASP.NET Core](xref:fundamentals/configuration/index) считывает строку подключения из *appsettings.json* файла.

Добавить `using` инструкции для `ContosoUniversity.Data` и `Microsoft.EntityFrameworkCore` пространства имен, а затем постройте проект.

[!code-csharp[Main](intro/samples/cu/Startup.cs?name=snippet_Usings)]

Откройте *appsettings.json* и добавьте строку подключения, как показано в следующем примере.

[!code-json[](./intro/samples/cu/appsettings1.json?highlight=2-4)]

### <a name="sql-server-express-localdb"></a>SQL Server Express LocalDB

Строка подключения указывает на базу данных SQL Server LocalDB. LocalDB — это облегченная версия SQL Server Express Database Engine и предназначен для разработки приложений, а не использования в рабочей среде. LocalDB запускает по запросу и в пользовательском режиме, поэтому нет сложные конфигурации. По умолчанию создает LocalDB *.mdf* файлов баз данных в `C:/Users/<user>` каталога.

## <a name="add-code-to-initialize-the-database-with-test-data"></a>Добавьте код для инициализации базы данных с тестовыми данными

Платформа Entity Framework будет создать пустую базу данных. В этом разделе необходимо написать метод, вызываемый после создания базы данных, чтобы заполнить его данными теста.

Здесь вы воспользуетесь `EnsureCreated` метод для автоматического создания базы данных. В [более поздней версии учебника](migrations.md) вы научитесь обрабатывать изменения модели с помощью Code First Migrations для изменения схемы базы данных вместо удаления и повторного создания базы данных.

В *данные* папки, создайте новый файл класса с именем *DbInitializer.cs* и замените следующий код, который вызывает базы данных, создаваемый при необходимости код шаблона и загружает данные в новый теста База данных.

[!code-csharp[Main](intro/samples/cu/Data/DbInitializer.cs?name=snippet_Intro)]

Этот код проверяет, если существует любой студентов в базе данных, а в противном случае предполагается новые базы данных и требуется инициализировать с тестовыми данными. Он загружает тестовых данных в массивы вместо `List<T>` коллекций для оптимизации производительности.

В *Program.cs*, изменить `Main` метод для выполнения следующих при запуске приложения:

* Получите экземпляр контекста базы данных из контейнера внедрения зависимостей.
* Вызовите метод инициализации, передав ему контекст.
* Освободить контекст, когда выполняется метод начальное значение.

[!code-csharp[Main](intro/samples/cu/Program.cs?name=snippet_Seed&highlight=3-20)]

Добавить `using` инструкции:

[!code-csharp[Main](intro/samples/cu/Program.cs?name=snippet_Usings)]

В более старых учебники могут возникать похожий код в `Configure` метод в *файла Startup.cs*. Мы рекомендуем использовать `Configure` метод только для настройки конвейера запросов. Принадлежит кода запуска приложения в `Main` метод.

Теперь первый раз, при запуске приложения, базы данных создана и заполнена с тестовыми данными. При каждом изменении модели данных можно удалить базу данных, обновите seed-метод и начать заново с новой базы данных так же, как. На следующих занятиях рассматривается вы увидите, как изменить базу данных при изменений, без удаления и повторного создания в модели данных.

## <a name="create-a-controller-and-views"></a>Создание контроллера и представления

Далее будет использоваться механизм формирования шаблонов в Visual Studio добавить контроллер MVC и представления, которые будут использовать EF для запроса и сохранения данных.

Автоматическое создание CRUD методы действий и представления называется формирование шаблонов. Формирование шаблонов отличается от создания кода, что код формирования шаблонов является отправной точкой, можно изменить в соответствии с требованиями, тогда как обычно не изменить созданный код. При необходимости настройки автоматически созданного кода использовать разделяемые классы или повторном создании кода об изменениях.

* Щелкните правой кнопкой мыши **контроллеров** папки в **обозревателе решений** и выберите **Добавить > новый элемент формирования шаблонов**.

Если открывается диалоговое окно **Добавление зависимостей MVC**:

* [Обновите Visual Studio до последней версии](https://www.visualstudio.com/downloads/). Это диалоговое окно отображает версии Visual Studio, предшествующие 15.5.
* Если обновить не удается, выберите **ДОБАВИТЬ** и снова выполните шаги по добавлению контроллера.

* В **Добавление формирования шаблонов** диалоговое окно:

  * Выберите **контроллер MVC с представлениями, использующий Entity Framework**.

  * Нажмите кнопку **Добавить**.

* В **добавить контроллер** диалоговое окно:

  * В **класс модели** выберите **студента**.

  * В **класс контекста данных** выберите **SchoolContext**.

  * Примите имя по умолчанию **StudentsController** как имя.

  * Нажмите кнопку **Добавить**.

  ![Ученик формирования шаблонов](intro/_static/scaffold-student.png)

  При нажатии кнопки **добавить**, подсистему формирования шаблонов Visual Studio создает *StudentsController.cs* файл и ряд представлений (*.cshtml* файлы), работающих с контроллером.

(Ядро формирование шаблонов также можно создать контекст базы данных автоматически Если вы не создаете вручную сначала, как это было ранее в этом учебнике. Можно указать новый класс контекста в **добавления контроллера** , щелкнув знак «плюс» справа от **класс контекста данных**.  Visual Studio создаст вашей `DbContext` класса, а также контроллеров и представления.)

Обратите внимание, что контроллер принимает `SchoolContext` как параметр конструктора.

[!code-csharp[Main](intro/samples/cu/Controllers/StudentsController.cs?name=snippet_Context&highlight=5,7,9)]

Внедрение зависимостей ASP.NET берет на себя передать экземпляр `SchoolContext` в контроллер. Вы настроили в *файла Startup.cs* файлов более ранних версий.

Контроллер содержит `Index` метод действия, который отображает всех студентов в базе данных. Метод возвращает список учащихся из набора, считывая сущностей учащихся `Students` свойства экземпляра контекста базы данных:

[!code-csharp[Main](intro/samples/cu/Controllers/StudentsController.cs?name=snippet_ScaffoldedIndex&highlight=3)]

Вы узнаете о элементы асинхронного программирования в этом коде далее в этом учебнике.

*Views/Students/Index.cshtml* представление отображает этот список в таблице:

[!code-cshtml[](intro/samples/cu/Views/Students/Index1.cshtml)]

Нажмите CTRL + F5, чтобы запустить проект или **Отладка > Начать без отладки** в меню.

Перейдите на вкладку учащихся для просмотра тестовых данных, `DbInitializer.Initialize` метод вставки. В зависимости от того как узких окно браузера, вы увидите `Student` ссылку вкладку в верхней части страницы или придется щелкнуть значок навигации в правом верхнем углу, чтобы увидеть эту ссылку.

![Домашняя страница Contoso университета узкий](intro/_static/home-page-narrow.png)

![Страница индекса студентов](intro/_static/students-index.png)

## <a name="view-the-database"></a>Просмотр базы данных

При запуске приложения, `DbInitializer.Initialize` вызовы метода `EnsureCreated`. EF узнали, что база данных не была, и поэтому он создан один, а затем остальная часть `Initialize` код метода заполнения базы данных с данными. Можно использовать **обозреватель объектов SQL Server** (SSOX) для просмотра базы данных в Visual Studio.

Закройте браузер.

Если окно SSOX еще не открыт, выберите его из **представление** меню в Visual Studio.

В SSOX, щелкните **(localdb) \MSSQLLocalDB > баз данных**, затем щелкните запись для имени базы данных, который находится в строке подключения в вашей *appsettings.json* файла.

Разверните **таблиц** узел, чтобы просмотреть таблицы в базе данных.

![Таблицы в SSOX](intro/_static/ssox-tables.png)

Щелкните правой кнопкой мыши **студента** и нажмите кнопку **данные представления** столбцы, которые были созданы и строк, которые были вставлены в таблицу.

![Таблица студента в SSOX](intro/_static/ssox-student-table.png)

*.Mdf* и *.ldf* файлы базы данных находятся в *C:\Users\<имя_пользователя >* папки.

Так как выполняется вызов `EnsureCreated` в методе инициализатора, который выполняется при запуске приложения, теперь может внести изменения в `Student` класса, удалите базу данных, снова запустите приложение и базы данных автоматически будет создан повторно для сопоставления внесенные изменения. Например, при добавлении `EmailAddress` свойства `Student` класса, вы увидите новую `EmailAddress` столбца в таблице будет создана повторно.

## <a name="conventions"></a>Соглашения

Объем кода, который раньше нужно было написать в порядке иметь возможность создавать всей базы данных автоматически Entity Framework сводится к минимуму из-за использования соглашения или предположения, что позволяет платформе Entity Framework.

* Имена `DbSet` свойства используются в качестве имен таблиц. Для сущностей, не ссылается `DbSet` свойство класса сущности, имена используются в качестве имен таблиц.

* Имена свойств сущности используются для имен столбцов.

* Свойства сущности, которые называются Идентификатором или classnameID распознаются как свойства основного ключа.

* Свойство интерпретируется как свойство внешнего ключа, если он называется  *<navigation property name> <primary key property name>*  (например, `StudentID` для `Student` свойство навигации с момента `Student` — первичный ключ сущности `ID`). Свойства внешнего ключа может также называться просто  *<primary key property name>*  (например, `EnrollmentID` с момента `Enrollment` первичного ключа сущности является `EnrollmentID`).

Можно переопределить обычным образом. Например можно явно указать имена таблиц, как было показано ранее в этом учебнике. И можно задать имена столбцов и настройте желаемые свойства как первичного или внешнего ключа, как можно будет увидеть в [более поздней версии учебника](complex-data-model.md) этой серии.

## <a name="asynchronous-code"></a>Асинхронный код

Асинхронное программирование является режимом по умолчанию для ASP.NET Core и EF Core.

Ограниченное число потоков, доступных на веб-сервере, и в случае высокой загрузки все доступные потоки быть используется. В этом случае сервер может обработать новые запросы, пока не освободятся потоков. С синхронным кодом большое количество потоков может блокировали они не выполняя фактически действия из-за ожидания завершения ввода-вывода. Асинхронный код когда процесс ожидает ввода-вывода завершить, свой поток освобождается для сервера, используемые для обработки других запросов. В результате асинхронного кода обеспечивает более эффективное использование ресурсов сервера и что сервер включен для обработки большего объема трафика без задержек.

Асинхронного кода привести небольшой объем служебных данных во время выполнения, но в ситуациях сниженным трафиком, снижение производительности будет незначительным, при в ситуациях с высоким трафиком, является существенным потенциальное улучшение производительности.

В следующем коде `async` ключевое слово, `Task<T>` возвращаемое значение, `await` ключевое слово, и `ToListAsync` метод делает код более асинхронного выполнения.

[!code-csharp[Main](intro/samples/cu/Controllers/StudentsController.cs?name=snippet_ScaffoldedIndex)]

* `async` Ключевое слово указывает компилятору создавать обратные вызовы для части тела метода и автоматически создавать `Task<IActionResult>` возвращаемый объект.

* Тип возвращаемого значения `Task<IActionResult>` представляет выполняющуюся работу с результат типа `IActionResult`.

* `await` Ключевое слово указывает компилятору на необходимость разделить на две части метода. Первая часть завершается с операцией, которая запускается в асинхронном режиме. Вторая часть переводится в метод обратного вызова, вызываемый после завершения операции.

* `ToListAsync`асинхронная версия `ToList` метода расширения.

Некоторые аспекты, которые следует учитывать при написании асинхронного кода, использующего платформу Entity Framework.

* Только инструкции, вызывающие запросов или команд, отправляемых в базе данных выполняются асинхронно. Содержащий, например, `ToListAsync`, `SingleOrDefaultAsync`, и `SaveChangesAsync`. Они не включают, например, инструкции, которые просто изменить `IQueryable`, такие как `var students = context.Students.Where(s => s.LastName == "Davolio")`.

* Контекст EF не потокобезопасным: не пытайтесь выполнить несколько операций параллельно. При вызове любого метода async EF, всегда используйте `await` ключевое слово.

* Если вы хотите использовать преимущества производительности асинхронного кода, убедитесь, что ни одну библиотеку пакеты, которые вы используете (например, для разбиения на страницы), также используют асинхронный, вызывающие методы Entity Framework, которые запросы, отправляемые в базу данных.

Дополнительные сведения об асинхронном программировании в .NET см. в разделе [Обзор Async](https://docs.microsoft.com/dotnet/articles/standard/async).

## <a name="summary"></a>Сводка

В результате создается простое приложение, которое используется для хранения и отображения данных Entity Framework Core и SQL Server Express LocalDB. В этом руководстве вы узнаете, как выполнять основные CRUD (Создание, чтение, обновление и удаление) операции.

>[!div class="step-by-step"]
[Вперед](crud.md)
