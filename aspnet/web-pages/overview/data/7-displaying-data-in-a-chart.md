---
uid: web-pages/overview/data/7-displaying-data-in-a-chart
title: "Отображение данных на диаграмме с веб-страниц ASP.NET (Razor) | Документы Microsoft"
author: microsoft
description: "В этой главе объясняется, как отобразить данные в виде диаграммы. В предыдущих главах вы узнали, как отображать данные в сетке и вручную. В этой главе объясняется..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/22/2012
ms.topic: article
ms.assetid: f889fd46-4dac-4ecb-83d8-60e64c22036e
ms.technology: dotnet-webpages
ms.prod: .net-framework
msc.legacyurl: /web-pages/overview/data/7-displaying-data-in-a-chart
msc.type: authoredcontent
ms.openlocfilehash: f252b74bc42d0ea65b8b1150973c4f3c50cc9cf4
ms.sourcegitcommit: 493a215355576cfa481773365de021bcf04bb9c7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2018
---
<a name="displaying-data-in-a-chart-with-aspnet-web-pages-razor"></a>Отображение данных на диаграмме с веб-страниц ASP.NET (Razor)
====================
по [Microsoft](https://github.com/microsoft)

> В этой статье объясняется, как использовать диаграмму для отображения данных в веб-сайта ASP.NET Web Pages (Razor) с помощью `Chart` поддержки.
> 
> **Вы узнаете**:
> 
> - Способ отображения данных в диаграмме.
> - Как изменить стиль диаграммы, используя встроенные темы.
> - Способ сохранения диаграммы и как их кэшированием для повышения производительности.
> 
> Ниже перечислены возможности, представленные в статье программирования ASP.NET:
> 
> - `Chart` Вспомогательные.
> 
> > [!NOTE]
> > Информация в этой статье относится к веб-страниц ASP.NET 1.0 и 2 веб-страниц.


<a id="The_Chart_Helper"></a>
## <a name="the-chart-helper"></a>Вспомогательный объект диаграммы

Если вы хотите отображать данные в графической форме, можно использовать `Chart` вспомогательный. `Chart` Вспомогательный объект может отображать изображения, отображающий данные в различные типы диаграмм. Он поддерживает множество параметров для форматирования и пометки. `Chart` Вспомогательный объект может отображать более 30 типов диаграмм, включая все типы диаграмм, которые могут быть знакомы с Microsoft Excel или других средств &#8212; диаграммы с областями, линейчатые диаграммы, гистограммы, графики и круговые диаграммы, а также многое другое специализированные диаграммы, такие как биржевые диаграммы.

| **Диаграмма с областями** ![Описание: рисунок для типа диаграммы с областями](7-displaying-data-in-a-chart/_static/image1.jpg) | **Линейчатая диаграмма** ![Описание: рисунок для типа линейчатой диаграммы](7-displaying-data-in-a-chart/_static/image2.jpg) |
| --- | --- |
| **Гистограмма** ![Описание: рисунок типа диаграммы столбца](7-displaying-data-in-a-chart/_static/image3.jpg) | **График** ![Описание: рисунок типа диаграммы строки](7-displaying-data-in-a-chart/_static/image4.jpg) |
| **Круговая диаграмма** ![Описание: рисунок для типа круговой диаграммы](7-displaying-data-in-a-chart/_static/image5.jpg) | **Биржевая диаграмма** ![Описание: рисунок для типа биржевой диаграммы](7-displaying-data-in-a-chart/_static/image6.jpg) |

### <a name="chart-elements"></a>Элементы диаграммы

Диаграммы показывают данные и дополнительные элементы, такие как условных обозначений, осей, рядов и т. д. На следующем рисунке показаны многие элементы диаграммы, которые можно настраивать при использовании `Chart` вспомогательный. В этой статье показано, как настроить некоторые (но не всех) из этих элементов.

![Описание: Рисунок, иллюстрирующий элементы диаграммы](7-displaying-data-in-a-chart/_static/image7.jpg)

<a id="Creating_a_Chart"></a>
## <a name="creating-a-chart-from-data"></a>Создание диаграммы на основе данных

Данные, отображаемые на диаграмме может быть массив из результатов, возвращаемых из базы данных или данных в XML-файл.

### <a name="using-an-array"></a>С помощью массива

Как описано в статье [введение в ASP.NET Web Pages программирование с использованием синтаксиса Razor](https://go.microsoft.com/fwlink/?LinkId=202890), массив позволяет хранить коллекции схожих элементов в одной переменной. Массивы можно использовать для хранения данных, должны быть включены в диаграмме.

Эта процедура показывает создание диаграммы из данных в массивы, с помощью типа диаграммы по умолчанию. Также показано, как для отображения диаграммы в пределах страницы.

1. Создайте новый файл с именем *ChartArrayBasic.cshtml*.
2. Замените существующее содержимое следующим кодом: 

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample1.cshtml)]

    Код сначала создает новую диаграмму и задает высоту и ширину. Укажите заголовок диаграммы с помощью `AddTitle` метод. Чтобы добавить данные, используйте `AddSeries` метод. В этом примере используется `name`, `xValue`, и `yValues` параметры `AddSeries` метод. `name` Параметр отображается в условных обозначениях диаграммы. `xValue` Параметр содержит массив данных, отображаемых вдоль горизонтальной оси диаграммы. `yValues` Параметр содержит массив данных, используемый для построения вертикальной точек диаграммы.

    `Write` Метод фактически отображает диаграммы. В этом случае, так как не был указан тип диаграммы `Chart` вспомогательный отображает его по умолчанию диаграммы и гистограммы.
3. Запустите страницу в браузере. Браузер отображает диаграммы. 

    ![](7-displaying-data-in-a-chart/_static/image8.jpg)

### <a name="using-a-database-query-for-chart-data"></a>С помощью запроса к базе данных для данных диаграммы

Если в базе данных сведения, необходимые для создания диаграммы, можно выполнить запрос к базе данных и затем использовать данные из результатов для создания диаграммы. Эта процедура показано, как для чтения и отображения данных из базы данных, созданные в статье [введение в работу с базой данных в веб-узлы веб-страниц ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202893).

1. Добавить *приложения\_данные* папки в корневой каталог веб-сайта, если папка не существует.
2. В *приложения\_данные* папки, добавьте файл базы данных, с именем *SmallBakery.sdf* , которое описано в [введение в работу с базой данных в узлы веб-страниц ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202893).
3. Создайте новый файл с именем *ChartDataQuery.cshtml*.
4. Замените существующее содержимое следующим кодом:   

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample2.cshtml)]

    Код сначала открывает SmallBakery базу данных и присваивает его переменной с именем `db`. Данная переменная представляет `Database` объект, который может использоваться для чтения и записи в базу данных. Затем код выполняет запрос SQL для получения цены каждого продукта и имя. Код создает новую диаграмму и передает запрос к базе данных путем вызова на диаграмме `DataBindTable` метод. Этот метод принимает два параметра: `dataSource` параметр используется для данных из запроса и `xField` параметр позволяет задать столбец данных, используемый для оси x диаграммы.

    В качестве альтернативы с помощью `DataBindTable` метод, можно использовать `AddSeries` метод `Chart` вспомогательный. `AddSeries` Позволяет задать `xValue` и `yValues` параметров. Например, вместо использования `DataBindTable` метод следующим образом:

    [!code-css[Main](7-displaying-data-in-a-chart/samples/sample3.css)]

    Можно использовать `AddSeries` метод следующим образом:

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample4.html)]

    Оба отображают те же результаты. `AddSeries` Метода является более гибким, поскольку можно указать тип диаграммы и данные более явно, но `DataBindTable` метод проще в использовании, если вам не нужен дополнительную гибкость.
5. Запустите страницу в браузере. 

    ![](7-displaying-data-in-a-chart/_static/image9.jpg)

### <a name="using-xml-data"></a>Использование XML-данных

Третий параметр для графики — для использования в XML-файл в качестве данных для диаграммы. Это требует, чтобы XML-файл также файл схемы (*.xsd* файл), описывающий XML-структуру. Эта процедура демонстрируется чтение данных из XML-файла.

1. В *приложения\_данные* папки, создайте новый XML-файл с именем *data.xml*.
2. Замените существующий XML следующих некоторые XML-данные о сотрудниках в вымышленной компании. 

    [!code-xml[Main](7-displaying-data-in-a-chart/samples/sample5.xml)]
3. В *приложения\_данные* папки, создайте новый XML-файл с именем *data.xsd*. (Обратите внимание, что расширения на этот раз будет *.xsd*.)
4. Замените существующий XML-код следующим кодом: 

    [!code-xml[Main](7-displaying-data-in-a-chart/samples/sample6.xml)]
5. В корневом веб-сайта, создайте новый файл с именем *ChartDataXML.cshtml*.
6. Замените существующее содержимое следующим кодом: 

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample7.cshtml)]

    Код сначала создает `DataSet` объекта. Этот объект используется для управления данными, который считывается из файла XML и организуйте ее в соответствии с данными из файла схемы. (Обратите внимание, что начало кода включает инструкцию `using SystemData`. Это необходимо, чтобы иметь возможность работать с `DataSet` объекта. Дополнительные сведения см. в разделе [ &quot;использование&quot; инструкций и полные имена](#SB_UsingStatements) далее в этой статье.)

    Затем код создает `DataView` объекта, основанного на наборе данных. Представление данных предоставляет объект, который можно привязать диаграммы &#8212; т. е. чтение и построения. Диаграммы выполняет привязку к данным с помощью `AddSeries` метода, как вы видели ранее при построения диаграмм массива данных, за исключением того, что это время `xValue` и `yValues` параметры имеют значение `DataView` объекта.

    В этом примере также показан способ указания определенного типа диаграммы. При добавлении данных в `AddSeries` метода `chartType` параметра также настроен на отображение на круговой диаграмме.
7. Запустите страницу в браузере. 

    ![](7-displaying-data-in-a-chart/_static/image10.jpg)

> [!TIP] 
> 
> <a id="SB_UsingStatements"></a>
> ### <a name="using-statements-and-fully-qualified-names"></a>«Using» и полные имена
> 
> Веб-страниц ASP.NET с синтаксисом Razor на основе .NET Framework состоит из нескольких тысяч компонентов (классы). Чтобы сделать его неудобно работать с этими классами, они организованы в *пространства имен*, которые являются подобно библиотеки. Например `System.Web` пространство имен содержит классы, поддерживающие связь с браузером и сервером, `System.Xml` пространство имен содержит классы, используемые для создания и чтения файлов XML и `System.Data` пространство имен содержит классы, которые позволяют работать с данными.
> 
> Чтобы получить доступ к любой данный класс в .NET Framework, код должен знать не только имя класса, но пространство имен, класс. Например, чтобы использовать `Chart` вспомогательного приложения, код должен найти `System.Web.Helpers.Chart` класс, который объединяет пространство имен (`System.Web.Helpers`) с именем класса (`Chart`). Этот процесс известен как класс *полное* имя &#8212; его полностью и однозначно расположения в vastness платформы .NET Framework. В коде это будет выглядеть следующим образом:
> 
> `var myChart = new System.Web.Helpers.Chart(width: 600, height: 400) // etc.`
> 
> Тем не менее, сложно (и подвержен ошибкам) чтобы использовать эти имена long, полное нужно ссылаться на класс или вспомогательный каждый раз. Таким образом, чтобы было проще использовать имена классов, можно *импорта* пространства имен, вас интересует, который обычно является лишь небольшое число один из многих пространства имен в .NET Framework. При импорте пространства имен, можно использовать только имя класса (`Chart`) вместо полное доменное имя (`System.Web.Helpers.Chart`). Когда ваш код выполняется и обнаруживает имя класса, он может выглядеть в только что импортированные для поиска этого класса пространства имен.
> 
> При использовании веб-страниц ASP.NET с синтаксисом Razor для создания веб-страниц, обычно используется один и тот же набор классов каждый раз, включая `WebPage` класса, различные вспомогательные методы и т. д. Чтобы сохранить работу импорта соответствующего пространства имен, каждый раз при создании веб-сайт, ASP.NET настроено, поэтому он автоматически импортирует набор основных пространств имен для каждого веб-узла. Вот почему еще не приходилось работать с пространства имен или импорта до сейчас; все классы, которые вы работали с находятся в пространствах имен, уже импортирована для вас.
> 
> Тем не менее иногда требуется для работы с классом, который не находится в пространстве имен, автоматически импортируются автоматически. В этом случае вы можете использовать полное имя этого класса, или можно вручную импортировать пространство имен, содержащее класс. Чтобы импортировать пространство имен, используйте `using` инструкции (`import` в Visual Basic), как показано в примере выше статьи.
> 
> Например `DataSet` класс находится в `System.Data` пространства имен. `System.Data` Пространство имен доступно для страницы ASP.NET Razor не автоматически. Таким образом для работы с `DataSet` класса, используя его полное имя, можно использовать следующий код:
> 
> `var dataSet = new System.Data.DataSet();`
> 
> Если необходимо использовать `DataSet` класса несколько раз можно затем использовать только имя класса в коде и импортировать пространство имен следующим образом:
> 
> [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample8.cshtml)]
> 
> Можно добавить `using` инструкции для других имен .NET Framework, требуется ссылка. Тем не менее, как уже упоминалось, не требуется сделать это часто, так как большинство классов, которые вы будете работать с находятся в пространствах имен, которые автоматически импортируются в ASP.NET для использования в *.cshtml* и *.vbhtml* страниц.


<a id="Displaying_Charts"></a>
## <a name="displaying-charts-inside-a-web-page"></a>Отображение диаграмм внутри веб-страницы

В примерах вы просмотрели на данный момент в диаграмму, а затем диаграммы отображается непосредственно в браузере как графическое изображение. Во многих случаях, вы хотите отобразить диаграмму как часть страницы, не только сам по себе в браузере. Для этого требуется двухэтапный процесс. Первым шагом является создание страницы, которая приводит к возникновению ошибки диаграммы, как вы уже видели.

Второй шаг — отображение полученное изображение в другую страницу. Для отображения изображения, можно использовать HTML `<img>` элемента так же, как для отображения изображения. Однако вместо ссылки на *.jpg* или *.png* файл `<img>` ссылок на элементы *.cshtml* файл, содержащий `Chart` вспомогательный, Создание диаграммы. При запуске страницы отображения, `<img>` элемент возвращает выходные данные `Chart` вспомогательный и подготавливает к просмотру диаграммы.

![](7-displaying-data-in-a-chart/_static/image11.jpg)

1. Создайте файл с именем *ShowChart.cshtml*.
2. Замените существующее содержимое следующим кодом: 

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample9.html)]

    Код использует `<img>` элемент для отображения на диаграмме, созданной ранее в *ChartArrayBasic.cshtml* файла.
3. Запустите веб-страницы в браузере. *ShowChart.cshtml* файл отображает изображения диаграммы, в зависимости от кода, содержащегося в *ChartArrayBasic.cshtml* файла.

<a id="Styling_a_Chart"></a>
## <a name="styling-a-chart"></a>Стиля диаграммы

`Chart` Вспомогательные поддерживает большое количество параметров, которые позволяют настраивать внешний вид диаграммы. Можно задать цвета, шрифты, границы и т. д. Простой способ настройки внешнего вида диаграммы является использование *темы*. Темы — это коллекции данных, задающие способ визуализации диаграммы с помощью шрифтов, цветов, меток, палитр, границ и эффекты. (Обратите внимание, что стиль диаграммы не указывает тип диаграммы).

В следующей таблице перечислены встроенные темы.

| Тема | Описание: |
| --- | --- |
| `Vanilla` | Отображает красный столбцы на белом фоне. |
| `Blue` | Отображает синий столбцов на синем фоне градиента. |
| `Green` | Отображает синий столбцов на зеленый градиента фона. |
| `Yellow` | Отображаются столбцы, оранжевый на желтом фоне градиента. |
| `Vanilla3D` | Отображает трехмерных красный столбцы на белом фоне. |

Можно указать тему для использования при создании новой диаграммы.

1. Создайте новый файл с именем *ChartStyleGreen.cshtml*.
2. Замените существующее содержимое на странице с помощью следующего:

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample10.cshtml)]

    Данный пример кода является таким же, как и предыдущий пример, который использует базу данных, но добавляет `theme` параметр при создании `Chart` объекта. Ниже показан измененный код:

    [!code-csharp[Main](7-displaying-data-in-a-chart/samples/sample11.cs)]
3. Запустите страницу в браузере. Вы увидите те же данные, но диаграмма выглядит более профессиональный: 

    ![](7-displaying-data-in-a-chart/_static/image12.jpg)

<a id="Saving_a_Chart"></a>
## <a name="saving-a-chart"></a>Сохранение диаграммы

При использовании `Chart` вспомогательный как показанные выше в этой статье вспомогательное приложение повторно создает диаграмму с нуля при каждом вызове. При необходимости код для диаграммы также повторно запрашивает базу данных или повторно считывает XML-файл для получения данных. В некоторых случаях это может быть сложной операцией, например при больших размерах базы данных, выполняется запрос, или в том случае, если XML-файл содержит большой объем данных. Даже если диаграммы не имеют большой объем данных, процесс создания образа динамически занимать ресурсы сервера, и если многие пользователи запрашивают страницу или страницы, отобразить диаграмму, может быть оказывают влияние на производительность веб-сайта.

Для сокращения влиять на производительность создания диаграммы, можно создать диаграмму первый раз она необходима и сохраните его. При снова потребуются диаграммы, а не выполняется повторное создание, вы можете просто взять сохраненную версию и обработать ее.

Диаграмму можно сохранить в следующих случаях:

- Кэшировать диаграммы в памяти компьютера (на сервере).
- Сохраните диаграмму в виде файла изображения.
- Сохраните диаграмму как XML-файл. Этот параметр позволяет изменять диаграммы, до его сохранения.

### <a name="caching-a-chart"></a>Кэширование диаграммы

После создания диаграммы, которые можно кэшировать. Кэширование диаграммы означает, он не должен быть создан повторно, если оно должно отображаться в дальнейшем. Диаграмма сохраняется в кэше, вы предоставляете его ключ, который должен быть уникальным для этой диаграммы.

Диаграммы сохраняются в кэше может быть удалена, если серверу не хватает памяти. Кроме того кэш очищается при перезапуске приложения по любой причине. Таким образом это стандартный способ работы с диаграммой, кэшированные — сначала всегда проверьте ли он доступен в кэше и если нет, то для создания или создайте его повторно.

1. В корневой веб-сайта, создайте файл с именем *ShowCachedChart.cshtml*.
2. Замените существующее содержимое следующим кодом: 

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample12.html)]

    `<img>` Тег содержит `src` атрибутом, указывающим на *ChartSaveToCache.cshtml* файла и передает ключ на данную страницу как строку запроса. Ключ содержит такое значение &quot;myChartKey&quot;. *ChartSaveToCache.cshtml* файл содержит `Chart` вспомогательный объект, будет создана диаграмма. Вы создадите эту страницу через несколько секунд.

    В конце страницы представляет собой ссылку на страницу с именем *ClearCache.cshtml*. Это страница, на которой скоро здесь также создается. Требуется *ClearCache.cshtml* только для проверки кэширование для этого примера — не ссылку или страницу, обычно следует использовать при работе с диаграммами кэшированные.
3. В корневой веб-сайта, создайте новый файл с именем *ChartSaveToCache.cshtml*.
4. Замените существующее содержимое следующим кодом:

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample13.cshtml)]

    Код сначала проверяет, является ли что-либо была передана в качестве значения ключа в строке запроса. Если Да, в коде предпринимается попытка чтения диаграммы из кэша путем вызова `GetFromCache` метод и передает его ключ. Если оказалось, что нет данных в кэше по этому ключу (которая может произойти при первом запросе диаграммы), код создает диаграмму в обычном режиме. По окончании диаграммы код сохраняет его в кэш путем вызова `SaveToCache`. Этот метод требуется ключ (то есть диаграммы можно запросить более поздней версии) и количество времени, диаграммы, которые должны сохраняться в кэше. (Точное время будет кэшировать диаграммы зависит от частоты рассматривать может изменить данные, которые он представляет.) `SaveToCache` Также требует `slidingExpiration` параметр &#8212; Если задано значение true, время ожидания счетчик сбрасывается при каждом доступе к диаграмме. В этом случае фактически означает, срока действия записи кэша диаграммы 2 минут после последнего обращения к другому диаграммы. (Альтернативу скользящий срок действия — абсолютный срок действия, то есть, запись кэша будет срок действия ровно 2 минуты после его помещено в кэш, независимо от того, как часто он осуществлялся).

    Наконец, код использует `WriteFromCache` метод для извлечения и отображения диаграммы из кэша. Обратите внимание, что этот метод находится за пределами `if` блок, который проверяет кэш, так как он получит диаграммы из кэша или диаграммы был первоначально должен был быть создан и сохранен в кэше.

    Обратите внимание, что в примере `AddTitle` метод включает отметку времени. (Он добавляет текущую дату и время &#8212; `DateTime.Now` &#8212; к заголовку.)
5. Создание новой страницы с именем *ClearCache.cshtml* и замените его содержимое следующим:

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample14.cshtml)]

    Эта страница содержит `WebCache` модуля поддержки диаграммы, которая кэшируется в *ChartSaveToCache.cshtml*. Как отмечалось ранее, не нужно обычно имеют такие страницы. Вы создаете здесь только для того, чтобы упростить тестирование кэширования.
6. Запустите *ShowCachedChart.cshtml* веб-страницы в браузере. На странице отображается изображение диаграммы, в зависимости от кода, содержащегося в *ChartSaveToCache.cshtml* файла. Запишите говорит отметка времени в заголовок диаграммы. 

    ![Описание: Изображение простой диаграммы с меткой времени в заголовок диаграммы](7-displaying-data-in-a-chart/_static/image13.jpg)
7. Закройте браузер.
8. Запустите *ShowCachedChart.cshtml* еще раз. Обратите внимание, что отметка времени же как и раньше, указывающая, что диаграмма не был создан повторно, но вместо этого было считано из кэша.
9. В *ShowCachedChart.cshtml*, нажмите кнопку **очистить кэш** ссылку. Открывается *ClearCache.cshtml*, который сообщает, что кэш был очищен.
10. Нажмите кнопку **вернуться к ShowCachedChart.cshtml** связь, или повторно запустите *ShowCachedChart.cshtml* из WebMatrix. Изменилось этот раз отметка времени, так как очистить кэш. Таким образом код должен повторно создать диаграммы и поместить его в кэш.

### <a name="saving-a-chart-as-an-image-file"></a>Сохранение диаграммы в виде файла изображения

Можно также сохранить диаграмму в виде файла изображения (например, как *.jpg* файл) на сервере. Затем можно использовать файл изображения так, как любое изображение. Преимущество заключается в хранятся в файл, а не сохранены на временном кэше. Можно сохранить новое изображение диаграммы в различные моменты времени (например, каждый час) и затем сохранить постоянно фиксировать изменения, происходящие с течением времени. Обратите внимание, что необходимо убедиться, что веб-приложение имеет разрешение на сохранение файла в папке на сервере, где требуется поместить файл образа.

1. В корневой веб-сайта, создайте папку с именем  *\_ChartFiles* , если он еще не существует.
2. В корневой веб-сайта, создайте новый файл с именем *ChartSave.cshtml*.
3. Замените существующее содержимое следующим кодом:

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample15.cshtml)]

    Код сначала проверяет, является ли *.jpg* файл существует, вызвав `File.Exists` метод. Если файл не существует, создается новый `Chart` из массива. Это время, код вызывает метод `Save` метод и передает `path` для указания пути к файлу и имя файла для сохранения диаграммы. В основной области страницы `<img>` элемент использует путь, чтобы она указывала на *.jpg* файла отображения.
4. Запустите *ChartSave.cshtml* файла.
5. Вернитесь в WebMatrix. Обратите внимание, что файл изображения с именем *chart01.jpg* была сохранена в  *\_ChartFiles* папки.

### <a name="saving-a-chart-as-an-xml-file"></a>Сохранение диаграммы в виде XML-файла

Наконец можно сохранить диаграмму в виде XML-файла на сервере. Преимущество использования этого метода над кэшированием или сохранением диаграммы в файл является, можно изменить перед выводом диаграммы, если вы хотели XML. Приложение должно иметь разрешения на чтение и запись для папки на сервере, в которой вы хотите поместить файл образа.

1. В корневой веб-сайта, создайте новый файл с именем *ChartSaveXml.cshtml*.
2. Замените существующее содержимое следующим кодом:

    [!code-cshtml[Main](7-displaying-data-in-a-chart/samples/sample16.cshtml)]

    Это тот же код, который вы видели ранее для хранения диаграммы в кэше, за исключением того, что он использует XML-файл. Код сначала проверяет, существует ли XML-файл, вызвав `File.Exists` метод. Если файл существует, код создает новый `Chart` и передает имя файла как `themePath` параметр. При этом создается диаграмма, в зависимости от того, что в XML-файле. Если XML-файл не существует, код будет создана диаграмма обычным образом, а затем вызывает `SaveXml` для его сохранения. Диаграмма отображается с помощью `Write` метода, как вы уже видели.

    С помощью страницы, показали, кэширование, этот код включает отметку времени в заголовок диаграммы.
3. Создание новой страницы с именем *ChartDisplayXMLChart.cshtml* и добавьте в нее следующую разметку: 

    [!code-html[Main](7-displaying-data-in-a-chart/samples/sample17.html)]
4. Запустите *ChartDisplayXMLChart.cshtml* страницы. Отображение диаграммы. Запишите метку времени в заголовок диаграммы.
5. Закройте браузер.
6. В WebMatrix, щелкните правой кнопкой мыши  *\_ChartFiles* папку, нажмите кнопку **обновление**и затем откройте нужную папку. *XMLChart.xml* файл в этой папке был создан `Chart` вспомогательный. 

    ![Описание: Папка _ChartFiles, отображение XMLChart.xml файл, созданный вспомогательный объект диаграммы.](7-displaying-data-in-a-chart/_static/image14.jpg)
7. Запустите *ChartDisplayXMLChart.cshtml* страницу еще раз. Диаграмма показывает ту же метку времени, как при первом запуске страницы. Это, так как диаграмма формируется из XML, сохраненный ранее.
8. В WebMatrix откройте  *\_ChartFiles* папку и удалите *XMLChart.xml* файла.
9. Запустите *ChartDisplayXMLChart.cshtml* страницу еще раз. На этот раз отметка времени обновляется, так как `Chart` вспомогательный пришлось повторно создайте XML-файл. Если необходимо, установите  *\_ChartFiles* папки и обратите внимание, что XML-файл обратно.

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a>Дополнительные ресурсы

- [Введение в работу с базой данных в ASP.NET Web Pages сайтов](https://go.microsoft.com/fwlink/?LinkId=202893)
- [Использование кэширования в ASP.NET Web Pages сайты для повышения производительности](https://go.microsoft.com/fwlink/?LinkId=202903)
- [Класс диаграммы](https://msdn.microsoft.com/library/system.web.helpers.chart(v=vs.99)) (Справочник по API веб-страниц ASP.NET на сайте MSDN)
