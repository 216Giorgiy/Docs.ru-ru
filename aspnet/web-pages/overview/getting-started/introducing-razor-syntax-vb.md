---
uid: web-pages/overview/getting-started/introducing-razor-syntax-vb
title: "Введение в программирование веб-ASP.NET с использованием синтаксиса Razor (Visual Basic) | Документы Microsoft"
author: tfitzmac
description: "В этом приложении предоставляет общие сведения о программировании с использованием веб-страниц ASP.NET в Visual Basic с использованием синтаксиса Razor."
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/07/2014
ms.topic: article
ms.assetid: 5da59646-e973-41cd-88a9-c6b2c0594027
ms.technology: dotnet-webpages
ms.prod: .net-framework
msc.legacyurl: /web-pages/overview/getting-started/introducing-razor-syntax-vb
msc.type: authoredcontent
ms.openlocfilehash: 8f5d223a5944d8adb9fe65c89e87829d18d1c7ee
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2018
---
<a name="introduction-to-aspnet-web-programming-using-the-razor-syntax-visual-basic"></a>Введение в программирование веб-ASP.NET с использованием синтаксиса Razor (Visual Basic)
====================
по [Tom FitzMacken](https://github.com/tfitzmac)

> В этой статье дается обзор программирования с веб-страниц ASP.NET с помощью синтаксиса Razor и Visual Basic. ASP.NET — технология Майкрософт для выполнения динамических веб-страниц на веб-серверах.
> 
> **Вы узнаете**:
> 
> - Top 8, программирование советов по началу работы с программирование веб-страниц ASP.NET с использованием синтаксиса Razor.
> - Основные принципы программирования вам.
> - Какие кода сервера ASP.NET и синтаксисом Razor — все о.
>   
> 
> ## <a name="software-versions"></a>Версии программного обеспечения
> 
> 
> - Веб-страниц ASP.NET (Razor) 3
>   
> 
> Этот учебник также работает с веб-страницы ASP.NET 2.


Большинство примеров использования ASP.NET Web Pages с синтаксисом Razor использовать C#. Но синтаксис Razor также поддерживает Visual Basic. Для программирования веб-страницу ASP.NET в Visual Basic, создать веб-страницы с *.vbhtml* расширение имени файла, а затем добавьте код Visual Basic. В этой статье дается обзор работы с языком Visual Basic и синтаксис для создания веб-страниц ASP.NET.

> [!NOTE]
> Шаблоны по умолчанию веб-сайт Microsoft WebMatrix (**Bakery**, **фотоальбома**, и **начального сайта**, т. д.) доступны в версии C# и Visual Basic. Шаблоны Visual Basic, можно установить как пакеты NuGet. Шаблоны веб-сайта устанавливаются в корневой папке веб-узла в папку с именем *шаблонов Microsoft*.


## <a name="the-top-8-programming-tips"></a>Top 8 советы по программированию

В этом разделе приведены несколько советов, которые абсолютно необходимо знать перед началом написания кода сервера ASP.NET с использованием синтаксиса Razor.

### <a name="1-you-add-code-to-a-page-using-the--character"></a>1. Добавьте код для страницы с помощью символ @

`@` Символ запускает встроенные выражения, одной инструкцией блоки и блоки нескольких инструкций:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample1.vbhtml)]

Результат отображается в браузере:

![Razor Img1](introducing-razor-syntax-vb/_static/image1.jpg)

> [!TIP] 
> 
> **Кодировка HTML**
> 
> При отображении содержимого в страницу с использованием `@` символов, как в предыдущих примерах ASP.NET кодирует в формате HTML выходные данные. Эта процедура заменяет зарезервированные символы HTML (например, `<` и `>` и `&`) с кодами, позволяющие символы для отображения в качестве символов на веб-странице, а как HTML-теги или сущностей. Без кодировки HTML, вывод серверный код могут отображаться неправильно и может предоставить доступ к странице угрозам безопасности.
> 
> Если вашей целью является для вывода разметки HTML, который отображает теги как разметка (например `<p></p>` для абзаца или `<em></em>` для выделения текста), см. в разделе [объединение текст, разметку и код в блоках кода](#BM_CombiningTextMarkupAndCode) далее в этой статье.
> 
> Вы можете прочитать больше о HTML-кодирования в [работа с HTML-формы в веб-узлы веб-страниц ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202892).


### <a name="2-you-enclose-code-blocks-with-codeend-code"></a>2. Блоки кода с кодом заключаются... Коду End

Блок кода включает один или несколько операторов кода, а заключено с ключевыми словами `Code` и `End Code`. Поместите открывающий `Code` ключевое слово сразу же после `@` символ &#8212; не должно быть пробелов между ними.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample2.vbhtml)]

Результат отображается в браузере:

![Razor Img2](introducing-razor-syntax-vb/_static/image2.jpg)

### <a name="3-inside-a-block-you-end-each-code-statement-with-a-line-break"></a>3. Внутри блока завершения каждого оператора с разрывом строки

Каждый оператор в блоке кода Visual Basic заканчивается разрыв строки. (Далее в этой статье вы увидите такую возможность wrap оператор long кода на несколько строк, при необходимости.)

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample3.vbhtml)]

### <a name="4-you-use-variables-to-store-values"></a>4. Использовать переменные для хранения значений

Можно хранить значения в *переменной*, включая строки, числа и даты, и т. д. Создание новой переменной с помощью `Dim` ключевое слово. Значения переменных можно вставить непосредственно в страницу с помощью `@`.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample4.vbhtml)]

Результат отображается в браузере:

![Razor Img3](introducing-razor-syntax-vb/_static/image3.jpg)

### <a name="5-you-enclose-literal-string-values-in-double-quotation-marks"></a>5. Строковый литерал по значению заключены в двойные кавычки

Объект *строка* — это последовательность символов, которые рассматриваются как текст. Чтобы указать строку, заключите его в двойные кавычки:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample5.vbhtml)]

Чтобы внедрить двойные кавычки в пределах строковое значение, вставьте двумя символами двойных кавычек. Символ двойных кавычек появляться только один раз в выходные данные страницы, введите ее в качестве `""` в кавычках строку и оно должно отображаться дважды, введите ее в качестве `""""` в строку в кавычках.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample6.vbhtml)]

Результат отображается в браузере:

![Razor Img4](introducing-razor-syntax-vb/_static/image4.jpg)

### <a name="6-visual-basic-code-is-not-case-sensitive"></a>6. Код Visual Basic регистр не учитывается

Язык Visual Basic регистр не учитывается. Программирование ключевые слова (такие как `Dim`, `If`, и `True`) и имена переменных (как `myString`, или `subTotal`) могут быть записаны в любом случае.

Следующие строки кода присвоить значение переменной `lastname` с использованием строчных букв имени и вывод значения переменной на страницу с помощью имени в верхнем регистре.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample7.vbhtml)]

Результат отображается в браузере:

![VB синтаксиса-5](introducing-razor-syntax-vb/_static/image5.jpg)

### <a name="7-much-of-your-coding-involves-working-with-objects"></a>7. Большая часть программирования предполагает работу с объектами

Объект представляет вещь, вы можете программировать с &#8212; страница текстового поля, файла, изображения, веб-запроса, сообщение электронной почты, запись клиента (строки базы данных), и т. д. Объекты имеют свойства, описывающие их характеристики &#8212; Объект-поле имеет `Text` свойство, объект запроса имеет `Url` имеет свойства, сообщение электронной почты `From` свойство и объект клиента имеет `FirstName` свойства. Объекты также имеют методы, являющиеся &quot;команд&quot; они могут выполнять. Примеры включают объект файла `Save` метод, объект image `Rotate` метод и объект электронной почты `Send` метод.

Вы будете часто работать с `Request` объект, который предоставляет сведения, такие как значения формы поля на странице (текстовые поля, т. д.), какой тип браузера, сделавшего запрос, URL-адрес страницы, удостоверение пользователя, и т. д. В этом примере показано, как получить доступ к свойствам объекта `Request` объект и способ вызова `MapPath` метод `Request` объекта, который дает абсолютный путь к странице на сервере:

[!code-html[Main](introducing-razor-syntax-vb/samples/sample8.html)]

Результат отображается в браузере:

![Razor Img5](introducing-razor-syntax-vb/_static/image6.jpg)

### <a name="8-you-can-write-code-that-makes-decisions"></a>8. Можно написать код, который принимает решения

Ключевой особенностью динамических веб-страниц является, можно определить, какие зависимости от условия. Наиболее распространенный способ сделать это — с `If` инструкции (и необязательно `Else` инструкции).

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample9.vbhtml)]

Инструкция `If IsPost` является быстрым способом написания `If IsPost = True`. Вместе с `If` инструкции, существует множество способов для проверки условий, повторите блоков кода, и т. д., который из них описаны далее в этой статье.

Результат отображается в браузере (после нажатия кнопки **отправить**):

![Razor Img6](introducing-razor-syntax-vb/_static/image7.jpg)

> [!TIP] 
> 
> **HTTP GET и POST методы и свойства IsPost**
> 
> Протокол, используемый для веб-страницы (HTTP) поддерживает очень ограниченное число методов (&quot;команд&quot;), которые используются для выполнения запросов к серверу. Два наиболее распространенных: GET, который используется для считывания страницы, и POST, который используется для отправки страницы. Как правило при первом запросе страницы, страница запрашивается с помощью GET. Если пользователь заполняет форму и затем нажимает **отправить**, браузер отправляет запрос POST к серверу.
> 
> В веб-программирования часто бывает полезно знать ли страница запрашивается как GET или POST, чтобы знать, как обрабатывать страницы. Веб-страницах ASP.NET, можно использовать `IsPost` свойство, чтобы узнать, является ли запрос GET или POST. Если запрос POST, `IsPost` свойство будет возвращать значение true, и можно выполнять следующие действия чтения значений текстовых полей в форме. Многие примеры, вы увидите показано, как обрабатывать страницы по-разному в зависимости от значения `IsPost`.


## <a name="a-simple-code-example"></a>Простой пример кода

Эта процедура показано, как создать страницу, которая иллюстрирует основные приемы программирования. В примере создается страница, на которой пользователи могут вводить двух чисел, а затем он добавляет их и отображает результат.

1. В редакторе создайте новый файл и назовите его *AddNumbers.vbhtml*.
2. Скопируйте следующий код и разметку в странице, заменив любой страницы.

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample10.vbhtml)]

    Ниже описаны некоторые меры, следует учесть:

    - `@` Символ запускает первый блок кода на странице, и он находился перед `totalMessage` переменной, внедренных в нижней части.
    - Блок в верхней части страницы заключен в `Code...End Code`.
    - Переменные `total`, `num1`, `num2`, и `totalMessage` хранить несколько чисел и строку.
    - Значение строки литерала, присваиваемое `totalMessage` переменная будет попадать в двойные кавычки.
    - Так как код Visual Basic регистр не учитывается, если `totalMessage` переменной в нижней части страницы, а только его имя должно соответствовать Правописание объявление переменной в верхней части страницы. Регистр не имеет значения.
    - Выражение `num1.AsInt()`  +  `num2.AsInt()` показано, как работать с объектами и методы. `AsInt` Метод для каждой переменной преобразует строку, введенные пользователем в целое число (целое число), который может быть добавлен.
    - `<form>` Тег содержит `method="post"` атрибута. Указывает, что когда пользователь щелкает **добавить**, страницы, которые будут отправляться на сервер с помощью метода HTTP POST. При отправке страницы, код `If IsPost` имеет значение true, а условного кода, отображается результат сложения чисел.
3. Сохраните страницу и запустите его в браузере. (Убедитесь, что выбран страницы **файлы** рабочей области, прежде чем запускать его.) Введите двух целых чисел, а затем нажмите кнопку **добавить** кнопки.

    ![Razor Img7](introducing-razor-syntax-vb/_static/image8.jpg)

## <a name="visual-basic-language-and-syntax"></a>Язык Visual Basic и синтаксис

Вы уже видели простой пример, как создать веб-страницу ASP.NET и сведения о добавлении серверного кода для HTML-разметка. Здесь вы узнаете основы работы с Visual Basic для написания кода сервера ASP.NET, с помощью синтаксиса Razor &#8212; то есть правила языка программирования.

Если у вас есть опыт работы с программирования (особенно если вы использовали C, C++, C#, Visual Basic или JavaScript), большая часть сведений здесь будут знакомы. Возможно, потребуется ознакомиться только с добавляется как WebMatrix код разметки в *.vbhtml* файлов.

### <a id="BM_CombiningTextMarkupAndCode"></a>Объединение текста, разметку и код в блоках кода

В блоках кода сервера часто необходимо выводить текст и разметку страницы. Если блок кода сервера содержит текст, не код и, вместо этого должны отображаться как есть, ASP.NET необходимо иметь возможность различать текст из кода. Для этого можно использовать следующие способы.

- Заключите текст в HTML-элемент блока как `<p></p>` или `<em></em>`:

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample11.vbhtml)]

    HTML-элемента, могут включать текст, дополнительных элементов HTML и выражения в коде сервера. Когда ASP.NET обнаруживает открывающий тег HTML (например, `<p>`), он отображает все, что элемент и его содержимое в виде является браузера (и обрабатывает выражения серверного кода).

- Используйте `@:` оператор или `<text>` элемент. `@:` Выводит одну строку содержимого, содержащий обычный текст или непарные теги HTML; `<text>` элемент заключает в себе несколько строк для вывода. Эти параметры полезны в тех случаях, когда требуется запретить для отрисовки HTML-элемент в рамках выходных данных.

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample12.vbhtml)]

    В следующем примере повторяется предыдущий пример, но использует одну пару `<text>` теги, заключающая текст для отрисовки.

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample13.vbhtml)]

    В следующем примере `<text>` и `</text>` теги заключите три строки, которые имеют неавтономные текста и непарные теги HTML (`<br />`), а также серверный код и соответствующие теги HTML. Опять же, может предшествовать каждой строки по отдельности с `@:` оператор; правильна способом.

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample14.vbhtml)]

    > [!NOTE]
    > При выводе текста как показано в этом разделе &#8212; с помощью элемента HTML `@:` оператор, или `<text>` элемент &#8212; ASP.NET не HTML-кодирование выходные данные. (Как уже отмечалось, ASP.NET кодирования вывода сервера кода выражений и блоков кода сервера, которым предшествует `@`, за исключением особых случаев, указанных в этом разделе.)

### <a name="whitespace"></a>Whitespace

Лишние пробелы в операторе (и за пределами строковый литерал) не влияет на инструкции:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample15.vbhtml)]

### <a name="breaking-long-statements-into-multiple-lines"></a>Разбиение длинных операторов на несколько строк

Длинный код инструкции можно разбить на несколько строк с помощью символа подчеркивания `_` (в Visual Basic называемый *символ продолжения*) после каждой строки кода. Чтобы приостановить выполнение инструкции на следующую строку, в конце строки, добавьте пробел, а затем символ продолжения. Оператор Continue на следующей строке. Можно создать оболочку операторов на столько строк для повышения удобства чтения. Следующие инструкции равнозначны:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample16.vbhtml)]

Однако невозможно создание оболочки строки середине строкового литерала. Следующий пример не работает:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample17.vbhtml)]

Для объединения длинную строку, которая переносится на несколько строк, как приведенный выше код, необходимо использовать *оператор объединения* (`&`), который вы увидите далее в этой статье.

### <a name="code-comments"></a>Комментарии к коду

Комментарии позволяют оставить заметки для себя или другим пользователям. Комментарии синтаксис Razor начинаются с префикса `@*` и заканчиваться `*@`.

[!code-cshtml[Main](introducing-razor-syntax-vb/samples/sample18.cshtml)]

Комментарии синтаксис Razor можно использовать в блоках кода, или можно использовать обычный символ комментария Visual Basic, который — одинарная кавычка (`'`) в качестве префикса для каждой строки.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample19.vbhtml)]

## <a name="variables"></a>Переменные

Переменная является именованный объект, который следует использовать для хранения данных. Переменные любое имя, но имя должно начинаться с буквы и не может содержать пробелы или зарезервированные символы. В Visual Basic как показано выше, не имеет значения регистра букв в имени переменной.

### <a name="variables-and-data-types"></a>Переменные и типы данных

Переменная может иметь определенный тип данных, который указывает, какого рода данные хранятся в переменной. Может иметь строковые переменные, в которых хранятся строковые значения (например &quot;Здравствуй, мир!&quot;), целочисленные переменные, которые сохраняют значения целого числа (например, 3 или 79) и переменные типа date, хранящие значения даты в различных форматах (например, 4 и 12/2012 или март 2009 г. ). И многие другие типы данных, которые можно использовать.

Тем не менее не нужно указывать тип для переменной. В большинстве случаев ASP.NET можно определить тип, основанный на использовании данных в переменной. (Иногда необходимо указать тип, вы увидите примеры, это не так.)

Чтобы объявить переменную без указания типа, используйте `Dim` плюс имя переменной (например, `Dim myVar`). Чтобы объявить переменную с типом, используйте `Dim` плюс имя переменной, за которым следует `As` и затем имя типа (например, `Dim myVar As String`).

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample20.vbhtml)]

В следующем примере показано некоторые встроенные выражения, которые используют эти переменные на веб-странице.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample21.vbhtml)]

Результат отображается в браузере:

![Razor Img9](introducing-razor-syntax-vb/_static/image9.jpg)

### <a name="converting-and-testing-data-types"></a>Преобразование и тестирование типы данных

Несмотря на то, что ASP.NET обычно может автоматически определить тип данных, иногда это невозможно. Таким образом может потребоваться помочь ASP.NET, выполнив явное преобразование. Даже если не нужно преобразовывать типы, иногда полезно для тестирования, чтобы увидеть, какие типы данных вы можете работать с.

Наиболее распространенным случаем является необходимость преобразования строки в другой тип, такой как целое число или дату. В примере показан типичный случай, где необходимо преобразовать строку в число.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample22.vbhtml)]

Как правило входные данные пользователя будут доставляться вам как строки. Даже если предлагается ввести число, и даже если они вводят цифры, при отправке ввод данных пользователем и прочитать его в код, данные в строковом формате. Таким образом необходимо преобразовать строку в число. В примере при попытке выполнить арифметические операции над значениями, без преобразования их, возникает следующая ошибка, так как ASP.NET не удается добавить две строки:

`Cannot implicitly convert type 'string' to 'int'.`

Чтобы преобразовать значения в целые числа, вызовите `AsInt` метод. Если преобразование прошло успешно, затем можно добавить номера.

В следующей таблице перечислены некоторые распространенные методы преобразования и тестирования для переменных.

| **Метод** | **Описание** | **Пример** |
| --- | --- | --- |
| `AsInt(), IsInt()` | Преобразует строку, представляющую целое число (например &quot;593&quot;) в целое число. | [!code-vb[Main](introducing-razor-syntax-vb/samples/sample23.vb)] |
| `AsBool(), IsBool()` | Преобразует строку как &quot;true&quot; или &quot;false&quot; к логическому типу. | [!code-vb[Main](introducing-razor-syntax-vb/samples/sample24.vb)] |
| `AsFloat(), IsFloat()` | Преобразует строку, имеет десятичное значение как &quot;1.3&quot; или &quot;7.439&quot; число с плавающей запятой. | [!code-vb[Main](introducing-razor-syntax-vb/samples/sample25.vb)] |
| `AsDecimal(), IsDecimal()` | Преобразует строку, имеет десятичное значение как &quot;1.3&quot; или &quot;7.439&quot; в десятичное число. (В ASP.NET, десятичное число, более точно, чем число с плавающей запятой.) | [!code-vb[Main](introducing-razor-syntax-vb/samples/sample26.vb)] |
| `AsDateTime(), IsDateTime()` | Преобразует строку, представляющую значение даты и времени для ASP.NET `DateTime` типа. | [!code-vb[Main](introducing-razor-syntax-vb/samples/sample27.vb)] |
| `ToString()` | Любой другой тип данных преобразуется в строку. | [!code-vb[Main](introducing-razor-syntax-vb/samples/sample28.vb)] |

## <a name="operators"></a>Операторы

Оператор — это ключевое слово или символ, который сообщает ASP.NET, какого рода команду, выполняемую в выражении. Visual Basic поддерживает многие операторы, но необходимо распознавать небольшое, чтобы приступить к разработке веб-страниц ASP.NET. В следующей таблице перечислены наиболее распространенные операторы.

| **Operator** | **Описание** | **Примеры** |
| --- | --- | --- |
| `+ - * /` | Математические операторы, используемые в числовых выражений. | [!code-vb[Main](introducing-razor-syntax-vb/samples/sample29.vb)] |
| `=` | Операторы равенства и назначения. В зависимости от контекста либо присваивает значение справа от оператора объекта с левой стороны или проверки значений на равенство. | [!code-vb[Main](introducing-razor-syntax-vb/samples/sample30.vb)] |
| `<>` | Неравенство. Возвращает `True` Если значения не равны. | [!code-vb[Main](introducing-razor-syntax-vb/samples/sample31.vb)] |
| `< > <= >=` | Меньше, чем больше, меньше или равны и не меньше. | [!code-vb[Main](introducing-razor-syntax-vb/samples/sample32.vb)] |
| `&` | Объединение, который используется для объединения строк. | [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample33.vbhtml)] |
| `+= -=` | Операторы инкремента или декремента, которых сложения и вычитания 1 (соответственно) из переменной. | [!code-vb[Main](introducing-razor-syntax-vb/samples/sample34.vb)] |
| `.` | Точка. Используются для различения объектов и их свойства и методы. | [!code-vb[Main](introducing-razor-syntax-vb/samples/sample35.vb)] |
| `()` | Круглые скобки. Используется для группирования выражений для передачи параметров в методы и для доступа к членам, массивов и коллекций. | [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample36.vbhtml)] |
| `Not` | Не. Обращает значение true, false и наоборот. Обычно используется в качестве это самый простой способ проверки `False` (то есть для не `True`). | [!code-vb[Main](introducing-razor-syntax-vb/samples/sample37.vb)] |
| `AndAlso OrElse` | Логическое AND и OR, которые используются для связывания условий. | [!code-vb[Main](introducing-razor-syntax-vb/samples/sample38.vb)] |

## <a name="working-with-file-and-folder-paths-in-code"></a>Работа с файлами и пути к папке, в коде

Вы будете часто работать с пути файлов и папок в коде. Ниже приведен пример структуры физическую папку для веб-сайта, как может выглядеть на компьютере разработчика:

`C:\WebSites\MyWebSite default.cshtml datafile.txt \images Logo.jpg \styles Styles.css`

Ниже приведены некоторые основные сведения о URL-адреса и пути.

- URL-адрес начинается с помощью имени домена (`http://www.example.com`) или имя сервера (`http://localhost`, `http://mycomputer`).
- URL-адрес соответствует физический путь на главном компьютере. Например `http://myserver` папке может соответствовать *C:\websites\mywebsite* на сервере.
- Виртуальный путь является сокращением для задания путей в коде без указания полного пути. Он включает часть URL-адрес, который следует за именем домена или сервера. При использовании виртуальных путей, можно переместить код в другой домен или сервер без необходимости обновлять соответствующие пути.

Ниже приведен пример поможет вам понять различия:

| Полный URL-адрес | `http://mycompanyserver/humanresources/CompanyPolicy.htm` |
| --- | --- |
| Имя сервера | *mycompanyserver* |
| Виртуальный путь | */humanresources/CompanyPolicy.htm* |
| Физический путь | *C:\mywebsites\humanresources\CompanyPolicy.htm* |

Виртуальный корневой каталог — / так же, как и корневом каталоге диска — диск \. (Виртуальная папка пути всегда использовать символы косой черты). Виртуальный путь к папке не нужно иметь то же имя, как физическая папка; Это может быть псевдоним. (На производственных серверах виртуальный путь редко соответствует как полный физический путь.)

При работе с файлами и папками в коде, иногда требуется обращаться к физическому пути и иногда виртуальный путь, в зависимости от того, какие объекты, которым вы работаете. ASP.NET предоставляет эти средства для работы с пути файлов и папок в коде: `Server.MapPath` метода и `~` оператор и `Href` метод.

### <a name="converting-virtual-to-physical-paths-the-servermappath-method"></a>Преобразование виртуальных и физических путей: метод Server.MapPath

`Server.MapPath` Метод преобразует виртуальный путь (например */default.cshtml*) абсолютный физический путь (например *C:\WebSites\MyWebSiteFolder\default.cshtml*). Используйте этот метод когда требуется полный физический путь. Типичным примером является при чтении или записи в текстовый файл или файл изображения на веб-сервере.

Абсолютный физический путь сайта на сервере размещения сайта обычно не известен, поэтому этот метод можно преобразовать путь вы знаете — виртуальный путь, соответствующий путь на сервере для вас. Передать виртуальный путь к файлу или папке в метод и возвращает физический путь:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample39.vbhtml)]

### <a name="referencing-the-virtual-root-the--operator-and-href-method"></a>Создание ссылок на виртуального корневого каталога: ~ оператор и метод Href

В *.cshtml* или *.vbhtml* файл, можно ссылаться на пути виртуального корневого каталога с помощью `~` оператор. Это очень удобно, поскольку можно перемещения страниц на сайте, и любые ссылки, содержащиеся в них на другие страницы не будет нарушена. Это также удобно в случае, если когда-либо переместить веб-сайта в другое место. Далее приводятся некоторые примеры.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample40.vbhtml)]

Если веб-сайт `http://myserver/myapp`, вот как ASP.NET будет интерпретировать эти пути при запуске страницы:

- `myImagesFolder`: `http://myserver/myapp/images`
- `myStyleSheet` : `http://myserver/myapp/styles/Stylesheet.css`

(Вы не увидите фактически не эти пути в качестве значения переменной, но ASP.NET будет рассматривать пути, как в случае, они были).

Можно использовать `~` оператор в серверном коде (как описано выше) и в разметке, следующим образом:

[!code-html[Main](introducing-razor-syntax-vb/samples/sample41.html)]

В разметке, используйте `~` оператор для создания путей к ресурсам, таким как файлы изображений, другие веб-страниц и файлов CSS. При выполнении страницы ASP.NET просматривает страницы (код и разметку) и разрешает все `~` ссылки на правильный путь.

## <a name="conditional-logic-and-loops"></a>Условная логика и циклы

ASP.NET серверный код позволяет выполнять задачи на основе условий и написать код, который повторяется определенное число раз, то есть код инструкции, выполняется в цикле).

### <a name="testing-conditions"></a>Проверка условий

Для проверки простого условия можно использовать `If...Then` инструкцию, которая возвращает `True` или `False` зависимости от теста, можно указать:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample42.vbhtml)]

`If` Блок начинается ключевое слово. Тестирование (условие) следует `If` ключевое слово и возвращает значение true или false. `If` Заканчивается инструкция `Then`. Операторы, которые будут выполняться, если аргумент имеет значение true, заключены в `If` и `End If`. `If` Инструкция может содержать `Else` блок, который задает операторы, которые выполняются, если условие равно false:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample43.vbhtml)]

Если `If` инструкция запускает блок кода, нет необходимости в использовании нормали `Code...End Code` инструкции, чтобы включить блоки. Можно просто добавить `@` к блоку, и он будет работать. Такой подход работает с `If` а также другие программирования ключевые слова, которые следуют блоки кода, включая Visual Basic `For`, `For Each`, `Do While`и т. д.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample44.vbhtml)]

Можно добавить несколько условий с помощью одного или нескольких `ElseIf` блоки:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample45.vbhtml)]

В этом примере, если первым условием в `If` блок не имеет значение true, `ElseIf` проверяется условие. Если это условие выполнено, операторы в `ElseIf` выполняются блока. Если ни одно из условий не соблюдается, операторы в `Else` выполняются блока. Можно добавить любое количество `ElseIf` блоки, а затем закройте с `Else` блокировать как &quot;все остальные&quot; условие.

Чтобы протестировать большое количество условий, используйте `Select Case` блока:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample46.vbhtml)]

Значение для тестирования, указан в скобках (в примере переменной будний день). Каждый отдельный тест использует `Case` инструкцию, которая содержит значение. Если значение `Case` значение проверки, код, который соответствует инструкции `Case` выполняется блок.

Результат выполнения двух последних условные блоки, которые отображаются в браузере:

![Razor Img10](introducing-razor-syntax-vb/_static/image10.jpg)

### <a name="looping-code"></a>Циклической обработки кода

Часто требуется выполнить те же инструкции несколько раз. Для этого цикла. Например можно часто выполняются те же операторы для каждого элемента в набор данных. Если вы знаете точно сколько раз следует включить в цикл, можно использовать `For` цикла. Этот тип цикла особенно полезен для подсчета или отсчет:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample47.vbhtml)]

С началом цикла `For` ключевое слово, и три элемента:

- Сразу после `For` инструкции объявления переменной счетчика (нет необходимости в использовании `Dim`) и укажите диапазон, как и в `i = 10 to 20`. Это означает переменную `i` начинается нумерацию строк с 10 и продолжается до достижения 20 (включительно).
- Между `For` и `Next` операторы — это содержимое блока. Этот файл может содержать один или несколько операторы кода, выполняемых с каждого цикла.
- `Next i` Инструкция завершает цикл. Он увеличивает значение счетчика и запуске следующей итерации цикла.

Строка кода между `For` и `Next` строк содержит код, который выполняется для каждой итерации цикла. Разметка создает новый абзац (`<p>` элемент) каждый раз и добавляет строку в выходные данные, отображение значений i (счетчик). При запуске этой страницы, в примере создается 11 строк, отображая выходные данные с текстом в каждой строке, указывающее номер элемента.

![Razor Img11](introducing-razor-syntax-vb/_static/image11.jpg)

Если вы работаете с коллекции или массива, при этом обычно используются `For Each` цикла. Коллекция — это группа схожие объекты и `For Each` цикла позволяет выполнить задачу для каждого элемента в коллекции. Этот тип цикла является удобным для коллекций, так как в отличие от `For` цикла, не нужно увеличить счетчик или ограничить. Вместо этого `For Each` кода цикла просто проходит через коллекцию до его завершения.

Этот пример возвращает элементы в `Request.ServerVariables` коллекции (который содержит сведения о веб-сервере). Она использует `For Each` цикла для отображения имени каждого элемента, создав новую `<li>` элемента в HTML маркированном списке.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample48.vbhtml)]

`For Each` Ключевым словом должны последовать переменную, которая представляет один элемент в коллекции (в примере `myItem`), за которым следует `In` ключевое слово, и требуется выполнить цикл по коллекции. В теле `For Each` цикла, можно получить доступ к текущего элемента, хранящегося в переменной, объявленный ранее.

![Razor Img12](introducing-razor-syntax-vb/_static/image12.jpg)

Чтобы создать более общего назначения цикла, используйте `Do While` инструкции:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample49.vbhtml)]

Этот цикл начинается с `Do While` ключевое слово, и условия, следует повторить блок. Циклы обычно увеличения (Добавить) или уменьшения (вычитаемое) переменную или объект, используемый для подсчета. В примере `+=` оператор добавляет 1 к значению переменной при каждом выполнении цикла. (Чтобы уменьшают значение переменной в цикле который отсчитывает, используйте оператор декремента `-=`.)

## <a name="objects-and-collections"></a>Объекты и коллекции

Почти все содержимое на веб-сайт ASP.NET — это объект, включая саму веб-страницу. В этом разделе рассматриваются важные объекты, к которым вы будете работать с часто в коде.

### <a name="page-objects"></a>Объекты страницы

Самый простой объект в ASP.NET является страница. Получить доступ к свойствам объекта страницы напрямую без любого соответствующего объекта. Следующий код возвращает путь файла страницы, с помощью `Request` объект страницы:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample50.vbhtml)]

Можно использовать свойства `Page` объекта, чтобы получить большой объем сведений, таких как:

- `Request`. Как вы уже видели, это совокупность сведений о текущем запросе, включая тип браузера, сделавшего запрос, URL-адрес страницы, удостоверение пользователя, и т. д.
- `Response`. Это коллекция сведений об ответе (страница «»), которое будет отправляться в браузере, серверный код завершения работы. Например это свойство можно использовать для записи сведений в ответ.

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample51.vbhtml)]

### <a name="collection-objects-arrays-and-dictionaries"></a>Коллекция объектов (массивов и словарей)

Коллекция — это группа объектов одного типа, например коллекцию `Customer` объекты из базы данных. ASP.NET содержит множество встроенных коллекций, таких как `Request.Files` коллекции.

Вы будете часто работать с данными в коллекциях. Двумя распространенными типами коллекции являются *массива* и *словарь*. Массив полезно в том случае, если вы хотите хранить коллекции схожих элементов, но не требуется создавать отдельную переменную для хранения каждого элемента:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample52.vbhtml)]

Для массивов объявить определенный тип данных, например `String`, `Integer`, или `DateTime`. Чтобы указать, что переменная может содержать массив, добавьте круглые скобки в имени переменной в объявлении (такие как `Dim myVar() As String`). Вы может обращаться к элементам в массиве с помощью их положение (индекс) или с помощью `For Each` инструкции. Массив индексов (с нуля) являются &#8212; то есть первый элемент находится в позиции 0, второй элемент находится в позиции 1 и т. д.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample53.vbhtml)]

Можно определить количество элементов в массиве, получив ее `Length` свойство. Для получения позиции указанного элемента в массиве (то есть, для поиска массива), используйте `Array.IndexOf` метод. Можно также сделать таких вещей, как обратное содержимое массива ( `Array.Reverse` метод) или Сортировка содержимого ( `Array.Sort` метода).

В результате выполнения массива строка-код, отображаемый в браузере.

![Razor Img13](introducing-razor-syntax-vb/_static/image13.jpg)

Словарь — это коллекция пар ключ/значение, которое необходимо ввести ключ (или имя), чтобы задать или получить соответствующее значение:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample54.vbhtml)]

Для создания словаря, используйте `New` ключевое слово, чтобы указать, что вы создаете новый `Dictionary` объекта. Можно присвоить переменной с помощью словаря `Dim` ключевое слово. Указывать типы данных элементов в словаре, с помощью скобок ( `( )` ). В конце объявления необходимо добавить другую пару скобок, так как он фактически является методом, который создает новый словарь.

Для добавления элементов в словарь, можно вызвать `Add` метод переменной словаря (`myScores` в этом случае), а затем укажите ключ и значение. Кроме того можно использовать скобки для указания ключа и выполните простого присваивания, как показано в следующем примере:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample55.vbhtml)]

Чтобы получить значение из словаря, необходимо указать ключ в круглые скобки:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample56.vbhtml)]

## <a name="calling-methods-with-parameters"></a>Вызов методов с параметрами

Как было показано ранее в этой статье, объекты, которые можно программировать иметь методы. Например `Database` объекта может быть `Database.Connect` метод. Многие методы также иметь один или несколько параметров. Объект *параметр* — значение, которое можно передать в метод, чтобы включить этот метод для выполнения необходимых задач. Например, рассмотрим объявление для `Request.MapPath` метод, который принимает три параметра:

[!code-vb[Main](introducing-razor-syntax-vb/samples/sample57.vb)]

Этот метод возвращает физический путь на сервере, соответствующий указанному виртуальному пути. Три параметра для метода `virtualPath`, `baseVirtualDir`, и `allowCrossAppMapping`. (Обратите внимание, что в объявлении, с типами данных данные, которые они примете перечисляются параметры). При вызове этого метода необходимо указать значения для всех трех параметров.

Если вы используете Visual Basic с синтаксисом Razor, есть два способа передачи параметров для метода: *позиционные параметры* или *именованных параметров*. Чтобы вызвать метод, с помощью позиционные параметры, параметры передаются в строгом порядке, который указан в объявлении метода. (Вы обычно будет этот порядок документации для метода.) Вы должны следовать в порядке и не могут пропускаться какие-либо параметры &#8212; При необходимости можно передать пустую строку (`""`) или значение null для позиционного параметра, которое не имеет значения для.

В следующем примере предполагается, имеется папка с именем *сценариев* на веб-сайте. Этот код вызывает `Request.MapPath` метод и передает значения для трех параметров в правильном порядке. Затем отображается путь к результирующему сопоставленных.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample58.vbhtml)]

Если существует много параметров для метода, можно сохранить код более гладким и удобочитаемым с помощью именованных параметров. Для вызова метода с именованными параметрами, укажите имя параметра, за которым следует `:=` и введите значение. Преимуществом именованных параметров является, можно добавить их в любом порядке, необходимом. (Недостатком является вызов метода не является максимально компактными.)

В следующем примере вызывается тот же метод, как описано выше, но использует именованные параметры для указания значений:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample59.vbhtml)]

Как видите, параметры передаются в другом порядке. Однако при выполнении предыдущего примера и в этом примере будет возвращать то же значение.

## <a name="handling-errors"></a>Обработка ошибок

### <a name="try-catch-statements"></a>Операторы Try-Catch

У вас будет часто инструкций в коде, может произойти сбой по причинам вне элемента управления. Пример:

- Если ваш код пытается открыть, создание, чтение или запись в файл, все виды ошибки могут возникать. Возможно, необходимый файл не существует, может быть заблокирован, код может не иметь разрешения и так далее.
- Аналогичным образом Если код пытается выполнить обновления записей в базе данных, могут быть проблемы с разрешениями, подключения к базе данных могут отбрасываться, для сохранения данных может быть недопустимым и т. д.

С точки зрения программирования, называются таких ситуациях *исключения*. Если код возникает исключение, он создает (создается исключение) сообщения об ошибке таким образом, в лучшем случае раздражающих для пользователей.

![Razor Img14](introducing-razor-syntax-vb/_static/image14.jpg)

В ситуациях, когда ваш код может обнаружить исключения, а также во избежание сообщения об ошибках этого типа можно использовать `Try/Catch` инструкции. В `Try` инструкции, запустите код, который выполняется проверка. В одном или нескольких `Catch` инструкций, можно осуществлять поиск конкретных ошибок (определенные типы исключений), которые могли возникнуть. Можно включить столько `Catch` инструкциях, как вы должны выполнять поиск ошибок, которые планирование.

> [!NOTE]
> Рекомендуется избегать использования `Response.Redirect` метод в `Try/Catch` инструкции, так как оно может вызвать исключение, на странице.


Пример страницы, которая создает текстовый файл на первый запрос и затем отображает кнопку, которая позволяет пользователю открыть файл. В примере намеренно используется недопустимое имя файла, чтобы он вызовет исключение. Код включает `Catch` инструкции для двух возможных исключений: `FileNotFoundException`, это происходит, если имя файла недопустимо, и `DirectoryNotFoundException`, это происходит, если ASP.NET даже не удается найти папку. (Вы можете Раскомментировать инструкции в примере чтобы увидеть, как он выполняется, если все работает правильно.)

Если код не обрабатывает исключение, вы увидите страницу ошибки, как и на предыдущем снимке экрана. Однако `Try/Catch` раздел помогает предотвратить пользователю просматривать эти типы ошибок.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample60.vbhtml)]

## <a name="additional-resources"></a>Дополнительные ресурсы

### <a name="reference-documentation"></a>Справочная документация

- [ASP.NET](https://msdn.microsoft.com/library/ee532866.aspx)
- [Язык Visual Basic](https://msdn.microsoft.com/library/2x7h1hfk.aspx)
