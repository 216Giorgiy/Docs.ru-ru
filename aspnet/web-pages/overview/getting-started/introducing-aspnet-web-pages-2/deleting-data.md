---
uid: web-pages/overview/getting-started/introducing-aspnet-web-pages-2/deleting-data
title: "Введение в ASP.NET Web Pages — удаление базы данных | Документы Microsoft"
author: tfitzmac
description: "Этого учебника показано, как удалить запись отдельной базы данных. Предполагается, что завершена ряда через обновление базы данных в ASP.NET Web АП..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/28/2015
ms.topic: article
ms.assetid: 75b5c1cf-84bd-434f-8a86-85c568eb5b09
ms.technology: dotnet-webpages
ms.prod: .net-framework
msc.legacyurl: /web-pages/overview/getting-started/introducing-aspnet-web-pages-2/deleting-data
msc.type: authoredcontent
ms.openlocfilehash: aef31b6170cc3bba2421eb8c2c41e83aadc129c5
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="introducing-aspnet-web-pages---deleting-database-data"></a>Введение в ASP.NET Web Pages — удаление базы данных
====================
по [Tom FitzMacken](https://github.com/tfitzmac)

> Этого учебника показано, как удалить запись отдельной базы данных. Предполагается, что завершена ряда через [обновление базы данных в веб-страниц ASP.NET](https://go.microsoft.com/fwlink/?LinkId=251583).
> 
> Что вы узнаете следующее.
> 
> - Как выбрать отдельную запись из списка записей.
> - Как удалить одну запись из базы данных.
> - Как проверить, что определенные нажатие кнопки в форме.
>   
> 
> Обсуждаются функции и технологии:
> 
> - `WebGrid` Вспомогательные.
> - SQL `Delete` команды.
> - `Database.Execute` Метод для выполнения SQL `Delete` команды.


## <a name="what-youll-build"></a>Что мы создадим

В предыдущем учебнике вы узнали, как обновить существующую запись базы данных. Этот учебник аналогичен за исключением того, вместо обновления записи, вы удалите его. Процессы, так же, за исключением того, что удаление проще, таким образом, этот учебник короткий.

В *фильмов* страницы, будет обновлена `WebGrid` вспомогательный, потому что он отображается как **удалить** ссылку рядом с каждой фильм, сопровождающее **изменить** ссылку, добавленный ранее.

![Страница фильмы ссылки для каждого фильма](deleting-data/_static/image1.png)

Как и в случае изменения, при нажатии кнопки **удалить** , его ссылке на другую страницу, где сведения о фильмах уже находится в форме:

![Удалить страницу фильмов с фильмом отображается](deleting-data/_static/image2.png)

Можно затем нажмите кнопку для удаления записи без возможности восстановления.

## <a name="adding-a-delete-link-to-the-movie-listing"></a>Добавление ссылки в описание фильма

Начните с добавления **удаление** связать `WebGrid` вспомогательный. Эта ссылка аналогичен **изменить** ссылку, добавленный в предыдущем учебнике.

Откройте *Movies.cshtml* файла.

Изменение `WebGrid` разметки в теле страницы путем добавления столбца. Ниже приведен измененный разметки.

[!code-html[Main](deleting-data/samples/sample1.html?highlight=9-10)]

Новый столбец является следующим:

[!code-html[Main](deleting-data/samples/sample2.html)]

Конфигурации сетки **изменить** столбцов в крайнее левое положение в сетке и **удалить** столбец справа. (Отсутствует запятая после `Year` столбец, в случае, если не заметила,.) Нет ничего особенного куда этих столбцов связь, а так же легко можно поместить их рядом друг с другом. В этом случае они отдельные усложнить их смешанным.

![Страница фильмы со ссылками на изменения и сведения о отмечена для отображения, если они не рядом друг с другом](deleting-data/_static/image3.png)

Новый столбец отображается ссылка (`<a>` элемент), текст которых говорится «Delete». Целевого объекта ссылки (его `href` атрибут) — код, который разрешается нечто похожее на этот URL-адрес с `id` значение отличается для каждого фильма:

[!code-css[Main](deleting-data/samples/sample3.css)]

Эта ссылка будет вызывать страницу с именем *DeleteMovie* и передать ему идентификатор фильма, вы выбрали.

Этот учебник не будет подробно создание эту ссылку, так как он является практически идентичен **изменить** ссылку из предыдущего учебника ([обновление базы данных в веб-страниц ASP.NET](https://go.microsoft.com/fwlink/?LinkId=251583)).

## <a name="creating-the-delete-page"></a>Создание страницы удаления

Теперь можно создать страницу, которая будет целевой для **удалить** ссылку в сетке.

> [!NOTE] 
> 
> **Важные** метод сначала выберите запись для удаления, а затем с помощью отдельной странице и кнопки, для подтверждения процесса крайне важно для безопасности. Как вы прочитали в предыдущих учебниках, делая *любой* изменений на веб-сайт должен *всегда* сделать с помощью формы &mdash; то есть с использованием операция HTTP POST. Если была создана, можно изменить только по ссылке (с использованием операции GET) на сайте, люди может делать простые запросы к веб-узла и удалять данные. Даже поисковой системой, индексацию случайно может вызвать удаление данных только по следующим ссылкам.
> 
> Приложение позволяет изменять записи пользователей, необходимо предлагать пользователю запись для редактирования в любом случае. Однако может возникнуть искушение, чтобы пропустить этот шаг для удаления записи. Однако не пропускайте этот шаг. (Это также полезно просмотреть записи и убедитесь, что они удалить запись, они предназначены для пользователей.)
> 
> В последующих наборе учебника вы увидите Добавление функции входа в систему, поэтому пользователю необходимо выполнить вход перед удалением записи.


Создайте страницу с именем *DeleteMovie.cshtml* и замените в файле следующей разметкой:

[!code-cshtml[Main](deleting-data/samples/sample4.cshtml)]

Эта разметка аналогичен *EditMovie* страниц, за исключением того, вместо того чтобы использовать текстовые поля (`<input type="text">`), включает разметку `<span>` элементов. Нет ничего здесь, чтобы изменить. Все, что нужно сделать — отображать сведения о фильме так, чтобы пользователи могут убедиться, что они удаления правой фильма.

Разметка уже содержит ссылку, которая дает пользователю возможность вернуться к странице список фильмов.

Как и в *EditMovie* страницы — идентификатор выбранного фрагмента хранится в скрытом поле. (Оно передается на страницу в первую очередь как значение строки запроса.) Отсутствует `Html.ValidationSummary` вызова, который будет отображать ошибки проверки. В этом случае ошибка может быть что идентификатор фильма не был передан на страницу или что идентификатор фильма является недопустимым. Эта ситуация может возникнуть, если кто-то выполнена эту страницу без выбора фильма в *фильмов* страницы.

Подписи кнопки — **удалить фильма**, и его имя атрибута задано значение `buttonDelete`. `name` Атрибут будет использоваться в коде для обозначения кнопки отправки формы.

Вам придется написать код 1) прочитать сведения о фильме при первом отображении страницы и (2) фактическое удаление фильм, когда пользователь нажимает кнопку.

## <a name="adding-code-to-read-a-single-movie"></a>Добавление кода для чтения одной фильма

В верхней части *DeleteMovie.cshtml* добавьте следующий блок кода:

[!code-cshtml[Main](deleting-data/samples/sample5.cshtml)]

Эта разметка совпадает со значением соответствующий код в *EditMovie* страницы. Он возвращает идентификатор фильма вне строки запроса и использует идентификатор прочитать запись из базы данных. Код включает проверку (`IsInt()` и `row != null`) и убедитесь в допустимый идентификатор фильма, передаваемые на странице.

Помните, что этот код следует запускать только при первом запуске запуске страницы. Вы не хотите повторно чтения записи фильма из базы данных, когда пользователь щелкает **удалить фильма** кнопки. Таким образом, код для чтения фильма находится внутри тест, который говорит `if(!IsPost)` &mdash; именно *Если запрос не операцию post (отправки формы)*.

## <a name="adding-code-to-delete-the-selected-movie"></a>Добавление кода для удаления выбранного фрагмента

Чтобы удалить фильм, когда пользователь нажимает кнопку, добавьте следующий код внутри закрывающую скобку `@` блока:

[!code-csharp[Main](deleting-data/samples/sample6.cs)]

Данный пример кода является код для обновления существующей записи, но проще. Код выполняется по сути SQL `Delete` инструкции.

 Как и в *EditMovie* страницы, код находится в `if(IsPost)` блока. На этот раз `if()` немного сложнее условия: 

[!code-csharp[Main](deleting-data/samples/sample7.cs)]

Есть две причины здесь. Во-первых, что идет отправка страницы, как вы уже видели &mdash; `if(IsPost)`.

Второе: `!Request["buttonDelete"].IsEmpty()`, это означает, что запрос содержит объект с именем `buttonDelete`. Конечно он является косвенным способом тестирования, какая кнопка отправки формы. Если форма содержит несколько кнопок отправки, в запросе отображается только имя кнопки, которая была нажата. Таким образом, логически Если имя конкретной кнопки отображается в запросе &mdash; или как указано в коде, если эта кнопка не является пустым &mdash; , при нажатии кнопки отправки формы.

`&&` Оператор означает «и» (логическое и). Поэтому вся `if` условие...

*Этот запрос создан post (не первого запроса)*  
  
 AND  
  
** `buttonDelete` *Была кнопка кнопки, которая отправки формы.*

Эта форма (на самом деле, эта страница) содержит только одну кнопку, поэтому дополнительные тестовые для `buttonDelete` технически не является обязательным. Тем не менее которое вы собираетесь выполнить операцию, которая приведет к окончательному удалению данных. Поэтому требуется, убедитесь, что максимально выполняемой операции, только в том случае, когда пользователь явно запрашивает его. Например предположим, позже развернуть эту страницу и добавить к нему другие кнопки. Даже в таком случае будет выполняться только в том случае, если код, который удаляет фильма `buttonDelete` была нажата кнопка.

Как и в *EditMovie* можно получить идентификатор из скрытого поля и затем выполнить команду SQL. Синтаксис `Delete` инструкции:

`DELETE FROM table WHERE ID = value`

Крайне важно, чтобы включить `WHERE` предложения и идентификатора. Если опустить предложение WHERE *будут удалены все записи в таблице*. Как видно, передается значение идентификатора команды SQL с помощью заполнителя.

## <a name="testing-the-movie-delete-process"></a>Тестирование процесс удаления фильма

Теперь можно протестировать. Запустите *фильмов* и нажмите кнопку **удалить** рядом с фильма. Когда *DeleteMovie* страницу, нажмите кнопку **удалить фильма**.

![Удалить страницу фильма с выделенной кнопкой Удалить фильма](deleting-data/_static/image4.png)

При нажатии кнопки код удаляет фильмы и возвращает список фильмов. Существует поиск удаленные фильма и убедитесь, что оно будет удалено.

## <a name="coming-up-next"></a>В ближайшее время

Далее учебника показано, как получить все страницы на сайте общий внешний вид и макет.

## <a name="complete-listing-for-movie-page-updated-with-delete-links"></a>Полный пример для страницы фильма (со ссылками удалить последнее обновление)

[!code-cshtml[Main](deleting-data/samples/sample8.cshtml)]

## <a name="complete-listing-for-deletemovie-page"></a>Полный пример для DeleteMovie страницы

[!code-cshtml[Main](deleting-data/samples/sample9.cshtml)]

## <a name="additional-resources"></a>Дополнительные ресурсы

- [Введение в программирование веб-ASP.NET с синтаксисом Razor](https://go.microsoft.com/fwlink/?LinkID=202890)
- [Инструкция DELETE SQL](http://www.w3schools.com/sql/sql_delete.asp) на сайте W3Schools

>[!div class="step-by-step"]
[Назад](updating-data.md)
[Вперед](layouts.md)
