---
uid: web-pages/overview/security/enabling-login-from-external-sites-in-an-aspnet-web-pages-site
title: Вход с использованием внешних сайтов в ASP.NET Web Pages сайта (Razor) | Документы Microsoft
author: tfitzmac
description: В этой статье объясняется, как выполнить вход на сайт веб-страниц ASP.NET (Razor), используя Facebook, Google, Twitter, Yahoo и других сайтов, то есть, как обеспечить поддержку...
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/21/2014
ms.topic: article
ms.assetid: ef852096-a5bf-47b3-9945-125cde065093
ms.technology: dotnet-webpages
ms.prod: .net-framework
msc.legacyurl: /web-pages/overview/security/enabling-login-from-external-sites-in-an-aspnet-web-pages-site
msc.type: authoredcontent
ms.openlocfilehash: 47d15686194b15b7b06a99d63125c19a41f91ed9
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
ms.locfileid: "26530173"
---
<a name="logging-in-using-external-sites-in-an-aspnet-web-pages-razor-site"></a>Вход с использованием внешних сайтов в веб-страницы (Razor) узла ASP.NET
====================
по [Tom FitzMacken](https://github.com/tfitzmac)

> В этой статье объясняется, как выполнить вход на сайт веб-страниц ASP.NET (Razor), используя Facebook, Google, Twitter, Yahoo и других сайтов — то есть, как обеспечить поддержку OAuth и OpenID в веб-узла.
> 
> Что вы узнаете следующее.
> 
> - Как включить имя входа с других узлов при использовании шаблона WebMatrix начального сайта.
> 
> Это функция ASP.NET, представленные в статье:
> 
> - `OAuthWebSecurity` Вспомогательные.
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a>Версии программного обеспечения, используемая в этом учебнике
> 
> 
> - Веб-страниц ASP.NET (Razor) 2
> - WebMatrix 3

Веб-страниц ASP.NET включает поддержку [OAuth](http://oauth.net/) и [OpenID](http://openid.net/) поставщиков. С помощью этих поставщиков, можно позволить пользователям входить на сайт с помощью существующих учетных данных от Facebook, Twitter, корпорация Майкрософт и Google. Например выполнить вход с использованием учетной записи Facebook, пользователи так же можно выбрать значок Facebook, который перенаправляет их на страницу входа в Facebook, которой требуется ввести учетные данные. Их можно связать имя входа Facebook с помощью учетной записи на узле. Улучшение для функции членства веб-страницы –, пользователи могут связать несколько учетных записей (в том числе имена входа из сайты социальных сетей), использовать одну учетную запись на веб-сайте.

На данном рисунке показан на страницу входа из **начального сайта** шаблона, где пользователь сможет выбирать значок, Facebook, Twitter, Google или Microsoft, чтобы включить вход внешнюю учетную запись:

![внешних поставщиков](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/_static/image1.png)

Можно включить членство OAuth и OpenID Раскомментировать несколько строк кода в **начального сайта** шаблона. Методы и свойства, которые позволяют работать с OAuth и OpenID поставщики находятся в `WebMatrix.Security.OAuthWebSecurity` класса. **Начального сайта** шаблон включает в себя инфраструктуры полнофункционального членства, со страницы входа, база данных членства и весь код необходимо разрешить пользователям входить на сайт, используя учетные данные локального или из другого сайта .

В этом разделе приведен пример того, как разрешить пользователям входить в систему с внешних сайтов с сайтом, на основе **начального сайта** шаблона. После создания начального сайта, выполните (выполните подробные сведения):

- Для узлов, использующих поставщик OAuth (Facebook, Twitter и Microsoft) создать приложение на внешние веб-узле. Этот метод позволяет приложения ключи, необходимые для вызова компонента имени входа для этих сайтов.
- Для узлов, использующих поставщик OpenID (Google) у вас для создания приложения. Все эти веб-сайты необходимо настроить учетную запись для входа и создавать приложения для разработчиков.

    > [!NOTE]
    > Приложения Майкрософт только принимает динамической URL-адрес для работающего веб-сайта, поэтому нельзя использовать URL-адрес локального веб-сайта для тестирования имена входа.
- Изменение нескольких файлов веб-сайта для отправки на сайт, который вы хотите использовать имя входа и задайте поставщика проверки подлинности.

В этой статье приведены отдельные инструкции для выполнения следующих задач:

- [Включение входа Google](#To_enable_Google_logins)
- [Включение входа Facebook](#To_enable_Facebook_logins)
- [Включение входа Twitter](#To_enable_Twitter_logins)

<a id="To_enable_Google_logins"></a>
## <a name="enabling-google-logins"></a>Включение входа Google

1. Создайте или откройте узел веб-страниц ASP.NET, который основан на шаблоне начального сайта WebMatrix.
2. Откройте  *\_AppStart.cshtml* страницы и раскомментируйте следующую строку кода. 

    [!code-css[Main](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/samples/sample1.css)]

### <a name="testing-google-login"></a>Тестирование имя входа Google

1. Запустите *default.cshtml* страницы веб-узла и выберите **вход** кнопки.
2. На *входа* страницы в **используется другой службой для входа в** выберите либо **Google** или **Yahoo** кнопка отправки. В этом примере используется имя входа Google. 

    Веб-страница перенаправляет запрос на страницу входа Google.

    ![Вход Google](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/_static/image2.png)
3. Введите учетные данные существующей учетной записи Google.
4. Если Google вопросом, следует ли разрешить *Localhost* использовать информацию из учетной записи, нажмите кнопку **Разрешить**.

    Код проверки подлинности пользователя с помощью токена Google и возвращается на эту страницу на веб-сайте. Эта страница позволяет связать с существующей учетной записи на веб-сайте своего имени входа Google или они могут зарегистрировать новую учетную запись на сайте, связываемый с внешнее имя входа.

    ![OAuth 5](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/_static/image3.png)
5. Выберите **связать** кнопки. Браузер возвращается на домашней странице приложения.

<a id="To_enable_Facebook_logins"></a>
## <a name="enabling-facebook-logins"></a>Включение входа Facebook

1. Последовательно выберите пункты [сайт разработчиков Facebook](https://developers.facebook.com/apps) (вход, если вы еще не вошли).
2. Выберите **создать новое приложение** кнопку, а затем следуйте инструкциям на экране, чтобы задать имя и создать новое приложение.
3. В разделе **выберите интеграции приложения с Facebook**, выберите **веб-сайт** раздела.
4. Заполните **URL-адрес сайта** поле URL-адрес веб-узла (например, `http://www.example.com`). **Домена** поле является необязательным; это можно использовать для проверки подлинности для всего домена (например, *example.com*). 

    > [!NOTE]
    > При выполнении на локальном компьютере с URL-адрес сайта, например `http://localhost:12345` (где номер является номером локального порта), можно добавить это значение, чтобы **URL-адрес сайта** для тестирования веб-узла. Однако каждый раз номер порта изменения локального узла, будет необходимо обновить **URL-адрес сайта** поле приложения.
5. Выберите **сохранить изменения** кнопки.
6. Выберите **приложений** вкладку еще раз, а затем просмотрите начальную страницу для приложения.
7. Копировать **идентификатор приложения** и **секрет приложения** значения для вашего приложения и вставьте их в временного текстового файла. Вы передаете эти значения к поставщику Facebook в коде веб-сайта.
8. Выйдите из сайта разработчика Facebook.

Теперь внесении изменений на две страницы веб-сайта, чтобы пользователи смогут войти на сайт, используя учетную запись Facebook.

1. Создайте или откройте узел веб-страниц ASP.NET, который основан на шаблоне начального сайта WebMatrix.
2. Откройте  *\_AppStart.cshtml* страницы и раскомментируйте код для поставщика Facebook OAuth. Блок uncommented кода выглядит следующим образом: 

    [!code-csharp[Main](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/samples/sample2.cs)]
3. Копировать **идентификатор приложения** значение из приложения Facebook в качестве значения `appId` параметра (внутри кавычек).
4. Копировать **секрет приложения** значение из приложения Facebook в качестве `appSecret` значение параметра.
5. Сохраните и закройте файл.

### <a name="testing-facebook-login"></a>Проверка имени входа Facebook

1. Запустите на сайте *default.cshtml* странице и выберите **входа** кнопки.
2. На *входа* страницы в **используется другой службой для входа в** выберите **Facebook** значок. 

    Веб-страница перенаправляет запрос на страницу входа в Facebook.

    ![OAuth 2](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/_static/image4.png)
3. Войдите в учетную запись Facebook. 

    Код использует маркер Facebook для проверки подлинности пользователя и затем возвращает страницы, где можно связать имя входа Facebook с именем входа веб-узла. Адрес электронной почты пользователя заполняется в **электронной почты** поля в форме.

    ![OAuth 5](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/_static/image5.png)
4. Выберите **связать** кнопки. 

    Вы вошли в браузере возвращает на домашнюю страницу

<a id="To_enable_Twitter_logins"></a>
## <a name="enabling-twitter-logins"></a>Включение входа Twitter

1. Перейдите к [сайт разработчиков Twitter](https://dev.twitter.com/).
2. Выберите **создать приложение** связь, а затем войдите на сайт.
3. На **создать приложение** форме, заполните **имя** и **описание** поля.
4. В **веб-сайт** введите URL-адрес веб-узла (например, `http://www.example.com`). 

    > [!NOTE]
    > Если вы тестируете веб-узла локально (с помощью URL-адрес: `http://localhost:12345`), Twitter, не может принимать URL-адрес. Тем не менее, можно будет использовать локальный петлевой IP-адрес (например `http://127.0.0.1:12345`). Это упрощает процесс тестирования приложения локально. Однако каждый раз при изменении номера порта на локальный сайт, необходимо будет обновить **веб-сайт** поле приложения.
5. В **URL-адрес обратного вызова** введите URL-адрес для страницы в веб-сайта, будет отображаться для возвращения к после входа в Twitter. Например, чтобы перенаправить пользователей на домашней странице начального узла (который распознает их состояние вошедшего в систему), введите же URL-адреса, введенного в **веб-сайт** поля.
6. Принять условия соглашения и выбрать **создания приложения Twitter** кнопки.
7. На **Мои приложения** целевой страницы, выберите приложение, вы создали.
8. На **сведения** , прокрутите вниз и выберите **создать токен доступа Мой** кнопки.
9. На **сведения** вкладки, скопируйте **ключ потребителя** и **секрет пользователя** значения для вашего приложения и вставьте их в временного текстового файла. В коде веб-сайт будет передачи этих значений для поставщика Twitter.
10. Выйдите из сайта Twitter.

Теперь можно внести изменения две страницы в веб-сайта, чтобы пользователи смогут Войдите на сайт, используя учетную запись Twitter.

1. Создайте или откройте узел веб-страниц ASP.NET, который основан на шаблоне начального сайта WebMatrix.
2. Откройте  *\_AppStart.cshtml* страницы и раскомментируйте код для поставщика Twitter OAuth. Блок uncommented кода выглядит следующим образом: 

    [!code-csharp[Main](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/samples/sample3.cs)]
3. Копировать **ключ потребителя** значение из приложения Twitter в качестве значения `consumerKey` параметра (внутри кавычек).
4. Копировать **секрет пользователя** значение из приложения Twitter в качестве значения `consumerSecret` параметра.
5. Сохраните и закройте файл.

### <a name="testing-twitter-login"></a>Тестирование входа Twitter

1. Запустите *default.cshtml* страницы веб-узла и выберите **входа** кнопки.
2. На *входа* страницы в **используется другой службой для входа в** выберите **Twitter** значок. 

    Веб-страница перенаправляет запрос на страницу входа для приложения, которое вы создали Twitter.

    ![OAuth 4](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/_static/image6.png)
3. Войдите в учетную запись Twitter.
4. Код использует маркер Twitter для проверки подлинности пользователя и последующий возврат на страницу можно связать имя входа с учетной записью веб-сайта. Ваш адрес электронной почты будет заполняться в **электронной почты** поля в форме.

    ![OAuth 5](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/_static/image7.png)
5. Выберите **связать** кнопки. 

    Вы вошли в браузере возвращает на домашнюю страницу

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a>Дополнительные ресурсы


- [Настройка поведения сайта](https://go.microsoft.com/fwlink/?LinkId=202906)
- [Добавление безопасности и членство в веб-страниц сайта ASP.NET](https://go.microsoft.com/fwlink/?LinkID=202904)
