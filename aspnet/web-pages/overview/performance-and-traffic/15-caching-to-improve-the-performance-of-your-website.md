---
uid: web-pages/overview/performance-and-traffic/15-caching-to-improve-the-performance-of-your-website
title: "Кэширования данных в ASP.NET Web Pages (Razor) сайта для повышения производительности | Документы Microsoft"
author: tfitzmac
description: "Можно ускорить, веб-сайта, установив хранения — то есть кэш - результаты, как правило, может потребоваться значительное время для получения и обработки данных..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/14/2014
ms.topic: article
ms.assetid: 961e525b-7700-469e-8a68-d7010b6fb68c
ms.technology: dotnet-webpages
ms.prod: .net-framework
msc.legacyurl: /web-pages/overview/performance-and-traffic/15-caching-to-improve-the-performance-of-your-website
msc.type: authoredcontent
ms.openlocfilehash: c747fef33a6d1db19f09fd0303c47d689b956687
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="caching-data-in-an-aspnet-web-pages-razor-site-for-better-performance"></a>Кэширование данных в веб-страницы (Razor) узле ASP.NET для повышения производительности
====================
по [Tom FitzMacken](https://github.com/tfitzmac)

> В этой статье описывается использование вспомогательного кэширования данных для повышения производительности веб-сайте ASP.NET Web Pages (Razor). Веб-сайта можно ускорить, установив хранилища &#8212; то есть, кэш &#8212; Результирующие данные, обычно будет занимать много времени, получения и обработки и, не изменяйте.
> 
> **Что вы узнаете следующее.** 
> 
> - Как использовать кэширование повысить скорость реагирования веб-сайта.
> 
> Существуют следующие функции ASP.NET, представленные в статье:
> 
> - `WebCache` Вспомогательные.
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a>Версии программного обеспечения, используемая в этом учебнике
> 
> 
> - Веб-страниц ASP.NET (Razor) 3
>   
> 
> Этот учебник также работает с веб-страницы ASP.NET 2.


Каждый раз, кто-то запрашивает страницу с веб-узла, на веб-сервер должен выполнить ряд действий, чтобы выполнить запрос. Для некоторых веб-страниц сервер может потребоваться выполнение задачи, которые слишком долго (сравнительно), такие как извлечение данных из базы данных. Даже если эти задачи не принимают долго в абсолютном выражении, если большой объем трафика, весь ряд отдельных запросов, которые веб-сервер для выполнения сложной или медленно задачи могут привести к большой объем работы. В конечном счете это может повлиять на производительность сайта.

Для кэширования данных является одним из способов повышения производительности веб-сайта в условиях следующим образом. Если сайт получает повторных запросов той же информации и данные изменены для каждого пользователя не требуется, а не время конфиденциальные вместо повторного выборка или повторное вычисление, можно выборки данных один раз и затем сохраните результаты. При очередном поступлении запроса для этого сведения его просто получить из кэша.

Как правило можно кэшировать сведения, которые изменяются редко. Сведения о поместить в кэш, сохраняется в памяти на веб-сервере. Можно указать, как долго он должен быть кэширован, с секунд до дней. По истечении период кэширования информация автоматически удаляется из кэша.

> [!NOTE]
> Записей в кэше может быть удалено в целях отличный от истечении допустимого срока. Например веб-сервер может временно нехватке памяти и он может освободить память в том числе путем создания исключения элементов из кэша. Как вы увидите, даже если касаться сведения в кэш, необходимо убедитесь, что это по-прежнему возможна при необходимости.


Представьте, что веб-сайт имеет страница, на которой отображается текущая температура и прогноз погоды. Чтобы получить такую информацию, может отправить запрос к внешней службе. Поскольку эти сведения не сильно (за период времени два часа, например) изменились, и, поскольку внешних вызовов требуется время и пропускной способности, он хорошо подходит для кэширования.

## <a name="adding-caching-to-a-page"></a>Добавление кэширования на страницу

В ASP.NET есть `WebCache` помощник, который позволяет легко добавить кэширование на узел и добавить данные в кэш. В этой процедуре вы создадите страницы, который кэширует текущее время. Эта конфигурация не реального примера, поскольку текущее время — это то, часто изменяются, и, кроме того не сложно рассчитать. Тем не менее это хороший способ продемонстрировать, кэширование в действии.

1. Добавление новой страницы с именем *WebCache.cshtml* на веб-сайт.
2. Добавьте следующий код и разметку страницы:

    [!code-cshtml[Main](15-caching-to-improve-the-performance-of-your-website/samples/sample1.cshtml)]

    При кэшировании данных, можно поместить его в кэш, используя имя это уникален в пределах веб-сайта. В этом случае будет использоваться запись кэша с именем `CachedTime`. Это `cacheItemKey` показано в примере кода.

    Код сначала считывает `CachedTime` элемента кэша. Если возвращено значение (то есть, если элемент кэша не null), код просто устанавливает значение переменной времени для кэширования данных.

    Тем не менее если элемент кэша не существует (то есть оно равно null), код задает значение времени, добавляет его в кэш и задает значение срока действия в одну минуту. Запись кэша удаляются через одну минуту. (Значение по умолчанию срока действия для элемента в кэше — 20 минут). Команда `WebCache.Set(cacheItemKey, time, 1, false)` показано, как добавить текущее значение времени в кэш и его срок действия набора на 1 минуту. Установка *slidingExpiration* параметр `false` означает время истечения срока действия не обновляется при каждом запросе. Ее действия истекает ровно 1 минута после его добавления в кэш. Если это значение задано `true` истечения срока действия 1 минута сбрасывается при каждом запросе значения из кэша.

    Этот код иллюстрирует шаблон, который следует всегда использовать, когда данные кэша. Прежде чем что-либо получить из кэша, сначала всегда проверьте ли `WebCache.Get` метод вернул значение null. Помните, что возможно, истек срок действия записи кэша, или может быть удален по другой причине, поэтому любой определенной записи никогда не обязательно будут в кэше.
3. Запустите *WebCache.cshtml* в браузере. (Убедитесь, что выбран страницы **файлы** рабочей области, прежде чем запускать его.) При первом запросе страницы данных времени не находится в кэше, и код должен добавить значения времени в кэш.

    ![кэш-1](15-caching-to-improve-the-performance-of-your-website/_static/image1.jpg)
4. Обновить *WebCache.cshtml* в браузере. На этот раз данных времени находится в кэше. Обратите внимание, что время не изменилось со времени последнего просмотра страницы.

    ![кэш-2](15-caching-to-improve-the-performance-of-your-website/_static/image2.jpg)
5. Подождите одну минуту, чтобы кэш, чтобы быть пустым, а затем обновить страницу. Страницу еще раз указывает, что данные времени не был найден в кэше и время обновления добавляется в кэш.

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a>Дополнительные ресурсы


- [Отображение данных в диаграмме](https://go.microsoft.com/fwlink/?LinkId=202895)
- [Справочник по WebCache API](https://msdn.microsoft.com/en-us/library/system.web.helpers.webcache(v=vs.99).aspx) (MSDN)
