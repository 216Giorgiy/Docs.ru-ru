---
uid: web-pages/overview/ui-layouts-and-themes/4-working-with-forms
title: Работа с формами HTML на сайтах ASP.NET Web Pages (Razor) | Документы Microsoft
author: tfitzmac
description: Форма — раздел документа HTML размещения элементов входных данных пользователя, таких как текстовые поля, флажков, переключателей и раскрывающихся списков. Использование форм ч...
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/10/2014
ms.topic: article
ms.assetid: f3f4b8c8-e8f6-4474-ad94-69228a6c01ee
ms.technology: dotnet-webpages
ms.prod: .net-framework
msc.legacyurl: /web-pages/overview/ui-layouts-and-themes/4-working-with-forms
msc.type: authoredcontent
ms.openlocfilehash: 8579c444fd19d1a366349cc09f9f768de23055f8
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/10/2018
---
<a name="working-with-html-forms-in-aspnet-web-pages-razor-sites"></a>Работа с HTML-форм в ASP.NET веб-страницы (Razor) узлов
====================
по [Tom FitzMacken](https://github.com/tfitzmac)

> В этой статье описан процесс обработки HTML-форму (с текстовые поля и кнопки) при работе в веб-сайта ASP.NET Web Pages (Razor).
> 
> **Что вы узнаете следующее.** 
> 
> - Инструкции по созданию формы HTML.
> - Как выполнить чтение ввод данных пользователем из формы.
> - Способ проверки пользовательского ввода.
> - Как восстановить значения формы после отправки страницы.
> 
> Ниже перечислены ASP.NET программирования концепции, реализованные в статье:
> 
> - Объект `Request`.
> - Проверки входных данных.
> - HTML encoding.
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a>Версии программного обеспечения, используемая в этом учебнике
> 
> 
> - Веб-страниц ASP.NET (Razor) 3
>   
> 
> Этот учебник также работает с веб-страницы ASP.NET 2.


## <a name="creating-a-simple-html-form"></a>Создание простой HTML-формы

1. Создание нового веб-сайта.
2. В корневой папке создайте веб-страницы с именем *Form.cshtml* и вставьте следующую разметку:

    [!code-html[Main](4-working-with-forms/samples/sample1.html)]
3. Откройте страницу в браузере. (В WebMatrix в **файлы** рабочей области, щелкните правой кнопкой мыши файл, а затем выберите **запуск в браузере**.) Простая форма с тремя полями ввода и **отправить** отображается кнопка.

    ![Снимок экрана: три текстовых поля в форме.](4-working-with-forms/_static/image1.jpg)

    На этом этапе, если щелкнуть **отправить** кнопки ничего не происходит. Чтобы формы полезны, необходимо добавить некоторый код, который будет выполняться на сервере.

## <a name="reading-user-input-from-the-form"></a>Чтение входных данных пользователя в форме

Для обработки формы, добавьте код, который считывает значения полей, отправленных и какого-либо с ними. Эта процедура показано, как для чтения полей и отображать данные, введенные пользователем на странице. (В реальном приложении обычно производится более интересные действия с вводимыми пользователем данными. Вы сможете сделать, в статье о работе с базами данных.)

1. В верхней части *Form.cshtml* , введите следующий код:

    [!code-cshtml[Main](4-working-with-forms/samples/sample2.cshtml)]

    При первом запросе страницы, отображается только пустая форма. Пользователь (которая будет вы) должен заполнить форму и затем нажимает **отправить**. Это отправляет (POST) введенные пользователем данные на сервер. По умолчанию запрос переходит к той же странице (а именно, *Form.cshtml*).

    При этом время отправки страницы введенные значения отображаются над формы:

    ![Снимок экрана, показывающий значения, введенного отображаются на странице.](4-working-with-forms/_static/image2.jpg)

    Посмотрите на код для страницы. Сначала с помощью `IsPost` метод, чтобы определить, является ли страница отправляется &#8212; т.е., следует ли пользователь щелкнул **отправить** кнопки. Если это сообщение, `IsPost` возвращает значение true. Это стандартный способ веб-страницах ASP.NET, для определения, является ли вы работаете исходного запроса (запрос GET) или обратную передачу (запрос POST). (Дополнительные сведения о GET и POST, содержатся в боковой панели «HTTP GET и POST и IsPost Property» [введение в ASP.NET Web Pages программирование с использованием синтаксиса Razor](https://go.microsoft.com/fwlink/?LinkId=202890#SB_HttpGetPost).)

    Далее вы получаете значения, которые пользователь заполняется из `Request.Form` объекта и поместить их в переменные для использования в дальнейшем. `Request.Form` Объект содержит все значения, отправленные с данной страницей, каждый из которых идентифицируется по ключу. Ключ является эквивалентом `name` атрибута поля формы, которую требуется прочитать. Например, чтобы прочитать `companyname` поля (текстовое поле), можно использовать `Request.Form["companyname"]`.

    Значения формы хранятся в `Request.Form` объекта в виде строк. Таким образом при необходимости работать со значением как число, даты или другого типа, необходимо преобразовать его из строки в этот тип. В примере `AsInt` метод `Request.Form` используется для преобразования в целое значение поля сотрудников, (который содержит число сотрудников).
2. Откройте страницу в браузере, заполните поля формы и нажмите кнопку **отправить**. На странице отображается введенные значения.

> [!TIP] 
> 
> <a id="SB_HTMLEncoding"></a>
> ### <a name="html-encoding-for-appearance-and-security"></a>HTML-кодирование для внешнего вида и безопасности
> 
> HTML содержит специальные символы, такие как использование `<`, `>`, и `&`. Эти специальные знаки, где они не должны, они разрушить внешний вид и функциональные возможности веб-страницы. Например, браузер интерпретирует `<` символов (если за ним следует пробел) как начало элемента HTML, например `<b>` или `<input ...>`. Если браузер не распознает элемент, он просто отклоняет строке, которая начинается с `<` до достижения нечто, он снова распознает. Очевидно, что это может привести в некоторых странно визуализации на странице.
> 
> HTML-кодирования заменяет код, который браузеры интерпретируется как символ правильное следующих зарезервированных символов. Например `<` символ заменяется `&lt;` и `>` символ заменяется `&gt;`. Браузер отображает эти строки замены в виде символов, которые вы хотите просмотреть.
> 
> Рекомендуется использовать HTML-кодирование в любое время отображения строк (ввод), полученный от пользователя. Если этого не сделать, пользователь может попытаться получить веб-страницу для запуска вредоносный скрипт или выполнения других действий, компрометирующие безопасности веб-узла, или просто не предполагается. (Это особенно важно, если принимать входные данные пользователя, где-то хранить и отображения его в дальнейшем &#8212; так, как комментарий блога, просмотрите пользователя или нечто, похожее на.)
> 
> Можно избежать этих проблем, веб-страниц ASP.NET, автоматически кодирует в формате HTML текст содержимого, которые выходные данные из кода. Например, при отображении содержимого переменной или выражения, с помощью кода, например `@MyVar`, веб-страниц ASP.NET, автоматически кодирует выходные данные.


## <a name="validating-user-input"></a>Проверка пользовательского ввода

Пользователи делают ошибки. Попросите для заполнения поля и забудут это сделать, или попросите номера сотрудников и вместо этого введите имя. Чтобы убедиться в том, что формы был введен правильно перед его обработкой, проверьте входные данные пользователя.

Показано, как проверять все поля три формы, чтобы убедиться в том, что пользователь не оставить пустыми. Можно также проверить, что значение количества сотрудников является число. Если есть ошибки, как отображать ошибки сообщение о том, какие значения пользователь не прошел проверку.

1. В *Form.cshtml* файла, замените первый блок кода следующим кодом: 

    [!code-cshtml[Main](4-working-with-forms/samples/sample3.cshtml)]

    Проверка вводимых пользователем данных, используйте `Validation` вспомогательный. Зарегистрируйте обязательные поля, вызвав `Validation.RequireField`. Зарегистрируйте другими типами проверки путем вызова `Validation.Add` и указать поля для проверки и тип выполняемой проверки.

    При запуске страницы ASP.NET выполняет все необходимые проверки для вас. Результаты можно проверить путем вызова `Validation.IsValid`, возвращающий значение true, если все, что передается и значение false, если любое поле, не прошел проверку. Как правило, можно вызвать `Validation.IsValid` перед выполнением какой-либо обработки пользовательского ввода.
2. Обновление `<body>` элемент, добавив три вызова `Html.ValidationMessage` метод следующим образом:

    [!code-cshtml[Main](4-working-with-forms/samples/sample4.cshtml?highlight=8,13,18)]

    Для отображения сообщений об ошибках проверки, можно вызвать Html.`ValidationMessage` и передачи ей имени поля, которое требуется для сообщения.
3. Запустите страницу. Оставьте эти поля пустыми и нажмите кнопку **отправить**. Вы видите сообщения об ошибках.

    ![Снимок экрана, показывающий сообщения об ошибках, если ввод данных пользователем не проходит проверку.](4-working-with-forms/_static/image3.jpg)
4. Добавить строку (например, «ABC»), **Employee Count** поле и нажмите кнопку **отправить** еще раз. Это время, появится сообщение об ошибке, которое указывает, что строка не в правильном формате, а именно, целое число.

    ![Снимок экрана, показывающий сообщения об ошибках, если пользователи введите строку для поля сотрудников.](4-working-with-forms/_static/image4.jpg)

Веб-страницы ASP.NET предоставляет больше параметров для проверки введенных пользователем данных, включая возможность автоматически выполнять проверку с помощью клиентского скрипта, которая позволяет пользователям получать оперативно реагировать в браузере. В разделе [дополнительные ресурсы](#Additional_Resources) раздел позже для получения дополнительной информации.

## <a name="restoring-form-values-after-postbacks"></a>Восстановление значений формы после обратной передачи

При тестировании страницы в предыдущем разделе, вы могли заметить, при наличии ошибки проверки, все, что вы ввели (а не только недопустимые данные) был удален, и необходимо было повторно введите значения для всех полей. Это показывает, важно: при отправки страницы, обработать его и затем снова визуализации страницы странице создается заново с самого начала. Как видно, это означает, что теряются все значения, которые были на странице, когда оно было отправлено.

Это можно исправить, однако. У вас есть доступ к значениям, отправленные (в `Request.Form` объекта можно заполнять эти значения в поля формы при отображении страницы.

1. В *Form.cshtml* файла, замените `value` атрибуты `<input>` элементов с помощью `value` атрибут.: 

    [!code-cshtml[Main](4-working-with-forms/samples/sample5.cshtml?highlight=13,19,25)]

    `value` Атрибут `<input>` элементы ему было присвоено динамически считать значение из поля `Request.Form` объекта. При первом запросе страницы значения в `Request.Form` объекта пусты. Это нормально, так как в этом случае форма является пустым.
2. Откройте страницу в браузере, заполните поля формы или оставить пустыми и щелкните **отправить**. Отображается страница, на которой показано введенные значения.

    ![форм-5](4-working-with-forms/_static/image5.jpg)

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a>Дополнительные ресурсы

- [1001 способы получения входных данных из веб-пользователей](https://msdn.microsoft.com/library/ms971057.aspx)
- [С помощью форм и обработке ввода данных пользователем](https://msdn.microsoft.com/library/ms525182(VS.90).aspx)
- [Проверка пользовательского ввода на сайтах веб-страниц ASP.NET](https://go.microsoft.com/fwlink/?LinkId=253002)
- [Использование автозаполнения в HTML-формы](https://msdn.microsoft.com/library/ms533032(VS.85).aspx)
