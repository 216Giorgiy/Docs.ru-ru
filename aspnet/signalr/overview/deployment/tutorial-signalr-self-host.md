---
uid: signalr/overview/deployment/tutorial-signalr-self-host
title: "Учебник: SignalR резидентной | Документы Microsoft"
author: pfletcher
description: "Этот учебник показывает, как создание резидентной SignalR 2 сервера и способ подключения с помощью клиента JavaScript. Версии программного обеспечения, используемая в этом учебнике V..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/10/2014
ms.topic: article
ms.assetid: 400db427-27af-4f2f-abf0-5486d5e024b5
ms.technology: dotnet-signalr
ms.prod: .net-framework
msc.legacyurl: /signalr/overview/deployment/tutorial-signalr-self-host
msc.type: authoredcontent
ms.openlocfilehash: 997756ff8d48e41da981491d6154f3107ec7a051
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="tutorial-signalr-self-host"></a>Учебник: SignalR резидентной
====================
по [Патрик Флетчера](https://github.com/pfletcher)

[Загрузка завершенного проекта](http://code.msdn.microsoft.com/SignalR-Self-Host-Sample-6da0f383)

> Этот учебник показывает, как создание резидентной SignalR 2 сервера и способ подключения с помощью клиента JavaScript.
> 
> ## <a name="software-versions-used-in-the-tutorial"></a>Версии программного обеспечения, используемая в этом учебнике
> 
> 
> - [Visual Studio 2013](https://www.microsoft.com/visualstudio/eng/2013-downloads)
> - .NET 4.5
> - SignalR версии 2
>   
> 
> 
> ## <a name="using-visual-studio-2012-with-this-tutorial"></a>С помощью Visual Studio 2012 с помощью этого учебника
> 
> 
> Чтобы использовать Visual Studio 2012 с помощью этого учебника, выполните следующее:
> 
> - Обновление вашего [диспетчера пакетов](http://docs.nuget.org/docs/start-here/installing-nuget) до последней версии.
> - Установка [веб-установщика платформы](https://www.microsoft.com/web/downloads/platform.aspx).
> - Установщик веб-платформы для поиска и установки **ASP.NET и 2013.1 Web Tools для Visual Studio 2012**. Это будет установки Visual Studio шаблоны для SignalR классов, таких как **концентратора**.
> - Некоторые шаблоны (такие как **класс запуска OWIN**) будет недоступен; в этом случае используйте файл класса.
> 
> 
> ## <a name="questions-and-comments"></a>Вопросы и комментарии
> 
> Оставьте отзыв на том, как вам понравилось этого учебника и что можно улучшить в комментарии в нижней части страницы. Если у вас есть вопросы, которые не связаны непосредственно для работы с учебником, их можно разместить [форум по ASP.NET SignalR](https://forums.asp.net/1254.aspx/1?ASP+NET+SignalR) или [StackOverflow.com](http://stackoverflow.com/).


## <a name="overview"></a>Обзор

Сервер SignalR, как правило, размещенного в приложении ASP.NET в IIS, но также может быть резидентной (например консольное приложение или служба Windows) с помощью библиотеки резидентной. Эта библиотека, как и всех SignalR 2, основана на OWIN ([открыть веб-интерфейс .NET](http://owin.org)). OWIN определяет абстракцию между .NET веб-серверов и веб-приложений. OWIN разрывает связь веб-приложения с сервера, благодаря чему идеально подходит для размещения веб-приложения в свой собственный процесс, за пределами служб IIS на собственном сервере OWIN.

Не размещено в службах IIS причины:

- Средах, где IIS не доступен или желательно, такие как существующую ферму серверов без IIS.
- Производительность служб IIS необходимо избегать.
- Функциональные возможности SignalR — для добавления exising приложения, которое выполняется в службе Windows, рабочей роли Azure или другой процесс.

Если решение разработано как резидентного размещения для повышения производительности, рекомендуется также тестирования приложения, размещенные в IIS, для определения выигрыш в производительности.

Этот учебник содержит следующие разделы:

- [При создании сервера](#server)
- [Доступ к серверу с помощью клиента JavaScript](#js)

<a id="server"></a>

## <a name="creating-the-server"></a>При создании сервера

В этом учебнике вы создадите сервера, размещенного в консольном приложении, но сервер может размещаться в каких-либо процесса, таких как служба Windows или рабочей роли Azure. Образец кода для размещения сервера SignalR в службе Windows, см. [Self-Hosting SignalR в службе Windows](https://code.msdn.microsoft.com/SignalR-self-hosted-in-6ff7e6c3).

1. Откройте Visual Studio 2013 с правами администратора. Выберите **файл**, **новый проект**. Выберите **Windows** под **Visual C#** узел в **шаблоны** и выберите **консольное приложение** шаблона. Имя нового проекта «SignalRSelfHost» и нажмите кнопку **ОК**.

    ![](tutorial-signalr-self-host/_static/image1.png)
2. Откройте консоль диспетчера пакетов библиотеку, выбрав **средства**, **диспетчер пакетов библиотеки**, **консоль диспетчера пакетов**.
3. В консоли диспетчера пакетов введите следующую команду:

    [!code-powershell[Main](tutorial-signalr-self-host/samples/sample1.ps1)]

    Эта команда добавляет в проект библиотеки SignalR 2 Self-Host.
4. В консоли диспетчера пакетов введите следующую команду:

    [!code-powershell[Main](tutorial-signalr-self-host/samples/sample2.ps1)]

    Эта команда добавляет Microsoft.Owin.Cors библиотеки в проект. Эта библиотека будет использоваться для поддержки между доменами, необходимый для приложения, размещающие SignalR и веб-страницы клиента в разных доменах. Поскольку вы будете размещение сервера SignalR и веб-клиента по различным портам, это означает, что для связи между этими компонентами должен быть включен, между доменами.
5. Замените содержимое Program.cs кодом из этого примера.

    [!code-csharp[Main](tutorial-signalr-self-host/samples/sample3.cs)]

    Приведенный выше код включает в себя три класса:

    - **Программа**, в том числе **Main** метод определение первичного пути выполнения. В этом методе веб-приложения типа **запуска** запускаются по указанному URL-АДРЕСУ (`http://localhost:8080`). При необходимости безопасности на конечную точку SSL можно реализовать. В разделе [как: Настройка порта с SSL-сертификат](https://msdn.microsoft.com/en-us/library/ms733791.aspx) для получения дополнительной информации.
    - **При запуске**, класс, содержащий конфигурацию сервера SignalR (в этом учебнике используется только для таких конфигураций, это вызов `UseCors`) и вызов `MapSignalR`, в проекте, который создает маршруты для любых объектов концентратора.
    - **MyHub**, класс концентратора SignalR, приложение будет предоставлять клиентам. Этот класс содержит один метод, **отправки**, что клиенты будут вызывать для доставки сообщения на всех остальных подключенных клиентов.
6. Скомпилируйте и запустите приложение. Адрес, на котором выполняется сервер должно отображаться в окне консоли.

    ![](tutorial-signalr-self-host/_static/image2.png)
7. Если происходит сбой выполнения с исключением `System.Reflection.TargetInvocationException was unhandled`, вам потребуется перезапустить Visual Studio с правами администратора.
8. Остановите приложение перед переходом к следующему разделу.

<a id="js"></a>

## <a name="accessing-the-server-with-a-javascript-client"></a>Доступ к серверу с помощью клиента JavaScript

В этом разделе будет использование одного клиента JavaScript из [учебник по началу работы](../getting-started/tutorial-getting-started-with-signalr.md). Мы выполним только одно изменение на клиенте, который является явно задать URL-адрес концентратора. С резидентного приложения сервер может не обязательно на тот же адрес, URL-адрес подключения (из-за обратных прокси-серверов и подсистемы балансировки нагрузки), поэтому URL-адрес, необходимо явно определенных.

1. В **обозревателе решений**, щелкните правой кнопкой мыши решение и выберите **добавить**, **новый проект**. Выберите **Web** , а затем установите **веб-приложение ASP.NET** шаблона. Назовите проект «JavascriptClient» и нажмите кнопку **ОК**.

    ![](tutorial-signalr-self-host/_static/image3.png)
2. Выберите **пустой** шаблона и оставляет, остальные параметры не выбрано. Выберите **создания проекта**.

    ![](tutorial-signalr-self-host/_static/image4.png)
3. В консоли диспетчера пакетов, выберите проект «JavascriptClient» в **проекта по умолчанию** раскрывающийся список и выполните следующую команду:

    [!code-powershell[Main](tutorial-signalr-self-host/samples/sample4.ps1)]

    Эта команда устанавливает SignalR и JQuery библиотек, которые нужно в клиенте.
4. Щелкните правой кнопкой мыши проект и выберите пункт **добавить**, **новый элемент**. Выберите **Web** узел и выберите HTML-страницу. Назовите страницу **Default.html**.

    ![](tutorial-signalr-self-host/_static/image5.png)
5. Замените содержимое нового HTML-страницы с помощью следующего кода. Проверьте соответствие здесь ссылки на скрипты в папке «Сценарии» проекта сценариев.

    [!code-html[Main](tutorial-signalr-self-host/samples/sample5.html?highlight=31-32)]

    Следующий код (выделены в приведенном выше примере) является добавление, заданные для клиента, используемая в этом учебнике начало Stared (в дополнение к обновлению кода для SignalR бета-версия 2). Эта строка кода явно задает URL-адрес базового подключения для SignalR на сервере.

    [!code-javascript[Main](tutorial-signalr-self-host/samples/sample6.js)]
6. Щелкните правой кнопкой мыши решение и выберите **назначить запускаемые проекты...** . Выберите **несколько запускаемых проектов** переключатель и задайте обоим проектам **действия** для **запустить**.

    ![](tutorial-signalr-self-host/_static/image6.png)
7. Щелкните правой кнопкой мыши «Default.html» и выберите **задать в качестве начальной страницы**.
8. Запустите приложение. Будет запущен сервер и страницы. Возможно, потребуется перезагрузка веб-страницы (или выберите **Продолжить** в отладчике) при загрузке страницы до запуска сервера.
9. В браузере введите имя пользователя, при появлении запроса. Скопируйте URL-адрес страницы в другой вкладке или окне обозревателя и укажите другое имя пользователя. Можно отправлять сообщения из одной области в другую, как показано в учебнике Приступая к работе.
