---
uid: web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-updatepanel-triggers
title: Основные сведения о триггерах UpdatePanel ASP.NET AJAX | Документы Microsoft
author: scottcate
description: При работе в редакторе разметки в Visual Studio можно заметить (из IntelliSense), два дочерних элементов управления UpdatePanel. Одно из ч...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/12/2008
ms.topic: article
ms.assetid: faab8503-2984-48a9-8a40-7728461abc50
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-updatepanel-triggers
msc.type: authoredcontent
ms.openlocfilehash: f30f2ead402d2f49a89b2caf47cc30b6445d4cfb
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30890753"
---
<a name="understanding-aspnet-ajax-updatepanel-triggers"></a>Основные сведения о триггерах UpdatePanel ASP.NET AJAX
====================
по [Scott кате](https://github.com/scottcate)

[Скачать PDF](http://download.microsoft.com/download/C/1/9/C19A3451-1D14-477C-B703-54EF22E197EE/AJAX_tutorial02_Triggers_cs.pdf)

> При работе в редакторе разметки в Visual Studio можно заметить (из IntelliSense), два дочерних элементов управления UpdatePanel. Одно из которых состоит элемент триггеров, который определяет элементы управления на странице (или пользовательский элемент управления, если вы используете), запускающих частичной отрисовки элемента управления UpdatePanel, в которой находится элемент.


## <a name="introduction"></a>Вступление

Технология ASP.NET корпорации Майкрософт предоставляет модель программирования объектно ориентированного и событиями и объединяет его с преимуществами скомпилированного кода. Однако его серверную обработку модели имеет несколько недостатков, присущих технологии, многие из которых можно обратиться по новых возможностей, включенных в расширения Microsoft AJAX ASP.NET 3.5. Эти расширения позволяют множество новых возможностей многофункциональных клиентах, включая частичную отрисовку страницы, не требуя обновления всей странице, возможность доступа к веб-служб с помощью клиентского скрипта (в том числе ASP.NET, API профилирования) и расширенного клиентского API-интерфейса предназначены для зеркального отображения, многие из схемы управления, показано в наборе серверный элемент управления ASP.NET.

В этом техническом документе проверяет XML триггеры функциональные возможности ASP.NET AJAX `UpdatePanel` компонента. Триггеры XML обеспечивают четкий контроль над компонентами, которые могут привести к частичной визуализации для определенного элемента управления UpdatePanel.

В этом техническом документе основана на бета-версии 2 выпуска .NET Framework 3.5 и Visual Studio 2008. Расширения ASP.NET AJAX, ранее сборку надстройки, адресованный ASP.NET 2.0 теперь интегрированы в Библиотека базовых классов .NET Framework. В этом техническом документе также предполагается, что будут работать с Visual Studio 2008, не Visual Web Developer Express и предоставит пошаговые руководства по пользовательского интерфейса Visual Studio (хотя Листинги кода будут полностью совместимы, вне зависимости от среда разработки).

## <a name="triggers"></a>*Триггеры*

Триггеры для заданного UpdatePanel, по умолчанию автоматически включают все дочерние элементы, которые вызывают обратную передачу, к примеру, включая элементы управления текстового поля, имеющие их `AutoPostBack` свойство **true**. Тем не менее триггеры, также можно включить, декларативно с помощью разметки; Это делается в `<triggers>` части объявления элемента управления UpdatePanel. Несмотря на то, что триггеры может осуществляться через `Triggers` свойство коллекции, рекомендуется зарегистрировать триггеры частичной отрисовки во время выполнения (например, если элемент управления не доступен во время разработки) с помощью `RegisterAsyncPostBackControl(Control)` метод ScriptManager объекта на странице в `Page_Load` событий. Помните, что не имеют состояния, и поэтому необходимо повторно зарегистрировать эти элементы управления каждый раз, когда они создаются.

Включение триггера автоматического дочерних также может быть отключена (так, что дочерние элементы управления, создавать обратных передач автоматически не запускают частичные модули подготовки), задав `ChildrenAsTriggers` свойства **false**. Это позволяет наибольшую гибкость в назначении какие конкретные элементы управления могут вызывать отрисовки страницы и рекомендуется, чтобы разработчик будет участие в ответ на события, а не обработки все события, которые могут возникнуть.

Обратите внимание, что при элементов управления UpdatePanel являются вложенными, если UpdateMode задано значение **условного**, если дочерний UpdatePanel запускается, но родительский не, затем только дочерние будет обновляться UpdatePanel. Тем не менее если родительский UpdatePanel обновляется, затем дочерние UpdatePanel также будет обновлен.

## <a name="the-lttriggersgt-element"></a>*&lt;Триггеры&gt; элемент*

При работе в редакторе разметки в Visual Studio, может отобразиться (из IntelliSense), существует два дочерних элемента из `UpdatePanel` элемента управления. Большинство распространенных варианта элемент `<ContentTemplate>` элемент, который фактически инкапсулирует содержимое, которое будет нести панели обновления (содержимое, для которой мы Включение частичной визуализации). Второй элемент — `<Triggers>` элемент, который определяет элементы управления на странице (или пользовательский элемент управления, если вы используете), запускающих частичной отрисовки элемента управления UpdatePanel, в котором &lt;триггеры&gt; находится элемент.

`<Triggers>` Элемент может содержать любое количество каждого из двух дочерних узлов: `<asp:AsyncPostBackTrigger>` и `<asp:PostBackTrigger>`. Они принимают два атрибута `ControlID` и `EventName`и можно указать любой элемент управления в текущий блок инкапсуляции (к примеру, если элемент управления UpdatePanel, находится в пределах веб-элемент управления пользователя, вы не следует пытаться ссылки на элемент управления на Страница, на котором будет находиться в пользовательский элемент управления).

`<asp:AsyncPostBackTrigger>` Элемент особенно полезна в том, что можно выбрать целевую любого события из элемента управления, который является дочерним для *любой* управления UpdatePanel в единице инкапсуляции, не только UpdatePanel, с которой данный триггер является дочерним . Таким образом любой элемент управления можно сделать для запуска частичного обновления.

Аналогичным образом `<asp:PostBackTrigger>` элемент может использоваться для триггера частичной отрисовки, но, требующего полного приема-передачи на сервер. Этот элемент триггера может также использоваться для принудительной отрисовки по страницам, если элемент управления в противном случае активируют обычно частичной отрисовки (например, в том случае, когда `Button` управления существует в `<ContentTemplate>` элемента управления UpdatePanel). Опять же PostBackTrigger элемента можно указать любой элемент управления, который является потомком любого элемента управления UpdatePanel в текущем подразделении инкапсуляции.

## <a name="lttriggersgt-element-reference"></a>*&lt;Триггеры&gt; ссылка на элемент*

*Потомки разметку:*

| **Tag** | **Описание** |
| --- | --- |
| &lt;asp:AsyncPostBackTrigger&gt; | Указывает элемент управления и событий, приведут к частичное обновление страницы в течение UpdatePanel, содержащий ссылку на этот триггер. |
| &lt;asp:PostBackTrigger&gt; | Указывает элемент управления и события, которое приведет к ее полного обновления (обновление всей странице). Этот тег используется для принудительного полного обновления, когда элемент управления, в противном случае приведет к запуску частичную отрисовку. |

## <a name="walkthrough-cross-updatepanel-triggers"></a>*Пошаговое руководство: Триггеры между UpdatePanel*

1. Создайте новую страницу ASP.NET с объектом ScriptManager, задайте для поддержки частичной отрисовки. Добавить элементы в двух UpdatePanel на эту страницу - в первом, включать элемент управления Label (Label1) и два элемента управления Button (Button1 и Button2). Нажмите, чтобы обновить и должно быть указано button1 и Button2 должно быть указано нажмите, чтобы обновить это или нечто вроде тех строк. В втором UpdatePanel включать только элемент управления Label (Label2), но свойства ForeColor по умолчанию для его различения, отличные от.
2. Установить свойство UpdateMode обоих тегов UpdatePanel **условного**.

**Список 1: Разметка для default.aspx:** 

[!code-aspx[Main](understanding-asp-net-ajax-updatepanel-triggers/samples/sample1.aspx)]

1. В обработчик события нажатия кнопки Button1 установите Label1.Text и Label2.Text зависящих от времени (например, DateTime.Now.ToLongTimeString()). В обработчик событий Click для Button2 присвоено только Label1.Text значение зависит от времени.

**Список 2: Фонового кода (усечение) в default.aspx.cs:** 

[!code-csharp[Main](understanding-asp-net-ajax-updatepanel-triggers/samples/sample2.cs)]

1. Нажмите клавишу F5 для построения и запуска проекта. Обратите внимание, что при нажатии кнопки панелей и обновления, оба метки изменить текст; Тем не менее если щелкнуть этот панель обновления, обновляет только Label1.


[![](understanding-asp-net-ajax-updatepanel-triggers/_static/image2.png)](understanding-asp-net-ajax-updatepanel-triggers/_static/image1.png)

([Просмотр полноразмерное изображение](understanding-asp-net-ajax-updatepanel-triggers/_static/image3.png))


## <a name="under-the-hood"></a>*Внутренняя структура*

Используя пример, который мы только что создан, мы можем рассмотрим действия ASP.NET AJAX и принципы работы нашей триггеры между панели UpdatePanel. В этом случае мы работаем над источника созданный страницы HTML, а также модуль Mozilla Firefox, называемый FireBug - с его помощью можно легко проверить AJAX операций обратной передачи. Также мы воспользуемся средством .NET Reflector с программой. Оба эти средства доступны через Интернет, а также можно найти, и поиск в Интернете.

Проверка исходного кода страницы показывает, почти ничего не соответствует обычным; элементы управления UpdatePanel, отображаются как `<div>` контейнеры и мы можно увидеть ресурса скрипта, включает предоставляемых по `<asp:ScriptManager>`. Существуют также некоторые новые относящегося к AJAX вызовы PageRequestManager внутренних библиотеки клиентских сценариев AJAX. И, наконец, мы увидим два контейнеры UpdatePanel — один с создаваемые `<input>` кнопки с двумя `<asp:Label>` элементов управления отображаются в виде `<span>` контейнеров. (Если проверить дерево DOM в FireBug можно заметить неактивными метки для указания, что они не создает видимого содержимого).

Нажмите кнопку обновления этой панели и обратите внимание, что верхний UpdatePanel обновляется с указанием текущего времени сервера. В FireBug перейдите на вкладку консоли, чтобы можно было проверить запрос. Сначала проверьте параметры запроса POST:


[![](understanding-asp-net-ajax-updatepanel-triggers/_static/image5.png)](understanding-asp-net-ajax-updatepanel-triggers/_static/image4.png)

([Просмотр полноразмерное изображение](understanding-asp-net-ajax-updatepanel-triggers/_static/image6.png))


Обратите внимание, что UpdatePanel указал для серверного кода AJAX точно, укажите дерево элемента управления было запущено через параметр ScriptManager1: `Button1` из `UpdatePanel1` элемента управления. Теперь нажмите кнопку обновления как панелей. Затем анализируя ответ, возникнуть серия с разделителями канала переменные, заданные в строке; в частности, мы увидим top UpdatePanel `UpdatePanel1`, имеет во время всего его HTML, отправляемого в браузер. Библиотеки клиентских сценариев AJAX замещает UpdatePanel исходный HTML-содержимого с новым содержимым через `.innerHTML` свойство, и поэтому сервер отправляет измененное содержимое с сервера в формате HTML.

Теперь нажмите кнопку обновления как панелей и изучить полученные результаты с сервера. Результаты во многом схожи - элементы обоих UpdatePanel получают новый HTML от сервера. Как и в предыдущем обратного вызова, отправляется состояния дополнительные страницы.

Как мы видим, так как нет специального кода используется для выполнения обратной передачи AJAX, библиотеки клиентских сценариев AJAX может перехватить обратные передачи форм без никакого дополнительного кода. Серверные элементы управления автоматически использовать JavaScript, чтобы они автоматически не отправлять форму — ASP.NET автоматически вставляет код проверку формы и состояние уже, главным образом достигается путем включения автоматического сценария ресурса, класс PostBackOptions и класс ClientScriptManager.

Например рассмотрим элемент управления CheckBox; Изучите Дизассемблирование класса в .NET Reflector. Чтобы сделать это, убедитесь, что сборку System.Web открыт и перейдите к `System.Web.UI.WebControls.CheckBox` класса, открыв `RenderInputTag` метод. Найдите условного выражения, которое проверяет `AutoPostBack` свойство:


[![](understanding-asp-net-ajax-updatepanel-triggers/_static/image8.png)](understanding-asp-net-ajax-updatepanel-triggers/_static/image7.png)

([Просмотр полноразмерное изображение](understanding-asp-net-ajax-updatepanel-triggers/_static/image9.png))


Если включена автоматическая обратная передача на `CheckBox` управления (с помощью параметра AutoPostBack, true), итоговые `<input>` таким образом отрисовку с обработки скрипта в событий ASP.NET его `onclick` атрибута. Перехват отправки формы, затем позволяет ASP.NET AJAX, вставляемый в страницу nonintrusively, помогает избежать возможных критических изменений, которые могут возникнуть за счет использования возможно неточный строку замены. Кроме того, это позволяет *любой* пользовательского элемента управления ASP.NET, использующие всю мощь ASP.NET AJAX без никакого дополнительного кода для поддержки его использования в контейнере UpdatePanel.

`<triggers>` Функциональный соответствует значения, инициализируемые в вызове PageRequestManager \_updateControls (Обратите внимание, что библиотеки клиентских сценариев ASP.NET AJAX использует соглашение о, методы, события и имена полей, которые начинаются со знака подчеркивания помеченных как внутренние и они не предназначены для использования за пределами этой библиотеки). С его помощью можно видеть, какие элементы управления предназначены для повторных вызовов AJAX.

Например добавим два дополнительных элемента управления на страницу, оставляя один элемент управления за пределами панели UpdatePanel полностью и оставить их на UpdatePanel. Будет добавить элемент управления CheckBox в верхнем UpdatePanel и удалить DropDownList с количеством цветов, определенных в списке. Ниже приведен новый разметки.

**Список 3: Новый разметки**

[!code-aspx[Main](understanding-asp-net-ajax-updatepanel-triggers/samples/sample3.aspx)]

А вот нового кода:

**Листинг 4: фонового кода**

[!code-csharp[Main](understanding-asp-net-ajax-updatepanel-triggers/samples/sample4.cs)]

Идея этой страницы является раскрывающегося списка выбирается один из трех цветов для отображения второй метки, что флажок определяет, является ли полужирным шрифтом, и ли отображать метки даты, а также время. Этот флажок не вызывает обновления AJAX, но следует раскрывающегося списка, несмотря на то, что он не размещается в UpdatePanel.


[![](understanding-asp-net-ajax-updatepanel-triggers/_static/image11.png)](understanding-asp-net-ajax-updatepanel-triggers/_static/image10.png)

([Просмотр полноразмерное изображение](understanding-asp-net-ajax-updatepanel-triggers/_static/image12.png))


Как виден на снимке экрана выше, самую новую кнопку, чтобы щелкать заключалась в данной панели обновления, которое обновляется независимо top время от времени нижней правой кнопки. Дата была также отключить между щелчками, как дата отображается в нижней метки. Наконец интерес представляет цвет метки нижней: был обновлен раньше, чем текст метки, где показано, что состояние элемента управления важен, и пользователи ожидают, что он будет сохранен посредством обратных передач AJAX. *Тем не менее*, время не был обновлен. Время была автоматически повторно через сохраняемость \_ \_VIEWSTATE поля страницы, интерпретируются средой выполнения ASP.NET, когда элемент управления повторно подготовленных к просмотру на сервере. ASP.NET AJAX серверного кода не распознает, в котором методы элементов управления изменяется состояние; он просто повторно заполняет из состояния представления и запускает события, которые подходят.

Его следует обратить внимание, однако, был ли инициализирован времени на странице\_событие загрузки, время будет увеличения правильно. Таким образом, разработчики должны, будьте осторожны, что соответствующий код выполняется во время соответствующие обработчики событий и избежать использования страницы\_загрузки при обработчик событий управления уместно.

## <a name="summary"></a>Сводка

Управления UpdatePanel расширения AJAX ASP.NET гибкая и могут использовать несколько методов для идентификации события элементов управления, которые должны быть причиной может быть обновлена. Он поддерживает обновляются автоматически, ее дочерними элементами управления, но может также реагировать на события элементов управления в другом месте на странице.

Чтобы уменьшить вероятность для обработки нагрузки на сервер, рекомендуется `ChildrenAsTriggers` UpdatePanel быть присвоено `false`, и, события был указан параметр-в, а не включены по умолчанию. Это также предотвращает все ненужные события из-за потенциально нежелательные эффекты, включая проверки и изменения для поля ввода. Эти типы ошибок может быть трудно локализовать, так как обновления страницы прозрачно для пользователя, и причину может поэтому не сразу.

С помощью проверки внутренней работы ASP.NET AJAX формы post перехвата модели, можно было определить, используется платформа ASP.NET уже предоставлена. При этом он сохраняет максимальную совместимость с элементами управления, созданных с использованием такая же платформа и как минимум intrudes на любые дополнительные JavaScript, написанные для страницы.

## <a name="bio"></a>Биография

Вадим Paveza имеет старший разработчик приложения .NET в Terralever ([www.terralever.com](http://www.terralever.com)), начальные интерактивный маркетинга компании в Tempe, AZ. Он может быть достигнута по [ robpaveza@gmail.com ](mailto:robpaveza@gmail.com), и в своем блоге находится в [ http://geekswithblogs.net/robp/ ](http://geekswithblogs.net/robp/).

Скотт кате работает с веб-технологиями Майкрософт с 1997 и – президент myKB.com ([www.myKB.com](http://www.myKB.com)) приложений, основное внимание уделено базы знаний программные решения, где он специализируется на написание ASP.NET на основе. Скотт можно обратиться по электронной почте [ scott.cate@myKB.com ](mailto:scott.cate@myKB.com) или его блог по [ScottCate.com](http://ScottCate.com)

> [!div class="step-by-step"]
> [Назад](understanding-partial-page-updates-with-asp-net-ajax.md)
> [Вперед](understanding-asp-net-ajax-authentication-and-profile-application-services.md)
