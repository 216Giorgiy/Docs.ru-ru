---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/configuring-the-production-web-application-to-use-the-production-database-vb
title: Настройка рабочего веб-приложение для использования рабочей базы данных (Visual Basic) | Документы Microsoft
author: rick-anderson
description: Как отмечалось в предыдущих учебниках, не нередко сведения о конфигурации могут отличаться в средах разработки и эксплуатации. Это es...
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/23/2009
ms.topic: article
ms.assetid: a64a7aa0-6608-449e-83bf-1ef8cceee504
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/configuring-the-production-web-application-to-use-the-production-database-vb
msc.type: authoredcontent
ms.openlocfilehash: b1741807fe02b4e60db7098cfd46922d3ba50ccd
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30887929"
---
<a name="configuring-the-production-web-application-to-use-the-production-database-vb"></a>Настройка рабочего веб-приложение для использования рабочей базы данных (Visual Basic)
====================
по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Загрузить код](http://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_08_VB.zip) или [скачать PDF](http://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial08_DBConfig_vb.pdf)

> Как отмечалось в предыдущих учебниках, не нередко сведения о конфигурации могут отличаться в средах разработки и эксплуатации. Это особенно важно для управляемых данными веб-приложений, как строки подключения к базам данных отличаются от разработки и рабочих средах. Этот учебник рассматриваются способы настройки рабочей среде, чтобы более подробно, включает строку подключения, соответствующие.


## <a name="introduction"></a>Вступление

Управляемые данными веб-приложения обычно использовать другую базу данных во время разработки, когда в рабочей среде. Для приложений, размещаемую в поставщике узла и разработанных локально базы данных разработки обычно размещается на компьютере s разработчика а производственной базы данных размещается на сервере базы данных на веб-размещения территории s компании. Развертывание управляемых данными веб-приложение включает в себя копирование базы данных разработки базы данных на рабочем сервере. В предыдущем учебнике мы рассмотрели способы для выполнения этого шага.

Веб-приложение использует эти сведения в *строка подключения* для установления соединения с базой данных. Строка соединения, которая обычно хранится в `Web.config`, указывает имя сервера базы данных, имя базы данных, контекст безопасности и другие сведения. База данных, используемая веб-приложения зависит от того, выполняется ли веб-приложения в среде разработки или производства, строки подключения должны отличаться между этими двумя средами.

Довольно часто для сведений о конфигурации могут отличаться в средах разработки и эксплуатации. *Распространенные конфигурации различия между разработки и эксплуатации* учебнике рассматриваются методы для поддержки сведений о конфигурации отдельных между этих двух средах, а также краткое описание на строки подключения базы данных. Этот учебник рассматриваются способы настройки рабочей среде, чтобы более подробно, включает строку подключения, соответствующие.

## <a name="examining-the-connection-string-information"></a>Анализ данных строки подключения

Строка подключения, используемая веб-приложением рецензий хранится в файле конфигурации приложения s `Web.config`. `Web.config` включает в себя специальный раздел для хранения строки подключения, соответствующее имя [ &lt;connectionStrings&gt;](https://msdn.microsoft.com/library/bf7sd233.aspx). `Web.config` -Файле для веб-сайта рецензий одну строку соединения, заданные в этом разделе с именем `ReviewsConnectionString`:

[!code-xml[Main](configuring-the-production-web-application-to-use-the-production-database-vb/samples/sample1.xml)]

Строка подключения - источник данных =. \SQLEXPRESS; AttachDbFilename = | Безопасность DataDirectory|\Reviews.mdf;Integrated = True; User Instance = True — состоит из числа возможностей и значения, с помощью пары параметр и значений, разделенных точкой с запятой и каждого параметра и значения, разделенные знаком равенства. Приведены четыре параметры, используемые в этой строке подключения.

- `Data Source` — Указывает расположение сервера базы данных и имя экземпляра сервера базы данных (если таковые имеются). Значение, `.\SQLEXPRESS`, пример которого сервер базы данных и имя экземпляра. Срок указывает, что сервер базы данных на том же компьютере, что приложение; Имя экземпляра является `SQLEXPRESS`.
- `AttachDbFilename` — Указывает расположение файла базы данных. Значение содержит заполнитель `|DataDirectory|`, который разрешается в полное приложение s `App_Data` папку во время выполнения.
- `Integrated Security` -Логическое значение, указывающее, следует ли использовать указанного имени пользователя и пароля при подключении к базе данных (false) или текущий Windows учетные данные учетной записи (true).
- `User Instance` — параметр конфигурации, относящиеся к SQL Server экспресс-выпусков, указывающее, следует ли разрешить пользователям без прав администратора на локальном компьютере присоединяться и подключаться к базе данных SQL Server, экспресс-выпуск. В разделе [экземпляров SQL Server Express пользователя](https://msdn.microsoft.com/library/ms254504.aspx) Дополнительные сведения об этом параметре.
  

Параметры строки подключения допустимый зависят от базы данных, подключении и [ADO.NET](http://ADO.NET) используемого поставщика базы данных. Например строка подключения для подключения к Microsoft SQL Server базы данных отличается от используемого для подключения к базе данных Oracle. Аналогично подключение к базе данных Microsoft SQL Server с помощью поставщика SqlClient использует другую строку соединения, чем при использовании поставщика OLE DB.

Можно будет создать строку подключения базы данных вручную с помощью сайта, например [ConnectionStrings.com](http://www.connectionstrings.com/) как доступные параметры ресурса. Однако более простой подход является добавление базы данных в обозревателе серверов в Visual Studio и затем получить строку подключения из окна «Свойства». Разрешить s использовать этот второй прием для создания строки подключения базы данных на рабочем сервере.

Откройте Visual Studio и перейдите в окно обозревателя серверов (в Visual Web Developer, это окно называется обозревателе базы данных). Щелкните правой кнопкой мыши на параметр подключения к данным и выберите Добавить подключение в контекстном меню. Откроется окно мастера, показанной на рис. 1. Выберите нужный источник данных и нажмите кнопку Продолжить.


[![Выберите Добавить новую базу данных в обозревателе серверов](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image2.jpg)](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image1.jpg) 

**Рис. 1**: выберите Добавить новую базу данных в обозревателе серверов ([Просмотр полноразмерное изображение](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image3.jpg))


Затем укажите разные базы данных сведения о подключении (см. рис. 2). При регистрации веб-хостинга компанию, они должны предоставлять сведения о подключении к базе данных — имя сервера базы данных, имя базы данных, имя пользователя и пароль для подключения к базе данных и т. д. После ввода этой информации нажмите кнопку ОК, чтобы завершить этот мастер и добавить базу данных в обозревателе серверов.


[![Укажите соединение с базой данных](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image5.jpg)](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image4.jpg) 

**На рисунке 2**: укажите соединение с базой данных ([Просмотр полноразмерное изображение](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image6.jpg))


Среда рабочей базы данных должны появиться в обозревателе серверов. Выберите базу данных из обозревателя серверов и перейдите в окно «Свойства». Там будет найти свойство с именем строки подключения в строке подключения s базы данных. При условии, что вы используете базы данных Microsoft SQL Server в рабочей среде и Поставщик SqlClient строки подключения должен выглядеть следующим образом:

<strong>Источник данных =<em>serverName</em>; Начальный каталог =<em>databaseName</em>; Сохранять сведения о безопасности = True; ИД пользователя =<em>username</em>; Пароль =*пароль</strong>*

Где *serverName*, *databaseName*, *username*, и *пароль* являются значениями для имени сервера базы данных, базы данных имя и имя пользователя и пароль, предоставленные вашей компании узла веб.

## <a name="deploying-the-book-reviews-web-application"></a>Развертывание веб-приложения обзоров книги

Предыдущего учебника были рассмотрены копирование базы данных разработки в рабочую среду, но не было изучить развертывание приложения, управляемые данными. На этом этапе в рабочей среде находится база данных, но используется версия приложения просматривает книги со статического проверки. Необходимо развернуть новый, управляемые данными приложения на рабочем сервере, а также обновленную конфигурацию.

Занять некоторое время для развертывания управляемых данными приложения из среды разработки в производственную среду. В предыдущих учебниках подробно был рассматривается этот процесс. Обновитель статье *развертывание веб-сайта с помощью FTP-клиент* или *развертыванию ваш веб-сайт с помощью Visual Studio* учебники. Вам потребуется убедитесь, что строка подключения базы данных рабочей календарем, используемым в производственной среде, это означает, что альтернативный `Web.config` файл должен быть развернут. В частности, это изменить `Web.config` файл s `<connectionStrings>` элемент должен содержать строку подключения для рабочей базы данных и должен выглядеть следующим образом:

[!code-xml[Main](configuring-the-production-web-application-to-use-the-production-database-vb/samples/sample2.xml)]

Обратите внимание, что строка соединения в `<connectionStrings>` элемента совпадает с именем (`ReviewsConnectionString`), но теперь содержит строку подключения базы данных рабочей, а не строку подключения базы данных разработки.

Если у вас есть более документально оформленными принципами рабочий процесс развертывания, либо вручную изменить `Web.config` файл, чтобы использовать строку подключения для рабочей базы данных перед развертыванием (Обратите внимание восстановить его с помощью строки подключения базы данных разработки После этого) или поддерживать отдельные `Web.config` файл рабочей среды сведения о конфигурации, который загружается в рабочую среду в процессе развертывания.

> [!NOTE]
> Если вы случайно развернуть `Web.config` файл, содержащий строку подключения базы данных разработки будут произошла ошибка при попытке подключения к базе данных приложения в рабочей среде. Эта ошибка проявляющийся как `SqlException` с сообщением, сообщение о том, что сервер не найден или недоступен.


После развертывания узла в рабочей среде см. на сайте рабочей через браузер. Должны видеть и использовать те же возможности пользователя, что при выполнении управляемое данными приложение локально. Конечно при посещении веб-сайта в производстве сайта выключен сервером рабочей базы данных, в то время как посетите веб-сайт в среде разработки используется база данных в разработке. На рисунке 3 показана *обучение самостоятельно ASP.NET 3.5 в течение 24 часов* просмотрите страницу с веб-сайта в рабочей среде (Обратите внимание, URL-адрес в адресной строке браузера s).


[![Управляемых данными приложений: теперь доступен в рабочей среде!](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image8.jpg)](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image7.jpg) 

**Рис. 3**: приложение The Data-Driven — теперь доступен в рабочей среде! ([Просмотр полноразмерное изображение](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image9.jpg))


### <a name="storing-connection-strings-in-a-separate-configuration-file"></a>Хранение строк подключений в отдельный файл конфигурации

Распространенный способ для хранения данных отдельную конфигурацию для сред разработки и эксплуатации является наличие двух версий `Web.config`: один для среды разработки и один для рабочей среды. Одновременно развернуть-соответствующего `Web.config` версии могут быть скопированы в рабочей среде. В идеальном случае этот процесс бы быть автоматизирован как часть рабочего процесса развертывания.

Вместо обслуживание двух разных `Web.config` файлы, можно, при необходимости, обеспечивают более детальный различия. Элементы, которые составляют `Web.config` файла могут быть определены в внешние файлы конфигурации, затем на которые ссылается `Web.config` файла. По сути можно иметь одну `Web.config` -файле для обеих сред, на которые ссылается файл databaseConnectionStrings.config, который будет содержать строки подключения используется приложением и должен быть уникальным для каждой среды. Найти, разделяя различные сведения о конфигурации в отдельные файлы обеспечивает упорядочить свое и проще `Web.config` выделяет конфигурации различия между средами разработки и рабочих файлов и многое другое.

Чтобы использовать этот способ, начните с создания новой папки веб-приложения с именем `ConfigSections`. Затем добавьте эту новую папку с именем databaseConnectionStrings.dev.config и databaseConnectionStrings.production.config два файла. Затем скопируйте `<connectionStrings>` элемент из `Web.config` файлы databaseConnectionStrings.dev.config и databaseConnectionStrings.production.config, а затем измените строку подключения в databaseConnectionStrings.production.config файла, чтобы указать строку подключения для рабочей базы данных. Например, файл databaseConnectionStrings.dev.config должен содержать только `<connectionStrings>` элемент со строкой соединения, который ссылается на базу данных разработки:

[!code-xml[Main](configuring-the-production-web-application-to-use-the-production-database-vb/samples/sample3.xml)]

Аналогичным образом, databaseConnectionStrings.production.config файл должен содержать только `<connectionStrings>` элемент, но имеет строку подключения для рабочей базы данных.

Создайте копию файла databaseConnectionStrings.dev.config и назовите его databaseConnectionStrings.config.

> [!NOTE]
> Можно задать в файле конфигурации нечто, отличное от databaseConnectionStrings.config, если вы d, таких как `connectionStrings.config` или `dbInfo.config`. Тем не менее, убедитесь, что имя файла с `.config` расширение как `.config` файлы по умолчанию не предоставляются обработчиком ASP.NET. Если имя файла иное значение, например `connectionStrings.txt`, пользователь может указывать браузер, чтобы [www.yoursite.com/ConfigSettings/connectionStrings.txt](http://www.yoursite.com/ConfigSettings/connectionStrings.txt) и просмотреть содержимое файла!


На этом этапе `ConfigSections` папка должна содержать три файла (см. рис. 4). Файлы databaseConnectionStrings.dev.config и databaseConnectionStrings.production.config соответственно содержат строки подключения для разработки и рабочих средах. Файл databaseConnectionStrings.config содержит строку подключения, который будет использоваться веб-приложением во время выполнения. Как следствие файла databaseConnectionStrings.config должны быть идентичен файлу databaseConnectionStrings.dev.config в среде разработки, тогда как в производстве databaseConnectionStrings.config файл должен быть идентичен databaseConnectionStrings.production.config.


[![ConfigSections](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image11.jpg)](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image10.jpg) 

**Рис. 4**: ConfigSections ([Просмотр полноразмерное изображение](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image12.jpg))


Теперь нам нужно указать `Web.config` для использования файла databaseConnectionStrings.config для его хранилища строк подключения. Откройте файл `Web.config` и замените существующий элемент `<connectionStrings>` следующим кодом:

[!code-xml[Main](configuring-the-production-web-application-to-use-the-production-database-vb/samples/sample4.xml)]

`configSource` Атрибут задает физический путь относительно `Web.config` файла. Если внешние `.config` файл находится в том же каталоге, что `Web.config` задайте этот атрибут для имени файла `.config` файла. Если он s в подкаталог, как в случае с databaseConnectionStrings.config, укажите с помощью обратной косой черты в качестве разделителя имен папок и файлов, таких как ConfigSections\databaseConnectionStrings.config вложенную папку.

Этого изменения, разработки и рабочих средах содержит такие же `Web.config` файла. Теперь отличается только файл databaseConnectionStrings.config. Скопируйте файл databaseConnectionStrings.production.config в рабочей среде и переименуйте его в databaseConnectionStrings.config. Если в будущем, внесены изменения в строку подключения для производственной базы данных необходимо будет внести их в файл databaseConnectionStrings.production.config и затем отправьте этот файл в рабочей среде, переименованием databaseConnectionStrings.config.

> [!NOTE]
> Можно указать сведения для любого `Web.config` элемента в отдельный файл и используйте `configSource` ссылку на этот файл с помощью атрибута `Web.config`.


## <a name="summary"></a>Сводка

Управляемые данными приложения обычно используется разных баз данных в средах разработки и эксплуатации. Следовательно строк подключения базы данных, хранящихся в s конфигурацию веб-приложения должно быть уникальным для среды. В этом учебнике мы рассматривали как определить строку подключения базы данных в рабочей среде и способов для поддержания уникальный строку подключения в двух средах.

Программирование довольны!

### <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения по темам, рассматриваемые в этом учебнике см. в следующих ресурсах:

- [Строки подключения и файлы конфигурации](https://msdn.microsoft.com/library/ms254494.aspx)
- [Сведения о @ ConnectionStrings.com строки конфигурации базы данных](http://www.connectionstrings.com/)
- [Можно вывести параметры из файла Web.config](http://www.asp101.com/tips/index.asp?id=154)
- [Техническая документация для &lt;connectionStrings&gt; элемент](https://msdn.microsoft.com/library/bf7sd233.aspx)

> [!div class="step-by-step"]
> [Назад](deploying-a-database-vb.md)
> [Вперед](configuring-a-website-that-uses-application-services-vb.md)
