---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-a-database-vb
title: "Развертывание базы данных (Visual Basic) | Документы Microsoft"
author: rick-anderson
description: "Развертывание веб-приложения ASP.NET влечет за собой, получение необходимых файлов и ресурсов из среды разработки в рабочую среду. Для приложения..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/23/2009
ms.topic: article
ms.assetid: 96ac3e69-04c7-4917-ad06-5f8968c3fbf1
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-a-database-vb
msc.type: authoredcontent
ms.openlocfilehash: b0890d50f21eb790d81d54261a67fcf487b1c95e
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="deploying-a-database-vb"></a>Развертывание базы данных (Visual Basic)
====================
по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Загрузить код](http://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_07_VB.zip) или [скачать PDF](http://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial07_DeployDB_vb.pdf)

> Развертывание веб-приложения ASP.NET влечет за собой, получение необходимых файлов и ресурсов из среды разработки в рабочую среду. Для управляемых данными веб-приложений в нем схемы базы данных и данных. Этот учебник является первым в рядах, рассматриваются шаги, необходимые для успешного развертывания базы данных из среды разработки в рабочую среду.


### <a name="introduction"></a>Вступление

Развертывание веб-приложения ASP.NET влечет за собой, получение необходимых файлов и ресурсов из среды разработки в рабочую среду. В течение последних шести учебников мы рассматривали развертывание простого рецензий веб-приложения. Этот демонстрационный сайт был состоит из различных серверных ресурсов - страниц ASP.NET, файлы конфигурации, `Web.sitemap` файл и т. д. — вместе с ресурсами на стороне клиента, как изображения и CSS-файлах. Но что насчет управляемых данными веб-приложений? Какие дополнительные шаги необходимо выполнить, чтобы развернуть веб-приложение, который использует базу данных?

На следующем несколько учебников мы поговорим об шаги, необходимые для развертывания управляемых данными веб-приложения. Этот учебник начинает проверять получение s схемы базы данных и содержимое из среды разработки в рабочую среду, в во время последующих учебнике рассматривается изменения необходимые настройки. После того, что мы изучим сложностей, связанных с развертыванием базы данных, которая использует службы приложений (членства, ролей, профиль и т. д.).

## <a name="examining-the-updated-book-reviews-web-application"></a>Проверка обновленных книги проверки веб-приложения

Чтобы продемонстрировать развертывание данными веб-приложения, ли хранить обновлены рецензий веб-приложения с простой статического веб-сайта в один управляемой данными. Как и прежде, существует две версии приложения в этом учебнике s: одна с помощью модели проекта веб-приложения и та, которая использует модель проекта веб-сайта.

Обновленные рецензий веб-приложение использует [SQL Server 2008 Express Edition](https://www.microsoft.com/express/sql/default.aspx) базы данных, которая хранится на сайте s `App_Data` папку (`~/App_Data/Reviews.mdf`). Если у вас установлены на компьютере SQL Server 2008 демонстрации должно работать без ошибок. При наличии более старой версии SQL Server, вы можете либо установить свободного SQL Server 2008 Express Edition, или можно использовать базы данных, доступные в этом учебнике s сценарии загрузки самостоятельно создать базу данных.

`Reviews.mdf` База данных содержит четыре таблицы:

- `Genres`-содержит запись для каждого жанра, как технология, фантастики и бизнеса.
- `Books`— включает запись для каждой проверки со столбцами как `Title`, `GenreId`, `ReviewDate`, и `Review`, среди прочего.
- `Authors`— включает сведения о каждый автор, участвовал проверенные книги.
- `BooksAuthors`-Соединяемая таблица многие ко многим, указывающее, какие авторы написали какие книг.
  

Рисунок 1 демонстрирует схему аварийного восстановления из этих четырех таблиц.


[![S книги проверки веб-приложения базы данных является состоит из четырех таблиц](deploying-a-database-vb/_static/image2.jpg)](deploying-a-database-vb/_static/image1.jpg) 

**Рис. 1**: s книги проверки веб-приложения базы данных является состоит из четырех таблиц ([Просмотр полноразмерное изображение](deploying-a-database-vb/_static/image3.jpg))


В предыдущей версии рецензий веб-сайта было отдельную страницу ASP.NET для каждой книги. Например, была страницу с именем `~/Tech/TYASP35.aspx` , содержались проверки *обучение самостоятельно ASP.NET 3.5 в течение 24 часов*. Это новая версия управляемых данными веб-сайта имеет обзоры, хранящиеся в базе данных и одной страницы ASP.NET, Review.aspx?ID=*bookId*, отображающий проверки для указанной книги. Кроме того, имеется Genre.aspx?ID=*genreId* со списком проверенные электронной заданного жанра.

Рисунки 2 и 3 show `Genre.aspx` и `Review.aspx` страницы в действии. Обратите внимание, URL-адрес в адресной строке для каждой страницы. В на рисунке 2 ИТ s Genre.aspx? ID = 85d164ba-1123-4 c 47-82a0-c8ec75de7e0e. Так как 85d164ba-1123-4c47-82a0-c8ec75de7e0e `GenreId` значение для технологии жанра, s заголовок операций чтения страниц «Технологии просматривает» и маркированный список перечисляет этих проверок на сайте, не удовлетворяющие этого жанра.


[![Страница жанра технологии](deploying-a-database-vb/_static/image5.jpg)](deploying-a-database-vb/_static/image4.jpg) 

**На рисунке 2**: Страница жанра технологии ([Просмотр полноразмерное изображение](deploying-a-database-vb/_static/image6.jpg))


[![Рассмотрение приступите к изучению ASP.NET 3.5 в 24 часа](deploying-a-database-vb/_static/image8.jpg)](deploying-a-database-vb/_static/image7.jpg) 

**Рис. 3**: Обзор для *обучение самостоятельно ASP.NET 3.5 в течение 24 часов* ([Просмотр полноразмерное изображение](deploying-a-database-vb/_static/image9.jpg))


Просматривает книги веб-приложения также включает раздел администрирования, где администраторы могут добавлять, изменять и удалить жанров, обзоры и создавать сведения. В настоящее время любой посетитель доступны в разделе "Администрирование". В будущем учебника мы добавить поддержку для учетных записей пользователей и разрешите только авторизованным пользователям в страницы администрирования.

При загрузке приложения рецензий Пожалуйста Имейте в виду, что он предназначен для демонстрации развертывание приложения, управляемые данными. Оно не обеспечивает рекомендации отделов разработки приложения. Например имеется не отдельный данных Access Layer (DAL); на страницах ASP.NET взаимодействовать непосредственно с базой данных через управления SqlDataSource или кода ADO.NET в своих классах кода. Более подробное рассмотрение создание управляемых данными приложений с помощью многоуровневой архитектуры, см. в разделе Мои [ *работа с данными* учебники](../../data-access/index.md).

## <a name="databases-on-development-versus-production"></a>Базы данных на разработку и производства

При начале разработки управляемых данными веб-приложения, необходимо указать строку подключения базы данных, которая предоставляет сведения приложения о том, как подключиться к базе данных. Эта строка подключения указывает среди прочего, сервер базы данных, имя базы данных и сведения о безопасности. Наиболее часто используемые приложением во время разработки базы данных отличается от базы данных, используемого при его s в рабочей среде. Существует много преимуществ использования разных баз данных для разработки и рабочей среде. С другими database в средства разработки пункт не нужно беспокоиться о случайное изменение или удаление динамических данных. Он также позволяет поместить в фиктивной тестовые данные или привести к значительным изменениям в модель данных не нужно беспокоиться о воздействии на приложения в рабочей среде. Недостатком присутствия в другую базу данных в средах разработки и эксплуатации том, что когда приложение развертывания базы данных и все необходимые изменения в схему базы данных s или данных также должны быть развернуты.

До первого развертывания имеется только один экземпляр базы данных, и что экземпляр находится в среде разработки. При развертывании приложения в рабочей среде, в первый раз мы не только скопировать необходимые серверные и клиентские файлы, но также скопировать базу данных из среды разработки в рабочую среду. Это происходит, когда мы независимо от правого теперь с веб-приложением рецензий - база данных расположена в `App_Data` папку, в нашей среде разработки, но имеет не еще передаются в рабочей среде.

После развертывания приложения существует две копии базы данных. Мере разработки приложения, могут добавляться новые функции, создавая необходимость изменений в модель данных (такие как добавление новых столбцов к существующим таблицам, внесения изменений в существующие столбцы, добавления новых таблиц и т. д). При развертывании веб-приложения после изменения применены к базе данных в среде разработки с момента последнего развертывания должен применяться в производственной базе данных. Некоторые стратегии управления этот процесс рассматриваются в будущем учебника. Это учебник посвящен развертывание всей базы данных из среды разработки в рабочую среду.

## <a name="deploying-the-database-to-the-production-environment"></a>Развертывание базы данных в рабочей среде

В оставшейся части этого учебника рассматривается развертывание базы данных из среды разработки в рабочую среду. Если вы следуете вдоль вы обязательно важно убедиться, что ваша учетная запись с поставщиком веб узла включает Microsoft SQL Server база данных должна поддерживать. Необходимо иметь некоторые сведения в одном месте, а именно: имя сервера базы данных, имя базы данных и имя пользователя и пароль для подключения к базе данных.

Как отмечалось ранее в этом учебнике, рецензий веб-сайт s она базы данных SQL Server 2008 Express Edition, сохраненной в `App_Data` папки. Были получены причине, что развертывание такой базы данных должно быть простым копированием `App_Data` папке из среды разработки в рабочую среду. Однако большинство поставщиков веб-узел не поддерживают размещения баз данных в `App_Data` папку причинам безопасности. Вместо этого веб-узлы укажите учетную запись на сервере базы данных SQL Server в корпоративной среде. Развертывание базы данных из среды разработки в производственную среду требуется получить зарегистрированные s базы данных веб-узла сервера, базы данных.

Так как получить базу данных из среды разработки в производственную среду? Существует несколько способов решения этой задачи в зависимости от того, какие службы вашего веб-узла предложения. С некоторые узлы, например DiscountASP.NET, можно FTP резервная копия базы данных или фактический `.mdf` файл на веб-сайт и восстановите файл резервной копии с помощью панели управления или подключите `.mdf` файл базы данных SQL server. С помощью таких средств развертывания базы данных простым копированием `App_Data` папки для рабочей среды и его подключения через панель управления. Это может быть простым и быстрым способом для публикации базы данных в первый раз.

Другой подход заключается в том, чтобы использовать мастер публикации базы данных. Мастер публикации базы данных — это классическое приложение Windows, создаваемую команды SQL для создания схемы базы данных s - таблицы, хранимые процедуры, представления, определяемые пользователем функции и т. д - и, возможно, данные в его таблицах. Можно подключитесь к сервер веб-узле поставщика s базы данных посредством SQL Server Management Studio, а затем выполните этот скрипт для копирования базы данных в рабочей среде. Еще лучше, если поставщик узла web поддерживает Microsoft s [Database Publishing Services](http://www.codeplex.com/sqlhost/Wiki/View.aspx?title=Database%20Publishing%20Services&amp;referringTitle=Home) имеется сценарий, созданные с помощью мастера публикации базы данных, автоматически выполняется на сервере базы данных от вашего имени. Поскольку мастер публикации базы данных создает скрипт, который создает базы данных s схему и данные, он будет работать независимо от ли поставщик узла web предоставляет функции, например о прикреплении отправленного `.mdf` файла.

### <a name="generating-the-sql-commands-to-create-the-database-schema-and-data-using-the-database-publishing-wizard"></a>Создание команд SQL для создания схемы базы данных и данных с помощью мастера публикации базы данных

Разрешить s показывает, как с помощью мастера публикации баз данных для развертывания в рабочей среде рецензий базы данных. Если вы используете Visual Studio 2008 или выше, мастер публикации базы данных еще не установлен. Если вы используете Visual Studio 2005, то необходимо будет первым [загрузить и установить](https://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&amp;displaylang=en) мастера.

Откройте Visual Studio и перейдите к `Reviews.mdf` базы данных. Если вы используете Visual Web Developer, перейдите в обозреватель базы данных; Если вы используете Visual Studio, используйте обозреватель серверов. На рисунке 4 показаны `Reviews.mdf` базы данных в обозревателе баз данных в Visual Web Developer. Как показано на рис. 4, `Reviews.mdf` база данных состоит из четырех таблиц, три хранимые процедуры и определяемые пользователем функции.


[![Найдите базу данных в обозревателе базы данных или обозревателя серверов](deploying-a-database-vb/_static/image11.jpg)](deploying-a-database-vb/_static/image10.jpg) 

**Рис. 4**: найдите базу данных в обозревателе серверов или обозревателя базы данных ([Просмотр полноразмерное изображение](deploying-a-database-vb/_static/image12.jpg))


Щелкните правой кнопкой мыши имя базы данных и выберите параметр «Опубликовать в поставщик» в контекстном меню. Откроется мастер публикации базы данных (см. рис. 5). Нажмите кнопку Далее, чтобы перейти за пределами экрана-заставки.


[![Экран-заставка мастер публикации базы данных](deploying-a-database-vb/_static/image14.jpg)](deploying-a-database-vb/_static/image13.jpg) 

**Рис. 5**: база данных публикации мастер экрана-заставки ([Просмотр полноразмерное изображение](deploying-a-database-vb/_static/image15.jpg))


Второй экран мастера перечислены доступные базы данных для мастера публикации баз данных и позволяет выбрать, следует ли в скрипт все объекты выбранной базы данных или выбрать, какие объекты в скрипт. Выберите соответствующую базу данных и оставить включен параметр «Скрипт все объекты выбранной базы данных».

> [!NOTE]
> Если появляется ошибка «нет объектов в базе данных *databaseName* типов с поддержкой сценариев с помощью этого мастера» при на экране, показанный на рисунке 6 нажав кнопку "Далее", убедитесь, что путь к файлу базы данных не является слишком длинные. Как отмечалось в [элемент обсуждения](http://www.codeplex.com/sqlhost/Thread/View.aspx?ThreadId=11014) на странице проекта мастера публикации баз данных эта ошибка может возникать, если указан слишком длинный путь к файлу базы данных.


[![Экран-заставка мастер публикации базы данных](deploying-a-database-vb/_static/image17.jpg)](deploying-a-database-vb/_static/image16.jpg) 

**Рис. 6**: база данных публикации мастер экрана-заставки ([Просмотр полноразмерное изображение](deploying-a-database-vb/_static/image18.jpg))


На следующем экране можно создать файл скрипта, или если ваш веб-узел ее поддерживает, опубликовать базу данных непосредственно на сервер веб-узле поставщика s базы данных. Как показано на рис. 7, у меня скрипт в файл `C:\REVIEWS.MDF.sql`.


[![Скриптов для базы данных в файл или опубликовать его непосредственно к поставщику вашего веб-узла](deploying-a-database-vb/_static/image20.jpg)](deploying-a-database-vb/_static/image19.jpg) 

**Рис. 7**: скриптов для базы данных в файл или опубликовать его непосредственно к поставщику вашего веб-узла ([Просмотр полноразмерное изображение](deploying-a-database-vb/_static/image21.jpg))


Последующие экрана запрашивает широкий набор параметров создания скриптов. Можно указать, должен ли скрипт включать инструкции drop для удаления этих существующих объектов. По умолчанию значение равно True, что очень удобно, если развертывание базы данных в первый раз. Можно также указать, будет ли в целевую базу данных SQL Server 2000, SQL Server 2005 или SQL Server 2008. Наконец, можно указать, включать ли в скрипт схему и данные, только данные или только схемы. Схема — это совокупность объектов базы данных, таблицы, хранимые процедуры, представления и т. д. Данные представляют сведения, хранимые в таблицах.

Как показано на рис. 8, я узле имеются мастера должен удалить существующие объекты базы данных, для создания скрипта для базы данных SQL Server 2008 и опубликовать схему и данные.


[![Укажите публикации параметров](deploying-a-database-vb/_static/image23.jpg)](deploying-a-database-vb/_static/image22.jpg) 

**Рис. 8**: задать параметры публикации ([Просмотр полноразмерное изображение](deploying-a-database-vb/_static/image24.jpg))


Окончательный двух экранах кратко описываются действия, которые будут выполнены, а затем отображают состояние создания скриптов. В результате выполнения мастера является, что у нас есть файл скрипта, содержащий команды SQL, необходимые для создания базы данных в рабочей среде и заполнить его с теми же данными, как и для разработки.

### <a name="executing-the-sql-commands-on-the-production-environment-database"></a>Выполнение команд SQL в базе данных рабочей среды

Теперь, когда у нас есть скрипт, который содержит команды SQL для создания базы данных и его данных, остается заключается в выполнении скрипта в рабочей базе данных. Некоторые поставщики веб узла предлагают текстового поля в панели управления для ввода команд SQL для выполнения в вашей базе данных. Если у вас есть очень большого файла скрипта, то этот параметр может не работать ( `REVIEWS.MDF.sql` файл сценария — более 425 КБ, например,).

Лучшим вариантом является подключение непосредственно на сервер рабочей базы данных, с помощью SQL Server Management Studio (SSMS). Если у вас есть отличные от Express Edition из SQL Server на компьютере установлена затем скорее всего уже установлена среда SSMS. В противном случае вы можете [загрузить и установить](https://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&amp;displaylang=en) копию SQL Server Management Studio Express Edition.

Запустите среду SSMS и подключитесь к сервер веб-узла s базы данных с помощью сведений, предоставленных поставщиком веб узла.


[![Подключения на веб-узле поставщика s базы данных сервер](deploying-a-database-vb/_static/image26.jpg)](deploying-a-database-vb/_static/image25.jpg) 

**Рис. 9**: подключиться к s ваш поставщик услуг узла сервера базы данных ([Просмотр полноразмерное изображение](deploying-a-database-vb/_static/image27.jpg))


Разверните вкладку базы данных и найдите базу данных. Нажмите кнопку "Создать запрос" в левом верхнем углу панели инструментов, вставьте в команды SQL из файла сценария, создаваемые с помощью мастера публикации баз данных и нажмите кнопку выполнения для запуска этих команд на рабочем сервере базы данных. Если файл сценария особенно велик она может занять несколько минут для выполнения команд.


[![Подключения на веб-узле поставщика s базы данных сервер](deploying-a-database-vb/_static/image29.jpg)](deploying-a-database-vb/_static/image28.jpg) 

**Рис. 10**: подключиться к s ваш поставщик услуг узла сервера базы данных ([Просмотр полноразмерное изображение](deploying-a-database-vb/_static/image30.jpg))


Все, что s — его! На этом этапе разработки базы данных дублируется в рабочей среде. При обновлении базы данных в среде SSMS вы увидите, что новые объекты базы данных. Рис. 11 показана рабочей базы данных s таблицы, хранимые процедуры и определяемые пользователем функции, которые являлись зеркальным отображением базы данных разработки. И связи с этим мы мастер публикации базы данных для публикации данных, таблицы s рабочей базы данных имеют те же данные таблицы s разработки базы данных во время выполнения мастера. Рис. 12 представлены данные в `Books` таблицы в рабочей базе данных.


[![Объекты базы данных повторяются на рабочей базы данных](deploying-a-database-vb/_static/image32.jpg)](deploying-a-database-vb/_static/image31.jpg) 

**Рис. 11**: база данных объекты были повторяются на производственной базы данных ([Просмотр полноразмерное изображение](deploying-a-database-vb/_static/image33.jpg))


[![Рабочая база данных содержит те же данные в базе данных разработки](deploying-a-database-vb/_static/image35.jpg)](deploying-a-database-vb/_static/image34.jpg) 

**Рис. 12**: рабочая база данных содержит те же данные как для базы данных разработки ([Просмотр полноразмерное изображение](deploying-a-database-vb/_static/image36.jpg))


На этом этапе мы только развернули разработки базы данных в рабочей среде. Мы еще не рассматривались развертывание самого веб-приложения или проверить необходимые изменения конфигурации приложением в рабочей среде использовать рабочей базы данных. В следующем уроке мы рассмотрим эти проблемы!

## <a name="summary"></a>Сводка

Для развертывания управляемых данными веб-приложения требуется копирование базы данных, используемые во время разработки в рабочую среду. Многие поставщики веб-узла предоставляют средства для упрощения процесса развертывания базы данных. Например, с DiscountASP.NET FTP базы данных `.mdf` файла (или резервной копии), а затем присоедините базу данных к серверу базы данных с помощью панели управления. Другой вариант, который работает независимо от того, какие возможности вашего веб-узле поставщика предложения является Microsoft s мастер публикации базы данных средства, которое формирует скрипт SQL-команд для создания схемы s разработки базы данных и данных. После создания этот скрипт вы можете выполнить для производственной базы данных.

Теперь, когда s рецензий веб-приложения база данных в рабочей среде мы можно развернуть приложение. Тем не менее сведения о конфигурации для приложения s web указывает строку подключения к базе данных, и эта строка подключения ссылается на базу данных разработки. Необходимо обновить данные этой строки соединения, при развертывании узла в рабочей среде. Следующее руководство рассматривает эти различия в конфигурации и рассматриваются шаги, необходимые для публикации сайта рецензий управляемых данными в рабочей среде.

Программирование довольны!

### <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения по темам, рассматриваемые в этом учебнике см. в следующих ресурсах:

- [Загрузка базы данных Microsoft SQL Server, 1.1 мастер публикации](https://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&amp;displaylang=en)
- [Загрузить Microsoft SQL Server Management Studio Express Edition](https://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&amp;displaylang=en)

>[!div class="step-by-step"]
[Назад](core-differences-between-iis-and-the-asp-net-development-server-vb.md)
[Вперед](configuring-the-production-web-application-to-use-the-production-database-vb.md)
