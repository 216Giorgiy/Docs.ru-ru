---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/users-and-roles-on-the-production-website-vb
title: Пользователи и роли рабочего веб-сайта (VB) | Документы Microsoft
author: rick-anderson
description: Средство администрирования веб-сайт ASP.NET (WSAT) предоставляет веб-интерфейс для настройки параметров членства и ролей, а также для создания, редактирования,...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/09/2009
ms.topic: article
ms.assetid: 491ed5ae-9be1-4191-87be-65e4e1c57690
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/users-and-roles-on-the-production-website-vb
msc.type: authoredcontent
ms.openlocfilehash: 611a54b9dd5f188fd64c7020bfbf8171fea27a71
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30886996"
---
<a name="users-and-roles-on-the-production-website-vb"></a>Пользователи и роли рабочего веб-сайта (Visual Basic)
====================
по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Скачать PDF](http://download.microsoft.com/download/5/C/5/5C57DB8C-5DEA-4B3A-92CA-4405544D313B/aspnet_tutorial16_CustomAWAT_vb.pdf)

> Средство администрирования веб-сайт ASP.NET (WSAT) предоставляет веб-интерфейс для настройки параметров членства и ролей и создание, изменение и удаление пользователей и ролей. К сожалению WSAT работает только при посещении с localhost, это означает, что невозможно достичь рабочий веб-сайт администрирования через браузер. Хорошие новости: существуют способы решения проблем, которые позволяют управлять пользователями и ролями в рабочей среде. Этот учебник анализирует эти действия и др.


## <a name="introduction"></a>Вступление

ASP.NET 2.0 появился ряд *службы приложений*, которые являются набором стандартных блоков служб, которые можно добавить в веб-приложение. Мы добавили членства и ролей службы веб-сайт рецензий обратно в [ *Настройка веб-сайт, использующий службы приложений* учебника](configuring-a-website-that-uses-application-services-vb.md). Службы членства упрощает создание и управление учетных записей пользователей; службы роли есть API, распределение по группам пользователей. Сайт рецензий имеет три учетные записи пользователей - Скотт, Цзисунь и Анна - и одна роль администратора с Скотт и Цзисунь в роли администратора.

ASP. Службы приложений NET не привязаны к конкретной реализации. Вместо этого вы указываете служб приложений для использования конкретного *поставщика*, и этот поставщик реализует службу с помощью определенной технологии. Настраивался рецензий веб-приложении использование `SqlMembershipProvider` и `SqlRoleProvider` поставщиков для служб членства и ролей. Эти два поставщика хранить сведения об учетной записи и роль пользователя в базе данных SQL Server и наиболее часто используемых поставщиков для Интернет клиентов веб-приложений, размещенных на веб-хостинга.

Управляет общей проблемой для разработчиков, использующих службы членства и ролей пользователей и ролей в рабочей среде. Как можно удалить учетную запись пользователя из рабочей веб-сайт, добавить новую роль или Добавление существующего пользователя в существующую роль? Этот учебник рассматриваются различные методы для управления пользователями и ролями рабочих веб-сайта.

## <a name="using-the-aspnet-web-site-administration-tool"></a>С помощью ASP.NET Web Site Administration Tool

В ASP.NET есть [Web Site Administration Tool](https://msdn.microsoft.com/library/yy40ytx0.aspx) (WSAT), упрощает создание и управление учетными записями пользователей и ролями и указать правила авторизации пользователей и ролей. Для использования WSAT, щелкните значок Конфигурация ASP.NET в обозревателе решений, или перейдите в меню веб-сайт или проект и выберите параметр конфигурации ASP.NET. Любой из этих подходов запускает веб-браузер и указывает его WSAT к адресу, например: `http://localhost:portNumber/asp.netwebadminfiles/default.aspx?applicationPhysicalPath=pathToApplication`

WSAT состоит из трех разделов:

- **Безопасность** -Управление пользователями, ролями и правила авторизации.
- **ApplicationConfiguration** -управление &lt;appSettings&gt; и параметры SMTP отсюда. Вы можно также перевести приложение в автономный режим и управлять параметры здесь отладки и трассировки, а также указать страницу настраиваемой ошибки по умолчанию.
- **ProviderConfiguration** -Настройка поставщиков, используемых службами приложений.

Раздел безопасности (показано в **рис. 1**) содержит ссылки для правила доступа, создания новых пользователей, управление пользователями, создание и управление ролями и создания и управления. Здесь можно добавить новую роль в системе, удаление существующего пользователя или добавить или удалить из учетной записи пользователя роли.

[![](users-and-roles-on-the-production-website-vb/_static/image2.png)](users-and-roles-on-the-production-website-vb/_static/image1.png)

**Рис. 1**: WSAT раздел безопасности содержит параметры для управления пользователями и ролями  
([Просмотр полноразмерное изображение](users-and-roles-on-the-production-website-vb/_static/image3.png))

К сожалению WSAT доступен только локально. Не удается посетите WSAT на веб-сайте удаленного производственного; При посещении `www.yoursite.com/asp.netwebadminfiles/default.aspx` получить ответ 404 не найдено. Код, который использует WSAT лежащих в основе `Membership` и `Roles` классы в .NET Framework для создания, изменения и удаления пользователей и ролей. Эти классы см. сведения о конфигурации веб-приложения, чтобы определить, какой поставщик для использования; в [ *Настройка веб-сайт, использующий службы приложений* учебника](configuring-a-website-that-uses-application-services-vb.md) мы настраиваем рецензий веб-сайта по `SqlMembershipProvider` и `SqlRoleProvider` поставщиков. Это осуществлялось путем добавления `<membership>` и `<roleManager>` разделов для `Web.config`.

[!code-xml[Main](users-and-roles-on-the-production-website-vb/samples/sample1.xml)]

Обратите внимание, что `<membership>` и `<roleManager>` разделах ссылки `SqlMembershipProvider` и `SqlRoleProvider` поставщиков в их `type` атрибута, соответственно. Эти поставщики хранения пользователя и сведения о роли в указанной базе данных SQL Server. Задается база данных, используемая эти поставщики `connectionStringName` атрибут, `ReviewsConnectionString`, которая определена в `~/ConfigSections/databaseConnectionStrings.config` файла. Помните, что `databaseConnectionStrings.config` файл в интегрированной среде разработки содержит строку подключения к базе данных разработки, в то время как `databaseConnectionStrings.config` файл в производстве содержит строку подключения в производственной базе данных.

По сути, WSAT должен осуществляться локально через среду разработки, и он работает с данными пользователя и роли базы данных, указанной в `databaseConnectionStrings.config` файла. Следовательно Если изменить строку подключения в `databaseConnectionStrings.config` файла в среде разработки можно использовать WSAT локально для управления пользователями и ролями в рабочей среде.

Чтобы продемонстрировать эту функцию, откройте `databaseConnectionStrings.config` в Visual Studio в среде разработки и замените строку подключения базы данных разработки строку подключения для рабочей базы данных. Затем запустите WSAT, перейдите на вкладку Безопасность и добавить нового пользователя с именем Sam с паролем «password». (меньше кавычки). **На рисунке 2** показывает экран WSAT при создании этой учетной записи.

[![](users-and-roles-on-the-production-website-vb/_static/image5.png)](users-and-roles-on-the-production-website-vb/_static/image4.png)

**На рисунке 2**: создать нового пользователя с именем Sam в рабочей среде  
([Просмотр полноразмерное изображение](users-and-roles-on-the-production-website-vb/_static/image6.png))

Так как мы изменили строку подключения в `databaseConnectionStrings.config` для указания на производственный сервер базы данных Sam, добавленная в качестве пользователя в рабочей среде. Чтобы проверить это, измените строку подключения в `databaseConnectionStrings.config` файла в базу данных разработки и посетите `Login.aspx` страницы в среде разработки. Попытайтесь войти в качестве диспетчера учетных записей безопасности (см. **рис. 3**).

[![](users-and-roles-on-the-production-website-vb/_static/image8.png)](users-and-roles-on-the-production-website-vb/_static/image7.png)

**Рис. 3**: не удается войти в качестве Sam в среде разработки  
([Просмотр полноразмерное изображение](users-and-roles-on-the-production-website-vb/_static/image9.png))

Не удается войти в качестве Sam в среде разработки, так как учетная запись пользователя не существует в локальной базе данных. Вместо этого будет добавлен в производственной базе данных. Чтобы проверить это, просмотр содержимого `aspnet_Users` таблицы в средах разработки, так и в рабочих базах данных. В среде разработки следует только три записи для пользователей, Scott Цзисунь и Анна. Однако `aspnet_Users` таблица рабочей базы данных содержит четыре записи: Скотт, Цзисунь, Алиса и Sam. Следовательно Sam можно выполнить вход через веб-сайт в рабочей среде, но не с помощью среды разработки.

[![](users-and-roles-on-the-production-website-vb/_static/image11.png)](users-and-roles-on-the-production-website-vb/_static/image10.png)

**Рис. 4**: Sam может войти рабочий веб-сайт  
([Просмотр полноразмерное изображение](users-and-roles-on-the-production-website-vb/_static/image12.png))

> [!NOTE]
> Не забудьте изменить строку подключения в `databaseConnectionStrings.config` файл обратно в базу данных разработки строка подключения по окончании работы с WSAT в противном случае вы будете работать с рабочими данными при проверке узла по разработке Среда. Также имейте в виду, что метод, который мы только что обсудили мы сможем использовать WSAT для удаленного управления пользователями и ролями, изменения в любые другие WSAT параметры конфигурации (правила доступа, SMTP настройки, отладки и трассировки параметров и т. д) изменить `Web.config` файл. Следовательно любые изменения, внесенные в параметры применимы к среде разработки, а не в рабочей среде.


## <a name="creating-custom-user-and-role-management-web-pages"></a>Создание пользовательского и роль управления веб-страницы

WSAT предоставляет вне системы поле для управления пользователями и ролями, но может быть запущен только локально и требует внесения изменений в строку подключения для управления пользователями и ролями в производстве. Большинство веб-сайтов, поддерживающих учетные записи пользователей также включают ряд пользователей и роли администрирования веб-страниц, которые позволяют администраторам управлять пользователями и ролями со страниц на сайте. Такие страницы веб-администрирования было гораздо проще управлять пользователями и ролями и очень важны для сайтов, где может быть много администраторов или администраторов, которые не имеют доступа к или технические использовать Visual Studio для запуска WSAT.

ASP.NET включает ряд встроенных входа веб-элементов управления, которые делают реализации многих из этих веб-страниц администрирования так же легко, как перетаскивание. Например можно создать страницу для администраторов для создания учетной записи пользователя путем перетаскивания элемента управления CreateUserWizard на странице и установка нескольких свойств. На самом деле, страница для создания пользователей в WSAT, показанный на **рис. 2** использует тот же элемент управления CreateUserWizard, который можно добавить на страницы. Кроме того, становятся доступны программным способом с помощью функции членства и ролей служб `Membership` и `Roles` классы в .NET Framework. Эти классы можно написать код для создания, изменение и удаление пользователей и ролей, а также для добавления или удаления пользователей ролям, для определения пользователей в роли и выполнять другие задачи, связанные с пользователем и роли.

В [ *Настройка веб-сайт, использующий службы приложений* учебника](configuring-a-website-that-uses-application-services-vb.md) добавлены на страницу, чтобы `Admin` папку с именем `CreateAccount.aspx`. Эта страница позволяет администратору для добавления новой учетной записи пользователя на узел и указать, является ли только что созданный пользователь в роли администратора (в разделе **рис. 5**).

[![](users-and-roles-on-the-production-website-vb/_static/image14.png)](users-and-roles-on-the-production-website-vb/_static/image13.png)

**Рис. 5**: Администраторы могут создавать новые учетные записи пользователей  
([Просмотр полноразмерное изображение](users-and-roles-on-the-production-website-vb/_static/image15.png))

Более подробное рассмотрение построения страниц администрирования пользователя и роли, а также пошаговые инструкции по использованию `Membership` и `Roles` классы и элементы управления ASP.NET Web, связанные с именем входа, не забудьте прочитать Мой [безопасности веб-сайта Учебники по](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md). Вы найдете рекомендации по созданию веб-страниц для создания новых учетных записей, создание и управление ролями, назначения пользователей с ролями и другие стандартные административные задачи.

Для реализации функции типа WSAT на рабочий веб-сайт всегда можно создать собственную серию веб-страниц, реализующих функции WSAT. Чтобы помочь приступить к работе, ознакомьтесь с WSAT исходный код, который находится в папке `%WINDIR%\Microsoft.NET\Framework\v2.0.50727\ASP.NETWebAdminFiles`. Другой вариант — использовать вариант WSAT Dan Clem, который он использует в своей статье, [последовательное свои собственные Web Site Administration Tool](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx). Дэн проводит читателей через процесс создания пользовательского инструмента WSAT like, включает исходный код своего приложения для загрузки (в C#) и предоставляет пошаговые инструкции по добавлению его пользовательские WSAT размещенного веб-сайт.

## <a name="summary"></a>Сводка

Средство администрирования веб-сайта ASP.NET (WSAT) можно использовать в сочетании с членством и ролями служб приложения для управления данными пользователя и роли для веб-сайта. К сожалению WSAT доступен только локально и не может быть обход рабочий веб-сайт. Тем не менее изменив строку подключения в разработке среды, чтобы он указывал на производственную базу данных можно использовать WSAT для управления пользователями и ролями рабочих веб-сайта.

Хотя подход WSAT данных позволяет быстро и легко управлять пользователями и ролями, его необходимо запуск WSAT из Visual Studio, а также временные изменения в строке подключения. WSAT предоставляет быстрый способ управлять пользователями и ролями в рабочей среде, но неудобно и подходит для веб-сайтов, с нескольких администраторов или администраторов, которые не имеют или не знакомы с Visual Studio и WSAT. По этим причинам большинство веб-сайтов, поддерживающих учетные записи пользователей содержат набор веб-страниц администрирования. Набор веб-страниц, устраняет необходимость WSAT и использовать различные пользователями с правами администратора на любом компьютере.

Программирование довольны!

### <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения по темам, рассматриваемые в этом учебнике см. в следующих ресурсах:

- [Проверка ASP. NET членства, ролей и профиля](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [Последовательное собственные Web Site Administration Tool](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)
- [Обзор средства администрирования веб-сайта](https://msdn.microsoft.com/library/yy40ytx0.aspx)
- [Учебники по безопасности веб-сайта](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md)

> [!div class="step-by-step"]
> [Назад](precompiling-your-website-vb.md)
