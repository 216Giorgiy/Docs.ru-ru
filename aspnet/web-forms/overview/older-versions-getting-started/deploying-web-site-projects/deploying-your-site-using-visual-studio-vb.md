---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-your-site-using-visual-studio-vb
title: Развертывание узла с помощью Visual Studio (VB) | Документы Microsoft
author: rick-anderson
description: Visual Studio включает средства для развертывания веб-сайта. Дополнительные сведения об этих средствах в этом учебнике.
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/01/2009
ms.topic: article
ms.assetid: 977105f3-7987-4e50-8be7-afb53b4ca28a
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-your-site-using-visual-studio-vb
msc.type: authoredcontent
ms.openlocfilehash: 1c0e094761a92b10555d2cfcef586ad8c2fb8d27
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="deploying-your-site-using-visual-studio-vb"></a>Развертывание узла с помощью Visual Studio (Visual Basic)
====================
по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Загрузить код](http://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_04_VB.zip) или [скачать PDF](http://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial04_DeployingViaVS_vb.pdf)

> Visual Studio включает средства для развертывания веб-сайта. Дополнительные сведения об этих средствах в этом учебнике.


## <a name="introduction"></a>Вступление

Предыдущего учебника рассматривали развертывание простой веб-приложения ASP.NET к веб-узла. В частности учебник, было показано, как использовать FTP-клиент как FileZilla для передачи необходимые файлы из среды разработки в рабочую среду. Visual Studio также предоставляет встроенные средства для упрощения развертывания узла поставщика услуг. Этот учебник проверяет два из этих инструментов: средство копирования веб-сайта, где можно будет переместить файлы в и из удаленного веб-сервера с помощью FTP или серверных расширений FrontPage; и средство публикации, которое копирует весь веб-сайт в указанном расположении.


> [!NOTE]
> Другие средства, связанных с развертыванием, предоставляемые Visual Studio включают [веб-проекты установки](https://msdn.microsoft.com/library/wx3b589t.aspx) и [веб-развертывания проектов](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en) надстройки. Веб-проекты установки пакета содержимого веб-сайта и сведения о конфигурации в единый файл MSI. Этот параметр наиболее полезен для веб-сайтов, которые развертываются в локальной сети или для компаний, торгующих предварительно упакованные веб-приложения, Установка клиентов на своих собственных веб-серверах. Надстройка Web развертывания проектов является Visual Studio надстройки, которая позволяет указывать конфигурации различия между построений для сред разработки и рабочих средах. Веб-проекты установки не рассматриваются в данной серии учебных курсов; Развертывание веб-проектов, приведены в [ *распространенные конфигурации различия между разработки и эксплуатации* ](common-configuration-differences-between-development-and-production-vb.md) учебника.


## <a name="deploying-your-site-using-the-copy-web-site-tool"></a>Развертывание узла с помощью средства копирования веб-сайта

Средство копирования веб-сайта Visual Studio схожую функциональность автономного FTP-клиента. По сути средства копирования веб-сайта позволяет подключиться к удаленный веб-сайт через FTP или серверные расширения FrontPage. Подобно FileZilla по пользовательскому интерфейсу, пользовательский интерфейс копирования веб-сайта состоит из двух панелей: панели слева перечислены локальных файлов во время в правой части перечислены эти файлы на целевом сервере.

> [!NOTE]
> Средство копирования веб-сайт доступен только для проектов веб-сайтов. Visual Studio предлагает этот инструмент, при работе с проектом веб-приложения.


Давайте рассмотрим использование средства копирования веб-сайта для публикации приложения рецензия на книгу в производственную среду. Так как средство копирования веб-узла работает только с проектами, которые используют модель проекта веб-сайта только можно проверить с помощью этого средства в проекте BookReviewsWSP. Откройте этот проект.

Запустите проект средства копирования веб-сайта, щелкнув значок копирования веб-узла в обозревателе решений (этот значок обведен на рис. 1); Кроме того можно выбрать параметр Копировать веб-сайт в меню веб-сайта. Любой из этих подходов запускает пользовательский интерфейс копирования веб-узла показано на рисунке 1; только слева на рисунке 1 заполняется, так как у нас есть еще для подключения к удаленному серверу.


[![Пользовательский интерфейс средства копирования веб-узла будет разделить на две области](deploying-your-site-using-visual-studio-vb/_static/image2.png)](deploying-your-site-using-visual-studio-vb/_static/image1.png)

**Рис. 1**: копирования веб-сайта пользовательским интерфейсом средства — разделить на две области ([Просмотр полноразмерное изображение](deploying-your-site-using-visual-studio-vb/_static/image3.png))


Чтобы развернуть узел необходимо сначала подключиться к веб-узла. Нажмите кнопку "Подключить" в верхней части пользовательского интерфейса для копирования веб-сайта. Откроется диалоговое окно Открыть веб-сайт, показанный на рисунке 2.

Назначение веб-сайта можно соединиться, выбрав один из четырех вариантов слева.

- **Файловая система** -выберите этот параметр, чтобы развернуть сайт в общую папку или сетевую папку доступ с вашего компьютера.
- **Локальный сервер IIS** -используйте этот параметр для развертывания узла к веб-серверу IIS, установленной на компьютере.
- **FTP-сайта** -подключения для удаленного веб-сайта с помощью протокола FTP.
- **Удаленный узел** -подключения к удаленному веб-сайту с использованием серверных расширений FrontPage.

Большинство поставщиков веб-узла поддерживает FTP, но меньше обеспечивают поддержку серверных расширений FrontPage. По этой причине я выбран параметр FTP-сайта и затем вводить сведения о соединении, как показано на рис. 2.


[![Указать целевой веб-сайт](deploying-your-site-using-visual-studio-vb/_static/image5.png)](deploying-your-site-using-visual-studio-vb/_static/image4.png)

**На рисунке 2**: укажите целевой веб-сайт ([Просмотр полноразмерное изображение](deploying-your-site-using-visual-studio-vb/_static/image6.png))


После подключения, средства копирования веб-узла загружает файлы на удаленном сайте в правой области и отображает состояние каждого файла: новые возможности, Deleted, изменено или без изменений. Можно скопировать файл с локального сайта в удаленный узел или наоборот a.

Давайте добавим новую страницу BookReviewsWSP проект и развернуть его, чтобы мы могли видеть средство копирования веб-узла в действии. Создайте новую страницу ASP.NET в Visual Studio в корневом каталоге с именем `Privacy.aspx`. Страница, на главной странице `Site.master` и добавить политику конфиденциальности на веб-узле на эту страницу. На рисунке 3 показана Visual Studio после создания этой страницы.


[![Добавление новой страницы с именем &lt;кода&gt;Privacy.aspx&lt;/code&gt; корневую папку веб-сайта](deploying-your-site-using-visual-studio-vb/_static/image8.png)](deploying-your-site-using-visual-studio-vb/_static/image7.png)

**Рис. 3**: Добавление новой страницы с именем `Privacy.aspx` корневую папку веб-сайта ([Просмотр полноразмерное изображение](deploying-your-site-using-visual-studio-vb/_static/image9.png))


Далее возвращается к пользовательскому интерфейсу копирования веб-сайта. Как показано на рис. 4, в левой области теперь включает новые файлы - `Policy.aspx` и `Policy.aspx.vb`. Более того эти файлы будут отмечены значок со стрелкой и состояние из новая, указывающее на то, что они существуют на локальном узле, но не на удаленном сайте.


[![Средство копирования веб-узла включает новое &lt;кода&gt;Privacy.aspx&lt;/code&gt; страницы в ее левой области](deploying-your-site-using-visual-studio-vb/_static/image11.png)](deploying-your-site-using-visual-studio-vb/_static/image10.png)

**Рис. 4**: средство копирования веб-узла включает новое `Privacy.aspx` страницы в ее левой области ([Просмотр полноразмерное изображение](deploying-your-site-using-visual-studio-vb/_static/image12.png))


Для развертывания новых файлов, выберите их и щелкните значок со стрелкой для перемещения их на удаленный сайт. После завершения передачи `Policy.aspx` и `Policy.aspx.vb` файлы существуют на локальных и удаленных узлах с состояние Unchanged.

А также список новых файлов, средство копирования веб-узла выделяет все файлы, которые различаются между локальными и удаленными сайтами. Чтобы увидеть это в действии, вернуться к `Privacy.aspx` страницы и добавить несколько слов о политике конфиденциальности. Сохраните страницу, а затем вернитесь в средство копирования веб-сайта. Как показано на рисунке 5, `Privacy.aspx` страницы на панели слева находится в состоянии Changed, указывающее, что он синхронизирован с удаленного узла.


[![Средство копирования веб-узла означает, что &lt;кода&gt;Privacy.aspx&lt;/code&gt; страницы был изменен.](deploying-your-site-using-visual-studio-vb/_static/image14.png)](deploying-your-site-using-visual-studio-vb/_static/image13.png)

**Рис. 5**: Указывает, что средство копирования веб-узла `Privacy.aspx` страницы был изменен ([Просмотр полноразмерное изображение](deploying-your-site-using-visual-studio-vb/_static/image15.png))


Средство копирования веб-узла также указывается, если файл был удален с момента последней операции копирования. Удалить `Privacy.aspx` из локального проекта и обновить средство копирования веб-узла. `Privacy.aspx` И `Privacy.aspx.vb` файлы остаются в списке в левой области, но в состоянии Deleted, указывающее на то, что они были удалены с момента последней операции копирования.

## <a name="publishing-a-web-application"></a>Публикация веб-приложения

Другой способ развертывания веб-приложения из среды Visual Studio — использовать параметр публикации, который предоставляется через меню "Построение". Параметр публикации явно компилирует приложение и затем копирует все необходимые файлы вплоть до указанного удаленного узла. Как мы скоро будет убедиться, параметр публикации — более тупыми чем средство копирования веб-узла. В то время как средство копирования веб-сайта позволяет изучить файлы на локальных и удаленных узлах и позволяет выгружать или загружать отдельные файлы, при необходимости, параметр публикации развертывает всего веб-приложения.


Помимо копирования все необходимые файлы для указанного удаленного сайта, вариант Публикация явным образом компиляции приложения. Учитывая, что проекты веб-приложений должны быть явно скомпилирована он должен иметь как не удивительно, что параметр публикации доступен для проектов веб-приложений. Что может быть немного странно является элемент «опубликовать» также доступны для проектов веб-сайтов. Как отмечалось в [ *определения файлов, которые должны быть развернуты* ](determining-what-files-need-to-be-deployed-vb.md) учебника проектов веб-сайтов может быть скомпилирован явным образом через процесс называют *предварительной компиляции*. Этот учебник посвящен использованию параметра публикации проектов веб-приложений; будущие учебника будет изучено предварительной компиляции, после чего мы вернемся к рассмотрению с помощью параметра публикации проектов веб-сайтов.

> [!NOTE]
> Во время публикации доступен в Visual Studio для проектов веб-сайтов и проектов веб-приложений, Visual Web Developer только предоставляет возможность публикации проектов веб-приложений.


Давайте взглянем на развертывание приложения рецензий, используя параметр публикации. Сначала откройте BookReviewsWAP (проект веб-приложения) в Visual Studio. Выберите в меню публикации BookReviewsWAP построения проекта. Откроется диалоговое окно с запросом в целевое расположение, среди других параметров конфигурации (см. рис. 6). Гораздо как с помощью средства копирования веб-сайта можно ввести расположение, которое указывает локальную папку, локальный веб-сайт на сервере IIS, удаленный веб-узел, поддерживающий серверные расширения FrontPage или адрес FTP-сервера. Можно выбрать, следует ли заменить файлы на удаленном веб-сервере развернутых файлов или удалить все содержимое на удаленном узле перед публикацией. Можно также указать, следует ли копировать:

- Только файлы в проекте, необходимые для выполнения приложения, который пропускает перевод ненужные исходный код и файлы, связанные с проектом.
- Все файлы проекта, включая файлы исходного кода и файлов проекта Visual Studio, такие как файл решения.
- Все файлы в папке проекта источника копируются все файлы из исходной папки проекта, независимо от того, является ли они включены в проект.

Имеется также возможность отправки содержимого `App_Data` папки.


[![Указать целевой веб-сайт](deploying-your-site-using-visual-studio-vb/_static/image17.png)](deploying-your-site-using-visual-studio-vb/_static/image16.png)

**Рис. 6**: укажите целевой веб-сайт ([Просмотр полноразмерное изображение](deploying-your-site-using-visual-studio-vb/_static/image18.png))


Для приложения рецензия на книгу удаленный сайт содержит файлы, развернутые при копировании проекта BookReviewsWSP через средство копирования веб-узла. Таким образом давайте можете опубликовать удалить все ее содержимое. Кроме того Давайте просто скопировать необходимые файлы, а не засорять в рабочей среде с ненужные исходного кода и файлов проекта. После указания этих параметров, нажмите кнопку "Опубликовать". На следующих нескольких секунд Visual Studio развернет необходимые файлы на конечный сайт отображение ход его выполнения в окне вывода.

На рисунке 7 показано файлов на FTP-сайта после завершения операции публикации. Обратите внимание, что только разметки страницы и необходимости sever клиента стороне и вспомогательные файлы были отправлены.


[![Только необходимые файлы были опубликованы в рабочей среде](deploying-your-site-using-visual-studio-vb/_static/image20.png)](deploying-your-site-using-visual-studio-vb/_static/image19.png)

**Рис. 7**: только необходимые файлы были опубликованы в рабочей среде ([Просмотр полноразмерное изображение](deploying-your-site-using-visual-studio-vb/_static/image21.png))


Параметр публикации — менее огромным средство от средства копирования веб-сайта. Средство копирования веб-сайта позволяет проверять файлы на локальных и удаленных узлах и просмотреть, как они отличаются, элемент «опубликовать» предоставляет интерфейс отсутствует. Кроме того средство копирования веб-сайта позволяет изменять параметры одноразовые, отправка или удаление отдельных файлов. Вариант Публикация не допускает такой точного управления; Вместо этого он публикует *всей* приложения. Такое поведение влечет его преимущества и недостатки. Преимущество такого подхода вы знаете, при использовании параметра публикации не изменяется отправлять файл важные. Рассмотрим, что произойдет при внесении небольшое изменение очень больших веб-сайт - с возможностью публикации не удается обновить эту страницу или два, который был изменен, но вместо этого необходимо дождаться завершения Visual Studio развертывает всего сайта.

Не часто бывает определенных файлов, содержимое которых отличается от рабочей среды разработки. Пример ключа является файл конфигурации приложения, `Web.config`. Так как публикация слепо копируются файлы веб-приложения его перезаписывает файлы рабочей среде пользовательскую конфигурацию с версией в среде разработки. Последующие учебника более подробно рассматривается в этом разделе и предлагает советы по развертыванию веб-приложения, если существует подобные различия.

## <a name="summary"></a>Сводка

Развертывание веб-сайта включает копирование необходимые файлы из среды разработки в рабочую среду. Предыдущем учебнике было показано, как передача файлов по FTP-клиент как FileZilla. Этот учебник проверить два средства развертывания в Visual Studio: средство копирования веб-узла и элемент «опубликовать». Средство копирования веб-узла аналогична FTP-клиента в том, что он имеет два разделенного интерфейс со списком файлов на локальном компьютере и указанного удаленного компьютера, упрощающий выгружать или загружать файлы между двумя компьютерами. Параметр публикации — это более тупыми средство, которое явно скомпилирует проект и выполнит развертывание всего приложения в указанное назначение.

Программирование довольны!

### <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения по темам, рассматриваемые в этом учебнике см. в следующих ресурсах:

- [Копирование веб-сайта с помощью средства копирования веб-сайта](https://msdn.microsoft.com/library/1cc82atw.aspx)
- [Как I: следует развертывать веб-сайта с помощью средства копирования веб-сайта](../../../videos/how-do-i/how-do-i-deploy-a-web-site-using-the-copy-web-site-tool.md) (видео)
- [Практическое руководство: Публикация проектов веб-приложений](https://msdn.microsoft.com/library/aa983453.aspx)
- [Практическое руководство: Публикация веб-сайтов](https://msdn.microsoft.com/library/20yh9f1b.aspx)
- [Проекты установки и развертывания в Visual Studio](https://msdn.microsoft.com/library/wx3b589t.aspx)

> [!div class="step-by-step"]
> [Назад](deploying-your-site-using-an-ftp-client-vb.md)
> [Вперед](common-configuration-differences-between-development-and-production-vb.md)
