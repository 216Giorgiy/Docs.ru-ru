---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/configuring-a-website-that-uses-application-services-cs
title: Настройка веб-сайта, использующего службы приложений (C#) | Документы Microsoft
author: rick-anderson
description: ASP.NET версии 2.0 включает ряд служб приложений, которые входят в состав платформы .NET Framework и использовать в качестве стандартного блока набор служб, ё...
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/23/2009
ms.topic: article
ms.assetid: 1e33d1c6-3f9f-4c26-81e2-2a8f8907bb05
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/configuring-a-website-that-uses-application-services-cs
msc.type: authoredcontent
ms.openlocfilehash: da4ef328e3461e96fbb0cdca156ce1b9a076748f
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="configuring-a-website-that-uses-application-services-c"></a><span data-ttu-id="b96a5-103">Настройка веб-сайта, использующего службы приложений (C#)</span><span class="sxs-lookup"><span data-stu-id="b96a5-103">Configuring a Website that Uses Application Services (C#)</span></span>
====================
<span data-ttu-id="b96a5-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b96a5-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b96a5-105">[Загрузить код](http://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_09_CS.zip) или [скачать PDF](http://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial09_AppServicesConfig_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="b96a5-105">[Download Code](http://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_09_CS.zip) or [Download PDF](http://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial09_AppServicesConfig_cs.pdf)</span></span>

> <span data-ttu-id="b96a5-106">ASP.NET версии 2.0 появился ряд служб приложений, которые входят в состав платформы .NET Framework и использовать в качестве набора службы стандартных блоков, которые можно использовать для добавления широкий набор функций для веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="b96a5-106">ASP.NET version 2.0 introduced a series of application services, which are part of the .NET Framework and serve as a suite of building block services that you can use to add rich functionality to your web application.</span></span> <span data-ttu-id="b96a5-107">Этот учебник более подробно рассматривается настройка веб-сайт в рабочей среде для использования службы приложений и распространенные проблемы, связанные с ролями в рабочей среде и учетные записи пользователей.</span><span class="sxs-lookup"><span data-stu-id="b96a5-107">This tutorial explores how to configure a website in the production environment to use application services and addresses common issues with managing user accounts and roles on the production environment.</span></span>


## <a name="introduction"></a><span data-ttu-id="b96a5-108">Вступление</span><span class="sxs-lookup"><span data-stu-id="b96a5-108">Introduction</span></span>

<span data-ttu-id="b96a5-109">ASP.NET версии 2.0 включает ряд *службы приложений*, который входят в состав платформы .NET Framework и служить в качестве стандартного блока набор служб, которые можно использовать для добавления широкий набор функций для веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="b96a5-109">ASP.NET version 2.0 introduced a series of *application services*, which are part of the .NET Framework and serve as a suite of building block services that you can use to add rich functionality to your web application.</span></span> <span data-ttu-id="b96a5-110">Службы приложений входят:</span><span class="sxs-lookup"><span data-stu-id="b96a5-110">The application services include:</span></span>

- <span data-ttu-id="b96a5-111">**Членство** — это API-Интерфейс для создания и управления учетными записями пользователей.</span><span class="sxs-lookup"><span data-stu-id="b96a5-111">**Membership** - an API for creating and managing user accounts.</span></span>
- <span data-ttu-id="b96a5-112">**Роли** — это API-Интерфейс для распределение по группам пользователей.</span><span class="sxs-lookup"><span data-stu-id="b96a5-112">**Roles** - an API for categorizing users into groups.</span></span>
- <span data-ttu-id="b96a5-113">**Профиль** — это API-Интерфейс для хранения настраиваемых, пользовательских содержимого.</span><span class="sxs-lookup"><span data-stu-id="b96a5-113">**Profile** - an API for storing custom, user-specific content.</span></span>
- <span data-ttu-id="b96a5-114">**Карта сайта** — это API-Интерфейс для определения сайта s логическая структура в виде иерархии, который затем можно отобразить через элементы управления навигацией, например меню и адресной строки.</span><span class="sxs-lookup"><span data-stu-id="b96a5-114">**Site Map** - an API for defining a site s logical structure in the form of a hierarchy, which can then be displayed via navigation controls, such as menus and breadcrumbs.</span></span>
- <span data-ttu-id="b96a5-115">**Персонализация** — это API-Интерфейс для поддержки настраиваемых параметров, наиболее часто используется с [ *веб-части*](https://msdn.microsoft.com/library/e0s9t4ck.aspx).</span><span class="sxs-lookup"><span data-stu-id="b96a5-115">**Personalization** - an API for maintaining customization preferences, most often used with [*WebParts*](https://msdn.microsoft.com/library/e0s9t4ck.aspx).</span></span>
- <span data-ttu-id="b96a5-116">**Наблюдение за работоспособностью** — это API-Интерфейс для мониторинга производительности, безопасности, ошибки и другие показатели работоспособности системы для выполнения веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="b96a5-116">**Health Monitoring** - an API for monitoring performance, security, errors, and other system health metrics for a running web application.</span></span>
  

<span data-ttu-id="b96a5-117">API-интерфейсы служб приложений не связаны с конкретной реализации.</span><span class="sxs-lookup"><span data-stu-id="b96a5-117">The application services APIs are not tied to a specific implementation.</span></span> <span data-ttu-id="b96a5-118">Вместо этого вы указываете служб приложений для использования конкретного *поставщика*, и этот поставщик реализует службу с помощью определенной технологии.</span><span class="sxs-lookup"><span data-stu-id="b96a5-118">Instead, you instruct the application services to use a particular *provider*, and that provider implements the service using a particular technology.</span></span> <span data-ttu-id="b96a5-119">Наиболее часто используемых Интернет клиентов веб-приложений, размещенных на веб-хостинга, нет тех поставщиков, которые используется реализация базы данных SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b96a5-119">The most commonly used providers for Internet-based web applications hosted at a web hosting company are those providers that use a SQL Server database implementation.</span></span> <span data-ttu-id="b96a5-120">Например `SqlMembershipProvider` является поставщиком для API членства, который сохраняет сведения об учетной записи пользователя в базе данных Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b96a5-120">For example, the `SqlMembershipProvider` is a provider for the Membership API that stores user account information in a Microsoft SQL Server database.</span></span>

<span data-ttu-id="b96a5-121">С помощью приложения службы и поставщики SQL Server добавляет некоторые проблемы при развертывании приложения.</span><span class="sxs-lookup"><span data-stu-id="b96a5-121">Using the application services and SQL Server providers adds some challenges when deploying the application.</span></span> <span data-ttu-id="b96a5-122">Во-первых объекты базы данных служб приложения должен быть правильно создан для разработки и производственной базы данных и инициализирован надлежащим образом.</span><span class="sxs-lookup"><span data-stu-id="b96a5-122">For starters, the application services database objects must be properly created on both the development and production databases and appropriately initialized.</span></span> <span data-ttu-id="b96a5-123">Также существуют важные настройки, которые должны быть выполнены.</span><span class="sxs-lookup"><span data-stu-id="b96a5-123">There are also important configuration settings that need to be made.</span></span>

> [!NOTE]
> <span data-ttu-id="b96a5-124">API-интерфейсы, разработанные с помощью служб приложения [ *модель поставщика*](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), шаблон, который обеспечивает API-Интерфейс s детали реализации должны быть предоставлены во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="b96a5-124">The application services APIs were designed using the [*provider model*](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), a design pattern that allows for an API s implementation details to be provided at runtime.</span></span> <span data-ttu-id="b96a5-125">.NET Framework имеется ряд поставщиков приложений, которые можно использовать, например `SqlMembershipProvider` и `SqlRoleProvider`, являющиеся поставщиков членства и ролей API-интерфейсов, использующих SQL Server, базы данных реализации.</span><span class="sxs-lookup"><span data-stu-id="b96a5-125">The .NET Framework ships with a number of application service providers that can be used, such as the `SqlMembershipProvider` and `SqlRoleProvider`, which are providers for the Membership and Roles APIs that use a SQL Server database implementation.</span></span> <span data-ttu-id="b96a5-126">Можно также создать и подключаемый модуль пользовательского поставщика.</span><span class="sxs-lookup"><span data-stu-id="b96a5-126">You can also create and plug-in a custom provider.</span></span> <span data-ttu-id="b96a5-127">На самом деле рецензий веб-приложения уже содержит настраиваемый поставщик API карты сайта (`ReviewSiteMapProvider`), который создает карта сайта из данных в `Genres` и `Books` таблицы в базе данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-127">In fact, the Book Reviews web application already contains a custom provider for the Site Map API (`ReviewSiteMapProvider`), which constructs the site map from the data in the `Genres` and `Books` tables in the database.</span></span>


<span data-ttu-id="b96a5-128">Этот учебник запускает рассматриваются как я расширенных рецензий веб-приложения для использования членства и ролей API-интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="b96a5-128">This tutorial starts with a look at how I extended the Book Reviews web application to use the Membership and Roles APIs.</span></span> <span data-ttu-id="b96a5-129">Затем Пошаговое руководство по развертыванию веб-приложение использует службы приложения с помощью реализации базы данных SQL Server и завершается, устраняя распространенных проблем с управлением учетные записи пользователей и ролей в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="b96a5-129">It then walks through deploying a web application that uses application services with a SQL Server database implementation, and concludes by addressing common issues with managing user accounts and roles on the production environment.</span></span>

## <a name="updates-to-the-book-reviews-application"></a><span data-ttu-id="b96a5-130">Обновления для приложения обзоров книги</span><span class="sxs-lookup"><span data-stu-id="b96a5-130">Updates to the Book Reviews Application</span></span>

<span data-ttu-id="b96a5-131">За последние несколько учебников, веб-приложение проверяет книги была обновлена из статического веб-сайта в динамические, управляемые данными веб-приложение завершения с набором страниц администрирования для управления жанров и проверки.</span><span class="sxs-lookup"><span data-stu-id="b96a5-131">Over the past couple tutorials the Book Reviews web application was updated from a static website to a dynamic, data-driven web application complete with a set of administration pages for managing genres and reviews.</span></span> <span data-ttu-id="b96a5-132">Тем не менее в этом разделе администрирования в настоящее время не защищен: любой пользователь, который знает (или догадок) URL-адрес страницы администрирования можно waltz в и создать, изменить или удалить проверки на нашем сайте.</span><span class="sxs-lookup"><span data-stu-id="b96a5-132">However, this administration section is currently not protected - any user who knows (or guesses) the administration page URL can waltz in and create, edit, or delete reviews on our site.</span></span> <span data-ttu-id="b96a5-133">Распространенный способ защитить определенные части веб-сайт является реализация учетные записи пользователей и затем использовать правила авторизации URL-адреса для ограничения доступа к определенным пользователям или ролям.</span><span class="sxs-lookup"><span data-stu-id="b96a5-133">A common way to protect certain portions of a website is to implement user accounts and then use URL authorization rules to restrict access to certain users or roles.</span></span> <span data-ttu-id="b96a5-134">Можно загрузить с помощью этого учебника рецензий веб-приложение поддерживает учетные записи пользователей и ролей.</span><span class="sxs-lookup"><span data-stu-id="b96a5-134">The Book Reviews web application available for download with this tutorial supports user accounts and roles.</span></span> <span data-ttu-id="b96a5-135">Он имеет один задана роль с именем Admin и только пользователи с этой ролью есть доступ к страницам администрирования.</span><span class="sxs-lookup"><span data-stu-id="b96a5-135">It has a single role defined named Admin and only users in this role can access the administration pages.</span></span>

> [!NOTE]
> <span data-ttu-id="b96a5-136">Я хранить созданы три учетные записи пользователей в веб-приложении рецензий: Скотт Цзисунь и Анна.</span><span class="sxs-lookup"><span data-stu-id="b96a5-136">I ve created three user accounts in the Book Reviews web application: Scott, Jisun, and Alice.</span></span> <span data-ttu-id="b96a5-137">Все три пользователи имеют тот же пароль: **пароль!**</span><span class="sxs-lookup"><span data-stu-id="b96a5-137">All three users have the same password: **password!**</span></span> <span data-ttu-id="b96a5-138">Скотт и Цзисунь назначена роль администратора, Алиса не будет.</span><span class="sxs-lookup"><span data-stu-id="b96a5-138">Scott and Jisun are in the Admin role, Alice is not.</span></span> <span data-ttu-id="b96a5-139">S не-страницы администрирования по-прежнему доступны для анонимных пользователей.</span><span class="sxs-lookup"><span data-stu-id="b96a5-139">The site s non-administration pages are still accessible to anonymous users.</span></span> <span data-ttu-id="b96a5-140">То есть, необходимо войти на сайт, если вы хотите администрировать, в этом случае необходимо войти как пользователь в роли администратора.</span><span class="sxs-lookup"><span data-stu-id="b96a5-140">That is, you do not need to sign in to visit the site, unless you want to administer it, in which case you must sign in as a user in the Admin role.</span></span>


<span data-ttu-id="b96a5-141">Для включения другой пользовательский интерфейс для пользователей, прошедших проверку подлинности и анонимный был обновлен s рецензий приложения главной страницы.</span><span class="sxs-lookup"><span data-stu-id="b96a5-141">The Book Reviews application s master page has been updated to include a different user interface for authenticated and anonymous users.</span></span> <span data-ttu-id="b96a5-142">Если анонимный пользователь посещает сайт она видит ссылку входа в правом верхнем углу.</span><span class="sxs-lookup"><span data-stu-id="b96a5-142">If an anonymous user visits the site she sees a Login link in the upper right corner.</span></span> <span data-ttu-id="b96a5-143">Прошедший проверку пользователь видит сообщение «Добро пожаловать, *username*!»</span><span class="sxs-lookup"><span data-stu-id="b96a5-143">An authenticated user sees the message, "Welcome back, *username*!"</span></span> <span data-ttu-id="b96a5-144">и ссылка на выход. Здесь s также страницу входа (`~/Login.aspx`), который содержит имя входа веб-элемент управления, который предоставляет пользовательский интерфейс и логику для проверки подлинности посетителя.</span><span class="sxs-lookup"><span data-stu-id="b96a5-144">and a link to log out. There s also a login page (`~/Login.aspx`), which contains a Login Web control that provides the user interface and logic for authenticating a visitor.</span></span> <span data-ttu-id="b96a5-145">Только администраторы могут создавать новые учетные записи.</span><span class="sxs-lookup"><span data-stu-id="b96a5-145">Only administrators can create new accounts.</span></span> <span data-ttu-id="b96a5-146">(Есть страницы для создания и управления учетными записями пользователей в `~/Admin` папки.)</span><span class="sxs-lookup"><span data-stu-id="b96a5-146">(There are pages for creating and managing user accounts in the `~/Admin` folder.)</span></span>

### <a name="configuring-the-membership-and-roles-apis"></a><span data-ttu-id="b96a5-147">Настройка членства и ролей API-интерфейсы</span><span class="sxs-lookup"><span data-stu-id="b96a5-147">Configuring the Membership and Roles APIs</span></span>

<span data-ttu-id="b96a5-148">Рецензий веб-приложение использует членства и ролей API-интерфейсы для поддержки учетных записей пользователей и группы пользователей в роли (а именно, ролью "Администратор").</span><span class="sxs-lookup"><span data-stu-id="b96a5-148">The Book Reviews web application uses the Membership and Roles APIs to support user accounts and to group those users into roles (namely, the Admin role).</span></span> <span data-ttu-id="b96a5-149">`SqlMembershipProvider` И `SqlRoleProvider` используются классы поставщика, так как мы хотим сохранять сведения учетной записи и роли в базе данных SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b96a5-149">The `SqlMembershipProvider` and `SqlRoleProvider` provider classes are used because we want to store account and role information in a SQL Server database.</span></span>

> [!NOTE]
> <span data-ttu-id="b96a5-150">Этот учебник предназначен не быть подробный анализ при настройке веб-приложения для поддержки членства и ролей API-интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="b96a5-150">This tutorial is not intended to be a detailed examination at configuring a web application to support the Membership and Roles APIs.</span></span> <span data-ttu-id="b96a5-151">Подробное рассмотрение эти API-интерфейсы и шаги необходимо предпринять, чтобы настроить веб-сайт для использования их прочитать Мой [ *учебники безопасности веб-сайта*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="b96a5-151">For a thorough look at these APIs and the steps you need to take to configure a website to use them, please read my [*Website Security Tutorials*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span>


<span data-ttu-id="b96a5-152">Для использования службы приложений с базой данных SQL Server, необходимо сначала добавить объекты базы данных, используемые этих поставщиков в базу данных, где требуется учетная запись пользователя и хранятся сведения о роли.</span><span class="sxs-lookup"><span data-stu-id="b96a5-152">To use the application services with a SQL Server database you must first add the database objects used by these providers to the database where you want the user account and role information stored.</span></span> <span data-ttu-id="b96a5-153">Эти объекты необходимые базы данных включают широкий набор таблиц, представлений и хранимых процедур.</span><span class="sxs-lookup"><span data-stu-id="b96a5-153">These requisite database objects include a variety of tables, views, and stored procedures.</span></span> <span data-ttu-id="b96a5-154">Если не указано иное, `SqlMembershipProvider` и `SqlRoleProvider` классы поставщика использовать базу данных SQL Server, экспресс-выпуск с именем `ASPNETDB` в приложение s `App_Data` папку; Если такой базы данных не существует, она будет создана автоматически с объектами базы данных, необходимые поставщиками во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="b96a5-154">Unless specified otherwise, the `SqlMembershipProvider` and `SqlRoleProvider` provider classes use a SQL Server Express Edition database named `ASPNETDB` located in the application s `App_Data` folder; if such a database does not exist, it is automatically created with the necessary database objects by these providers at runtime.</span></span>

<span data-ttu-id="b96a5-155">Возможно, и обычно подходит для создания приложения служб объектов базы данных в той же базе данных, где хранятся данные конкретного приложения s веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="b96a5-155">It is possible, and usually ideal, to create the application services database objects in the same database where the website s application-specific data is stored.</span></span> <span data-ttu-id="b96a5-156">Платформа .NET Framework поставляется со средством с именем `aspnet_regsql.exe` , устанавливает объекты базы данных в указанной базе данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-156">The .NET Framework ships with a tool named `aspnet_regsql.exe` that installs the database objects on a specified database.</span></span> <span data-ttu-id="b96a5-157">У меня перемещается вперед и использовать это средство для добавления этих объектов `Reviews.mdf` базы данных в `App_Data` папке (база данных разработки).</span><span class="sxs-lookup"><span data-stu-id="b96a5-157">I have gone ahead and used this tool to add these objects to the `Reviews.mdf` database in the `App_Data` folder (the development database).</span></span> <span data-ttu-id="b96a5-158">Мы рассмотрим, как использовать это средство далее в этом учебнике при мы добавляем эти объекты в производственной базе данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-158">We'll see how to use this tool later in this tutorial when we add these objects to the production database.</span></span>

<span data-ttu-id="b96a5-159">При добавлении приложения служб объектов базы данных в базе данных, отличный от `ASPNETDB` вам потребуется настроить `SqlMembershipProvider` и `SqlRoleProvider` поставщика классы конфигурации, чтобы они использовали соответствующей базы данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-159">If you add the application services database objects to a database other than `ASPNETDB` you will need to customize the `SqlMembershipProvider` and `SqlRoleProvider` provider classes configurations so that they use the appropriate database.</span></span> <span data-ttu-id="b96a5-160">Чтобы настроить поставщик членства добавьте [  *&lt;членства&gt; элемент* ](https://msdn.microsoft.com/library/1b9hw62f.aspx) в `<system.web>` статьи `Web.config`; использовать [  *&lt;roleManager&gt; элемент* ](https://msdn.microsoft.com/library/ms164660.aspx) для настройки поставщика ролей.</span><span class="sxs-lookup"><span data-stu-id="b96a5-160">To customize the Membership provider add a [*&lt;membership&gt; element*](https://msdn.microsoft.com/library/1b9hw62f.aspx) within the `<system.web>` section in `Web.config`; use the [*&lt;roleManager&gt; element*](https://msdn.microsoft.com/library/ms164660.aspx) to configure the Roles provider.</span></span> <span data-ttu-id="b96a5-161">Следующий фрагмент кода взят из s приложения рецензий `Web.config` и показывает, настроить параметры для членства и ролей API-интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="b96a5-161">The following snippet is taken from the Book Reviews application s `Web.config` and shows the configure settings for the Membership and Roles APIs.</span></span> <span data-ttu-id="b96a5-162">Обратите внимание, что оба регистрации нового поставщика - `ReviewMembership` и `ReviewRole` -, использующих `SqlMembershipProvider` и `SqlRoleProvider` поставщиков, соответственно.</span><span class="sxs-lookup"><span data-stu-id="b96a5-162">Note that both register a new provider - `ReviewMembership` and `ReviewRole` - that use the `SqlMembershipProvider` and `SqlRoleProvider` providers, respectively.</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample1.xml)]

<span data-ttu-id="b96a5-163">`Web.config` Файл s `<authentication>` элемент также был настроен для поддержки проверки подлинности на основе форм.</span><span class="sxs-lookup"><span data-stu-id="b96a5-163">The `Web.config` file s `<authentication>` element has also been configured to support forms-based authentication.</span></span>
  

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample2.xml)]

### <a name="limiting-access-to-the-administration-pages"></a><span data-ttu-id="b96a5-164">Ограничение доступа к страницам администрирования</span><span class="sxs-lookup"><span data-stu-id="b96a5-164">Limiting Access to the Administration Pages</span></span>

<span data-ttu-id="b96a5-165">ASP.NET позволяет легко предоставить или запретить доступ для определенного файла или папки пользователем или роли с помощью его *Авторизация URL-адреса* компонентов.</span><span class="sxs-lookup"><span data-stu-id="b96a5-165">ASP.NET makes it easy to grant or deny access to a particular file or folder by user or by role via its *URL authorization* feature.</span></span> <span data-ttu-id="b96a5-166">(Мы кратко описано Авторизация URL-адреса в *основные различия между IIS и ASP.NET Development Server* учебника и показано, как применять правила авторизации URL-адрес, по-разному для статических IIS и ASP.NET Development Server Сравнение динамического содержимого.) Поскольку мы хотим запретить доступ к `~/Admin` папки, за исключением этих пользователей в роли администратора, необходимо добавить правила авторизации URL-адрес в эту папку.</span><span class="sxs-lookup"><span data-stu-id="b96a5-166">(We briefly discussed URL authorization in the *Core Differences Between IIS and the ASP.NET Development Server* tutorial and showed how IIS and the ASP.NET Development Server apply URL authorization rules differently for static versus dynamic content.) Because we want to prohibit access to the `~/Admin` folder except for those users in the Admin role, we need to add URL authorization rules to this folder.</span></span> <span data-ttu-id="b96a5-167">В частности правила авторизации URL-адреса необходимо разрешить пользователям в роли администратора и запретить другим пользователям.</span><span class="sxs-lookup"><span data-stu-id="b96a5-167">Specifically, the URL authorization rules need to allow users in the Admin role and deny all other users.</span></span> <span data-ttu-id="b96a5-168">Это достигается путем добавления `Web.config` файл `~/Admin` папке со следующим содержимым:</span><span class="sxs-lookup"><span data-stu-id="b96a5-168">This is accomplished by adding a `Web.config` file to the `~/Admin` folder with the following contents:</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample3.xml)]

<span data-ttu-id="b96a5-169">Для Дополнительные сведения о функции авторизации URL-адреса ASP.NET s и способ его использования по буквам правила авторизации для пользователей и ролей, не забудьте прочитать [ *авторизации на основе пользователя* ](../../older-versions-security/membership/user-based-authorization-cs.md) и [ *Авторизации на основе ролей* ](../../older-versions-security/roles/role-based-authorization-cs.md) учебники из моей [ *учебники безопасности веб-сайта*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="b96a5-169">For more information on ASP.NET s URL authorization feature and how to use it to spell out authorization rules for users and for roles, be sure to read the [*User-Based Authorization*](../../older-versions-security/membership/user-based-authorization-cs.md) and [*Role-Based Authorization*](../../older-versions-security/roles/role-based-authorization-cs.md) tutorials from my [*Website Security Tutorials*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span>

## <a name="deploying-a-web-application-that-uses-application-services"></a><span data-ttu-id="b96a5-170">Развертывание веб-приложения, использующего службы приложений</span><span class="sxs-lookup"><span data-stu-id="b96a5-170">Deploying a Web Application That Uses Application Services</span></span>

<span data-ttu-id="b96a5-171">При развертывании веб-сайта, использующего службы приложений и поставщика, который хранит сведения о службах приложений в базе данных, крайне важно, что объекты базы данных, необходимые для приложения службы быть создана в производственной базы данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-171">When deploying a website that uses application services and a provider that stores the application services information in a database, it is imperative that the database objects needed by the application services be created on the production database.</span></span> <span data-ttu-id="b96a5-172">Изначально рабочей базы данных не содержит эти объекты, поэтому при первом развертывании приложения (или при его развертывании в первый раз после добавления службы приложений), то необходимо выполнить дополнительные шаги, чтобы получить эти объекты необходимые базы данных на производственной базы данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-172">Initially the production database does not contain these objects, so when the application is first deployed (or when it is deployed for the first time after application services have been added), you must take extra steps to get these requisite database objects on the production database.</span></span>

<span data-ttu-id="b96a5-173">Еще одна проблема может возникать при развертывании веб-сайта, использующего службы приложений, если планируется реплицировать учетные записи пользователей, созданные в среде разработки в рабочую среду.</span><span class="sxs-lookup"><span data-stu-id="b96a5-173">Another challenge can arise when deploying a website that uses application services if you intend to replicate the user accounts created in the development environment to the production environment.</span></span> <span data-ttu-id="b96a5-174">В зависимости от конфигурации членства и ролей возможно, что даже если учетные записи пользователей, которые были созданы в среде разработки в производственной базе данных успешно скопировать, этих пользователей не удается войти в веб-приложения в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="b96a5-174">Depending on the Membership and Roles configuration, it is possible that even if you successfully copy the user accounts that were created in the development environment to the production database, these users cannot sign into the web application in production.</span></span> <span data-ttu-id="b96a5-175">Мы рассмотрим причиной этой проблемы и описывают, как предотвратить ситуацию.</span><span class="sxs-lookup"><span data-stu-id="b96a5-175">We'll look at the cause of this issue and discuss how to prevent it from happening.</span></span>

<span data-ttu-id="b96a5-176">ASP.NET поставляется с низким приоритетом [ *средство администрирования веб-сайта (WSAT)* ](https://msdn.microsoft.com/library/yy40ytx0.aspx) , можно запустить из Visual Studio и предоставляет пользователю правила учетной записи, роли и авторизация осуществляется через веб сервера интерфейс.</span><span class="sxs-lookup"><span data-stu-id="b96a5-176">ASP.NET ships with a nice [*Web Site Administration Tool (WSAT)*](https://msdn.microsoft.com/library/yy40ytx0.aspx) that can be launched from Visual Studio and allows the user account, roles, and authorization rules to be managed through a web-based interface.</span></span> <span data-ttu-id="b96a5-177">К сожалению WSAT работает только для локальных веб-сайтов, это означает, что он не может использоваться для удаленного управления учетные записи пользователей, роли и правила авторизации для веб-приложения в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="b96a5-177">Unfortunately, the WSAT only works for local websites, meaning that it cannot be used to remotely manage user accounts, roles, and authorization rules for the web application in the production environment.</span></span> <span data-ttu-id="b96a5-178">Мы рассмотрим различные способы реализации WSAT поведение из рабочий веб-сайт.</span><span class="sxs-lookup"><span data-stu-id="b96a5-178">We'll look at different ways to implement WSAT-like behavior from your production website.</span></span>

### <a name="adding-the-database-objects-using-aspnetregsqlexe"></a><span data-ttu-id="b96a5-179">Добавление aspnet объектов базы данных с помощью\_regsql.exe</span><span class="sxs-lookup"><span data-stu-id="b96a5-179">Adding the Database Objects Using aspnet\_regsql.exe</span></span>

<span data-ttu-id="b96a5-180">*Развертывание базы данных* учебника было показано, как копирование таблиц и данных из базы данных разработки в производственной базе данных и определенно эти методы можно использовать для копирования объектов базы данных служб приложения для производственной базы данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-180">The *Deploying a Database* tutorial showed how to copy the tables and data from the development database to the production database, and these techniques can certainly be used to copy the application services database objects to the production database.</span></span> <span data-ttu-id="b96a5-181">Другой вариант — `aspnet_regsql.exe` инструмент, который добавляет или удаляет объекты базы данных приложения службы из базы данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-181">Another option is the `aspnet_regsql.exe` tool, which adds or removes the application services database objects from a database.</span></span>

> [!NOTE]
> <span data-ttu-id="b96a5-182">`aspnet_regsql.exe` Средство создает объекты базы данных для указанной базы данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-182">The `aspnet_regsql.exe` tool creates the database objects on a specified database.</span></span> <span data-ttu-id="b96a5-183">Он не выполняет миграцию данных в этих объектах базы данных из базы данных разработки в производственной базе данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-183">It does not migrate data in those database objects from the development database to the production database.</span></span> <span data-ttu-id="b96a5-184">Если требуется скопировать сведения об учетной записи и роль пользователя в базе данных разработки в производственной базе данных, используйте методы, описанные в *развертывание базы данных* учебника.</span><span class="sxs-lookup"><span data-stu-id="b96a5-184">If you mean to copy the user account and role information in the development database to the production database use the techniques covered in the *Deploying a Database* tutorial.</span></span>


<span data-ttu-id="b96a5-185">Разрешить s рассмотрим, как добавлять объекты базы данных рабочей базы данных с помощью `aspnet_regsql.exe` средства.</span><span class="sxs-lookup"><span data-stu-id="b96a5-185">Let s look at how to add the database objects to the production database using the `aspnet_regsql.exe` tool.</span></span> <span data-ttu-id="b96a5-186">Запустить, откройте проводник и перейдите в каталог платформы .NET Framework версии 2.0 на компьютере %WINDIR%\ меню Microsoft.NET\Framework\v2.0.50727.</span><span class="sxs-lookup"><span data-stu-id="b96a5-186">Start by opening Windows Explorer and navigating to the .NET Framework version 2.0 directory on your computer, %WINDIR%\ Microsoft.NET\Framework\v2.0.50727.</span></span> <span data-ttu-id="b96a5-187">Там можно найти `aspnet_regsql.exe` средства.</span><span class="sxs-lookup"><span data-stu-id="b96a5-187">There you should find the `aspnet_regsql.exe` tool.</span></span> <span data-ttu-id="b96a5-188">Это средство можно использовать из командной строки, но оно также включает графический пользовательский интерфейс; Дважды щелкните `aspnet_regsql.exe` файл, чтобы запустить его графический компонент.</span><span class="sxs-lookup"><span data-stu-id="b96a5-188">This tool can be used from the command-line, but it also includes a graphical user interface; double-click the `aspnet_regsql.exe` file to launch its graphical component.</span></span>

<span data-ttu-id="b96a5-189">Инструмент запустится, отображая экрана-заставки, объясняющий, его назначение.</span><span class="sxs-lookup"><span data-stu-id="b96a5-189">The tool starts by displaying a splash screen explaining its purpose.</span></span> <span data-ttu-id="b96a5-190">Нажмите кнопку Далее, чтобы перейти на экране «Выбор параметров установки», как показано на рис. 1.</span><span class="sxs-lookup"><span data-stu-id="b96a5-190">Click Next to advance to the "Select a Setup Option" screen, which is shown in Figure 1.</span></span> <span data-ttu-id="b96a5-191">Здесь можно добавить объекты базы данных или удалить их из базы данных служб приложения.</span><span class="sxs-lookup"><span data-stu-id="b96a5-191">From here you can choose to add the application services database objects or remove them from a database.</span></span> <span data-ttu-id="b96a5-192">Поскольку мы хотим добавить эти объекты в производственной базе данных, выберите параметр «Настройка SQL Server для служб приложений» и нажмите кнопку Далее.</span><span class="sxs-lookup"><span data-stu-id="b96a5-192">Because we want to add these objects to the production database, select the "Configure SQL Server for application services" option and click Next.</span></span>


<span data-ttu-id="b96a5-193">[![Чтобы настроить SQL Server для служб приложений](configuring-a-website-that-uses-application-services-cs/_static/image2.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image1.jpg)</span><span class="sxs-lookup"><span data-stu-id="b96a5-193">[![Choose to Configure SQL Server for Application Services](configuring-a-website-that-uses-application-services-cs/_static/image2.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image1.jpg)</span></span>

<span data-ttu-id="b96a5-194">**Рис. 1**: выберите для настройки SQL Server для служб приложений ([Просмотр полноразмерное изображение](configuring-a-website-that-uses-application-services-cs/_static/image3.jpg))</span><span class="sxs-lookup"><span data-stu-id="b96a5-194">**Figure 1**: Choose to Configure SQL Server for Application Services ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image3.jpg))</span></span>


<span data-ttu-id="b96a5-195">В окне «Выбор сервера и базы данных» экрана запрашивает сведения для подключения к базе данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-195">In "Select the Server and Database" screen prompts for information to connect to the database.</span></span> <span data-ttu-id="b96a5-196">Укажите сервер базы данных, учетные данные и имя базы данных, предоставляемые веб-хостинга компанию и нажмите кнопку Далее.</span><span class="sxs-lookup"><span data-stu-id="b96a5-196">Enter the database server, the security credentials, and the database name supplied to you by your web hosting company and click Next.</span></span>

> [!NOTE]
> <span data-ttu-id="b96a5-197">После ввода сервера базы данных и учетные данные, ошибка может возникнуть при расширении раскрывающегося списка базу данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-197">After entering your database server and credentials you may get an error when expanding the database drop-down list.</span></span> <span data-ttu-id="b96a5-198">`aspnet_regsql.exe` Средства запросов `sysdatabases` системной таблицы, чтобы получить список баз данных на сервере, но некоторые веб-размещения компаний блокировки свои серверы баз данных, чтобы эта информация не является общедоступным.</span><span class="sxs-lookup"><span data-stu-id="b96a5-198">The `aspnet_regsql.exe` tool queries the `sysdatabases` system table to retrieve a list of databases on the server, but some web hosting companies lock down their database servers so that this information is not publicly available.</span></span> <span data-ttu-id="b96a5-199">При появлении этой ошибки можно ввести имя базы данных непосредственно в раскрывающемся списке.</span><span class="sxs-lookup"><span data-stu-id="b96a5-199">If you get this error you can type the database name directly into the drop-down list.</span></span>


<span data-ttu-id="b96a5-200">[![Укажите средство, используя сведения о подключении к базе данных s](configuring-a-website-that-uses-application-services-cs/_static/image5.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image4.jpg)</span><span class="sxs-lookup"><span data-stu-id="b96a5-200">[![Supply the Tool With Your Database s Connection Information](configuring-a-website-that-uses-application-services-cs/_static/image5.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image4.jpg)</span></span>

<span data-ttu-id="b96a5-201">**На рисунке 2**: укажите s средства с вашей базы данных сведений о соединении ([Просмотр полноразмерное изображение](configuring-a-website-that-uses-application-services-cs/_static/image6.jpg))</span><span class="sxs-lookup"><span data-stu-id="b96a5-201">**Figure 2**: Supply the Tool With Your Database s Connection Information ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image6.jpg))</span></span>


<span data-ttu-id="b96a5-202">Последующие экрана перечислены действия, которые должны выполняться, а именно, объекты базы данных служб приложения должны быть добавлены в указанной базе данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-202">The subsequent screen summarizes the actions that are about to take place, namely that the application services database objects are going to be added to the specified database.</span></span> <span data-ttu-id="b96a5-203">Щелкните рядом с завершения этого действия.</span><span class="sxs-lookup"><span data-stu-id="b96a5-203">Click Next to complete this action.</span></span> <span data-ttu-id="b96a5-204">Через несколько секунд последнем экране отображается отметить, что объекты базы данных были добавлены (см. рис. 3).</span><span class="sxs-lookup"><span data-stu-id="b96a5-204">After a few moments, the final screen is displayed, noting that the database objects have been added (see Figure 3).</span></span>


<span data-ttu-id="b96a5-205">[![Выполнена успешно! Объекты базы данных служб приложения были добавлены в производственной базе данных](configuring-a-website-that-uses-application-services-cs/_static/image8.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image7.jpg)</span><span class="sxs-lookup"><span data-stu-id="b96a5-205">[![Success! The Application Services Database Objects Were Added to the Production Database](configuring-a-website-that-uses-application-services-cs/_static/image8.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image7.jpg)</span></span>

<span data-ttu-id="b96a5-206">**Рис. 3**: успех!</span><span class="sxs-lookup"><span data-stu-id="b96a5-206">**Figure 3**: Success!</span></span> <span data-ttu-id="b96a5-207">Приложения служб базы данных объекты были добавлены в производственной базе данных ([Просмотр полноразмерное изображение](configuring-a-website-that-uses-application-services-cs/_static/image9.jpg))</span><span class="sxs-lookup"><span data-stu-id="b96a5-207">The Application Services Database Objects Were Added to the Production Database ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image9.jpg))</span></span>


<span data-ttu-id="b96a5-208">Чтобы убедиться, что объекты базы данных служб приложений успешно добавлены в производственной базе данных, откройте SQL Server Management Studio и подключитесь к рабочей базе данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-208">To verify that the application services database objects were successfully added to the production database, open SQL Server Management Studio and connect to your production database.</span></span> <span data-ttu-id="b96a5-209">Как показано на рис. 4, вы увидите таблицы базы данных приложения службы в базе данных, `aspnet_Applications`, `aspnet_Membership`, `aspnet_Users`, и т. д.</span><span class="sxs-lookup"><span data-stu-id="b96a5-209">As Figure 4 shows, you should now see the application services database tables in your database, `aspnet_Applications`, `aspnet_Membership`, `aspnet_Users`, and so forth.</span></span>


<span data-ttu-id="b96a5-210">[![Убедитесь, что объекты базы данных были добавлены в производственной базе данных](configuring-a-website-that-uses-application-services-cs/_static/image11.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image10.jpg)</span><span class="sxs-lookup"><span data-stu-id="b96a5-210">[![Confirm That the Database Objects Were Added to the Production Database](configuring-a-website-that-uses-application-services-cs/_static/image11.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image10.jpg)</span></span>

<span data-ttu-id="b96a5-211">**Рис. 4**: Убедитесь, что объекты базы данных были добавлены в производственной базе данных ([Просмотр полноразмерное изображение](configuring-a-website-that-uses-application-services-cs/_static/image12.jpg))</span><span class="sxs-lookup"><span data-stu-id="b96a5-211">**Figure 4**: Confirm That the Database Objects Were Added to the Production Database ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image12.jpg))</span></span>


<span data-ttu-id="b96a5-212">Требуется использовать только `aspnet_regsql.exe` средства при развертывании веб-приложения в первый раз или в первый раз после запуска с помощью служб приложений.</span><span class="sxs-lookup"><span data-stu-id="b96a5-212">You will only need to use the `aspnet_regsql.exe` tool when deploying your web application for the first time or for the first time after you have started using the application services.</span></span> <span data-ttu-id="b96a5-213">После установки этих объектов базы данных на производственной базы данных они выиграл t необходимость быть повторно добавлены или изменены.</span><span class="sxs-lookup"><span data-stu-id="b96a5-213">Once these database objects are on the production database they won t need to be re-added or modified.</span></span>

### <a name="copying-user-accounts-from-development-to-production"></a><span data-ttu-id="b96a5-214">Копирование учетных записей пользователей из среды разработки в рабочей среде</span><span class="sxs-lookup"><span data-stu-id="b96a5-214">Copying User Accounts from Development to Production</span></span>

<span data-ttu-id="b96a5-215">При использовании `SqlMembershipProvider` и `SqlRoleProvider` классы поставщиков для хранения информации о службах приложений в базе данных SQL Server, сведения об учетной записи и роль пользователя хранится в различных таблицах базы данных, включая `aspnet_Users`, `aspnet_Membership`, `aspnet_Roles`, и `aspnet_UsersInRoles`, среди прочего.</span><span class="sxs-lookup"><span data-stu-id="b96a5-215">When using the `SqlMembershipProvider` and `SqlRoleProvider` provider classes to store the application services information in a SQL Server database, the user account and role information is stored in a variety of database tables, including `aspnet_Users`, `aspnet_Membership`, `aspnet_Roles`, and `aspnet_UsersInRoles`, among others.</span></span> <span data-ttu-id="b96a5-216">Если во время разработки вы создаете учетные записи пользователей в среде разработки можно реплицировать эти учетные записи пользователей в рабочей среде путем копирования соответствующих записей из таблиц, соответствующих баз данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-216">If during development you create user accounts in the development environment you can replicate those user accounts in production by copying the corresponding records from the applicable database tables.</span></span> <span data-ttu-id="b96a5-217">При использовании мастера публикации баз данных для развертывания объектов базы данных служб приложения могут также выбрано копирование записей, приведет к учетные записи пользователей, созданные в разработке, необходимо также включить производства.</span><span class="sxs-lookup"><span data-stu-id="b96a5-217">If you used the Database Publishing Wizard to deploy the application services database objects you may have also elected to copy the records, which would result in the user accounts created in development to also be on production.</span></span> <span data-ttu-id="b96a5-218">Однако в зависимости от настроек конфигурации, возможно, этих пользователей, учетные записи которых были созданы в разработке и копируются в рабочей среде не удается выполнить вход с рабочей веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="b96a5-218">But, depending on your configuration settings, you may find that those users whose accounts were created in development and copied to production are unable to login from the production website.</span></span> <span data-ttu-id="b96a5-219">Что делать?</span><span class="sxs-lookup"><span data-stu-id="b96a5-219">What gives?</span></span>

<span data-ttu-id="b96a5-220">`SqlMembershipProvider` И `SqlRoleProvider` классы поставщика были разработаны таким образом, что одна база данных может служить в качестве пользовательского хранилища для нескольких приложений, где каждое приложение может в теории имеют пользователи с перекрывающимися имена пользователей и ролей с тем же именем.</span><span class="sxs-lookup"><span data-stu-id="b96a5-220">The `SqlMembershipProvider` and `SqlRoleProvider` provider classes were designed such that a single database could serve as a user store for multiple applications, where each application could, in theory, have users with overlapping usernames and roles with the same name.</span></span> <span data-ttu-id="b96a5-221">Чтобы разрешить в гибкой настройке базы данных поддерживает список приложений в `aspnet_Applications` таблицы и каждый пользователь связан с одним из этих приложений.</span><span class="sxs-lookup"><span data-stu-id="b96a5-221">To allow for this flexibility, the database maintains a list of applications in the `aspnet_Applications` table, and each user is associated with one of these applications.</span></span> <span data-ttu-id="b96a5-222">В частности `aspnet_Users` таблица имеет `ApplicationId` столбец, который связывает каждого пользователя, для записи в `aspnet_Applications` таблицы.</span><span class="sxs-lookup"><span data-stu-id="b96a5-222">Specifically, the `aspnet_Users` table has an `ApplicationId` column that ties each user to a record in the `aspnet_Applications` table.</span></span>

<span data-ttu-id="b96a5-223">В дополнение к `ApplicationId` столбца, `aspnet_Applications` таблица также содержит `ApplicationName` столбец, который предоставляет имя более понятную для приложения.</span><span class="sxs-lookup"><span data-stu-id="b96a5-223">In addition to the `ApplicationId` column, the `aspnet_Applications` table also includes an `ApplicationName` column, which provides a more human-friendly name for the application.</span></span> <span data-ttu-id="b96a5-224">При попытке веб-сайт для работы с учетной записью пользователя, например для проверки учетных данных пользователя s со страницы входа, его необходимо сообщить `SqlMembershipProvider` класса какие приложения для работы с.</span><span class="sxs-lookup"><span data-stu-id="b96a5-224">When a website attempts to work with a user account, such as validating a user s credentials from the login page, it must tell the `SqlMembershipProvider` class what application to work with.</span></span> <span data-ttu-id="b96a5-225">Обычно делает это путем указания имени приложения и это значение берется из конфигурации поставщика s в `Web.config` — в частности, с помощью `applicationName` атрибута.</span><span class="sxs-lookup"><span data-stu-id="b96a5-225">It usually does this by supplying the application name, and the this value comes from the provider s configuration in `Web.config` - specifically via the `applicationName` attribute.</span></span>

<span data-ttu-id="b96a5-226">Но что произойдет, если `applicationName` атрибут не указан в `Web.config`?</span><span class="sxs-lookup"><span data-stu-id="b96a5-226">But what happens if the `applicationName` attribute is not specified in `Web.config`?</span></span> <span data-ttu-id="b96a5-227">В этом случае членство система использует в корневом каталоге приложения как `applicationName` значение.</span><span class="sxs-lookup"><span data-stu-id="b96a5-227">In such a case the Membership system uses the application root path as the `applicationName` value.</span></span> <span data-ttu-id="b96a5-228">Если `applicationName` атрибута не включен явно в `Web.config`, затем, есть возможность использовать корневой другого приложения среды разработки и производственной среде и таким образом будет связан с другим приложением имена в списке приложений служб.</span><span class="sxs-lookup"><span data-stu-id="b96a5-228">If the `applicationName` attribute is not explicitly set in `Web.config`, then, there is the possibility that the development environment and production environment use a different application root and therefore will be associated with different application names in the application services.</span></span> <span data-ttu-id="b96a5-229">В случае подобные различия этих пользователей, созданных в среде разработки будет иметь `ApplicationId` значение, которое не совпадает с `ApplicationId` значение для рабочей среды.</span><span class="sxs-lookup"><span data-stu-id="b96a5-229">If such a mismatch occurs then those users created in the development environment will have an `ApplicationId` value that does not match with the `ApplicationId` value for the production environment.</span></span> <span data-ttu-id="b96a5-230">Конечным результатом является возможности входа пользователей выиграл t.</span><span class="sxs-lookup"><span data-stu-id="b96a5-230">The net result is that those users won t be able to login.</span></span>

> [!NOTE]
> <span data-ttu-id="b96a5-231">Если обнаружатся в этой ситуации — с учетными записями пользователей, которые копируются в рабочей среде с несоответствующие `ApplicationId` значение — можно написать запрос, чтобы обновить эти неверные `ApplicationId` значения `ApplicationId` использовать в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="b96a5-231">If you find yourself in this situation - with user accounts copied to production with a mismatched `ApplicationId` value - you could write a query to update these incorrect `ApplicationId` values to the `ApplicationId` used on production.</span></span> <span data-ttu-id="b96a5-232">После обновления, пользователи, учетные записи которых были созданы с помощью среды разработки бы уже могли войти в веб-приложения в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="b96a5-232">Once updated, the users whose accounts were created on the development environment would now be able to sign into the web application on production.</span></span>


<span data-ttu-id="b96a5-233">Хорошие новости — это простой шаг, можно предпринять, чтобы обеспечить, что этих двух средах использовать тот же `ApplicationId` - явно заданного `applicationName` атрибута в `Web.config` для всех поставщиков служб приложений.</span><span class="sxs-lookup"><span data-stu-id="b96a5-233">The good news is that there is a simple step you can take to ensure that the two environments use the same `ApplicationId` - explicitly set the `applicationName` attribute in `Web.config` for all of your application services providers.</span></span> <span data-ttu-id="b96a5-234">Явно задать `applicationName` атрибут «BookReviews» в `<membership>` и `<roleManager>` элементы, что следующий фрагмент кода из `Web.config` показано.</span><span class="sxs-lookup"><span data-stu-id="b96a5-234">I explicitly set the `applicationName` attribute to "BookReviews" in the `<membership>` and `<roleManager>` elements as this snippet from `Web.config` shows.</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample4.xml)]

<span data-ttu-id="b96a5-235">Более подробное описание параметра `applicationName` атрибут и обоснование, ссылаться на [ *Скотт Гатри* ](https://weblogs.asp.net/scottgu/) s записи блога, [ *всегда задать applicationName свойство во время настройки членства в ASP.NET и другие поставщики*](https://weblogs.asp.net/scottgu/443634).</span><span class="sxs-lookup"><span data-stu-id="b96a5-235">For more discussion on setting the `applicationName` attribute and the rationale behind it, refer to [*Scott Guthrie*](https://weblogs.asp.net/scottgu/) s blog post, [*Always set the applicationName property when configuring ASP.NET Membership and other Providers*](https://weblogs.asp.net/scottgu/443634).</span></span>

### <a name="managing-user-accounts-in-the-production-environment"></a><span data-ttu-id="b96a5-236">Управление учетными записями пользователей в рабочей среде</span><span class="sxs-lookup"><span data-stu-id="b96a5-236">Managing User Accounts in the Production Environment</span></span>

<span data-ttu-id="b96a5-237">Средство администрирования веб-сайта ASP.NET (WSAT) упрощает создание и управление учетными записями пользователей, определения и применения ролей и буквам правила авторизации пользователей и ролей.</span><span class="sxs-lookup"><span data-stu-id="b96a5-237">The ASP.NET Web Site Administration Tool (WSAT) makes it easy to create and manage user accounts, define and apply roles, and spell out user- and role-based authorization rules.</span></span> <span data-ttu-id="b96a5-238">Вы можете запустить WSAT из Visual Studio в обозревателе решений и щелкнув значок конфигурации ASP.NET или перейдите в меню веб-сайт или проект и выбрав пункт меню конфигурации ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="b96a5-238">You can launch the WSAT from Visual Studio by going to the Solution Explorer and clicking the ASP.NET Configuration icon or by going to the Website or Project menus and selecting the ASP.NET Configuration menu item.</span></span> <span data-ttu-id="b96a5-239">К сожалению WSAT могут работать только с локального веб-сайтов.</span><span class="sxs-lookup"><span data-stu-id="b96a5-239">Unfortunately, the WSAT can only work with local websites.</span></span> <span data-ttu-id="b96a5-240">Таким образом нельзя использовать WSAT с рабочей станции для управления веб-сайт в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="b96a5-240">Therefore, you cannot use the WSAT from your workstation to manage the website in the production environment.</span></span>

<span data-ttu-id="b96a5-241">Хорошие новости — все функциональные возможности, предоставляемые WSAT можно программным способом с помощью членства и ролей API-интерфейсы; Кроме того многие окна WSAT используйте стандартные элементы управления входа ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="b96a5-241">The good news is that all of the functionality exposed provided by the WSAT is available programmatically through the Membership and Roles APIs; furthermore, many of the WSAT screens use the standard ASP.NET Login-related controls.</span></span> <span data-ttu-id="b96a5-242">Иными словами можно добавить страниц ASP.NET для веб-сайта, предоставляют возможности необходимые управления.</span><span class="sxs-lookup"><span data-stu-id="b96a5-242">In short, you can add ASP.NET pages to your website that offer the necessary management capabilities.</span></span>

<span data-ttu-id="b96a5-243">Помните, что ранее учебника обновлены рецензий веб-приложения для включения `~/Admin` папку и эта папка была назначена только пользователи в роли администратора.</span><span class="sxs-lookup"><span data-stu-id="b96a5-243">Recall that an earlier tutorial updated the Book Reviews web application to include an `~/Admin` folder, and this folder has been configured to only allow users in the Admin role.</span></span> <span data-ttu-id="b96a5-244">В этой папке с именем добавлены страницы `CreateAccount.aspx` из которого администратор может создать новую учетную запись.</span><span class="sxs-lookup"><span data-stu-id="b96a5-244">I added a page to that folder named `CreateAccount.aspx` from which an administrator can create a new user account.</span></span> <span data-ttu-id="b96a5-245">Эта страница управления CreateUserWizard использует для отображения пользовательского интерфейса и внутреннего логика для создания новой учетной записи пользователя.</span><span class="sxs-lookup"><span data-stu-id="b96a5-245">This page uses the CreateUserWizard control to display the user interface and backend logic for creating a new user account.</span></span> <span data-ttu-id="b96a5-246">Какие дополнительные, s я настроил элемент управления, чтобы включить элемент управления CheckBox, предлагает ли нового пользователя, также должны быть добавлены к роли администратора (см. рис. 5).</span><span class="sxs-lookup"><span data-stu-id="b96a5-246">What s more, I customized the control to include a CheckBox that prompts whether the new user should also be added to the Admin role (see Figure 5).</span></span> <span data-ttu-id="b96a5-247">С небольшой работы можно создать пользовательский набор страниц, реализующий пользователя и роли, связанные с управлением задачи, которые в противном случае предоставляются WSAT.</span><span class="sxs-lookup"><span data-stu-id="b96a5-247">With a little bit of work you can build a custom set of pages that implements the user and role management-related tasks that would otherwise be provided by the WSAT.</span></span>

> [!NOTE]
> <span data-ttu-id="b96a5-248">Для Дополнительные сведения об использовании членства и ролей API-интерфейсов и элементов управления ASP.NET Web, связанные с именем входа, не забудьте прочитать Мой [ *учебники безопасности веб-сайта*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="b96a5-248">For more information on using the Membership and Roles APIs along with the Login-related ASP.NET Web controls, be sure to read my [*Website Security Tutorials*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span> <span data-ttu-id="b96a5-249">Дополнительные сведения о настройке управления CreateUserWizard см. в [ *Создание учетных записей пользователей* ](../../older-versions-security/membership/creating-user-accounts-cs.md) и [ *хранения Дополнительные сведения о пользователе* ](../../older-versions-security/membership/storing-additional-user-information-cs.md) учебники или извлечение [ *Питерсон Erich* ](http://www.erichpeterson.com/) статье s [ *Настройка управления CreateUserWizard* ](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="b96a5-249">For more on customizing the CreateUserWizard control refer to the [*Creating User Accounts*](../../older-versions-security/membership/creating-user-accounts-cs.md) and [*Storing Additional User Information*](../../older-versions-security/membership/storing-additional-user-information-cs.md) tutorials, or check out [*Erich Peterson*](http://www.erichpeterson.com/) s article, [*Customizing the CreateUserWizard Control*](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx).</span></span>


<span data-ttu-id="b96a5-250">[![Администраторы могут создавать новые учетные записи пользователей](configuring-a-website-that-uses-application-services-cs/_static/image14.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image13.jpg)</span><span class="sxs-lookup"><span data-stu-id="b96a5-250">[![Administrators Can Create New User Accounts](configuring-a-website-that-uses-application-services-cs/_static/image14.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image13.jpg)</span></span>

<span data-ttu-id="b96a5-251">**Рис. 5**: Администраторы могут создавать новые учетные записи пользователей ([Просмотр полноразмерное изображение](configuring-a-website-that-uses-application-services-cs/_static/image15.jpg))</span><span class="sxs-lookup"><span data-stu-id="b96a5-251">**Figure 5**: Administrators Can Create New User Accounts ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image15.jpg))</span></span>


<span data-ttu-id="b96a5-252">Случай полный набор функций извлечения WSAT [ *последовательное свои собственные Web Site Administration Tool*](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx), в какой автор Dan Clem пошаговое описание процесса создания пользовательского инструмента WSAT like.</span><span class="sxs-lookup"><span data-stu-id="b96a5-252">If you need the full functionality of the WSAT check out [*Rolling Your Own Web Site Administration Tool*](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx), in which author Dan Clem walks through the process of building a custom WSAT-like tool.</span></span> <span data-ttu-id="b96a5-253">Дэн папки его исходного кода приложения (в C#) и предоставляет пошаговые инструкции по добавлению ее для вашего размещаемого веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="b96a5-253">Dan shares his application s source code (in C#) and provides step-by-step instructions for adding it to your hosted website.</span></span>

## <a name="summary"></a><span data-ttu-id="b96a5-254">Сводка</span><span class="sxs-lookup"><span data-stu-id="b96a5-254">Summary</span></span>

<span data-ttu-id="b96a5-255">При развертывании веб-приложения, который использует реализацию базы данных служб приложения сначала необходимо убедиться, что рабочая база данных имеет объекты необходимые базы данных.</span><span class="sxs-lookup"><span data-stu-id="b96a5-255">When deploying a web application that uses the application services database implementation you must first ensure that the production database has the requisite database objects.</span></span> <span data-ttu-id="b96a5-256">Эти объекты могут быть добавлены с помощью способов, приведенных в *развертывание базы данных* учебника; Кроме того, можно использовать `aspnet_regsql.exe` средства, как было показано в этом учебнике.</span><span class="sxs-lookup"><span data-stu-id="b96a5-256">These objects can be added using the techniques discussed in the *Deploying a Database* tutorial; alternatively, you can use the `aspnet_regsql.exe` tool, as we saw in this tutorial.</span></span> <span data-ttu-id="b96a5-257">Существуют и другие проблемы мы рассмотрели сосредоточено вокруг имя приложения, используемое в средах разработки и эксплуатации (что является существенным, если пользователи и роли, созданные в среде разработки недействителен в производстве) и методы синхронизации Управление пользователями и ролями в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="b96a5-257">Other challenges we touched on center around synchronizing the application name used in the development and production environments (which is important if you want users and roles created in the development environment to be valid on production) and techniques for managing the users and roles in the production environment.</span></span>

<span data-ttu-id="b96a5-258">Программирование довольны!</span><span class="sxs-lookup"><span data-stu-id="b96a5-258">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="b96a5-259">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="b96a5-259">Further Reading</span></span>

<span data-ttu-id="b96a5-260">Дополнительные сведения по темам, рассматриваемые в этом учебнике см. в следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="b96a5-260">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="b96a5-261">*Средство регистрации ASP.NET SQL Server (aspnet_regsql.exe)*</span><span class="sxs-lookup"><span data-stu-id="b96a5-261">*ASP.NET SQL Server Registration Tool (aspnet_regsql.exe)*</span></span>](https://msdn.microsoft.com/library/ms229862.aspx)
- [<span data-ttu-id="b96a5-262">*Создание базы данных служб приложения для SQL Server*</span><span class="sxs-lookup"><span data-stu-id="b96a5-262">*Creating the Application Services Database for SQL Server*</span></span>](https://msdn.microsoft.com/library/x28wfk74.aspx)
- [<span data-ttu-id="b96a5-263">*Создание схемы членства в SQL Server*</span><span class="sxs-lookup"><span data-stu-id="b96a5-263">*Creating the Membership Schema in SQL Server*</span></span>](../../older-versions-security/membership/creating-the-membership-schema-in-sql-server-cs.md)
- [<span data-ttu-id="b96a5-264">*Изучение s членства ASP.NET, ролей и профиля*</span><span class="sxs-lookup"><span data-stu-id="b96a5-264">*Examining ASP.NET s Membership, Roles, and Profile*</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="b96a5-265">*Последовательное собственные Web Site Administration Tool*</span><span class="sxs-lookup"><span data-stu-id="b96a5-265">*Rolling Your Own Web Site Administration Tool*</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)
- [<span data-ttu-id="b96a5-266">*Учебники по безопасности веб-сайта*</span><span class="sxs-lookup"><span data-stu-id="b96a5-266">*Website Security Tutorials*</span></span>](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md)
- [<span data-ttu-id="b96a5-267">*Обзор средства администрирования веб-сайта*</span><span class="sxs-lookup"><span data-stu-id="b96a5-267">*Web Site Administration Tool Overview*</span></span>](https://msdn.microsoft.com/library/yy40ytx0.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="b96a5-268">[Назад](configuring-the-production-web-application-to-use-the-production-database-cs.md)
> [Вперед](strategies-for-database-development-and-deployment-cs.md)</span><span class="sxs-lookup"><span data-stu-id="b96a5-268">[Previous](configuring-the-production-web-application-to-use-the-production-database-cs.md)
[Next](strategies-for-database-development-and-deployment-cs.md)</span></span>
