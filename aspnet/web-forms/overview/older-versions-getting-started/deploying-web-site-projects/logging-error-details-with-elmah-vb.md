---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/logging-error-details-with-elmah-vb
title: Записи сведений об ошибках с ELMAH (VB) | Документы Microsoft
author: rick-anderson
description: Ошибка ведения журнала модули и обработчики (ELMAH) другой подход для ведения журнала ошибок времени выполнения в рабочей среде. ELMAH ошибочен бесплатно, открытый код...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/09/2009
ms.topic: article
ms.assetid: a5f0439f-18b2-4c89-96ab-75b02c616f46
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/logging-error-details-with-elmah-vb
msc.type: authoredcontent
ms.openlocfilehash: 584791a944c9e8eb0113da68719292f448573980
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/10/2018
---
<a name="logging-error-details-with-elmah-vb"></a>Записи сведений об ошибках с ELMAH (Visual Basic)
====================
по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Загрузить код](http://download.microsoft.com/download/1/0/C/10CC829F-A808-4302-97D3-59989B8F9C01/ASPNET_Hosting_Tutorial_14_VB.zip) или [скачать PDF](http://download.microsoft.com/download/5/C/5/5C57DB8C-5DEA-4B3A-92CA-4405544D313B/aspnet_tutorial14_ELMAH_vb.pdf)

> Ошибка ведения журнала модули и обработчики (ELMAH) другой подход для ведения журнала ошибок времени выполнения в рабочей среде. ELMAH — это библиотека ведения журнала свободного с открытым исходным ошибка, которая включает в себя функции, например фильтрации ошибок и возможность просматривать журнал ошибок с веб-страницы в виде RSS-канала или загружать его как файл с разделителями запятыми. Этого учебника вы научитесь Загрузка и настройка ELMAH.


## <a name="introduction"></a>Вступление

[Предыдущего учебника](logging-error-details-with-asp-net-health-monitoring-vb.md) проверить ASP. Система, обеспечивающую вне библиотеки поле для записи в широком наборе веб-события наблюдения за работоспособностью NET. Многие разработчики используют для входа и отправить подробные сведения об необработанных исключений мониторинга работоспособности. Однако есть несколько сложностями с этой системой. Первое и самое главное заключается в отсутствии каких-либо пользовательского интерфейса для просмотра сведений о записи журнала событий. Если вы хотите просмотреть 10 последней ошибки или просмотреть сведения об ошибке, что произошло прошлой неделе, необходимо либо Вставка через базу данных, просмотр папки "Входящие", ваш адрес электронной почты или построения веб-страницы, отображающий сведения из `aspnet_WebEvent_Events` таблицы.

Другой усложняют основано на мониторинг работоспособности сложности. Поскольку мониторинг состояния может использоваться для записи множество различных событий, и используются различные параметры для регистрации событий с инструкциями, правильной настройке системы мониторинга работоспособности может быть сложно. Наконец есть проблемы совместимости. Так как наблюдение за работоспособностью сначала была добавлена в .NET Framework версии 2.0, она недоступна для более старых веб-приложений, созданных с использованием ASP.NET версии 1.x. Кроме того `SqlWebEventProvider` класс, который использовался в предыдущем учебнике, чтобы сведений об ошибках журналы базы данных работает только с базами данных Microsoft SQL Server. Необходимо будет создать класс поставщика пользовательского журнала необходимости ошибок в журнал в альтернативное хранилище данных, например XML-файл или база данных Oracle.

Ошибка ведения журнала модули и обработчики (ELMAH), система ведения журналов бесплатный, открытым исходным кодом ошибки, созданные является альтернативой система наблюдения за работоспособностью [Атиф Азиз](http://www.raboof.com/). Самое заметное различие между двумя системами — ELAMH на возможность отображения списка ошибок и сведения об ошибке с веб-страницы и как RSS-канал. ELMAH проще в настройке, чем наблюдение за работоспособностью, так как только она записывает ошибки. Кроме того ELMAH включает поддержку 1.x ASP.NET, приложениях ASP.NET 2.0 и ASP.NET 3.5 и поставляется с множеством регистраторов источника.

Этот учебник рассматриваются шаги, необходимые для добавления в приложение ASP.NET ELMAH. Давайте начнем!

> [!NOTE]
> Наблюдение за системой и ELMAH работоспособности имеют свои собственные наборы преимуществ и недостатков. Я рекомендую попробовать обеих систем, и решить, какие один лучший средства вашим потребностям.


## <a name="adding-elmah-to-an-aspnet-web-application"></a>Добавление ELMAH веб-приложения ASP.NET

Интеграция ELMAH в новом или существующем приложении ASP.NET является простым и понятным процесс, который принимает пять минут. По сути оно включает в себя четыре простых шагов:

1. Загрузить ELMAH и добавить `Elmah.dll` сборки веб-приложению
2. Зарегистрировать модули HTTP и обработчик в ELMAH элемента `Web.config`,
3. Укажите параметры конфигурации ELMAH, и
4. При необходимости создайте инфраструктуре источника журнала ошибок.

Давайте рассмотрим каждый из этих четырех шагов, по одному.

### <a name="step-1-downloading-the-elmah-project-files-and-addingelmahdllto-your-web-application"></a>Шаг 1: Загрузка ELMAH файлы проекта и добавление`Elmah.dll`в веб-приложение

ELMAH 1.0 бета-версии 3 (сборка 10617), самой последней версии на момент написания статьи, включается в загрузить с помощью этого учебника. Кроме того, посетите [ELMAH веб-сайт](https://code.google.com/p/elmah/) для получения самой последней версии или загрузить исходный код. Извлеките файл ELMAH в папке на рабочем столе и файл сборки ELMAH (`Elmah.dll`).

> [!NOTE]
> `Elmah.dll` Файл находится в загрузки `Bin` папке, которая содержит вложенные папки для разных версий платформы .NET Framework и для сборки выпуска и отладки. Используйте построения выпуска для соответствующего Framework. Например, при создании веб-приложения ASP.NET 3.5, скопируйте `Elmah.dll` файл из `Bin\net-3.5\Release` папки.


Затем откройте Visual Studio и добавить сборку в проект, правой кнопкой мыши имя веб-сайта в обозревателе решений и выбрав команду Добавить ссылку в контекстном меню. Откроется диалоговое окно «Добавление ссылки». Перейдите на вкладку "Обзор", выберите `Elmah.dll` файл. Это действие добавляет `Elmah.dll` файла в веб-приложение `Bin` папки.

> [!NOTE]
> Тип проекта веб-приложения (WAP) не содержит `Bin` папки в обозревателе решений. Вместо этого он представлен список этих элементов в папке ссылки.


`Elmah.dll` Сборка содержит классы, используемые системой ELMAH. Эти классы делятся на три категории:

- **Модули HTTP** -HTTP-модуль — это класс, который определяет обработчики событий для `HttpApplication` события, такие как `Error` событий. ELMAH включает несколько модулей HTTP, три из них наиболее germane выполняется: 

    - `ErrorLogModule` -систему источник журнала необработанных исключений.
    - `ErrorMailModule` -отправляет сведения о возникновении необработанного исключения в сообщении электронной почты.
    - `ErrorFilterModule` -применяет определенные разработчиком фильтры, чтобы определить, какие исключения регистрируются и что другие игнорируются.
- **Обработчики HTTP-данных** -обработчика HTTP-данных — это класс, ответственный за создание разметки для определенного типа запроса. ELMAH включает в себя обработчики HTTP-данных, которые отображают сведения об ошибке, как веб-страницы, RSS-канал или файл с разделителями запятыми (CSV).
- **Источники журналов ошибок** - готового ELMAH могут входить ошибки в памяти для базы данных Microsoft SQL Server, базы данных Microsoft Access, базы данных Oracle, XML-файл в базу данных SQLite, или в базу данных Vista DB. Как система наблюдения за работоспособностью ELMAH архитектура была построена с использованием модель поставщика, это означает, что можно создавать и легко интегрировать свои собственные пользовательские источника регистраторы, при необходимости.

### <a name="step-2-registering-elmahs-http-module-and-handler"></a>Шаг 2: Регистрация HTTP-модуля и обработчика ELMAH

Хотя `Elmah.dll` файл содержит модули HTTP и обработчика необходимо, чтобы автоматически журнала необработанных исключений и чтобы отобразить сведения об ошибке с веб-страницы, они должны быть явно зарегистрированы в конфигурации веб-приложения. `ErrorLogModule` HTTP-модуля после их регистрации подписывается на `HttpApplication` `Error` событие. Каждый раз, когда это событие вызывается `ErrorLogModule` регистрирует подробности исключения с источником указанного журнала. Мы рассмотрим, как определить источник регистратор в следующем разделе «Настройка ELMAH». `ErrorLogPageFactory` Фабрика обработчиков HTTP отвечает за создание разметку при просмотре журнала ошибок с веб-страницы.

Особый синтаксис для регистрации HTTP-модули и обработчики зависит от веб-сервера, который подготавливается сайт. Для ASP.NET Development Server и Microsoft IIS версии 6.0 и более ранних, HTTP-модули и обработчики регистрируются в `<httpModules>` и `<httpHandlers>` разделы, в которых отображаются внутри `<system.web>` элемента. Если используется IIS версии 7.0, то они должны быть зарегистрированы в `<system.webServer>` элемента `<modules>` и `<handlers>` разделы. К счастью, можно определить HTTP-модули и обработчики в *оба* помещает независимо от того, используется веб-сервера. Этот вариант является наиболее переносимой разрешается ту же конфигурацию для использования в средах разработки и эксплуатации, независимо от того, используется веб-сервера.

Начните с регистрации `ErrorLogModule` HTTP-модуля и `ErrorLogPageFactory` обработчик HTTP-данных в `<httpModules>` и `<httpHandlers>` раздела `<system.web>`. Если конфигурация в уже определяет этих элементов и затем просто включите `<add>` элемент ELMAH в HTTP-модуль и обработчик.

[!code-xml[Main](logging-error-details-with-elmah-vb/samples/sample1.xml)]

Затем зарегистрируйте ELMAH в HTTP-модуль и обработчик в `<system.webServer>` элемент. Как и раньше Если этот элемент не существует в конфигурации добавьте его.

[!code-xml[Main](logging-error-details-with-elmah-vb/samples/sample2.xml)]

По умолчанию службы IIS 7 выдаст ошибку при HTTP-модули и обработчики, регистрируются в `<system.web>` раздела. `validateIntegratedModeConfiguration` Атрибута в `<validation>` элемент указывает, что службы IIS 7 для подавления таких сообщений об ошибках.

Обратите внимание, что синтаксис для регистрации `ErrorLogPageFactory` содержит обработчик HTTP `path` атрибута, который имеет значение `elmah.axd`. Этот атрибут сообщает веб-приложения, если запрос прибывает страницы с именем `elmah.axd` , то запрос должен обрабатываться `ErrorLogPageFactory` обработчика HTTP-данных. Мы рассмотрим `ErrorLogPageFactory` обработчика HTTP-данных в действии, далее в этом учебнике.

### <a name="step-3-configuring-elmah"></a>Шаг 3: Настройка ELMAH

ELMAH ищет его параметры конфигурации на веб-сайте `Web.config` файла в настраиваемого раздела конфигурации с именем `<elmah>`. Чтобы использовать пользовательский раздел в `Web.config` должен быть сначала определен в `<configSections>` элемент. Откройте `Web.config` и добавьте следующую разметку, чтобы `<configSections>`:

[!code-xml[Main](logging-error-details-with-elmah-vb/samples/sample3.xml)]

> [!NOTE]
> При настройке приложения ASP.NET 1.x ELMAH удалите `requirePermission="false"` атрибута из `<section>` элементов, описанных выше.


Указанный выше синтаксис регистрирует пользовательский `<elmah>` раздел и его подразделы: `<security>`, `<errorLog>`, `<errorMail>`, и `<errorFilter>`.

Добавьте `<elmah>` раздел `Web.config`. В этом разделе должен находиться в том же уровне, что `<system.web>` элемент. Внутри `<elmah>` добавить раздел `<security>` и `<errorLog>` разделы следующим образом:

[!code-xml[Main](logging-error-details-with-elmah-vb/samples/sample4.xml)]

`<security>` Раздела `allowRemoteAccess` атрибут указывает, разрешен удаленный доступ. Если это значение равно 0, веб-странице журнала ошибок можно будет просмотреть только локально. Если этот атрибут имеет значение 1 для удаленной и локальной посетителей включен веб-странице журнала ошибок. Теперь давайте отключить веб-странице журнала ошибок для удаленных посетителей. Мы будем разрешен удаленный доступ к позже, после того как мы возможность обсуждать вопросы безопасности, это можно сделать.

`<errorLog>` Раздел определяет источник ошибки журнала, который определяет, где записываются сведения об ошибке; Это похоже на `<providers>` раздела система наблюдения за работоспособностью. Задает указанный выше синтаксис `SqlErrorLog` класс как источник журнала ошибок, журналов ошибок для базы данных Microsoft SQL Server, указанной `connectionStringName` значение атрибута.

> [!NOTE]
> ELMAH поставляется с регистраторы дополнительные ошибки, которые можно использовать для ведения журнала ошибок в XML-файл, база данных Microsoft Access, базы данных Oracle и другим хранилищам данных. Ссылки на примеры `Web.config` файл, который входит в состав загрузки ELMAH сведения об использовании регистраторов эти альтернативные ошибки.


### <a name="step-4-creating-the-error-log-source-infrastructure"></a>Шаг 4: Создание инфраструктуры исходного журнала ошибок

В ELMAH `SqlErrorLog` поставщик регистрирует сведения об ошибке в указанной базе данных Microsoft SQL Server. `SqlErrorLog` Предусмотренном поставщиком этой базы данных, чтобы создать таблицу с именем `ELMAH_Error` и три хранимых процедур: `ELMAH_GetErrorsXml`, `ELMAH_GetErrorXml`, и `ELMAH_LogError`. ELMAH загружаемый файл содержит файл с именем `SQLServer.sql` в `db` папку, содержащую T-SQL для создания этой таблицы и следующих хранимых процедур. Вам потребуется запустить эти инструкции базы данных для использования `SqlErrorLog` поставщика.

**Рис. 1** и **2** Показать обозреватель баз данных в Visual Studio после объекты базы данных, необходимые для `SqlErrorLog` были добавлены поставщика.

[![](logging-error-details-with-elmah-vb/_static/image2.png)](logging-error-details-with-elmah-vb/_static/image1.png)

**Рис. 1**: `SqlErrorLog` поставщик заносит в журнал ошибки `ELMAH_Error` таблицы

[![](logging-error-details-with-elmah-vb/_static/image4.png)](logging-error-details-with-elmah-vb/_static/image3.png)

**На рисунке 2**: `SqlErrorLog` поставщик использует три хранимые процедуры

## <a name="elmah-in-action"></a>ELMAH в действии

На этом этапе мы добавили ELMAH веб-приложения, зарегистрированные `ErrorLogModule` HTTP-модуля и `ErrorLogPageFactory` обработчик HTTP-данных указан в параметры конфигурации ELMAH `Web.config`и добавить объекты базы данных необходимые для `SqlErrorLog` Поставщик журнала ошибок. Теперь готовы увидеть ELMAH в действии! Посетите веб-сайт рецензий и посетите страницу, которая вызывает ошибку времени выполнения, такие как `Genre.aspx?ID=foo`, или несуществующий страницы, такие как `NoSuchPage.aspx`. Отображается при посещении эти страницы зависит от `<customErrors>` конфигурации и посещении локально или удаленно. (Обращаться к [ *отображение настраиваемой страницы ошибки* учебника](displaying-a-custom-error-page-vb.md) в памяти в этом разделе.)

ELMAH не влияет на какое содержимое отображается для пользователя, когда происходит необработанное исключение; она просто записывает сведения о нем. Этот журнал доступен на веб-странице `elmah.axd` из корневого каталога веб-сайта, такие как `http://localhost/BookReviews/elmah.axd`. (Этот файл не существует физически в проекте, но при поступлении запроса для `elmah.axd` среда выполнения пересылает его `ErrorLogPageFactory` обработчик HTTP, который создает разметку, отправляемого в браузер.)

> [!NOTE]
> Можно также использовать `elmah.axd` страницу, чтобы дать указание ELMAH для формирования ошибки теста. Посетив `elmah.axd/test` (как в `http://localhost/BookReviews/elmah.axd/test`) вызывает ELMAH исключение типа `Elmah.TestException`, содержит сообщение об ошибке: «Это тест исключение, которое можно спокойно проигнорировать.»


**Рис. 3** показывает журнал ошибок при посещении `elmah.axd` из среды разработки.

[![](logging-error-details-with-elmah-vb/_static/image6.png)](logging-error-details-with-elmah-vb/_static/image5.png)

**Рис. 3**: `Elmah.axd` отображает журнал ошибок с веб-страницы  
([Просмотр полноразмерное изображение](logging-error-details-with-elmah-vb/_static/image7.png))

Журнал ошибок **рис. 3** содержит шесть записей об ошибках. Каждая запись содержит код состояния HTTP (404 или 500 для этих ошибок), тип, описание, имя пользователя, вошедшего в систему на момент возникновения ошибки и дату и время. Щелкнув ссылку сведения отображает страницу, которая включает в себя же сообщение об ошибке, показано в ошибки сведения желтый экрана из смерти (см. **рис. 4**) и значения переменных сервера во время возникновения ошибки (см.  **Рис. 5**). Можно также просмотреть необработанного XML, в котором сохраняются сведения об ошибке, который включает также дополнительные сведения, такие как значения в заголовке HTTP POST.

[![](logging-error-details-with-elmah-vb/_static/image9.png)](logging-error-details-with-elmah-vb/_static/image8.png)

**Рис. 4**: просмотрите описание ошибки YSOD  
([Просмотр полноразмерное изображение](logging-error-details-with-elmah-vb/_static/image10.png))

[![](logging-error-details-with-elmah-vb/_static/image12.png)](logging-error-details-with-elmah-vb/_static/image11.png)

**Рис. 5**: просмотр значений коллекции переменных сервера, во время возникновения ошибки  
([Просмотр полноразмерное изображение](logging-error-details-with-elmah-vb/_static/image13.png))

Включает развертывание ELMAH рабочий веб-сайт.

- Копирование `Elmah.dll` файл `Bin` папки в рабочей среде,
- Копирование конкретного ELMAH параметры конфигурации, `Web.config` файлом, используемым в производственной среде, и
- Добавление инфраструктуры исходного журнала ошибок в производственной базе данных.

Мы рассматривали методы копирования файлов из среды разработки в рабочую среду в предыдущих учебниках. Возможно, самый простой способ получить инфраструктуры исходного журнала ошибок в производственной базы данных является использование SQL Server Management Studio для подключения к рабочей базе данных, а затем выполните `SqlServer.sql` файл скрипта, который будет создавать необходимые таблицы и хранимые процедуры.

### <a name="viewing-the-error-details-page-on-production"></a>Просмотр странице Подробности ошибки в рабочей среде

После развертывания веб-узла в рабочей среде, посетите веб-сайт производства и создайте необработанное исключение. Как в среде разработки ELMAH не оказывает никакого влияния на страницу ошибки, отображаемую при возникновении необработанного исключения; Вместо этого он просто записывает эту ошибку. При попытке перейти на страницу журнала ошибок (`elmah.axd`) в рабочей среде, можно будет сталкивается с запрещено страница, отображаемая в **рис. 6**.

[![](logging-error-details-with-elmah-vb/_static/image15.png)](logging-error-details-with-elmah-vb/_static/image14.png)

**Рис. 6**: по умолчанию удаленный посетители не может просматривать веб-страницы журнала ошибок  
([Просмотр полноразмерное изображение](logging-error-details-with-elmah-vb/_static/image16.png))

Помните, что в конфигурации ELMAH `<security>` раздел задается `allowRemoteAccess` равным 0, что запрещает удаленным пользователям просмотр журнала ошибок. Очень важно запретить анонимных пользователей просматривать журнал, как сведения об ошибке, можно выявить уязвимости системы безопасности или другую конфиденциальную информацию. Если вы решили присвоить этому атрибуту значение 1 и удаленного доступа в журнале ошибок, то важно блокировки `elmah.axd` путь, так что только авторизованные посетители есть доступ к нему. Это можно сделать, добавив `<location>` элемент `Web.config` файла.

Следующая конфигурация разрешает только пользователям в роли администратора для доступа к веб-странице журнала ошибок:

[!code-xml[Main](logging-error-details-with-elmah-vb/samples/sample5.xml)]

> [!NOTE]
> Роли администратора и трех пользователей в системе - Скотт Цзисунь и Анна - были добавлены в [ *Настройка веб-сайт, использующий службы приложений* учебника](configuring-a-website-that-uses-application-services-vb.md). Скотт пользователей и Цзисунь являются членами роли администратора. Дополнительные сведения о проверке подлинности и авторизации см. в мой [учебники безопасности веб-сайта](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).


Теперь можно просмотреть журнал ошибок в производственной среде удаленными пользователями; обращаться к **3 цифры**, **4**, и **5** для снимков экрана веб-страницы журнала ошибок. Тем не менее, если пользователь с анонимным, так и без прав администратора пытается просмотреть страницу журнала ошибок они автоматически перенаправляются на страницу входа (`Login.aspx`), как **рис. 7** показано.

[![](logging-error-details-with-elmah-vb/_static/image18.png)](logging-error-details-with-elmah-vb/_static/image17.png)

**Рис. 7**: У пользователей, автоматически перенаправляется на страницу входа  
([Просмотр полноразмерное изображение](logging-error-details-with-elmah-vb/_static/image19.png))

### <a name="programmatically-logging-errors"></a>Программными средствами ведения журнала ошибок

В ELMAH `ErrorLogModule` HTTP-модуля автоматически регистрирует необработанных исключений в указанном журнале источник. Кроме того, может регистрировать ошибку без необходимости выдано необработанное исключение с помощью `ErrorSignal` класса и его `Raise` метод. `Raise` Методу передается `Exception` объект и записывает ее, как если бы исключение было исключение и достигнуто среды выполнения ASP.NET без обработки. Разница, то, что запрос выполняется после обычно `Raise` был вызван метод, тогда как вызываться исключение, необрабатываемое исключение прерывает обычное выполнение запроса и отображения настроенного среда выполнения ASP.NET страница ошибки.

`ErrorSignal` Класс можно использовать в ситуациях, отсутствует какое-либо действие, может завершиться ошибкой, когда его сбои не являются критическими выполняемой операции. Например, веб-сайт может содержать форму, которая принимает входные данные пользователя, сохраняет его в базе данных, а затем отправляет пользователю электронное сообщение о том, что они обработки информации. Что делать, если сведения сохраняются в базе данных успешно, но имеется ошибка при отправке сообщения электронной почты? Один из вариантов будет вызывать исключение и отправить пользователю страницу ошибки. Тем не менее это может запутать пользователя принять данные, введенные не был сохранен. Другой подход будет журнала ошибок, связанных с электронной почтой, но не изменять каким-либо образом взаимодействие с пользователем. Это место, куда `ErrorSignal` класс полезен.

[!code-vb[Main](logging-error-details-with-elmah-vb/samples/sample6.vb)]

## <a name="error-notification-via-email"></a>Ошибка уведомления по электронной почте

А также ведение журнала ошибок в базе данных ELMAH можно настроить к электронной почте, сведения об ошибке для указанного получателя. Эта функциональность обеспечивается `ErrorMailModule` HTTP-модуля; таким образом, необходимо зарегистрировать этот модуль HTTP в `Web.config` Чтобы отправить сведения об ошибке по электронной почте.

[!code-xml[Main](logging-error-details-with-elmah-vb/samples/sample7.xml)]

Затем укажите сведения об ошибке сообщения электронной почты в `<elmah>` элемента `<errorMail>` раздел, указывающий, отправитель и получатель, тема, электронной почты и ли электронное письмо отправляется асинхронно.

[!code-xml[Main](logging-error-details-with-elmah-vb/samples/sample8.xml)]

С указанные выше параметры каждый раз, когда возникнет ошибка среды выполнения ELMAH отправляет по электронной почте support@example.com с описанием ошибки. Электронной почты ELMAH ошибка включает те же сведения, показаны ошибки сведения о веб-странице, а именно сообщение об ошибке, трассировку стека и переменных сервера (обращаться к **рис** и **5**). Ошибка сообщения электронной почты включает содержимое исключение сведения желтый экрана из смерти как вложение (`YSOD.html`).

**Рис. 8** показывает электронных сообщений ELMAH ошибок, создаваемых, посетив `Genre.aspx?ID=foo`. Хотя **рис. 8** показывает только ошибки сообщение и трассировка стека, переменные сервера включены дальнейшей работы в тело сообщения электронной почты.

[![](logging-error-details-with-elmah-vb/_static/image21.png)](logging-error-details-with-elmah-vb/_static/image20.png)

**Рис. 8**: можно настроить ELMAH, чтобы отправить сведения об ошибке по электронной почте  
([Просмотр полноразмерное изображение](logging-error-details-with-elmah-vb/_static/image22.png))

## <a name="only-logging-errors-of-interest"></a>Только запись в журнал ошибок интерес

По умолчанию ELMAH записывает сведения о каждом необработанном исключении, включая 404 и других ошибок HTTP. Можно настроить ELMAH пропускать эти или другие типы ошибок, с помощью фильтрации ошибок. Выполняет логику фильтрации ELMAH `ErrorFilterModule` модуль HTTP, который необходимо зарегистрировать в `Web.config` для использования логику фильтрации. Правила фильтрации, определены в `<errorFilter>` раздела.

Приведенная ниже разметка предписывает ELMAH не ошибок в журнал 404.

[!code-xml[Main](logging-error-details-with-elmah-vb/samples/sample9.xml)]

> [!NOTE]
> Не забывайте, чтобы использовать фильтрации ошибок необходимо зарегистрировать `ErrorFilterModule` HTTP-модуля.


`<equal>` Внутри `<test>` раздел называется утверждения. Если утверждения имеет значение true из журнала ELMAH фильтруется ошибку. Доступны другие утверждения, включая: `<greater>`, `<greater-or-equal>`, `<not-equal>`, `<lesser>`, `<lesser-or-equal>`, и т. д. Можно также объединять утверждения, используя `<and>` и `<or>` логических операторов. Более того можно даже включать простое выражение JavaScript, как утверждения, или написать собственные утверждения в C# или Visual Basic.

Дополнительные сведения об ошибке ELMAH возможностей фильтрации посвящены [фильтрации ошибок раздел](https://code.google.com/p/elmah/wiki/ErrorFiltering) в [ELMAH вики-сайте](https://code.google.com/p/elmah/w/list).

## <a name="summary"></a>Сводка

ELMAH предоставляет простой, и эффективный механизм для ведения журнала ошибок в веб-приложения ASP.NET. Как система мониторинга работоспособности корпорации Майкрософт ELMAH ведения журнала ошибок в базе данных и может отправлять сведения об ошибке разработчику по электронной почте. В отличие от система наблюдения за работоспособностью ELMAH включает поддержка поле для более широкого круга хранилищ данных журнала ошибок, включая: Microsoft SQL Server, Microsoft Access, Oracle, XML-файлы и несколько других. Кроме того, ELMAH предоставляет встроенный механизм для просмотра журнала ошибок и сведения о конкретной ошибке на веб-странице `elmah.axd`. `elmah.axd` Страница также может отображать сведения об ошибке, как RSS-канал или в файл значений с разделителями запятыми (CSV), можно получить с помощью Microsoft Excel. Можно также указать ELMAH чтобы отфильтровать ошибки из журнала с помощью проверочных утверждений декларативной или программный. И ELMAH может использоваться с приложениями ASP.NET версии 1.x.

Каждый развернутого приложения должны иметь некий механизм для автоматической записи необработанных исключений и отправлением уведомлений о команде разработчиков. Ли это достигается с помощью наблюдения за работоспособностью или ELMAH получателей. Другими словами он не имеет значения, намного, используется ли наблюдение за работоспособностью и ELMAH; Оценка обеих систем и затем выбрать ту, которая лучше всего соответствует вашим потребностям. Существенно важно то, что механизм быть помещены в место для журнала необработанных исключений в рабочей среде.

Программирование довольны!

### <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения по темам, рассматриваемые в этом учебнике см. в следующих ресурсах:

- [ELMAH - ошибка модули и обработчики журнала](http://dotnetslackers.com/articles/aspnet/ErrorLoggingModulesAndHandlers.aspx)
- [Страница проекта ELMAH](https://code.google.com/p/elmah/) (исходного кода, примеры, вики-сайт)
- [Использование ELMAH в веб-приложение для перехвата необработанных исключений](http://screencastaday.com/ScreenCasts/43_Plugging_Elmah_into_Web_Application_to_Catch_Unhandled_Exceptions.aspx) (видео)
- [Страницы журнала ошибок безопасности](https://code.google.com/p/elmah/wiki/SecuringErrorLogPages)
- [С помощью HTTP-модули и обработчики для создания подключаемых компонентов ASP.NET](https://msdn.microsoft.com/library/aa479332.aspx)
- [Учебники по безопасности веб-сайта](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md)

> [!div class="step-by-step"]
> [Назад](logging-error-details-with-asp-net-health-monitoring-vb.md)
> [Вперед](precompiling-your-website-vb.md)
