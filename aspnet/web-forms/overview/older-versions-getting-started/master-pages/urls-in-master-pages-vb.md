---
uid: web-forms/overview/older-versions-getting-started/master-pages/urls-in-master-pages-vb
title: URL-адреса в главных страниц (Visual Basic) | Документы Microsoft
author: rick-anderson
description: Адреса, как URL-адреса на главной странице может нарушить работу из-за файла главной страницы в относительный каталог, отличный от содержимого страницы. Рассматривает преобразоваться...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/10/2008
ms.topic: article
ms.assetid: 43d1e83c-0092-4dcf-977c-e709c4dce7c3
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/urls-in-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: e1d4b2d66bedfb5f3d7d8c61265944a82605e77e
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30888075"
---
<a name="urls-in-master-pages-vb"></a>URL-адреса в главных страниц (Visual Basic)
====================
по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Загрузить код](http://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_04_VB.zip) или [скачать PDF](http://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_04_VB.pdf)

> Адреса, как URL-адреса на главной странице может нарушить работу из-за файла главной страницы в относительный каталог, отличный от содержимого страницы. Рассматривает преобразоваться URL-адреса через ~ декларативный синтаксис и программно с помощью ResolveUrl и ResolveClientUrl. (Также рассмотрим


## <a name="introduction"></a>Вступление

Во всех примерах мы видели до сих страницах располагаются в той же папке (корневой папке веб-сайта). Однако нет необходимости, почему страницах должна быть в той же папке. Безусловно, страницы содержимого можно создать во вложенных папках. Аналогичным образом, можно создать `~/MasterPages/` папку, куда поместить главной страницы веб-узла.

Одна возможная проблема с размещением в разных папках страницах подразумевает неработающие URL-адреса. Если главная страница содержит относительные URL-адреса гиперссылки, изображения или другие элементы, ссылки будут недопустимыми для страницы содержимого, которые находятся в другой папке. В этом учебнике рассматриваются источником этой проблемы, а также способы решения проблем.

## <a name="the-problem-with-relative-urls"></a>Проблема с относительные URL-адреса

URL-адрес веб-страницы, называется *относительный URL-адрес* Если расположение ресурса, он указывает задается относительно расположения веб-страницы в структуре папок веб-сайта. Любой URL-адрес, который не начинается с косой черты в начале прямого (`/`) или протокол (например, `http://`) является относительным, так как она будет устранена в браузере, исходя из расположения, содержащий URL-адрес веб-страницы.

Например, веб-узел имеет `~/Images/` папку с файлом одно изображение `PoweredByASPNET.gif`. Файл главной страницы `Site.master` имеет `<img>` элемент в `footerContent` область с следующую разметку:


[!code-html[Main](urls-in-master-pages-vb/samples/sample1.html)]

`src` Значения в атрибута `<img>` элемент является относительным URL-адресом, так как не начинается с `/` или `http://`. Иными словами `src` значение атрибута предписывает браузеру см. в `Images` вложенную папку для файла с именем `PoweredByASPNET.gif`.

При посещении страницы содержимого, выше разметки отправляется непосредственно в браузере. Теперь пора посетите `About.aspx` и просмотреть исходный код HTML, отправляемого в браузер. Вы обнаружите, что точное же разметки на главной странице было отправлено в браузере.


[!code-html[Main](urls-in-master-pages-vb/samples/sample2.html)]

Если страницы содержимого находится в корневой папке (как `About.aspx`) все работает правильно, так как отсутствует `Images` вложенная папка относительно корневой папки. Однако вещей разбить, если страница содержимого находится в папку, отличную от главной страницы. Чтобы проиллюстрировать это, создайте вложенную папку с именем `Admin`. Добавьте страницу содержимого с именем `Default.aspx` для `Admin` папки, убедитесь, что привязка новую страницу `Site.master` главной страницы.

> [!NOTE]
> В [ *указанием заголовка, мета-теги и другие заголовки HTML на главной странице* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) учебник, созданную пользовательскую страницу базовый класс с именем `BasePage` , автоматически устанавливается заголовка содержимого страницы (если он не был явно назначен). Не забудьте имеют являются производными от класса с выделенным кодом созданная страница `BasePage` , чтобы его можно с помощью этой функции.


После создания этой страницы содержимого, в обозревателе решений будет выглядеть на рис. 1.


![Новая папка и страницы ASP.NET, были добавлены в проект](urls-in-master-pages-vb/_static/image1.png)

**На рисунке 01**: новая папка и страницы ASP.NET, были добавлены в проект


Затем обновите `Web.sitemap` файла следует включить новый `<siteMapNode>` входа для этого занятия. Следующий код XML показывает полный `Web.sitemap` разметка, которая теперь включает добавление третьей `<siteMapNode>` элемента.


[!code-xml[Main](urls-in-master-pages-vb/samples/sample3.xml)]

Вновь созданный `Default.aspx` страница должна содержать четыре элементы управления содержимым, соответствующий четыре ContentPlaceHolders в `Site.master`. Добавьте в элемент управления содержимым, ссылающиеся на текст `MainContent` ContentPlaceHolder и затем перейдите на страницу с помощью браузера. Как показано на рисунке 2, не удается найти браузер `PoweredByASPNET.gif` файла изображения. Что здесь происходит?

`~/Admin/Default.aspx` Страницы содержимого отправляется же HTML для `footerContent` региона, как был `About.aspx` страницы:


[!code-html[Main](urls-in-master-pages-vb/samples/sample4.html)]

Поскольку `<img>` элемента `src` атрибута является относительным URL-адресом, браузер пытается найти `Images` папку относительно расположения папки веб-страницы. Другими словами, браузер выполняет поиск файла изображения `Admin/Images/PoweredByASPNET.gif`.


[![Не удается найти файл изображения PoweredByASPNET.gif](urls-in-master-pages-vb/_static/image3.png)](urls-in-master-pages-vb/_static/image2.png)

**На рисунке 02**: `PoweredByASPNET.gif` изображение не удается найти файл ([Просмотр полноразмерное изображение](urls-in-master-pages-vb/_static/image4.png))


### <a name="replacing-relative-urls-with-absolute-urls"></a>Замена относительные URL-адреса с помощью абсолютный URL-адреса

Противоположностью относительный URL-адрес является *абсолютный URL-адрес*, равное одному, который начинается с косой черты (`/`) или протокол, такой как `http://`. Поскольку абсолютный URL-адрес указывает расположение ресурса из известных фиксированной точки, же абсолютный URL-адрес в веб-страницах, независимо от расположения веб-страницы в структуре папок веб-сайта.

Чтобы исправить разорванного изображения, показанный на рисунке 2, необходимо обновить `<img>` элемента `src` атрибут, который будет использовать абсолютный URL-адрес вместо относительный. Чтобы определить правильный абсолютный URL-адрес, обратитесь на веб-страниц в веб-сайта и изучите адресной строки. Адресной строки на рисунке 2 показано, полный путь к веб-приложения является `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/`. Таким образом, корпорация Майкрософт может обновлять `<img>` элемента `src` атрибута ни с одной из следующих двух абсолютные URL:

- `/ASPNET_MasterPages_Tutorial_04_VB/Images/PoweredByASPNET.gif`
- `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_VB/Images/PoweredByASPNET.gif`

Теперь пора обновление `<img>` элемента `src` атрибут абсолютный URL-адрес, с помощью одной из форм, показанном выше, а затем перейдите `~/Admin/Default.aspx` страницу в обозревателе. Это время браузер будет правильно поиска и отображения `PoweredByASPNET.gif` файла образа (см. рис. 3).


[![— PoweredByASPNET.gif изображения теперь отображаются](urls-in-master-pages-vb/_static/image6.png)](urls-in-master-pages-vb/_static/image5.png)

**На рисунке 03**: `PoweredByASPNET.gif` — изображения теперь отображаются ([Просмотр полноразмерное изображение](urls-in-master-pages-vb/_static/image7.png))


Во время работы жесткого программирования в абсолютный URL-адрес, жестко связывает HTML для сервера веб-сайта и расположение папки, в которой может измениться. С помощью абсолютный URL-адрес в формате `http://localhost:3908/...` вызвано негибкие предшествующий localhost номер порта выбирается автоматически при каждом запуске Visual Studio встроенного сервера разработки ASP.NET Web. Аналогичным образом `http://localhost` часть допустим только при тестировании локально. После развертывания код на рабочем сервере базовый URL-адрес будет изменить на другое, например `http://www.yourserver.com`. Абсолютный URL-адрес в форме `/ASPNET_MasterPages_Tutorial_04_VB/...` также страдает от того же хрупкость, поскольку зачастую это путь к приложению отличается от разработки и рабочих серверов.

Хорошо то, что ASP.NET предоставляет метод для создания допустимый относительный URL-адрес во время выполнения.

## <a name="usingandresolveclienturl"></a>С помощью`~`и`ResolveClientUrl`

А чем вписывать абсолютный URL-адрес, ASP.NET позволяет разработчикам страниц использовать тильда (`~`) для указания корневого веб-приложения. Например, ранее в этом учебнике использовался нотации `~/Admin/Default.aspx` в тексте для ссылки на `Default.aspx` страницы в `Admin` папки. `~` Указывает, что `Admin` папка является вложенной корневого веб-приложения.

`Control` Класса [ `ResolveClientUrl` метод](https://msdn.microsoft.com/library/system.web.ui.control.resolveclienturl.aspx) принимает URL-адрес и изменяет его на относительный URL-адрес для веб-страницы, на котором находится элемент управления. Например, вызов `ResolveClientUrl("~/Images/PoweredByASPNET.gif")` из `About.aspx` возвращает `Images/PoweredByASPNET.gif`. Вызов его из `~/Admin/Default.aspx`, однако возвращает `../Images/PoweredByASPNET.gif`.

> [!NOTE]
> Поскольку все серверные элементы управления ASP.NET, являются производными от `Control` класса, все серверные элементы управления имеют доступ к `ResolveClientUrl` метод. Даже `Page` класс является производным от `Control` класса, то есть можно использовать этот метод напрямую из кода классы страниц ASP.NET.


### <a name="usingin-the-declarative-markup"></a>С помощью`~`в декларативная разметка

Несколько элементов управления ASP.NET Web включают свойства, связанные с URL-адрес: у элемента управления HyperLink `NavigateUrl` свойство; изображения элемента управления есть `ImageUrl` свойство; и т. д. При подготовке к просмотру, эти элементы управления передать значения свойств, связанных с URL-адрес для `ResolveClientUrl`. Следовательно Если эти свойства содержат `~` URL-адрес для указания корневого веб-приложения, будут изменены в допустимый относительный URL-адрес.

Имейте в виду, что только элементы управления сервера ASP.NET преобразования `~` в своих свойствах, связанных с URL-адрес. Если `~` отображается в статических HTML-разметка, таких как `<img src="~/Images/PoweredByASPNET.gif" />`, механизм ASP.NET отправляет `~` в браузер вместе с остальными HTML-содержимого. Предполагается, что браузер `~` является частью URL-адрес. Например, если браузер получает разметку `<img src="~/Images/PoweredByASPNET.gif" />` предполагает на вложенную папку с именем `~` создать вложенную папку `Images` , содержащий файл изображения `PoweredByASPNET.gif`.

Устранение разметки изображения в `Site.master`, замените существующий `<img>` элемента с помощью элемента управления ASP.NET изображения. Задать изображение веб-элемента управления `ID` для `PoweredByImage`, ее `ImageUrl` свойства `~/Images/PoweredByASPNET.gif`и его `AlternateText` свойства «На базе технологий ASP.NET!»


[!code-aspx[Main](urls-in-master-pages-vb/samples/sample5.aspx)]

После этого изменения на главную страницу, повторное использование `~/Admin/Default.aspx` страницу еще раз. Это время `PoweredByASPNET.gif` файл изображения отображается на странице (см. рис. 3). Когда изображение веб-элемент управления отображал использует `ResolveClientUrl` метод, чтобы разрешить его `ImageUrl` значение свойства. В `~/Admin/Default.aspx` `ImageUrl` преобразуется в соответствующий относительный URL-адрес, как в следующем примере показан исходный HTML:


[!code-html[Main](urls-in-master-pages-vb/samples/sample6.html)]

> [!NOTE]
> Помимо использования в URL-адрес веб-свойства элемента управления, `~` может также использоваться при вызове `Response.Redirect` и `Server.MapPath` методы среди других. Кроме того `ResolveClientUrl` ; см. метод нельзя вызвать напрямую из ASP.NET или декларативная разметка главной страницы, при необходимости [Фриц режим](https://www.pluralsight.com/blogs/fritz/)в записи блога [использование `ResolveClientUrl` в разметке](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx).


## <a name="fixing-the-master-pages-remaining-relative-urls"></a>Исправления на главной странице оставшихся относительные URL-адреса

В дополнение к `<img>` элемент в `footerContent` главной страницы содержит один более относительный URL-адрес, требующий поступившими, были устранены. `topContent` Область включает ссылку «Master страниц учебники,» указывающая на `Default.aspx`.


[!code-html[Main](urls-in-master-pages-vb/samples/sample7.html)]

Так как этот URL-адрес является относительным, он отправляет пользователю `Default.aspx` страницы в папке содержимого просматриваемой страницы. Чтобы эта ссылка всегда указывать `Default.aspx` в корневой папке, нужно заменить `<a>` управления элемент с веб-гиперссылку, чтобы мы могли использовать `~` нотации.

Удалить `<a>` элемент разметки и вместо него элемент управления гиперссылки. Установить по гиперссылке `ID` для `lnkHome`, ее `NavigateUrl` свойства `~/Default.aspx`и его `Text` значение «Master учебники страниц».


[!code-aspx[Main](urls-in-master-pages-vb/samples/sample8.aspx)]

Вот и все! На этом этапе все, что URL-адреса в нашей главной страницы правильно на основе при отрисовке страницы содержимого, независимо от того, какие папки главной страницы и страницы содержимого, находятся в.

### <a name="automatic-url-resolution-in-theheadsection"></a>URL-адреса автоматического разрешения в`<head>`раздела

В [ *Создание сайта макета с помощью главных страниц* ](creating-a-site-wide-layout-using-master-pages-vb.md) учебника мы добавили `<link>` для `Styles.css` файла в `<head>` области:


[!code-aspx[Main](urls-in-master-pages-vb/samples/sample9.aspx)]

Хотя `<link>` элемента `href` атрибута является относительным, он автоматически преобразуется в правильный путь во время выполнения. Как уже говорилось в [ *указанием заголовка, мета-теги и другие заголовки HTML на главной странице* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) учебнике `<head>` область является фактически серверный элемент управления, позволяющий выполнить изменение содержимое его внутренние элементы управления при его отрисовке.

Чтобы проверить это, повторное использование `~/Admin/Default.aspx` и просмотреть исходный код HTML, отправляемого в браузер. Как показано в приведенном ниже фрагменте кода, `<link>` элемента `href` атрибут был изменен соответствующий относительный URL-адрес, автоматически `../Styles.css`.


[!code-html[Main](urls-in-master-pages-vb/samples/sample10.html)]

## <a name="summary"></a>Сводка

Главные страницы очень часто включают ссылки, изображения и других внешних ресурсах, которые необходимо указать его URL-адрес. Поскольку главная страница и страницы содержимого может не существовать в той же папке, важно abstain использовать относительные URL-адреса. Хотя существует возможность использовать жестко заданный абсолютный URL-адреса, выполнив так сильно связывает абсолютный URL-адрес веб-приложения. Если изменяется абсолютный URL-адрес - как часто происходит при перемещении или развертывание веб-приложения — вам придется не забудьте вернуться назад и изменить абсолютный URL-адреса.

Идеальный подход заключается в использовании тильда (`~`) чтобы указать корневой каталог приложения. Сопоставьте ASP.NET веб-элементов управления, которые содержат свойства, связанные с URL-адрес `~` к корневому каталогу приложения во время выполнения. Внутренне использовать веб-элементы управления `Control` класса `ResolveClientUrl` методе, чтобы создать допустимый относительный URL-адрес. Этот метод является открытым и доступные из каждого серверного элемента управления (включая `Page` класса), поэтому можно использовать его программным образом из классов кода, при необходимости.

Программирование довольны!

### <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения по темам, рассматриваемые в этом учебнике см. в следующих ресурсах:

- [Главные страницы в ASP.NET](http://www.odetocode.com/Articles/419.aspx)
- [URL-адрес преобразоваться в главной страницы](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/masterpages/default.aspx#urls)
- [С помощью `ResolveClientUrl` в разметке](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx)

### <a name="about-the-author"></a>Об авторе

[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор по ASP/ASP.NET и основатель 4GuysFromRolla.com, работает с веб-технологиями Майкрософт с 1998 года. Скотт — независимый консультант, trainer и записи. Его последняя книга — [ *диспетчерами учат самостоятельно ASP.NET 3.5 в течение 24 часов*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco). Скотт может быть достигнута по [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com) или через его блог по [ http://ScottOnWriting.NET ](http://scottonwriting.net/).

### <a name="special-thanks-to"></a>Благодарности

Объясняются моих последующих статей для MSDN? Если Да, напишите мне по [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com).

> [!div class="step-by-step"]
> [Назад](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md)
> [Вперед](control-id-naming-in-content-pages-vb.md)
