---
uid: web-forms/overview/older-versions-getting-started/master-pages/creating-a-site-wide-layout-using-master-pages-vb
title: "Создание структуры сайта с помощью главных страниц (Visual Basic) | Документы Microsoft"
author: rick-anderson
description: "Этот учебник покажет основы главной страницы. А именно, каковы главные страницы, как работает один Создание главной страницы, каковы содержимого заполнителями, как работает один cr..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/21/2008
ms.topic: article
ms.assetid: 30945276-8ed9-4b27-8e50-4309244d3559
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/creating-a-site-wide-layout-using-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 69f73085198c79c01988aab9e63f3ce9e7647034
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="creating-a-site-wide-layout-using-master-pages-vb"></a>Создание структуры сайта с помощью главных страниц (Visual Basic)
====================
по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Загрузить код](http://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_01_VB.zip) или [скачать PDF](http://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_01_VB.pdf)

> Этот учебник покажет основы главной страницы. А именно, каковы главные страницы, как один создать главной страницы, каковы содержимого заполнителями как один создает страницу ASP.NET, которая использует главной страницы, как изменение главной страницы автоматически отражаются на связанные содержимого страницы и т. д.


## <a name="introduction"></a>Вступление

Один атрибут хорошо спроектированной веб-сайта — согласованного сайта макета страницы. Возьмем www.asp.net веб-сайта, например. На момент написания этой статьи каждая страница имеет то же содержимое в верхней и нижней части страницы. Как показано на рис. 1, в самой верхней части каждой страницы отображается серую линию со списком сообщества Майкрософт. Под, то есть логотипа веб-узла, список языков, в которые переведены сайта и основных разделов: Домашняя, приступить к работе, Дополнительные сведения, загрузки и т. д. Аналогичным образом нижней части страницы включает сведения о рекламе в www.asp.net заявление об авторских правах и ссылку на заявление о конфиденциальности.


[![Www.asp.net веб-сайт использует согласованного внешнего вида и поведения на всех страницах](creating-a-site-wide-layout-using-master-pages-vb/_static/image2.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image1.png)

**На рисунке 01**: www.asp.net веб-сайт использует согласованные поиска и чувствовать себя через все страницы ([Просмотр полноразмерное изображение](creating-a-site-wide-layout-using-master-pages-vb/_static/image3.png))


Другой атрибут хорошо спроектированной узла заключается в простоте, с помощью которого можно изменить внешний вид веб-узла. На домашней странице www.asp.net марта 2008 г представлена на рисунке 1, но между текущей датой и публикации этого учебника, могло измениться внешний вид. Возможно пунктов меню в верхней расширяться и включать новый раздел для MVC. Или может быть радикально обновленной различные цвета, шрифты и макет будет узнали о нем. Применение таких изменений для всего сайта должно быть быстрой и простой процесс, который не требует изменения для тысяч веб-страницы, входящие в состав сайта.

Создание шаблона для всех страниц в ASP.NET возможности использования *главные страницы*. По сути, главной страницы — это специальный тип страницы ASP.NET, который определяет разметку, являются общими для всех *содержимого страницы* а также области, которые можно настраивать на основе страницы содержимого, содержимого страницы. (Страница содержимого является страницей ASP.NET, привязанная к главной страницы). При каждом изменении макета главной страницы или форматирования все выходные данные его содержимого страницы аналогично немедленно обновляется, что делает применение изменения внешнего вида всего веб-узла, так же легко, как обновление и развертывание одного файла (а именно, главной страницы).

Это в первом учебнике серию учебников, в которых рассматривается использование главных страниц. В ходе этого учебника серии мы:

- Изучите создание главных страниц и их связанные содержимого страницы
- Рассматриваются различные советы, рекомендации и ловушек,
- Определить типичные проблемы главной страницы и изучить возможные варианты решения
- Как получить доступ к главной страницы из страницы содержимого и a наоборот, в разделе
- Узнайте, как указать страницу содержимого главной страницы во время выполнения, и
- Другие дополнительные разделы главной страницы.

Эти учебники предназначены для краткого и содержат пошаговые инструкции с множеством снимков экранов, дающих процесс визуально. В каждом учебнике доступен в C# и Visual Basic версии и загрузить полный код, используемый.

Этот учебник первых начинается с рассмотрим основы главной страницы. Мы рассматриваются как функционируют главные страницы, рассмотрим создание главной страницы и связанные страницы содержимого, с помощью Visual Web Developer и разделе как главной страницы изменения немедленно отражаются в его страниц. Давайте начнем!

## <a name="understanding-how-master-pages-work"></a>Основные сведения о том, как функционируют главные страницы

Создание веб-сайт с макетом согласованность всех страниц требует что каждой веб-страницы создавать общие форматирования разметки в дополнение к его настраиваемое содержимое. Например, каждого учебника или форум post на www.asp.net, имеют собственные уникальные материалы, каждая из этих страниц также отрисовки ряд общих `<div>` элементов, отображающих связи разделов верхнего уровня: Домашняя, приступить к работе, Дополнительные сведения и т. д.

Существуют различные методы для создания веб-страниц с помощью единого интерфейса. — Это упрощенный подход просто скопировать и вставить общие макета разметки в все веб-страницы, но такой подход имеет несколько недостатков. Во-первых всякий раз при создании новой страницы необходимо скопировать и вставить общего содержимого на страницу. Такие скопировав и вставив операций, богатыми возможностями ошибки может случайно скопировать только подмножество общих разметки в новую страницу. И к началу страницы, такой подход делает замены существующего сайта внешний новый реальную боль, так как для использования нового интерфейса должны изменяться каждый одной страницы на сайте.

До ASP.NET версии 2.0, страница разработчики часто помещают общие разметки в [пользовательские элементы управления](https://msdn.microsoft.com/en-us/library/y6wb1a0e.aspx) и затем добавить эти пользовательские элементы управления для каждой страницы. Этот подход необходим разработчик помните, что необходимо вручную добавить пользовательские элементы управления для каждой страницы, что разрешено для изменения проще всего сайта, так как при обновлении общих разметки только пользовательские элементы управления необходимо изменить. К сожалению Visual Studio .NET 2002 и 2003 - версии Visual Studio используется для создания приложений ASP.NET 1.x - отображается пользовательских элементов управления в режиме конструктора в виде серых блоков. Следовательно при таком подходе разработчики страниц не понравилось WYSIWYG среды разработки.

Недостатки использования пользовательских элементов управления были учтены в ASP.NET версии 2.0 и Visual Studio 2005 с появлением *главные страницы*. Главная страница — это специальный тип страницы ASP.NET, определяющий разметку-узла и *областей* там, где связанные *содержимого страницы* определить их пользовательской разметки. Как будет показано в шаге 1, эти регионы определяются ContentPlaceHolder элементов управления. Элемент управления ContentPlaceHolder просто указывает позицию в иерархии элементов управления на главной странице, где пользовательского содержимого могут быть добавлены со страницей содержимого.

> [!NOTE]
> Основные понятия и функциональные возможности главных страниц не был изменен после ASP.NET версии 2.0. Однако Visual Studio 2008 предлагает поддержку времени разработки для вложенные главные страницы, функцию, которая отсутствовавшая в Visual Studio 2005. Мы рассмотрим использование вложенные главные страницы в будущем учебника.


На рисунке 2 показано, как будет выглядеть на главную страницу для www.asp.net. Обратите внимание, что главная страница определяет общий макет сайта - разметки в верхней, нижней и правой части каждой страницы - а также ContentPlaceHolder в середине левом углу, где находится содержимое, уникальный для каждого отдельного веб-страницы.


![Главная страница определяет макет сайта и редактируемые области на основе содержимого содержимое страницы, страницы](creating-a-site-wide-layout-using-master-pages-vb/_static/image4.png)

**На рисунке 02**: главная страница определяет макет сайта и редактируемые области на основе содержимого содержимое страницы, страницы


После определения главной страницы его можно привязать к новой страницы ASP.NET через деления флажок. Эти страницы ASP.NET - вызывается страницами содержимого - включать элемент управления содержимым для каждого из элементов управления ContentPlaceHolder на главной странице. При посещении страницы содержимого с помощью браузера подсистема ASP.NET создает иерархию элементов управления главной страницы и внедряет иерархии элементов управления страницы содержимого в соответствующих местах. Эта иерархия объединенный элемент управления подготавливается к просмотру и результирующий HTML возвращается браузер пользователя. Следовательно страницы содержимого выдает общих разметки, определенные в его главной странице за пределами ContentPlaceHolder элементы управления и разметку страницы, определенные в свои собственные элементы управления содержимым. Этот принцип показан на рис. 3.


[![Разметка страницы запрошенный совмещенного в главной страницы](creating-a-site-wide-layout-using-master-pages-vb/_static/image6.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image5.png)

**На рисунке 03**: запрошенный разметку страницы совмещенного в главной страницы ([Просмотр полноразмерное изображение](creating-a-site-wide-layout-using-master-pages-vb/_static/image7.png))


Теперь, когда мы обсуждали как функционируют главные страницы, давайте рассмотрим создание главной страницы и связанные страницы содержимого, с помощью Visual Web Developer.

> [!NOTE]
> Для достижения наиболее широкой аудитории, мы создаем на протяжении этого учебника ряда веб-сайта ASP.NET будет создан с помощью ASP.NET 3.5 с корпорации Майкрософт бесплатную версию Visual Studio 2008 [Visual Web Developer 2008](https://www.microsoft.com/express/vwd/). Если вы еще не обновлены до ASP.NET 3.5, не беспокойтесь - концепции, описанные в этих учебниках рабочих одинаково с ASP.NET 2.0 и Visual Studio 2005. Тем не менее некоторые демонстрация приложения могут использовать новые возможности .NET Framework версии 3.5; При использовании функции 3.5 включать заметку, которая описывает, как реализовать аналогичные функциональные возможности в версии 2.0. Имейте в виду, демонстрационных приложений, доступных для загрузки из учебника целевые объекты .NET Framework версии 3.5, что приводит к `Web.config` файл, который содержит элементы конфигурации, относящиеся к 3.5. Короче говоря, если у вас еще установка .NET 3.5 на компьютере, затем загружаемая веб-приложение не будет работать без предварительного удаления 3.5 разметку из `Web.config`. В разделе [разбор ASP.NET версии 3.5 `Web.config` файл](http://www.4guysfromrolla.com/articles/121207-1.aspx) Дополнительные сведения по этой теме.


## <a name="step-1-creating-a-master-page"></a>Шаг 1: Создание главной страницы

Прежде чем мы можем рассмотреть создание и использование страницах, необходимо сначала на веб-сайте ASP.NET. Начните с создания нового файла на основе системы веб-узла ASP.NET. Для этого запустите Visual Web Developer и затем перейдите в меню «файл» и выберите новый веб-сайт, отображение диалогового окна нового веб-сайта (см. рис. 4). Выберите шаблон веб-сайт ASP.NET, указывает расположение раскрывающегося списка в файловой системе, выберите папку для размещения веб-сайта и выбранный язык Visual Basic. Это создаст новый веб-сайт с `Default.aspx` страницы ASP.NET, `App_Data` папки и `Web.config` файла.

> [!NOTE]
> Visual Studio поддерживает два режима управления проектом: проекты веб-сайтов и проектов веб-приложений. Проектов веб-сайтов отсутствует в файле проекта, тогда как проекты веб-приложений имитировать архитектуру проекта в Visual Studio .NET 2002/2003 — они включают файл проекта и компиляции исходного кода проекта в единую сборку, которая размещается в `/bin` папка. Проекты Visual Studio 2005 изначально только поддерживаемые веб-сайта, несмотря на то, что модель проекта веб-приложения был снова с пакетом обновления 1; Visual Studio 2008 предлагает обе модели проекта. Visual Web Developer 2005 и 2008 выпусков, однако поддерживают только проекты веб-сайтов. Я использую модели проекта веб-сайта для свои примеры в этой серии учебника. Если вы используете отличных от Express edition и хотите использовать [модель проекта веб-приложения](https://msdn.microsoft.com/en-us/library/aa730880(vs.80).aspx) вместо этого вы можете сделать это, но имейте в виду, что может быть некоторые несоответствия между отображаемые на экране и действия, которые необходимо выполнить сравнение показано снимки экрана и инструкции, приведенные в этих учебниках.


[![Создать новый файл на основе системы веб-сайта](creating-a-site-wide-layout-using-master-pages-vb/_static/image9.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image8.png)

**Рисунок 04**: Создание веб-сайта New File System-Based ([Просмотр полноразмерное изображение](creating-a-site-wide-layout-using-master-pages-vb/_static/image10.png))


Добавьте главной страницы сайта в корневую папку, щелкните правой кнопкой мыши имя проекта и добавить новый элемент и выбрав шаблон главной страницы. Обратите внимание, что главные страницы заканчиваться расширением `.master`. Имя этой новой главной страницы `Site.master` и нажмите кнопку Добавить.


[![Добавить главную страницу Site.master на веб-сайт с именем](creating-a-site-wide-layout-using-master-pages-vb/_static/image12.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image11.png)

**Рисунок 05**: Добавление страницы Master именованных `Site.master` на веб-сайт ([Просмотр полноразмерное изображение](creating-a-site-wide-layout-using-master-pages-vb/_static/image13.png))


Добавление нового файла главной страницы через Visual Web Developer создает главную страницу следующей декларативной разметкой:

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample1.aspx)]

Первая строка в декларативная разметка [ `@Master` директивы](https://msdn.microsoft.com/en-us/library/ms228176.aspx). `@Master` Аналогична директиве [ `@Page` директивы](https://msdn.microsoft.com/en-us/library/ydy4x04a.aspx) , которая отображается на страницах ASP.NET. Он определяет язык на стороне сервера (Visual Basic) и сведения о расположении и наследования класса кода программной части главной страницы.

`DOCTYPE` И декларативная разметка страницы отображается под `@Master` директивы. На этой странице доступны статическим HTML вместе с четырьмя серверных элементов управления:

- **Веб-формы ( `<form runat="server">`)** — так как все страницы ASP.NET обычно имеют веб-формы - и так, как Главная страница может включать веб-элементов управления, которые должны находиться в пределах веб-формы - следует добавить веб-формы на главной странице (вместо добавления веб-формы для вставки образом страницы содержимого).
- **Элемент управления ContentPlaceHolder `ContentPlaceHolder1`**  -ContentPlaceHolder элемент управления отображается в веб-формы и служит в качестве области для содержимого страницы пользовательского интерфейса.
- **На стороне сервера `<head>` элемент** - `<head>` элемент имеет `runat="server"` атрибут доступности через серверный код. `<head>` Элемент реализуется таким образом, чтобы заголовок страницы и другие `<head>`-, связанных с разметки может добавить или изменить программным способом. Например, установка страницы ASP.NET `Title` изменения свойств `<title>` элемент подготавливается к просмотру модулем `<head>` серверного элемента управления.
- **Элемент управления ContentPlaceHolder `head`**  -ContentPlaceHolder элемент управления отображается в `<head>` сервера управления и может использоваться декларативно добавлять содержимое в `<head>` элемент.

Это декларативная разметка главной страницы по умолчанию служит в качестве отправной точки для проектирования главных страниц. Вы можете изменить код HTML или добавление дополнительных веб-элементы управления или ContentPlaceHolders на главную страницу.

> [!NOTE]
> При проектировании главной странице убедитесь, что главная страница содержит веб-формы и, по крайней мере один элемент управления ContentPlaceHolder отображается в этой веб-формы.


### <a name="creating-a-simple-site-layout"></a>Создание простого узла структуры

Давайте разверните `Site.master`элемента по умолчанию декларативная разметка для создания макета сайта, где все страницы имеют: общие заголовок; в левом столбце навигации, новости и другое содержимое всего сайта; и нижнего колонтитула, отображает значок «На платформе с Microsoft ASP.NET». Рис. 6 показан результат главной страницы, при просмотре одного из его страниц с помощью браузера. Относится только к просматриваемую страницу области красным кружке на рис. 6 (`Default.aspx`); другое содержимое определены в главной страницы и поэтому согласованность на всех страницах содержимого.


[![Главная страница определяет разметку для слева, верхней и нижней части](creating-a-site-wide-layout-using-master-pages-vb/_static/image15.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image14.png)

**На рисунке 06**: главная страница определяет разметку для слева, верхней и нижней части ([Просмотр полноразмерное изображение](creating-a-site-wide-layout-using-master-pages-vb/_static/image16.png))


Для получения узла макета, показанные на рис. 6, начните с обновления `Site.master` главную страницу, чтобы он содержал следующий декларативная разметка:

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample2.aspx)]

Макет главной страницы определяется с помощью ряда `<div>` HTML-элементов. `topContent` `<div>` Содержит разметку, которая отображается в верхней части каждой страницы, хотя `mainContent`, `leftContent`, и `footerContent` `<div>` s используются для отображения содержимого страницы, левом столбце и «на платформе с Майкрософт Значок ASP.NET» соответственно. Помимо добавления этих `<div>` элементов, также переименовал `ID` свойство основным элементом управления ContentPlaceHolder из `ContentPlaceHolder1` для `MainContent`.

Правила форматирования и макета для них различные `<div>` элементы выраженная в [каскадной таблицы стилей (CSS)](http://en.wikipedia.org/wiki/Cascading_Style_Sheets) файл `Styles.css`, которой указываются с помощью `<link>` элемент на главной странице `<head>`элемент. Эти различные правила определяют внешний вид каждого `<div>` элемента указано выше. Например `topContent` `<div>` элемент, который отображает текст «Учебники Master страниц» и ссылка, имеет правилах форматирования, указанные в `Styles.css` следующим образом:

[!code-css[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample3.css)]

Если вы следуете на компьютере, необходимо будет загрузить сопутствующий код этого учебника и добавить `Styles.css` файл в проект. Аналогичным образом, также необходимо будет создать папку с именем `Images` и скопировать значок «На платформе с Microsoft ASP.NET» с демонстрационной загруженного веб-сайта в проект.

> [!NOTE]
> Обсуждение CSS и форматирования веб-страница выходит за рамки данной статьи. Дополнительные сведения о CSS извлечь [учебники CSS](http://www.w3schools.com/css/default.asp) в [W3Schools.com](http://www.w3schools.com/). Я также рекомендую загрузить сопутствующий код этого учебника и работать с параметры CSS в `Styles.css` чтобы увидеть влияние различных правил форматирования.


### <a name="creating-a-master-page-using-an-existing-design-template"></a>Создание с помощью существующего шаблона конструирования главной страницы

С годами создали несколько веб-приложений ASP.NET для малых средних компаний. Некоторые клиентские компьютеры были существующий макет сайта, они хотели использовать; другие наняли конструктор надлежащей графики. Некоторые уровню мне создать макет веб-сайта. Как можно видеть на рисунке 6, управление задачами программисту макет веб-сайта обычно статистику, как ваш бухгалтер выполнять open-heart surgery, а ваш doctor налогов.

К счастью существует innumerous веб-сайты, которые предлагают бесплатные шаблоны проектирования HTML — Google вернул более шести миллионов результатов поиска термина «шаблоны бесплатные веб-сайта». Мои любимые из них она [OpenDesigns.org](http://opendesigns.org/). После нахождения шаблона веб-сайта, но следует добавить файлов CSS и изображений в проект веб-сайта и интегрировать шаблона HTML на главную страницу.

> [!NOTE]
> Корпорация Майкрософт также предлагает ряд [освободить ASP.NET запустить набор шаблонов](https://msdn.microsoft.com/en-us/asp.net/aa336613.aspx) , интегрировать в диалоговом окне нового веб-сайта в Visual Studio.


## <a name="step-2-creating-associated-content-pages"></a>Шаг 2: Создание связанного содержимого страницы

С главной страницы создан мы готовы приступить к созданию страницы ASP.NET, привязанные к главной страницы. Такие страницы называются *содержимого страницы*.

Давайте добавьте новую страницу ASP.NET в проект и привяжите его к `Site.master` главной страницы. Щелкните правой кнопкой мыши имя проекта в обозревателе решений и выберите Добавить новый элемент. Выберите шаблон веб-формы, введите имя `About.aspx`и установите флажок «Выбрать главную страницу», как показано на рис. 7. При этом отображается Select главной страницы диалоговое окно поле (см. рис. 8), в котором можно выбрать главную страницу для использования.

> [!NOTE]
> Если вы создали веб-сайта ASP.NET, с помощью модели проекта веб-приложения, вместо модели проекта веб-сайта не появится флажок «Выбрать главную страницу» в диалоговом окне Добавление нового элемента, показанный на рисунке 7. Для создания содержимого страницы, когда проект веб-приложения с помощью модели вы необходимо выбрать шаблон веб-содержимого формы вместо шаблона веб-форму. После выбора шаблона веб-содержимого формы и нажмите кнопку Добавить, то выберите главной страницы, появится диалоговое окно показано на рисунке 8.


[![Добавление новой страницы содержимого](creating-a-site-wide-layout-using-master-pages-vb/_static/image18.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image17.png)

**На рисунке 07**: Добавление новой страницы содержимого ([Просмотр полноразмерное изображение](creating-a-site-wide-layout-using-master-pages-vb/_static/image19.png))


[![Выберите Site.master главной страницы](creating-a-site-wide-layout-using-master-pages-vb/_static/image21.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image20.png)

**На рисунке 08**: выберите `Site.master` главной страницы ([Просмотр полноразмерное изображение](creating-a-site-wide-layout-using-master-pages-vb/_static/image22.png))


Как показано на следующем декларативная разметка, новая страница содержимого содержит `@Page` директивы, что указывает обратно его шаблон страницы и управления содержимым для каждого из элементов управления ContentPlaceHolder на главной странице.

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample4.aspx)]

> [!NOTE]
> В разделе «Создание простая структура узла» в шаге 1 переименован `ContentPlaceHolder1` для `MainContent`. Если вы не переименовали управления ContentPlaceHolder `ID` таким же образом декларативная разметка страницы содержимого будут немного отличаться от разметки, показанном выше. А именно, второй содержимого элемента управления `ContentPlaceHolderID` отразят `ID` соответствующего ContentPlaceHolder управления на главной странице.


При подготовке к просмотру страницу содержимого, подсистема ASP.NET необходимо объединять страницы содержимого элементов управления с элементами управления ContentPlaceHolder главной страницы. Обработчик ASP.NET определяет страницы содержимого главной страницы `@Page` директивы `MasterPageFile` атрибута. Как показано выше разметки, привязанного к этой странице содержимого `~/Site.master`.

Поскольку главная страница имеет два элемента управления ContentPlaceHolder - `head` и `MainContent` -Visual Web Developer создается двух элементов управления содержимым. Каждый элемент управления содержимым, ссылается на определенный ContentPlaceHolder через его `ContentPlaceHolderID` свойство.

Где блеска главных страниц за предыдущие способы шаблона сайта — с их поддержку во время разработки. Рис. 9 показана `About.aspx` страницы содержимого, при просмотре через представление конструктора Visual Web Developer. Обратите внимание, что пока отображается содержимое главной страницы, он отображается серым и не может быть изменено. Элементы управления содержимым, соответствующий ContentPlaceHolders главной страницы будут, тем не менее, для редактирования. А так же, как с любой другой страницы ASP.NET, можно создать интерфейс страницы содержимого, добавив веб-элементы управления через представления источника или конструктора.


[![Страница содержимого режим конструктора отображает содержимое постранично, главной страницы](creating-a-site-wide-layout-using-master-pages-vb/_static/image24.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image23.png)

**На рисунке 09**: содержимого страницы конструктора представление отображает как определенной страницы и содержимое страницы Master ([Просмотр полноразмерное изображение](creating-a-site-wide-layout-using-master-pages-vb/_static/image25.png))


### <a name="adding-markup-and-web-controls-to-the-content-page"></a>Добавление разметки и веб-элементы управления на страницу содержимого

Теперь пора создать часть содержимого для `About.aspx` страницы. Как видно на рис. 10, введенный с заголовком «О автор» и несколько абзацев текста, но можно добавить веб-элементов управления, слишком. После создания этот интерфейс, посетите `About.aspx` страницу в обозревателе.


[![Перейдите на страницу About.aspx через браузер](creating-a-site-wide-layout-using-master-pages-vb/_static/image27.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image26.png)

**Рис. 10**: посетите `About.aspx` страницы через браузер ([Просмотр полноразмерное изображение](creating-a-site-wide-layout-using-master-pages-vb/_static/image28.png))


Важно понимать, что запрашиваемая страница содержимого и связанные с ней главной страницы совмещенного и подготовке к просмотру в целом полностью на веб-сервере. Браузер пользователя отправляется полученный, плавким HTML. Чтобы проверить это, просмотр HTML, полученных с помощью браузера, перейдите в меню «Вид» и выбрав источник. Обратите внимание, что нет кадров или другие специальные методы для отображения двух разных веб-страниц в одном окне.

### <a name="binding-a-master-page-to-an-existing-aspnet-page"></a>Привязка к существующую страницу ASP.NET главной страницы

Как было показано на этом шаге, добавление новой страницы содержимого к веб-приложению ASP.NET просто установив флажок «Выбрать главную страницу» и выбора главной страницы. К сожалению преобразование существующую страницу ASP.NET в главной страницы не так просто.

Для привязки к существующей страницы ASP.NET главной страницы необходимо выполнить следующие действия:

1. Добавить `MasterPageFile` для страницы ASP.NET атрибута `@Page` директивы, указывающий его соответствующей главной страницы.
2. Добавление элементов управления содержимым для каждого ContentPlaceHolders на главной странице.
3. Выборочно Вырезать и вставить страницу ASP.NET существующее содержимое в соответствующие элементы управления содержимым. Я говорю «выборочно» здесь так, как страница ASP.NET, скорее всего содержит разметку, которая уже выражается с главной страницы, такие как `DOCTYPE`, `<html>` элемент и веб-формы.

Пошаговые инструкции по этому процессу, а также снимков экрана извлечь [Скотт Гатри](https://weblogs.asp.net/scottgu/) [с помощью главных страниц и переходов](http://webproject.scottgu.com/VisualBasic/MasterPages/MasterPages.aspx) учебника. «Обновление `Default.aspx` и `DataSample.aspx` использовать главную страницу «разделе подробно описаны следующие действия.

Поскольку это гораздо проще создавать новые страницы содержимого, чем для преобразования существующих страниц ASP.NET в страницы содержимого, рекомендуется, каждый раз при создании нового веб-сайта ASP.NET добавить главной страницы сайта. Привязка всех новых страниц ASP.NET для этой главной страницы. Не беспокойтесь, если начальный Главная страница является очень простой или простой; можно обновить позднее главной страницы.

> [!NOTE]
> При создании нового приложения ASP.NET, Visual Web Developer добавляет `Default.aspx` страницы, не привязанный к главной страницы. Если вы хотите практике преобразования существующую страницу ASP.NET в страницы содержимого, действуйте и сделать это с `Default.aspx`. Кроме того, можно удалить `Default.aspx` и затем снова добавьте его, но на этот раз, установив флажок «Выбрать главную страницу».


## <a name="step-3-updating-the-master-pages-markup"></a>Шаг 3: Обновление разметки главной страницы

Одно из основных преимуществ главные страницы —, что одна главная страница может использоваться для определения всей разметки для различных страниц на сайте. Таким образом при обновлении внешний вид и поведение сайта требуется обновить один файл - главной страницы.

Для иллюстрации этого поведения, давайте обновить нашей главной страницы, чтобы включить текущую дату в верхней части левой. Добавить метку с именем `DateDisplay` для `leftContent` `<div>`.

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample5.aspx)]

Создайте `Page_Load` обработчик событий для базы данных master и добавьте следующий код:

[!code-vb[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample6.vb)]

Этот код задает метку `Text` свойство текущую дату и время в формате день недели, название месяца и двузначным днем (см. рис. 11). Благодаря этому изменению повторное использование содержимого страницы. Как показано на рис. 11, разметка немедленно обновляется с учетом изменений в главную страницу.


[![Изменения на главную страницу будут отражены при просмотре страницы содержимого](creating-a-site-wide-layout-using-master-pages-vb/_static/image30.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image29.png)

**Рис. 11**: изменения на главную страницу будут отражены при просмотре страницы содержимого ([Просмотр полноразмерное изображение](creating-a-site-wide-layout-using-master-pages-vb/_static/image31.png))


> [!NOTE]
> Как показано в этом примере, главные страницы может содержать серверные веб-элементы управления, код и обработчики событий.


## <a name="summary"></a>Сводка

Главные страницы позволяют разработчикам ASP.NET для создания согласованного макета-узла, который легко обновляется. Создание главных страниц и связанных страниц содержимого является просто создать стандартные страницы ASP.NET, как Visual Web Developer предлагает широкие возможности поддержки во время разработки.

В примере главной страницы, созданные в этом учебнике было двух ContentPlaceHolder элементов управления, head и тегу. Мы указан только разметки для элемента управления ContentPlaceHolder тегу в нашу страницу содержимого, однако. В следующем уроке мы рассмотрим несколько содержимого с помощью элементов управления на странице содержимого. Также показано, как определить по умолчанию разметки для содержимого элементов управления на главной странице, также как определение для переключения между использования значения по умолчанию разметки на главной страницы, а также предоставлять пользовательской разметки на странице содержимого.

Программирование довольны!

### <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения по темам, рассматриваемые в этом учебнике см. в следующих ресурсах:

- [ASP.NET для конструкторов: освободить шаблоны и рекомендации по разработке веб-сайтов ASP.NET с помощью веб-стандартам](https://msdn.microsoft.com/en-us/asp.net/aa336602.aspx)
- [Страницах](https://msdn.microsoft.com/en-us/library/wtxbf3hh.aspx)
- [Учебники каскадных таблиц стилей (CSS)](http://www.w3schools.com/css/default.asp)
- [Динамическое задание заголовка страницы](http://aspnet.4guysfromrolla.com/articles/051006-1.aspx)
- [Главные страницы в ASP.NET](http://www.odetocode.com/articles/419.aspx)
- [Главные страницы статьи краткого руководства](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/masterpages/default.aspx)

### <a name="about-the-author"></a>Об авторе

[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор по ASP/ASP.NET и основатель 4GuysFromRolla.com, работает с веб-технологиями Майкрософт с 1998 года. Скотт — независимый консультант, trainer и записи. Его последняя книга — [ *диспетчерами учат самостоятельно ASP.NET 3.5 в течение 24 часов*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco). Скотт может быть достигнута по [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com) или через его блог по [http://ScottOnWriting.NET](http://scottonwriting.net/).

### <a name="special-thanks-to"></a>Благодарности

Объясняются моих последующих статей для MSDN? Если Да, напишите мне по [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com).

>[!div class="step-by-step"]
[Назад](nested-master-pages-cs.md)
[Вперед](multiple-contentplaceholders-and-default-content-vb.md)
