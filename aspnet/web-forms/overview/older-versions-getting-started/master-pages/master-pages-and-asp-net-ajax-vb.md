---
uid: web-forms/overview/older-versions-getting-started/master-pages/master-pages-and-asp-net-ajax-vb
title: "Главные страницы и ASP.NET AJAX (VB) | Документы Microsoft"
author: rick-anderson
description: "Описывает параметры для использования ASP.NET AJAX и главных страниц. Рассматривает использование класса ScriptManagerProxy; Описывает, как различные JS-файлы загружаются dependi..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/11/2008
ms.topic: article
ms.assetid: 0ee9318c-29bb-4d58-b1dc-94e575b8ae10
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/master-pages-and-asp-net-ajax-vb
msc.type: authoredcontent
ms.openlocfilehash: b25234f82c46437d853d1ab5b240f8a688995ccc
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="master-pages-and-aspnet-ajax-vb"></a>Главные страницы и ASP.NET AJAX (Visual Basic)
====================
по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Загрузить код](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_08_VB.zip) или [скачать PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_08_VB.pdf)

> Описывает параметры для использования ASP.NET AJAX и главных страниц. Рассматривает использование класса ScriptManagerProxy; Описывает, как различные JS-файлы загружаются в зависимости от того, используется ли в базе данных Master ScriptManager страницу или страницы содержимого.


## <a name="introduction"></a>Вступление

За последние несколько лет больше разработчиков построения с поддержкой AJAX веб-приложений. Веб-сайта с поддержкой AJAX предусматривает ряд связанных веб-технологии для обеспечения отклика взаимодействие с пользователем. Создание приложения ASP.NET с поддержкой AJAX — гораздо проще благодаря инфраструктуры ASP.NET AJAX корпорации Майкрософт. Встроенное ASP.NET AJAX в ASP.NET 3.5 и Visual Studio 2008; Он также доступна как отдельный загружаемый компонент для приложений ASP.NET 2.0.

При построении веб-странице с поддержкой AJAX с помощью платформы ASP.NET AJAX, необходимо добавить точно один элемент управления ScriptManager для каждой страницы, использующей платформу. Как и предполагает его имя, которую диспетчер ScriptManager управляет клиентский сценарий, используемый в веб-страницы с поддержкой AJAX. Как минимум которую диспетчер ScriptManager выдает HTML, которая заставляет браузер, чтобы загрузить файлы JavaScript, состав клиентской библиотеки AJAX ASP.NET. Он также может использоваться для регистрации пользовательские файлы JavaScript, сценарии веб-службы и функции пользовательского приложения службы.

Если образце использует узел страницы (как должно), то не обязательно Добавление элемента управления ScriptManager для каждой из одной страницы содержимого. Вместо этого можно добавить элемент управления ScriptManager на главную страницу. Этот учебник демонстрирует добавление элемента управления ScriptManager на главную страницу. Он также рассказывается, как использовать элемент управления ScriptManagerProxy для регистрации пользовательских сценариев и служб сценариев на определенной странице содержимого.

> [!NOTE]
> Этот учебник не исследовать, разработки и построения с поддержкой AJAX веб-приложений с помощью платформы ASP.NET AJAX. См. Дополнительные сведения об использовании AJAX ASP.NET AJAX видеоролики и учебники, а также этих ресурсах, перечисленных в разделе "Дополнительные материалы" в конце этого учебника.


## <a name="examining-the-markup-emitted-by-the-scriptmanager-control"></a>Проверки разметки, генерируемой управления ScriptManager

Элемент управления ScriptManager создает разметку, которая заставляет браузер, чтобы загрузить файлы JavaScript, состав клиентской библиотеки AJAX ASP.NET. Он также добавляет бит встроенный JavaScript на страницу, который инициализирует этой библиотеки. В следующем примере показано содержимое, которое добавляется в выходных данных при отображении страницы, содержащей элемент управления ScriptManager:


[!code-html[Main](master-pages-and-asp-net-ajax-vb/samples/sample1.html)]

`<script src="url"></script>` Теги настроить браузер, чтобы загрузить и выполнить файл JavaScript в *URL-адрес*. ScriptManager создает три таких тегов; один ссылается на файл `WebResource.axd`, а два других ссылки на файл `ScriptResource.axd`. Эти файлы фактически не существуют как файлы веб-сайта. Вместо этого при получении запроса для либо один из этих файлов на веб-сервере, обработчик ASP.NET проверяет строку запроса и возвращает соответствующее содержимое JavaScript. Клиентская библиотека ASP.NET AJAX framework, составляют сценария, предоставленного эти три внешние файлы JavaScript. Другой `<script>` теги, генерируемой ScriptManager включать встроенный сценарий, который инициализирует этой библиотеки.

Ссылки на внешние скрипты и встроенный сценарий, генерируемой ScriptManager, необходимы для страницы, которая использует платформа AJAX для ASP.NET, но не требуется для страниц, которые не используют платформу. Таким образом вы причин, что это идеальный только добавление те страницы, которые используют платформу ASP.NET AJAX ScriptManager. Этого достаточно, но если имеется много страниц, использующих платформу в конечном итоге Добавление элемента управления ScriptManager ко всем страницам - повторяющиеся задачи, как минимум. Кроме того можно добавить ScriptManager главную страницу, которая затем внедряет этот необходимый сценарий в всех страниц содержимого. При таком подходе не забудьте добавить наличия ScriptManager на новую страницу, используется платформа ASP.NET AJAX, так как она уже включена, главной страницы необязательно. Шаг 1 последовательно по добавлению наличия ScriptManager на главную страницу.

> [!NOTE]
> Если вы планируете включая функций AJAX в пользовательском интерфейсе на главной странице, у вас есть нет выбора в нескольких,-ScriptManager должен включать на главной странице.


Один недостатком добавления ScriptManager главной страницы является то, что приведенный выше скрипт создается в *каждый* страница, независимо от того, нужно ли его необходимости. Четко это ведет к бесполезной пропускной способности для этих страниц, которые ScriptManager, включенных (с помощью главной страницы) еще не не используйте какие-либо функции платформы ASP.NET AJAX. Но насколько напрасно пропускной способности?

- Фактическое содержимое, генерируемой ScriptManager (как показано выше) итоговых немного превышает 1 КБ.
- Три файла внешнего скрипта ссылается `<script>` элемента, однако составляют примерно 450 КБ данных в несжатом виде; это общая пропускная способность в веб-сайта со сжатием gzip, можно сократить около 100 КБ. Тем не менее эти файлы кэшируются браузером один год, это означает, что достаточно лишь один раз загрузить и можно повторно использовать на других страницах на сайте.

В лучшем случае при кэшировании файлы скриптов Общая стоимость будет, размером 1 КБ, которой будет незначительным. В худшем случае тем не менее - это когда файлы скриптов имеют еще не был загружен и веб-сервер не использует сжатие в любой форме: попадание пропускной способности — примерно 450 КБ, который можно добавить в любом из второго и два через широкополосное подключение до 1 минуты для  пользователей через Коммутируемые модемы. Хорошо то, так как внешний скрипт файлы кэшируются браузером, Худший случай происходит редко.

> [!NOTE]
> Если вы по-прежнему не хотите поместить элемент управления ScriptManager на главной странице, рассмотрите возможность веб-формы ( `<form runat="server">` разметки на главной странице). Каждая страница ASP.NET, которая использует модель обратной передачи необходимо включить точно один веб-форму. При добавлении веб-форму добавляется дополнительное содержимое: число скрытых полей форм, `<form>` тега, и при необходимости JavaScript функциональные возможности для инициации обратной передачи из скрипта. Эта разметка не требуется для страниц, которые не обратной передачи. Эта разметка лишние удалось устраняется путем удаления веб-форма с главной страницы и вручную, добавив его в каждую страницу содержимого, которому он требуется. Тем не менее преимущества веб-формы на главной странице перевешивают ее недостатки от случая, когда он добавлен к ненужному определенные страницы содержимого.


## <a name="step-1-adding-a-scriptmanager-control-to-the-master-page"></a>Шаг 1: Добавление элемента управления ScriptManager на главную страницу

Каждый веб-страница, использующая ASP.NET AJAX framework должна содержать точно один элемент управления ScriptManager. Из-за этого требования обычно имеет смысл для размещения в одном элементе управления ScriptManager на главной странице таким образом, что все страницы содержимого, автоматически включается элемент управления ScriptManager. Кроме того которую диспетчер ScriptManager должен указываться перед любым серверных элементов управления ASP.NET AJAX, такие как элементы управления UpdatePanel и UpdateProgress. Таким образом рекомендуется поместить ScriptManager перед любыми элементами управления ContentPlaceHolder в веб-форму.

Откройте `Site.master` главную страницу и добавление элемента управления ScriptManager страницы в веб-форму, но перед `<div id="topContent">` элемент (см. рис. 1). При использовании Visual Web Developer 2008 или Visual Studio 2008, на панели инструментов на вкладке расширения AJAX расположен элемент управления ScriptManager. Если вы используете Visual Studio 2005, необходимо сначала установить платформу ASP.NET AJAX и добавьте элементы управления панели элементов. Перейдите на страницу загрузки ASP.NET AJAX для получения платформа ASP.NET 2.0.

После добавления ScriptManager на странице, изменить его `ID` из `ScriptManager1` для `MyManager`.


[![Добавить ScriptManager на главную страницу](master-pages-and-asp-net-ajax-vb/_static/image2.png)](master-pages-and-asp-net-ajax-vb/_static/image1.png)

**На рисунке 01**: Добавление ScriptManager на главную страницу ([Просмотр полноразмерное изображение](master-pages-and-asp-net-ajax-vb/_static/image3.png))


## <a name="step-2-using-the-aspnet-ajax-framework-from-a-content-page"></a>Шаг 2: С помощью платформы ASP.NET AJAX из страницы содержимого

В элементе управления ScriptManager добавлен на главную страницу теперь можно добавить функции платформы ASP.NET AJAX на любую страницу содержимого. Давайте создадим новую страницу ASP.NET, отображающий случайно выбранных продуктов из базы данных "Борей". Мы будем использовать элемент управления Timer инфраструктуры ASP.NET AJAX для обновления этого отображения каждые 15 секунд, показывающий новый продукт.

Начните с создания новой страницы в корневом каталоге с именем `ShowRandomProduct.aspx`. Не забудьте этой новой странице, чтобы привязать `Site.master` главной страницы.


[![Добавление новой страницы ASP.NET на веб-сайт](master-pages-and-asp-net-ajax-vb/_static/image5.png)](master-pages-and-asp-net-ajax-vb/_static/image4.png)

**На рисунке 02**: Добавление новой страницы ASP.NET на веб-сайт ([Просмотр полноразмерное изображение](master-pages-and-asp-net-ajax-vb/_static/image6.png))


Помните, что в задание заголовка, мета-теги и другие заголовки HTML в учебнике главной страницы [SKM1] созданную пользовательскую страницу базовый класс с именем `BasePage` , создавшей заголовок страницы, если оно не было задано явно. Последовательно выберите пункты `ShowRandomProduct.aspx` на странице кода класса и его производные от `BasePage` (вместо из `System.Web.UI.Page`).

Наконец, обновите `Web.sitemap` файл, чтобы включить запись для этого занятия. Добавьте следующую разметку под `<siteMapNode>` хозяин занятия взаимодействия содержимого страницы:


[!code-xml[Main](master-pages-and-asp-net-ajax-vb/samples/sample2.xml)]

Добавление этого `<siteMapNode>` элемент отражается на занятиях списком (см. рис. 5).

### <a name="displaying-a-randomly-selected-product"></a>Отображение случайно выбранного продукта

Вернитесь к `ShowRandomProduct.aspx`. В режиме конструктора перетащите элемент управления UpdatePanel из области элементов в `MainContent` элемент управления содержимым и задайте его `ID` свойства `ProductPanel`. UpdatePanel представляет область на экране, можно асинхронно обновить с помощью частичной обратную передачу.

Наш первой задачей является отображение сведений о случайно выбранных продуктов в UpdatePanel. Запустите путем перетаскивания элемента управления DetailsView в UpdatePanel. Задать для элемента управления DetailsView `ID` свойства `ProductInfo` и очистить его `Height` и `Width` свойства. Разверните DetailsView смарт-тег и выберите раскрывающемся списке выберите источник данных для привязки DetailsView новый элемент управления SqlDataSource с именем `RandomProductDataSource`.


[![Привязать DetailsView для нового элемента управления SqlDataSource](master-pages-and-asp-net-ajax-vb/_static/image8.png)](master-pages-and-asp-net-ajax-vb/_static/image7.png)

**На рисунке 03**: привязать новый элемент управления SqlDataSource DetailsView ([Просмотр полноразмерное изображение](master-pages-and-asp-net-ajax-vb/_static/image9.png))


Настройка элемента управления SqlDataSource для подключения к базе данных Northwind через `NorthwindConnectionString` (который мы создали Interacting с главной страницей из учебника страницы содержимого [SKM2]). При настройке инструкции select решили указать пользовательские инструкции SQL, а затем введите следующий запрос:


[!code-sql[Main](master-pages-and-asp-net-ajax-vb/samples/sample3.sql)]

`TOP 1` Ключевое слово в `SELECT` предложение возвращает первая запись, возвращенных запросом. `NEWID()` Функция создает новое значение глобальный уникальный идентификатор (GUID) и может использоваться в `ORDER BY` предложения для возврата записей в таблице в случайном порядке.


[![Настройка SqlDataSource для возврата одной, случайно выбранных записи](master-pages-and-asp-net-ajax-vb/_static/image11.png)](master-pages-and-asp-net-ajax-vb/_static/image10.png)

**На рисунке 04**: Настройка SqlDataSource для возврата в один случайным образом выбрать записи ([Просмотр полноразмерное изображение](master-pages-and-asp-net-ajax-vb/_static/image12.png))


По завершении работы мастера Visual Studio создает BoundField для двух столбцов, возвращаемых запросом выше. На этом этапе на странице должна выглядеть следующим образом:


[!code-aspx[Main](master-pages-and-asp-net-ajax-vb/samples/sample4.aspx)]

Рис. 5 показано `ShowRandomProduct.aspx` страниц при просмотре через браузер. Нажмите кнопку обновления в браузере, чтобы перезагрузить страницу; Вы увидите `ProductName` и `UnitPrice` значения для новой записи случайно выбранных.


[![Отображается имя и цену случайных продукта](master-pages-and-asp-net-ajax-vb/_static/image14.png)](master-pages-and-asp-net-ajax-vb/_static/image13.png)

**На рисунке 05**: отображается название и цену продукта произвольного ([Просмотр полноразмерное изображение](master-pages-and-asp-net-ajax-vb/_static/image15.png))


### <a name="automatically-displaying-a-new-product-every-15-seconds"></a>Отображение нового продукта автоматически каждые 15 секунд

Платформа ASP.NET AJAX включает элемент управления Timer, который выполняет обратную передачу в указанное время; на обратную передачу таймера `Tick` события. Элемента управления Timer, помещенного внутри элемента управления UpdatePanel, система инициирует частичной обратную передачу, во время которой мы привяжите данные к DetailsView для отображения нового случайно выбранного продукта.

Для этого перетащите таймер из области элементов и поместите его в UpdatePanel. Изменение таймера `ID` из `Timer1` для `ProductTimer` и его `Interval` свойство из 60000 до 15 000. `Interval` Указывает время в миллисекундах между обратными передачами; он 15000 при указании таймера для активации обратной частичной страницы через каждые 15 секунд. На этом этапе таймера должна выглядеть следующим образом:


[!code-aspx[Main](master-pages-and-asp-net-ajax-vb/samples/sample5.aspx)]

Создайте обработчик событий для таймера `Tick` событий. В этом обработчике событий, нам нужно изменить привязку данных для DetailsView путем вызова в DetailsView `DataBind` метод. Таким образом предписывает DetailsView для повторного получения данных от элемента управления источника данных, который выбирает и отобразить новый случайным образом выбрать записи (как и когда следует перезагрузить страницу, нажав кнопку Обновить»).


[!code-vb[Main](master-pages-and-asp-net-ajax-vb/samples/sample6.vb)]

Это все, чтобы он! Повторное использование страницы через браузер. Изначально отображается информация случайных продукта. Если терпеливо смотреть экрана можно заметить, что через 15 секунд сведения о новый продукт волшебным образом заменяет существующие отображения.

Чтобы лучше понять, что здесь происходит, давайте добавим элемент управления Label UpdatePanel, время последнего обновления отображения. Добавить веб-управления Label в UpdatePanel, задать его `ID` для `LastUpdateTime`и снять его `Text` свойство. Создайте обработчик событий для UpdatePanel `Load` событий и отображение текущего времени в метке. (UpdatePanel `Load` событие для каждой полной или частичной страницы обратной передачи.)


[!code-vb[Main](master-pages-and-asp-net-ajax-vb/samples/sample7.vb)]

С этим изменением завершения страницы включает время загрузки текущей отображаемой продукта. Рис. 6 показан при первом посещении страницы. Рис. 7 показана страница 15 секунд позже, после элемента управления Timer» установлен флажок» и обновления UpdatePanel для отображения сведений о нового продукта.


[![При загрузке страницы отображается случайным образом выбраны продукта](master-pages-and-asp-net-ajax-vb/_static/image17.png)](master-pages-and-asp-net-ajax-vb/_static/image16.png)

**На рисунке 06**: случайно выбранных продуктов отображается при загрузке страницы ([Просмотр полноразмерное изображение](master-pages-and-asp-net-ajax-vb/_static/image18.png))


[![Каждые 15 секунд появится новый случайным образом выбрать продукт](master-pages-and-asp-net-ajax-vb/_static/image20.png)](master-pages-and-asp-net-ajax-vb/_static/image19.png)

**На рисунке 07**: каждые 15 секунд, отображается новый случайным образом выбрать продукт ([Просмотр полноразмерное изображение](master-pages-and-asp-net-ajax-vb/_static/image21.png))


## <a name="step-3-using-the-scriptmanagerproxy-control"></a>Шаг 3: С помощью прокси диспетчера скриптов

Вместе с в том числе необходимый скрипт для клиентской библиотеки ASP.NET AJAX framework, которую диспетчер ScriptManager также можно зарегистрировать пользовательские файлы JavaScript, ссылки на сценарии веб-служб и нестандартной проверки подлинности, авторизации и служб профилирования. Обычно такие настройки относятся к определенной странице. Тем не менее если файлы пользовательского скрипта, ссылки на веб-службы, или проверки подлинности, авторизации или служб профилирования упоминаются в ScriptManager на главной странице затем они включаются на всех страницах веб-сайта.

Чтобы добавить параметры ScriptManager на основе страницу по используйте прокси диспетчера скриптов. Можно добавить на страницу содержимого ScriptManagerProxy и затем зарегистрировать пользовательский файл JavaScript, ссылки на веб-службы, или проверки подлинности, авторизации или службы профиля из ScriptManagerProxy; Это приводит к регистрации этих служб для конкретной страницы содержимого.

> [!NOTE]
> Страницы ASP.NET только может иметь не более одного управления ScriptManager. Таким образом нельзя добавить элемент управления ScriptManager страницы содержимого, если уже определен элемент управления ScriptManager на главной странице. Предоставляет способ для разработчиков определить ScriptManager на главной странице, но по-прежнему иметь возможность добавления ScriptManager настройки на основе страницу по является единственной целью ScriptManagerProxy.


Чтобы увидеть прокси диспетчера скриптов в действии, давайте дополнять UpdatePanel в `ShowRandomProduct.aspx` для включения кнопки, которая использует клиентский скрипт, чтобы приостановить или возобновить элемента управления Timer. Элемент управления Timer имеет три клиентского метода, которые можно использовать для достижения этого нужной функции:

- `_startTimer()`-запускает элемента управления Timer
- `_raiseTick()`-элемент управления таймера «тактов», тем самым, выполнение обратной передачи и вызов событие Tick на сервере
- `_stopTimer()`— Останавливает элемента управления Timer

Давайте создадим файл JavaScript с переменной с именем `timerEnabled` и функции с именем `ToggleTimer`. `timerEnabled` Переменной указывает состояние элемента управления Timer в настоящее время включено или отключено; по умолчанию имеет значение true. `ToggleTimer` Функция принимает два входных параметра: ссылку на кнопке приостановки/возобновления и на стороне клиента `id` значение элемента управления Timer. Эта функция переключает `timerEnabled`, возвращает ссылку на элемент управления Timer, запускает или останавливает таймер (в зависимости от значения `timerEnabled`) и обновляет отображаемый текст кнопки «Приостановка» или «Возобновление». Эта функция будет вызываться при нажатии кнопки приостановки или возобновления.

Начните с создания новой папки в веб-сайт с именем `Scripts`. Добавьте новый файл в папку «скрипты» с именем `TimerScript.js` типа файл JScript.


[![Добавьте новый файл JavaScript в папку «скрипты»](master-pages-and-asp-net-ajax-vb/_static/image23.png)](master-pages-and-asp-net-ajax-vb/_static/image22.png)

**На рисунке 08**: добавьте новый файл JavaScript, чтобы `Scripts` папку ([Просмотр полноразмерное изображение](master-pages-and-asp-net-ajax-vb/_static/image24.png))


[![Веб-сайт будет добавлен новый файл JavaScript](master-pages-and-asp-net-ajax-vb/_static/image26.png)](master-pages-and-asp-net-ajax-vb/_static/image25.png)

**На рисунке 09**: веб-сайт будет добавлен новый файл JavaScript ([Просмотр полноразмерное изображение](master-pages-and-asp-net-ajax-vb/_static/image27.png))


Добавьте следующий скрипт для `TimerScript.js` файла:


[!code-csharp[Main](master-pages-and-asp-net-ajax-vb/samples/sample8.cs)]

После этого необходимо зарегистрировать этот пользовательский файл JavaScript в `ShowRandomProduct.aspx`. Вернитесь к `ShowRandomProduct.aspx` и добавить на страницу элемент управления ScriptManagerProxy; установить его `ID` для `MyManagerProxy`. Регистрируемый пользовательским кодом JavaScript файла выберите прокси диспетчера скриптов в конструкторе, а затем перейдите в окно «Свойства». Одно из свойств называется скриптов. При выборе этого свойства отображаются редактор коллекции ScriptReference показано на рисунке 10. Нажмите кнопку Добавить, чтобы включить ссылку на новый скрипт и затем введите путь к файлу сценария в свойстве Path: `~/Scripts/TimerScript.js`.


[![Добавьте ссылку на скрипт прокси диспетчера скриптов](master-pages-and-asp-net-ajax-vb/_static/image29.png)](master-pages-and-asp-net-ajax-vb/_static/image28.png)

**Рис. 10**: добавить ссылку на скрипт прокси диспетчера скриптов ([Просмотр полноразмерное изображение](master-pages-and-asp-net-ajax-vb/_static/image30.png))


После добавления ссылки скрипта прокси диспетчера скриптов декларативной разметки обновляется с учетом `<Scripts>` коллекции с помощью одного `ScriptReference` запись, как в следующем примере разметки показано:


[!code-aspx[Main](master-pages-and-asp-net-ajax-vb/samples/sample9.aspx)]

`ScriptReference` Программа ScriptManagerProxy включить ссылку на файл JavaScript в его отображения разметки. То есть, путем регистрации пользовательского скрипта в ScriptManagerProxy `ShowRandomProduct.aspx` выводимые данные страницы теперь включает другой `<script src="url"></script>` тег: `<script src="Scripts/TimerScript.js" type="text/javascript"></script>`.

Теперь можно вызвать `ToggleTimer` функции, определенной в `TimerScript.js` из клиентского скрипта в `ShowRandomProduct.aspx` страницы. Добавьте следующий код HTML в UpdatePanel.


[!code-aspx[Main](master-pages-and-asp-net-ajax-vb/samples/sample10.aspx)]

При этом отображаются кнопки с текстом «Приостановка». Каждый раз, когда он выбран, функция JavaScript, которая `ToggleTimer` вызова при передаче в ссылке на кнопку и `id` значение элемента управления Timer (`ProductTimer`). Обратите внимание, синтаксис для получения `id` значение элемента управления Timer. `<%=ProductTimer.ClientID%>`Создает значение `ProductTimer` элемента управления Timer `ClientID` свойство. В именовании Идентификаторов элементов управления страницы содержимого [SKM3] учебника мы рассмотрели различия между серверным `ID` значение и полученный на стороне клиента `id` значение и как `ClientID` возвращает на стороне клиента `id`.

Рис. 11 показана эта страница при первом посещении через браузер. Таймера выполняется в данный момент и обновляет сведения о продукте отображаемых каждые 15 секунд. Рис. 12 показан экран, после нажатия кнопки «Пауза». Нажмите кнопку Приостановка останавливает таймер и обновляет текст, кнопки «Возобновление». Сведения о продукте обновления (и продолжить обновление каждые 15 секунд), когда пользователь нажимает кнопку возобновления.


[![Нажмите эту кнопку для остановки элемента управления Timer](master-pages-and-asp-net-ajax-vb/_static/image32.png)](master-pages-and-asp-net-ajax-vb/_static/image31.png)

**Рис. 11**: нажмите эту кнопку для остановки элемента управления Timer ([Просмотр полноразмерное изображение](master-pages-and-asp-net-ajax-vb/_static/image33.png))


[![Нажмите кнопку "Продолжить" для перезапуска таймера](master-pages-and-asp-net-ajax-vb/_static/image35.png)](master-pages-and-asp-net-ajax-vb/_static/image34.png)

**Рис. 12**: нажмите кнопку "Продолжить" для перезапуска таймера ([Просмотр полноразмерное изображение](master-pages-and-asp-net-ajax-vb/_static/image36.png))


## <a name="summary"></a>Сводка

При создании поддерживающих AJAX веб-приложений с помощью ASP.NET AJAX framework крайне важно, что каждая веб-страница с поддержкой AJAX включать элемент управления ScriptManager. Чтобы упростить этот процесс, мы можем добавить ScriptManager главной страницы, вместо того чтобы запомнить, для добавления ScriptManager требуется для каждой страницы содержимого. Шаг 1 было показано, как добавить ScriptManager на главную страницу во время шага 2 рассказывали реализации функций AJAX на странице содержимого.

Если необходимо добавить ссылки на сценарии веб-служб, пользовательские сценарии или настраиваемые проверки подлинности, авторизации или служб профилирования на определенную страницу содержимого, добавьте элемент управления ScriptManagerProxy страницы содержимого, а затем настройте существует настроек. Шаг 3 рассматривалось используйте ScriptManagerProxy, чтобы зарегистрировать пользовательский файл JavaScript в определенную страницу содержимого.

Программирование довольны!

### <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения по темам, рассматриваемые в этом учебнике см. в следующих ресурсах:

- [Платформа ASP.NET AJAX](../../../../ajax/index.md)
- [Учебники по ASP.NET AJAX](../aspnet-ajax/understanding-partial-page-updates-with-asp-net-ajax.md)
- [ASP.NET AJAX видео](../../../videos/aspnet-ajax/index.md)
- [Построение интерактивного пользовательского интерфейса с помощью Microsoft ASP.NET AJAX](http://aspnet.4guysfromrolla.com/articles/101007-1.aspx)
- [Использование функции NEWID для случайным образом Сортировка записей](http://www.sqlteam.com/article/using-newid-to-randomly-sort-records)
- [С помощью элемента управления Timer](http://aspnet.4guysfromrolla.com/articles/061808-1.aspx)

### <a name="about-the-author"></a>Об авторе

[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор по ASP/ASP.NET и основатель 4GuysFromRolla.com, работает с веб-технологиями Майкрософт с 1998 года. Скотт — независимый консультант, trainer и записи. Его последняя книга — [ *диспетчерами учат самостоятельно ASP.NET 3.5 в течение 24 часов*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco). Скотт может быть достигнута по [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com) или через его блог по [http://ScottOnWriting.NET](http://scottonwriting.net/).

### <a name="special-thanks-to"></a>Благодарности

Этот учебник ряд прошел проверку многие полезные рецензентов. Объясняются моих последующих статей для MSDN? Если Да, напишите мне по[mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)

>[!div class="step-by-step"]
[Назад](interacting-with-the-content-page-from-the-master-page-vb.md)
[Вперед](specifying-the-master-page-programmatically-vb.md)
