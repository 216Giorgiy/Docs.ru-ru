---
uid: web-forms/overview/moving-to-aspnet-20/data-bound-controls
title: "Элементы управления с привязкой к данным | Документы Microsoft"
author: microsoft
description: "Большинство приложений ASP.NET используют несколько уровень представления данных из источника данных. Элементы управления с привязкой к данным были жизненно важную часть взаимодействующими w..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2005
ms.topic: article
ms.assetid: 0e23ff32-646d-43f3-8bec-6b2313d3abd6
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/data-bound-controls
msc.type: authoredcontent
ms.openlocfilehash: 3ebb0f9a7a2f071b7bf7aa3855920f1a5784a61f
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="data-bound-controls"></a>Элементы управления с привязкой к данным
====================
по [Microsoft](https://github.com/microsoft)

> Большинство приложений ASP.NET используют несколько уровень представления данных из источника данных. Элементы управления с привязкой к данным были жизненно важную часть взаимодействия с данными в динамических веб-приложений. ASP.NET 2.0 содержит некоторые существенные улучшения для элементов управления с привязкой к данным, включая новый класс BaseDataBoundControl и декларативный синтаксис.


Большинство приложений ASP.NET используют несколько уровень представления данных из источника данных. Элементы управления с привязкой к данным были жизненно важную часть взаимодействия с данными в динамических веб-приложений. ASP.NET 2.0 содержит некоторые существенные улучшения для элементов управления с привязкой к данным, включая новый класс BaseDataBoundControl и декларативный синтаксис.

BaseDataBoundControl выступает в качестве базового класса для DataBoundControl и HierarchicalDataBoundControl класса. В этом модуле мы обсудим следующие классы, которые являются производными от DataBoundControl.

- AdRotator
- Список-элементы управления
- GridView
- FormView
- DetailsView

Кроме того, мы обсудим следующие классы, которые являются производными от класса HierarchicalDataBoundControl.

- TreeView
- Меню
- SiteMapPath

## <a name="databoundcontrol-class"></a>Класс DataBoundControl

Класс DataBoundControl — абстрактный класс (помечены как MustInherit в VB), используемый для взаимодействия с табличными или данных в формате списка. Следующие элементы управления являются некоторые элементы управления, которые являются производными от DataBoundControl.

## <a name="adrotator"></a>AdRotator

Элемент управления AdRotator дает возможность отображения графики объявления на веб-страницы, связанной с конкретным URL-адресом. График, который отображается повернут с помощью свойства для элемента управления. Частоту отображения конкретного ad на странице можно настроить с помощью **впечатлениями** свойство и рекламных объявлений можно фильтровать с помощью фильтрации по ключевым словам.

Элементы управления AdRotator используют XML-файл или таблицу в базе данных. Следующие атрибуты используются в XML-файлы для настройки элемента управления AdRotator.

### <a name="imageurl"></a>ImageUrl
URL-адрес изображения для отображения рекламного объявления.

### <a name="navigateurl"></a>NavigateUrl
URL-адрес пользователя должно быть выполнено для при щелчке рекламы. Это должно быть в кодировке URL-адрес.

### <a name="alternatetext"></a>AlternateText
Замещающий текст, который отображается во всплывающей подсказке и программами чтения с экрана. Также отображается, когда изображение, указанное свойством ImageUrl недоступен.

### <a name="keyword"></a>Ключевое слово
Определяет ключевое слово, которое может использоваться при использовании фильтрации по ключевым словам. Если указано, будет отображаться только те рекламы с помощью ключевого слова, соответствующие фильтру ключевое слово.

### <a name="impressions"></a>Просмотров
Взвешенное число, которое определяет, как часто определенного ad вероятнее всего, появятся. Это относительно впечатление других объявлений в том же файле. Максимальное значение просмотров, общую для всех объявлений в XML-файл — 2,048,000,000 1.

### <a name="height"></a>Высота
Высота ad в пикселях.

### <a name="width"></a>По ширине
Ширина ad в пикселях.


> [!NOTE]
> Атрибуты Height и Width переопределить значения высоты и ширины для самого элемента управления AdRotator.


Стандартные XML-файл может выглядеть следующим образом:

[!code-xml[Main](data-bound-controls/samples/sample1.xml)]

В приведенном выше примере ad для Contoso дважды — как вероятнее всего, появятся в виде ad для веб-узла ASP.NET из-за значения для атрибута впечатлениями.

Отображение баннера из указанного выше файла XML, добавление на страницу элемент управления AdRotator и задать **AdvertisementFile** свойство, чтобы указать XML-файл, как показано ниже:

[!code-aspx[Main](data-bound-controls/samples/sample2.aspx)]

Если вы решили использовать таблицу базы данных в качестве источника данных для элемента управления AdRotator, необходимо сначала настроить базу данных, используя следующую схему:

| **Имя столбца** | **Тип данных** | **Описание** |
| --- | --- | --- |
| Идентификатор | int | Первичный ключ. Этот столбец может иметь любое имя. |
| ImageUrl | nvarchar (*длина*) | Относительный или абсолютный URL-адрес изображения для отображения рекламного объявления. |
| NavigateUrl | nvarchar (*длина*) | Целевой URL-адрес для рекламы. Если значение не указано, то баннер не гиперссылки. |
| AlternateText | nvarchar (*длина*) | Текст, отображаемый, если изображение не удается найти. В некоторых браузерах текст отображается в виде всплывающей подсказки. Альтернативный текст также используется для специальных возможностей, чтобы пользователи, которые не могут просматривать график чувствую, ее описание чтение вслух. |
| Ключевое слово | nvarchar (*длина*) | Категория для объявления, на которой можно фильтровать страницы. |
| Просмотров | int(4) | Число, определяющее, как часто должно отображаться баннер. Чем больше число, тем чаще будет отображаться ad. Общее количество всех этих значений в XML-файл не может превышать 2,048,000,000-1. |
| По ширине | int(4) | Ширина изображения в пикселях. |
| Высота | int(4) | Высота изображения в пикселях. |

В случаях, когда уже имеется база данных с разными схемами, можно использовать **AlternateTextField**, **ImageUrlField**, и **NavigateUrlField** свойства для сопоставления AdRotator атрибуты к существующей базе данных. Для отображения данных из базы данных в элементе управления AdRotator, добавьте на страницу элемент управления источником данных, настроить строку подключения для элемента управления источником данных, чтобы она указывала на базу данных и задать для элемента управления AdRotator **DataSourceID** Свойство идентификатора элемента управления источником данных. В случаях, когда нет необходимости для программной настройки AdRotator рекламы с помощью события AdCreated. Событие AdCreated принимает два параметра; один объект и другой экземпляр AdCreatedEventArgs. AdCreatedEventArgs является ссылкой на ad, который находится в процессе создания.

В следующем фрагменте кода задает ImageUrl, NavigateUrl и AlternateText для ad программными средствами.

[!code-csharp[Main](data-bound-controls/samples/sample3.cs)]

## <a name="list-controls"></a>Список-элементы управления

Список-элементы управления включают ListBox, DropDownList, CheckBoxList, RadioButtonList и маркированный список. Каждый из этих элементов управления может быть данными, привязанными к источнику данных. Они использовать одно поле в источнике данных в качестве отображаемого текста и при необходимости можно использовать второе поле в качестве значения элемента. Элементы также могут быть добавлены статически во время разработки и могут быть использованы смешанные статические элементы и динамические элементы, добавленные из источника данных.

К данным привязать элемент управления списка, добавить на страницу элемент управления источником данных. Укажите команды SELECT для элемента управления источником данных, а затем установите свойство DataSourceID элемента управления списком идентификатор элемента управления источником данных. Используйте **DataTextField** и **DataValueField используются** свойства для определения отображения текста и значение для элемента управления. Кроме того, можно использовать **DataTextFormatString** свойства для управления внешним видом отображаемого текста, как показано ниже:

| **Выражение** | **Описание** |
| --- | --- |
| Цена: {0:C} | Для числовых и десятичных данных. Отображает литерала «Цена:» идут числа в денежном формате. Денежный формат зависит от региональных настроек, указанных в атрибуте языка и региональных параметров на **страницы** директив или в файле Web.config. |
| {0:D4} | Для целочисленных данных. Нельзя использовать вместе с десятичными числами. Целые числа отображаются в поле нулями, шириной в четыре знака. |
| {0:N2}% | Для числовых данных. Отображает число с до второго десятичного точности следуют литерал «%». |
| {0:000.0} | Для числовых и десятичных данных. Числа округляются до одного десятичного разряда. Числа, меньшие чем трехзначные, заполняются нулями. |
| {0:D} | Для данных даты и времени. Отображает длинный формат даты («четверг, 6 августа 1996 г»). Формат даты зависит от параметра языка и региональных параметров в файле Web.config. |
| {0:d} | Для данных даты и времени. Отображает короткий формат даты («12/31/99»). |
| {0:гг-мм-дд} | Для данных даты и времени. Отображает дату в числовом формате год месяц день (96-08-06) |

## <a name="gridview"></a>GridView

Элемент управления GridView позволяет для отображения и редактирования принципу декларативные табличных данных и является преемником элемента управления DataGrid. Следующие функции доступны в элементе управления GridView.

- Привязка к данным элементы управления источников, таких как SqlDataSource.
- Встроенные функции сортировки.
- Встроенные возможности обновления и удаления.
- Встроенные возможности разбиения на страницы.
- Встроенные возможности выбора строки.
- Программный доступ к объектной модели GridView, можно динамически задать свойства, обрабатывать события и т. д.
- Несколько ключевых полей.
- Несколько полей данных для столбцов гиперссылок.
- Настройка внешнего вида с тем и стилей.

**Поля столбцов**

Каждый столбец в элементе управления GridView представляется объектом DataControlField. По умолчанию присвоено свойству AutoGenerateColumns **true**, который создает объект AutoGeneratedField для каждого поля в источнике данных. Каждое поле выводятся в виде столбцов в элементе управления GridView в порядке, в котором они расположены в источнике данных. Можно также вручную управлять столбца, какие поля отображаются в **GridView** управления **AutoGenerateColumns** свойства **false** и затем определения собственного Коллекция полей столбцов. Различные типы полей столбцов определяют поведение столбцов в элементе управления.

В следующей таблице перечислены различные типы полей столбцов, используемых.

| **Тип поля столбца** | **Описание** |
| --- | --- |
| BoundField | Отображает значение поля в источнике данных. Это стандартный тип столбца элемента управления GridView. |
| ButtonField | Отображает кнопку для каждого элемента в элементе управления GridView. Это позволяет создать столбец пользовательских кнопочных элементов управления, например Add или кнопку «Удалить». |
| CheckBoxField | Отображает флажок для каждого элемента в элементе управления GridView. Данный тип поля столбца обычно используется для отображения полей с логическими значениями. |
| CommandField | Отображает предопределенные командные кнопки для выполнения при выборе, редактирование или удаление операций. |
| HyperLinkField | Отображает значение поля в источнике данных как гиперссылку. Данный тип поля столбца позволяет привязывать второе поле URL-адресу гиперссылки. |
| ImageField | Отображает изображение для каждого элемента в элементе управления GridView. |
| TemplateField | Отображает определенное пользователем содержимое для каждого элемента в элементе управления GridView в соответствии с указанным шаблоном. Данный тип поля столбца позволяет создать поле пользовательского столбца. |

Декларативно определять коллекцию полей столбцов, сначала следует добавить открывающих и закрывающих  **&lt;столбцы&gt;**  теги между открывающим и закрывающим тегами элемента управления GridView. Далее следует внести список полей, которые требуется включить между открывающим и закрывающим  **&lt;столбцы&gt;**  тегов. Столбцы, указанные добавляются в коллекцию столбцов в указанном порядке. **Столбцы** коллекция сохраняет все столбца поля в элементе управления и позволяет программным образом управлять полей столбцов в элементе управления GridView.

Явно заданные поля столбцов могут отображаться в сочетании с автоматически созданные поля столбцов. При использовании обоих явно заданные поля столбцов подготавливаются к просмотру во-первых, следуют автоматически созданные поля столбцов.

## <a name="binding-to-data"></a>Привязка к данным

Элемент управления GridView можно привязать к элементу управления источником данных (таких как **SqlDataSource**, **ObjectDataSource**и так далее), а также как любой источник данных, который реализует System.Collections.IEnumerable интерфейс (например, System.Data.DataView, System.Collections.ArrayList или System.Collections.Hashtable). Используйте один из следующих методов для привязки элемента управления GridView к соответствующему типу источника данных.

- Чтобы привязать элемент управления источником данных, присвойте свойству DataSourceID элемента управления GridView значение идентификатора элемента управления источником данных. Элемент управления GridView автоматически привязывается к элементу управления источника данных и может использовать функции элемента управления для выполнения сортировки, обновления, удаления и разбиения по страницам. Это предпочтительный метод для привязки к данным.
- Для привязки к источнику данных, который реализует интерфейс System.Collections.IEnumerable программно задать свойства DataSource элемента управления GridView к источнику данных и затем вызвать метод DataBind. При использовании этого метода, элемент управления GridView предоставляет встроенные сортировки, обновления, удаления и разбиения по страницам. Необходимо указать эту функциональность самостоятельно.

## <a name="data-operations"></a>Операции с данными

Элемент управления GridView предоставляет множество встроенных возможностей, которые пользователи могут сортировать, обновить, удалить, выберите и постраничного просмотра элементов в элементе управления. При привязке элемента управления GridView к элементу управления источником данных, управления GridView можно воспользоваться преимуществами источника данных возможности элемента управления и предоставить автоматическая сортировка, обновления и удаления функциональные возможности.

> [!NOTE]
> Элемент управления GridView могут обеспечить поддержку сортировки, обновления и удаления с другими типами источников данных; Тем не менее необходимо указать подходящий обработчик событий с реализацией этих операций.


Сортировка позволяет пользователю сортировать элементы в элементе управления GridView по отношению к определенному столбцу, щелкнув заголовок столбца. Чтобы разрешить сортировку, свойству AllowSorting **true**.

Автоматическое обновление, удаление и выбор функциональные возможности включены в том случае, если кнопки **ButtonField** или **TemplateField** полей столбцов, имя команды «Изменить», «Удалить» и «Select» щелчок соответственно. Элемент управления GridView может автоматически добавлять **CommandField** полей столбцов изменять, удалять и кнопка выбора, если свойство AutoGenerateEditButton, AutoGenerateDeleteButton или AutoGenerateSelectButton **true**соответственно.

> [!NOTE]
> Вставка новых записей в источнике данных не поддерживается напрямую с помощью элемента управления GridView. Тем не менее существует возможность вставки записей с помощью элемента управления GridView в сочетании с DetailsView или управления FormView.


Вместо отображения всех записей в источнике данных, в то же время, элемент управления GridView можно автоматически разбейте записей на страницах. Чтобы включить разбиение на страницы, значение свойства AllowPaging **true**.

## <a name="customizing-the-user-interface"></a>Настройка пользовательского интерфейса

Можно настроить внешний вид элемента управления GridView, задав свойства стиля для разных частей элемента управления. В следующей таблице перечислены различных свойств стиля.

| **Свойство стиля** | **Описание** |
| --- | --- |
| AlternatingRowStyle | Параметры стилей для чередующихся строк данных в элементе управления GridView. Если это свойство задано, строки данных отображаются переключаясь между RowStyle параметры и **AlternatingRowStyle** параметры. |
| EditRowStyle | Параметры стиля для строки, редактируемого в элементе управления GridView. |
| EmptyDataRowStyle | Параметры стиля для пустой строки данных отображаются в элементе управления GridView, когда источник данных не содержит какие-либо записи. |
| FooterStyle | Параметры стиля для строки нижнего колонтитула в элементе управления GridView. |
| HeaderStyle | Параметры стиля для строки заголовка элемента управления GridView. |
| PagerStyle | Параметры стиля для элемента управления GridView строку страничного навигатора. |
| RowStyle | Параметры стиля для строки данных в элементе управления GridView. Когда **AlternatingRowStyle** задается, строки данных отображаются переключаясь между **RowStyle** параметры и **AlternatingRowStyle** параметры. |
| SelectedRowStyle | Параметры стиля для выбранной строки в элементе управления GridView. |

Кроме того, можно отобразить или скрыть различные части элемента управления. В следующей таблице перечислены свойств, определяющих, какие части при отображении и скрытии.

| **Свойство** | **Описание** |
| --- | --- |
| ShowFooter | Показывает или скрывает нижний колонтитул элемента управления GridView. |
| ShowHeader | Показывает или скрывает раздел заголовка элемента управления GridView. |

### <a name="events"></a>События

Элемент управления GridView предоставляет несколько событий, которые можно запрограммировать. Это позволяет запускать пользовательские процедуры при возникновении события. В следующей таблице перечислены события, поддерживаемые элементом управления GridView.

| **Event** | **Описание** |
| --- | --- |
| PageIndexChanged | Происходит при нажатии кнопки страничного навигатора, но после элемента управления GridView обработает операцию разбиения на страницы. Это событие обычно используется, когда требуется выполнить задачу после перехода пользователя на другую страницу в элементе управления. |
| PageIndexChanging | Происходит при нажатии кнопки страничного навигатора, но перед GridView управления обработает операцию разбиения на страницы. Это событие часто используется для отмены операции разбиения по страницам. |
| RowCancelingEdit | Происходит при нажатии кнопки "Отмена" для строки, но перед элементом управления GridView выход из режима редактирования. Это событие часто используется для остановки операции отмены. |
| RowCommand | Происходит при нажатии кнопки в элементе управления GridView. Это событие часто используется для выполнения задачи при нажатии кнопки в элементе управления. |
| RowCreated | Происходит при создании новой строки в элементе управления GridView. Это событие часто используется для изменения содержимого строки после ее создания. |
| RowDataBound | Происходит, когда строки данных, связанных с данными в элементе управления GridView. Это событие часто используется для изменения содержимого строки после ее привязки к данным. |
| RowDeleted | Происходит при нажатии кнопки Delete строки, но после элемента управления GridView удаляет записи из источника данных. Это событие часто используется для проверки результатов операции удаления. |
| RowDeleting | Происходит при нажатии кнопки Delete строки, но перед GridView управления удаляет записи из источника данных. Это событие часто используется для отмены операции удаления. |
| RowEditing | Происходит при нажатии кнопки Изменить строки, но перед GridView элемента управления в режим редактирования. Это событие часто используется для отмены операции. |
| RowUpdated | Происходит при нажатии кнопки обновления строки, но после элемента управления GridView обновляет строку. Это событие часто используется для проверки результатов операции обновления. |
| RowUpdating | Происходит при нажатии кнопки обновления строки, но перед GridView управления обновляет строку. Это событие часто используется для отмены операции обновления. |
| SelectedIndexChanged | Происходит при нажатии кнопки выберите строки, но после элемента управления GridView обрабатывает операцию выбора. Это событие часто используется для выполнения задачи после выбора строки в элементе управления. |
| SelectedIndexChanging | Происходит при нажатии кнопки выберите строки, но перед GridView элемент управления обрабатывает операции select. Это событие часто используется для отмены операции выбора. |
| Сортировка | Происходит при щелчке гиперссылки для сортировки столбца, но после элемента управления GridView обработки операции сортировки. Это событие обычно используется для выполнения задачи после пользователь щелкает гиперссылку для сортировки столбца. |
| Сортировка | Происходит при щелчке гиперссылки для сортировки столбца, но перед GridView управления обработки операции сортировки. Это событие часто используется для отмены операции сортировки или выполнения настраиваемой сортировки. |

## <a name="formview"></a>FormView

Элемент управления FormView используется для отображения одной записи из источника данных. Это похоже на элемент управления DetailsView, за исключением того, он отображает пользовательские шаблоны вместо полей строк. Создание собственных шаблонов обеспечивает большую гибкость в управлении отображением данных. Элемент управления FormView поддерживает следующие функции:

- Привязка к данным элементы управления источников, таких как SqlDataSource и ObjectDataSource.
- Встроенные возможности вставки.
- Встроенные возможности обновления и удаления.
- Встроенные возможности разбиения на страницы.
- Программный доступ к объектной модели FormView можно динамически задать свойства, обрабатывать события и т. д.
- Настройка внешнего вида с использованием пользовательских шаблонов, тем и стилей.

## <a name="templates"></a>Шаблоны

Для управления FormView для отображения содержимого необходимо создать шаблоны для различных частей элемента управления. Большинство шаблонов являются необязательными. Тем не менее необходимо создать шаблон для режима, в котором элемент управления настроен. Например элемент управления FormView, который поддерживает вставку записей должен иметь определенный шаблон элемента вставки. В следующей таблице перечислены различные шаблоны, которые можно создать.

| **Тип шаблона** | **Описание** |
| --- | --- |
| EditItemTemplate | Определяет содержимое для строки данных, когда элемент управления FormView находится в режиме редактирования. Этот шаблон обычно содержит элементы управления для ввода и кнопки команд, с помощью которого пользователь может изменить существующую запись. |
| EmptyDataTemplate | Определяет содержимое для пустой строки данных отображается в случае, если элемент управления FormView привязан к источнику данных, который не содержит ни одной записи. Этот шаблон обычно содержит содержимое, чтобы предупредить пользователя о том, что источник данных не содержит какие-либо записи. |
| Шаблон FooterTemplate | Определяет содержимое для строки нижнего колонтитула. Этот шаблон обычно содержит дополнительное содержимое, которое вы хотите отобразить в строке нижнего колонтитула. В качестве альтернативы можно просто указать текст, отображаемый в строке нижнего колонтитула, присвоив свойству FooterText. |
| HeaderTemplate | Определяет содержимое для строки заголовка. Этот шаблон обычно содержит дополнительное содержимое, которое требуется для отображения в строке заголовка. В качестве альтернативы можно просто указать текст, отображаемый в строке заголовка, задав свойство HeaderText. |
| ItemTemplate | Определяет содержимое для строки данных, когда элемент управления FormView находится в режиме только для чтения. Этот шаблон обычно содержит содержимое для отображения значений существующей записи. |
| InsertItemTemplate | Определяет содержимое для строки данных, когда элемент управления FormView находится в режиме вставки. Этот шаблон обычно содержит элементы управления для ввода и кнопки команд, с помощью которого пользователь может добавить новую запись. |
| PagerTemplate | Определяет содержимое строки страничного навигатора, отображается в случае, если включена функция разбиения на страницы (если значение свойства AllowPaging **true**). Этот шаблон обычно содержит элементы управления, с которыми пользователь может перейти к другой записи. |

Элементы управления вводом в шаблоне элемента редактирования и шаблон элемента вставки можно привязать к поля источника данных, используя выражение двусторонней привязки. Это позволяет элементу управления FormView автоматически извлекать значения элемента управления вводом для обновления или операции вставки. Выражения двусторонней привязки также позволяют элементам управления вводом в шаблоне элемента редактирования автоматически отображать исходные значения полей.

### <a name="binding-to-data"></a>Привязка к данным

Элемент управления FormView можно привязать к элементу управления источником данных (таких как **SqlDataSource**, AccessDataSource, **ObjectDataSource** и т. д), или к любому источнику данных, который реализует Интерфейс System.Collections.IEnumerable (например, System.Data.DataView System.Collections.ArrayList и System.Collections.Hashtable). Используйте один из следующих методов для привязки элемента управления FormView к соответствующему типу источника данных.

- Чтобы привязать элемент управления источником данных, присвойте свойству DataSourceID элемента управления FormView значение идентификатора элемента управления источником данных. Элемент управления FormView автоматически привязывается к элементу управления источника данных и может использовать функции элемента управления для выполнения вставки, обновления, удаления и разбиения по страницам. Это предпочтительный метод для привязки к данным.
- Для привязки к источнику данных, который реализует **System.Collections.IEnumerable** интерфейсов, программно задать свойства DataSource FormView элемента управления к источнику данных и затем вызвать метод DataBind. При использовании этого метода, элемент управления FormView предоставляет встроенные возможности вставки, обновления, удаления и разбиения по страницам. Требуется для поддержки этой функции с помощью соответствующего события.

## <a name="data-operations"></a>Операции с данными

Элемент управления FormView предоставляет множество встроенных возможностей, позволяющие пользователям обновлять, delete, insert и постраничного просмотра элементов в элементе управления. Когда элемент управления FormView привязывается к элементу управления источником данных, управления FormView можно воспользоваться преимуществами источника данных возможности элемента управления и предоставить автоматического обновления, удаления, вставки и разбиения по страницам. Элемент управления FormView могут обеспечить поддержку для update, delete, insert и операции разбиения на страницы с другими типами источников данных; Однако необходимо указать подходящий обработчик событий с реализацией этих операций.

Поскольку элемент управления FormView использует шаблоны, он не предоставляет способ автоматического создания кнопки для выполнения обновления, удаления или вставки операций. Необходимо вручную включить эти кнопки в соответствующий шаблон. Элемент управления FormView распознает определенные кнопки, которые имеют свои **CommandName** присвоены определенные значения свойства. В следующей таблице перечислены кнопки команд, который распознается элементом управления FormView.

| **Button** | **Значение CommandName** | **Описание** |
| --- | --- | --- |
| Cancel | «Отмена» | Используется в операциях обновления или вставки для отмены операции и отказаться от значений, введенных пользователем. Для режима, указанного в свойстве DefaultMode возвращает управления FormView. |
| Удаление | "Удалить" | Используется в операциях удаления для удаления записи из источника данных. Вызывает события ItemDeleting и ItemDeleted. |
| Правка | «Edit» | Используется в операциях обновления для размещения элемента управления FormView в режиме редактирования. Содержимое, определенное в **EditItemTemplate** свойство отображается для строки данных. |
| Insert | «Вставка» | Используется в операциях вставки для попытки вставить новую запись в источнике данных, с помощью значений, предоставленных пользователем. Вызывает события ItemInserting и ItemInserted. |
| Новый | «New» | Используется в операциях вставки для размещения элемента управления FormView в режиме вставки. Содержимое, определенное в **InsertItemTemplate** свойство отображается для строки данных. |
| Страница | «Страница» | Используется в операции разбиения на страницы для представления кнопки в страничного навигатора, которая выполняет разбиение по страницам. Чтобы указать операцию разбиения на страницы, задайте **CommandArgument** свойство кнопки «Далее», «Назад», "First", «Последнее» или индекс страницы, к которой следует перейти. Вызывает события PageIndexChanging и PageIndexChanged. |
| Обновление | «Обновления» | Используется в операциях обновления для обновления текущей записи в источнике данных с помощью значений, предоставленных пользователем. Вызывает события ItemUpdating и ItemUpdated. |

В отличие от удаления кнопку (которая удаляет записи немедленно), при нажатии кнопок редактирования и создания FormView управления переходит в редактирования и режим вставки соответственно. В режиме редактирования содержимого содержатся в **EditItemTemplate** свойство отображается для текущего элемента данных. Как правило таким образом, чтобы кнопка "Изменить" заменяется на кнопку "Отмена" и обновление определено шаблоном элемента. Элементы управления вводом, подходящие для типа данных поля (например, текстовое поле или элемент управления CheckBox) обычно также отображаются со значением поля для пользователя для изменения. Щелкнув кнопкой "Обновить" обновляет запись в источнике данных, при нажатии кнопки отмены отменяет все изменения.

Аналогичным образом, содержимое, содержащихся в **InsertItemTemplate** свойство отображается для элемента данных, когда элемент управления находится в режиме вставки. Шаблон элемента вставки обычно определяется таким образом, чтобы заменить новую кнопку "Вставить" и "Отмена", а элементы управления вводом отображаются для пользователя ввести значения для новой записи. Кнопки "Вставить" вставляет запись в источнике данных, при нажатии кнопки отмены отменяет все изменения.

Элемент управления FormView предоставляет функции разбиения на страницы, которая позволяет пользователю переходить к другим записям в источнике данных. При включении строку страничного навигатора отображается в элементе управления FormView, содержащий управления перемещением по страницам. Чтобы включить разбиение на страницы, задайте **AllowPaging** свойства **true**. Можно настроить строку страничного навигатора, задав свойства объектов, содержащихся в PagerStyle и PagerSettings свойство. Вместо использования встроенных строки пользовательского интерфейса, можно создать собственный пользовательский Интерфейс, с помощью **PagerTemplate** свойство.

## <a name="customizing-the-user-interface"></a>Настройка пользовательского интерфейса

Можно настроить внешний вид элемента управления FormView, задав свойства стиля для разных частей элемента управления. В следующей таблице перечислены различных свойств стиля.

| **Свойство стиля** | **Описание** |
| --- | --- |
| EditRowStyle | Параметры стиля для строки данных, когда элемент управления FormView находится в режиме редактирования. |
| EmptyDataRowStyle | Параметры стиля для пустой строки данных отображается в элементе управления FormView, когда источник данных не содержит какие-либо записи. |
| FooterStyle | Параметры стиля для строки нижнего колонтитула управления FormView. |
| HeaderStyle | Параметры стиля для строки заголовка элемента управления FormView. |
| InsertRowStyle | Параметры стиля для строки данных, когда элемент управления FormView находится в режиме вставки. |
| PagerStyle | Параметры стиля строки страничного навигатора, отображаемого в элементе управления FormView при включенной функции разбиения на страницы. |
| RowStyle | Параметры стиля для строки данных, когда элемент управления FormView находится в режиме только для чтения. |

## <a name="events"></a>События

Элемент управления FormView предоставляет несколько событий, которые можно запрограммировать. Это позволяет запускать пользовательские процедуры при возникновении события. В следующей таблице перечислены события, поддерживаемые элементом управления FormView.

| **Event** | **Описание** |
| --- | --- |
| ItemCommand | Происходит при нажатии кнопки в элементе управления FormView. Это событие часто используется для выполнения задачи при нажатии кнопки в элементе управления. |
| ItemCreated | Происходит после создания всех объектов FormViewRow в элементе управления FormView. Это событие часто используется для изменения значения записи перед отображением. |
| ItemDeleted | Возникает, когда кнопку «Удалить» (кнопка с его **CommandName** свойством, имеющим значение «Delete») выбран, но после элемента управления FormView удаляет записи из источника данных. Это событие часто используется для проверки результатов операции удаления. |
| ItemDeleting | Происходит при нажатии кнопки Delete, но перед FormView управления удаляет записи из источника данных. Это событие часто используется для отмены операции удаления. |
| ItemInserted | Происходит, когда кнопка вставки (кнопка с его **CommandName** свойством, имеющим значение «Вставка») по нажатию, но после запись вставляется в элемент управления FormView. Это событие часто используется для проверки результатов операции вставки. |
| ItemInserting | Происходит при нажатии кнопки "Вставить", но перед FormView запись вставляется элемент управления. Это событие часто используется для отмены операции вставки. |
| ItemUpdated | Происходит, когда кнопка обновления (кнопка с его **CommandName** свойством, имеющим значение «Обновления») по нажатию, но после элемента управления FormView обновляет строку. Это событие часто используется для проверки результатов операции обновления. |
| ItemUpdating | Происходит при нажатии кнопки "Обновить", но перед FormView управления обновляет запись. Это событие часто используется для отмены операции обновления. |
| ModeChanged | Происходит после изменением режима FormView элемента управления (для редактирования, вставки или только для чтения). Это событие часто используется для выполнения задачи при изменении режима FormView элемента управления. |
| ModeChanging | Происходит перед изменением режима FormView элемента управления (для редактирования, вставки или только для чтения). Это событие часто используется для отмены изменения режима. |
| PageIndexChanged | Происходит при нажатии кнопки страничного навигатора, но после управления FormView обработает операцию разбиения на страницы. Это событие обычно используется, когда требуется выполнить задачу после перехода пользователя к другой записи в элементе управления. |
| PageIndexChanging | Происходит при нажатии кнопки страничного навигатора, но перед FormView управления обработает операцию разбиения на страницы. Это событие часто используется для отмены операции разбиения по страницам. |

## <a name="detailsview"></a>DetailsView

Элемент управления DetailsView используется для отображения одной записи из источника данных в таблице, где каждое поле записи отображается в строке таблицы. Он может использоваться в сочетании с элементом управления GridView для основной-подробности. Элемент управления DetailsView поддерживает следующие функции:

- Привязка к данным элементы управления источников, таких как SqlDataSource.
- Встроенные возможности вставки.
- Встроенные возможности обновления и удаления.
- Встроенные возможности разбиения на страницы.
- Программный доступ к модели объектов DetailsView, можно динамически задать свойства, обрабатывать события и т. д.
- Настройка внешнего вида с тем и стилей.

## <a name="row-fields"></a>Поля строк

Каждая строка данных в элементе управления DetailsView создается путем объявления в поле элемента управления. Разные типы полей определяют поведение строк в элементе управления. Элементы управления поля являются производными от DataControlField. Ниже перечислены типы полей различных строк, которые можно использовать.

| **Тип поля столбца** | **Описание** |
| --- | --- |
| BoundField | Отображает значение поля в источнике данных в виде текста. |
| ButtonField | Отображает кнопку в элементе управления DetailsView. Это позволяет отобразить строку с пользовательской кнопки элемента управления, например добавить или удалить кнопки. |
| CheckBoxField | Отображение флажка в элементе управления DetailsView. Данный тип поля строки обычно используется для отображения полей с логическими значениями. |
| CommandField | Отображает встроенные командные кнопки для выполнения изменения, вставки или удаления операций в элементе управления DetailsView. |
| HyperLinkField | Отображает значение поля в источнике данных как гиперссылку. Данный тип поля строки позволяет привязывать второе поле URL-адресу гиперссылки. |
| ImageField | Отображает изображение в элементе управления DetailsView. |
| TemplateField | Отображает пользовательское содержимое для строки в соответствии с указанным шаблоном элемента управления DetailsView. Данный тип поля строки позволяет создать настраиваемое поле строки. |

По умолчанию присвоено свойству AutoGenerateRows **true**, который автоматически создает объект поле строки с привязкой к для каждого поля, типа привязки в источнике данных. Допустимые типы привязки: строки, даты и времени, Decimal, Guid и набор типов-примитивов. Каждое поле отображается в строке, как текст, в том порядке, в котором они расположены в источнике данных.

Автоматическое генерирование строк обеспечивает быстрый и простой способ отображения каждого поля в записи. Тем не менее использовать DetailsView элемента управления расширенными возможностями, необходимо явно объявить поля строк, включаемых в элементе управления DetailsView. Чтобы объявить поля строк, сначала установите **AutoGenerateRows** свойства **false**. Добавьте открывающих и закрывающих  **&lt;поля&gt;**  теги между открывающим и закрывающим тегами элемента управления DetailsView. Наконец, список полей строк, которые требуется включить между открывающим и закрывающим  **&lt;поля&gt;**  тегов. Поля строки, указанные добавляются в коллекцию полей в указанном порядке. **Поля** коллекции дает возможность программно управлять поля строк в элементе управления DetailsView.

> [!NOTE]
> Автоматическое создание строки поля не добавляются к коллекции полей.


## <a name="binding-to-data"></a>Привязка к данным

Элемент управления DetailsView можно привязать к элементу управления источником данных, таких как **SqlDataSource** или AccessDataSource, или к любому источнику данных, который реализует интерфейс "System.Collections.IEnumerable", например System.Data.DataView, System.Collections.ArrayList и System.Collections.Hashtable.

Используйте один из следующих методов для привязки элемента управления DetailsView к соответствующему типу источника данных.

- Чтобы привязать элемент управления источником данных, присвойте свойству DataSourceID элемента управления DetailsView значение идентификатора элемента управления источником данных. Элемент управления DetailsView автоматически привязывается к системе управления версиями указанных данных. Это предпочтительный метод для привязки к данным.
- Для привязки к источнику данных, который реализует **System.Collections.IEnumerable** интерфейсов, программно задать свойства DataSource элемента управления DetailsView с источником данных и затем вызвать метод DataBind.

## <a name="security"></a>Безопасность

Этот элемент управления можно использовать для отображения введенных данных, в которых может содержаться вредоносный клиентский сценарий. Проверьте все сведения, которые отправляются от клиента для исполняемых сценариев, инструкций SQL и другого кода перед его отображения в приложении. ASP.NET предоставляет возможность проверки входного запроса с блокировкой сценариев и HTML вводимые пользователем данные.

## <a name="data-operations"></a>Операции с данными

Элемент управления DetailsView предоставляет встроенные возможности, позволяющие пользователям обновлять, delete, insert и постраничного просмотра элементов в элементе управления. При привязке элемента управления DetailsView к элементу управления источником данных, управления DetailsView можно воспользоваться преимуществами источника данных возможности элемента управления и предоставить автоматического обновления, удаления, вставки и разбиения по страницам.

Элемент управления DetailsView могут обеспечить поддержку для update, delete, insert и операции разбиения на страницы с другими типами источников данных; Тем не менее необходимо предоставить реализацию для выполнения этих операций в соответствующем обработчике событий.

Может автоматически добавлять элемент управления DetailsView **CommandField** поле строки с помощью кнопки изменять, удалять и создать, задав свойства AutoGenerateEditButton, AutoGenerateDeleteButton или AutoGenerateInsertButton для **true**соответственно. В отличие от удаления кнопку (которая удаляет выбранную запись немедленно), при нажатии кнопки, редактирования и создания, управления переходит в редактирования DetailsView режиме или вставки, соответственно. В режиме редактирования кнопка "Изменить" заменяется обновления и кнопку "Отмена". Элементы управления вводом, подходящие для типа данных поля (например, текстовое поле или элемент управления CheckBox) отображаются со значением поля для пользователя для изменения. Щелкнув кнопкой "Обновить" обновляет запись в источнике данных, при нажатии кнопки отмены отменяет все изменения. Аналогичным образом в режиме вставки, заменить новую кнопку "Вставить" и "Отмена" и элементы управления вводом отображаются для пользователя ввести значения для новой записи.

Элемент управления DetailsView предоставляет функции разбиения на страницы, которая позволяет пользователю переходить к другим записям в источнике данных. Если включено, элементы управления навигацией по странице отображаются в строку страничного навигатора. Чтобы включить разбиение на страницы, значение свойства AllowPaging **true**. С помощью свойства PagerStyle и PagerSettings можно настроить строку страничного навигатора.

## <a name="customizing-the-user-interface"></a>Настройка пользовательского интерфейса

Можно настроить внешний вид элемента управления DetailsView, задав свойства стиля для разных частей элемента управления. В следующей таблице перечислены различных свойств стиля.

| **Свойство стиля** | **Описание** |
| --- | --- |
| AlternatingRowStyle | Параметры стилей для чередующихся строк данных в элементе управления DetailsView. Если это свойство задано, строки данных отображаются переключаясь между RowStyle параметры и **AlternatingRowStyle** параметры. |
| CommandRowStyle | Параметры стиля для строки, содержащей встроенные кнопки в элементе управления DetailsView. |
| EditRowStyle | Параметры стиля для строк данных, когда элемент управления DetailsView находится в режиме редактирования. |
| EmptyDataRowStyle | Параметры стиля для пустой строки данных отображаются в элементе управления DetailsView, когда источник данных не содержит какие-либо записи. |
| FooterStyle | Параметры стиля для строки нижнего колонтитула в элементе управления DetailsView. |
| HeaderStyle | Параметры стиля для строки заголовка элемента управления DetailsView. |
| InsertRowStyle | Параметры стиля для строк данных, когда элемент управления DetailsView находится в режиме вставки. |
| PagerStyle | Параметры стиля для элемента управления DetailsView строку страничного навигатора. |
| RowStyle | Параметры стиля для строки данных в элементе управления DetailsView. Когда **AlternatingRowStyle** задается, строки данных отображаются переключаясь между **RowStyle** параметры и **AlternatingRowStyle** параметры. |
| FieldHeaderStyle | Параметры стиля для элемента управления DetailsView заголовка столбца. |

## <a name="events"></a>События

Элемент управления DetailsView предоставляет несколько событий, которые можно запрограммировать. Это позволяет запускать пользовательские процедуры при возникновении события. В следующей таблице перечислены события, поддерживаемые элементом управления DetailsView. Элемент управления DetailsView также наследует эти события из его базовых классов: привязки данных, с привязкой к данным, ликвидировать, Init, загрузки, PreRender и визуализации.

| **Event** | **Описание** |
| --- | --- |
| ItemCommand | Происходит при нажатии кнопки в элементе управления DetailsView. |
| ItemCreated | Происходит после создания всех объектов DetailsViewRow в элементе управления DetailsView. Это событие часто используется для изменения значения записи перед отображением. |
| ItemDeleted | Происходит при нажатии кнопки Delete, но после элемента управления DetailsView удаляет записи из источника данных. Это событие часто используется для проверки результатов операции удаления. |
| ItemDeleting | Происходит при нажатии кнопки Delete, но перед DetailsView управления удаляет записи из источника данных. Это событие часто используется для отмены операции удаления. |
| ItemInserted | Происходит при нажатии кнопки "Вставить", но после элемента управления DetailsView вставляет запись. Это событие часто используется для проверки результатов операции вставки. |
| ItemInserting | Происходит при нажатии кнопки "Вставить", но перед DetailsView запись вставляется элемент управления. Это событие часто используется для отмены операции вставки. |
| ItemUpdated | Происходит при нажатии кнопки "Обновить", но после элемента управления DetailsView обновляет строку. Это событие часто используется для проверки результатов операции обновления. |
| ItemUpdating | Происходит при нажатии кнопки "Обновить", но перед DetailsView управления обновляет запись. Это событие часто используется для отмены операции обновления. |
| ModeChanged | Происходит после элемента управления DetailsView изменяет режимы (изменения, вставки или только для чтения). Это событие часто используется для выполнения задач управления DetailsView изменения режимов. |
| ModeChanging | Происходит перед управления DetailsView изменяет режимы (изменения, вставки или только для чтения). Это событие часто используется для отмены изменения режима. |
| PageIndexChanged | Происходит при нажатии кнопки страничного навигатора, но после элемента управления DetailsView обработает операцию разбиения на страницы. Это событие обычно используется, когда требуется выполнить задачу после перехода пользователя к другой записи в элементе управления. |
| PageIndexChanging | Происходит при нажатии кнопки страничного навигатора, но перед DetailsView управления обработает операцию разбиения на страницы. Это событие часто используется для отмены операции разбиения по страницам. |

## <a name="the-menu-control"></a>Элемент управления меню

Элемент управления меню в ASP.NET 2.0 предназначен для системы полнофункциональный навигации. Это может быть связан с данными легко к источникам иерархических данных, например SiteMapDataSource.

Структуры элементов управления меню можно задать декларативно или динамически и состоит из одного корневого узла и любое количество вложенных узлов. В следующем коде определяется декларативно меню для элемента управления меню.

[!code-aspx[Main](data-bound-controls/samples/sample4.aspx)]

В приведенном выше примере Home.aspx узел является корневым узлом. Все остальные узлы вложены в корневой узел на различных уровнях.

Существует два типа меню, которые могут отображаться в элементе управления меню; статические и динамические меню. Статические меню состоят из меню, которые отображаются всегда. Динамические меню состоят из пунктов меню, которые видны только при наведении на них с помощью мыши. Клиенты могут часто путают статического меню с меню определяется декларативно и динамические меню с меню, которые являются с привязкой к данным во время выполнения. На самом деле динамических и статических меню не связаны с метод заполнения. Условия *статических* и *динамическое* ссылаться только ли меню статически отображаться по умолчанию или только отображается, если пользователь выполняет какие-либо действия.

**StaticDisplayLevels** свойство используется для настройки того, какое количество уровней меню, статический и поэтому отображается по умолчанию. В приведенном выше примере задание **StaticDisplayLevels** свойство и значение 2 для перевода в меню статически начальный узел, музыки узел и узел фильмов. Все остальные узлы динамически отображалось при наведении указателя мыши на родительский узел.

**MaximumDynamicDisplayLevels** свойства можно настроить максимальное число уровней динамического меню можно отобразить. Все динамические меню на уровень выше значения, указанного в **MaximumDynamicDisplayLevels** свойство отбрасываются.

> [!NOTE]
> Это почти наверняка, могут возникнуть ситуации, где меню не отображаются для подготовки к просмотру из-за свойства MaximumDynamicDisplayLevels. В таких случаях убедитесь, что свойство достаточно для отображения меню клиентов.


## <a name="data-binding-the-menu-control"></a>Привязка элемента управления Menu данных

Элемент управления меню можно привязать к любому источнику иерархических данных, например SiteMapDataSource или элемента управления XMLDataSource. SiteMapDataSource является наиболее широко используемым способом для привязки данных к элементу управления меню, так как веб-каналы из файла Web.sitemap и его схема предоставляет известных API-интерфейса для элемента управления меню. В следующем списке показан простой файл Web.sitemap.

[!code-xml[Main](data-bound-controls/samples/sample5.xml)]

Обратите внимание, что только один корневой элемент siteMapNode, таким образом, элемент «Home». Несколько атрибутов можно настроить для каждого siteMapNode. Ниже приведены наиболее часто используемые атрибуты.

- **URL-адрес** указывает URL-адрес для отображения, когда пользователь выбирает пункт меню. Если этот атрибут отсутствует, узел будет учитывать просто назад при нажатии.
- **Заголовок** текст, который отображается в элементе меню.
- **Описание** использовать в качестве документации для узла. Также отображается в подсказке при наведении курсора мыши над узлом.
- **siteMapFile** позволяет для вложенных карт. Этот атрибут должен указывать на корректный файл карты узла ASP.NET.
- **роли** позволяет управлять по ролям безопасности ASP.NET внешнего узла.

Обратите внимание, что хотя эти атрибуты являются необязательными, поведение меню может не иметь ожидаемого, если они не указаны. Например если *URL-адрес* атрибут указан, но *описание* атрибут не, этот узел не будет видимым и будет невозможно перейти к URL-адрес.

## <a name="controlling-a-menus-operation"></a>Управление операции меню

Существует несколько свойств, которые влияют на операции элемента управления меню ASP.NET; **Ориентация** свойства **DisappearAfter** свойства **StaticItemFormatString** свойство и **StaticPopoutImageUrl**свойства всего лишь некоторые из них.

- **Ориентация** можно задать либо *горизонтальной* или *вертикальной* и управляет ли пунктов статического меню упорядочивается по горизонтали в строке или по вертикали и с накоплением после друг с другом. Это свойство не влияет на динамические меню.
- **DisappearAfter** свойство настраивает длительность динамического меню всегда отображать после мышь не перемещен за его пределами. Значение указывается в миллисекундах и по умолчанию используется значение 500. Присвоение этому свойству значение -1 вызовет меню, чтобы никогда не удаляются автоматически. В этом случае меню только исчезнет, когда пользователь щелкает за пределами меню.
- **StaticItemFormatString** свойство позволяет легко поддерживать согласованность формулировки в системе меню. При указании этого свойства *{0}* следует ввести вместо описания, которое отображается в источнике данных. Например для элемента меню с Упражнение 1 say посетите наш страница "Продукты", т. д., можно указать посетите наш страницы для StaticItemFormatString {0}. Во время выполнения ASP.NET заменяет все вхождения {0} правильный описание для данного элемента меню.
- **StaticPopoutImageUrl** свойство задает изображения, которое используется для указания, что данное меню узел имеет дочерние узлы, к которым можно обращаться при наведении на него. Динамические меню будет продолжать использовать образ по умолчанию.

## <a name="templated-menu-controls"></a>Элементы управления шаблонного меню

Элемент управления меню шаблонного элемента управления и обеспечивает два различных элементов; StaticItemTemplate и DynamicItemTemplate. Используя эти шаблоны, вы можете легко добавлять серверных элементов управления или пользовательских элементов управления в меню.

Для правки шаблонов в Visual Studio .NET, нажмите кнопку меню смарт-тега, а затем выберите Редактирование шаблонов. Затем можно выбрать между редактирования StaticItemTemplate или DynamicItemTemplate.

При загрузке страницы, все элементы управления, добавленные StaticItemTemplate появится в статическом меню. Все элементы управления, добавленные DynamicItemTemplate будут отображаться все всплывающего меню.

## <a name="menu-events"></a>События меню

Элемент управления меню имеет два события, которые являются уникальными для него; **MenuItemClicked** и **MenuItemDatabound** событий.

Событие MenuItemClicked при выборе пункта меню. Событие MenuItemDatabound возникает в том случае, если элемент меню с привязкой к данным. **MenuEventArgs** , передаваемого на событие обработчика предоставляет доступ к пункту меню через свойство элемента.

## <a name="controlling-a-menus-appearance"></a>Управление внешним видом меню

Можно также изменять внешний вид элемента управления меню, используя один или несколько множество типов, доступных в меню Формат. В их число входят **StaticMenuStyle**, **DynamicMenuStyle**, **DynamicMenuItemStyle**, **DynamicSelectedStyle**и **DynamicHoverStyle**. Эти свойства настраиваются с помощью стандартной строки стиля HTML. Например следующие повлияет на стиль динамического меню.

[!code-aspx[Main](data-bound-controls/samples/sample6.aspx)]

> [!NOTE]
> Если вы используете какие-либо стили при наведении указателя мыши, необходимо добавить &lt;head&gt; элемент на веб-страницу *runat* элемента задано значение *сервера*.


Элементы управления меню также поддерживает использование тем в ASP.NET 2.0.

## <a name="the-treeview-control"></a>Элемент управления TreeView

TreeView-элемент управления отображает данные в древовидной структуре. Как и в меню элемента управления, его можно легко данными, привязанными к любому источнику иерархических данных, таких как SiteMapDataSource.

Часто непонятно, заказчики, скорее всего, для запроса об элементе управления TreeView в ASP.NET 2.0 ли она связана с WebControl IE TreeView, которая была доступна для ASP.NET 1.x. Нет. Элемент управления ASP.NET 2.0 TreeView был записан с нуля и обеспечивает значительное улучшение по сравнению TreeView WebControl IE, которые были доступны ранее.

Я не буду углубляться в подробности о том, как привязать элемент управления TreeView к карте узла, что выполняется точно так же, как элемент управления меню. Тем не менее элемент управления TreeView имеет некоторые уникальные отличия, тем, что он работает.

По умолчанию элемент управления TreeView отображается полностью развернутой. Чтобы изменить уровень разворачивания после начальной загрузки, изменить **ExpandDepth** свойству элемента управления. Это особенно важно в случаях, когда TreeView с привязкой к данным при развертывании узлов.

## <a name="databinding-the-treeview-control"></a>TreeView-элемент управления привязки данных

В отличие от меню элемента управления TreeView пригоден для обработки больших объемов данных. Таким образом в дополнение к привязка данных к SiteMapDataSource или XMLDataSource TreeView часто связывает данные с набора данных или других реляционных данных. В случаях, где TreeView-элемент управления привязан к больших объемов данных рекомендуется привязать только к данным, видимые в элементе управления. Затем можно привязать данные к дополнительным данным, как узлы в TreeView развертываются.

В этих случаях **PopulateOnDemand** TreeView должно быть присвоено *true*. Затем необходимо будет предоставить реализацию **TreeNodePopulate** метод.

## <a name="data-binding-without-postback"></a>Привязка без обратной передачи данных

Обратите внимание, что при разворачивании узла в предыдущем примере первая страница обратной и обновляет. Thats не проблема в этом примере, но можно себе представить, возможно, в рабочей среде с большим объемом данных. Сценарий, лучше будет одной в которой TreeView будет по-прежнему динамически заполнить его узлов, но без отправки обратно на сервер.

Установив **PopulateNodesFromClient** и **PopulateOnDemand** свойства в значение true, элемент управления ASP.NET TreeView будет динамически заполнять узлов без обратной передачи. Если родительский узел развернут, XMLHttp запрос от клиента и OnTreeNodePopulate событие. Сервер отправляет острова данных XML, который затем используется для данных привязать дочерние узлы.

ASP.NET динамически создает код клиента, который реализует эту функцию. &lt;Сценарий&gt; теги, которые содержат сценарий создаются AXD файл. Например в следующем списке показана ссылки скрипта для кода скрипта, который создает запрос XMLHttp.

[!code-html[Main](data-bound-controls/samples/sample7.html)]

Если при просмотре файла AXD выше в браузере, откройте его, вы увидите, что код, который реализует запрос XMLHttp. Этот метод предотвращает изменение файла скрипта для клиентов.

## <a name="controlling-the-operation-of-the-treeview-control"></a>Управление работой элемента управления TreeView

TreeView-элемент управления имеет несколько свойств, которые влияют на работу элемента управления. Наиболее очевидным свойства являются **ShowCheckBoxes**, **ShowExpandCollapse**, и **ShowLines**.

**ShowCheckBoxes** свойство влияет ли узлы отображения типа "флажок" при подготовке к просмотру. Допустимые значения для этого свойства: **нет**, **корневой**, **родительского**, **конечные**, и **все**. Эти влияют на элементе управления TreeView следующим образом:

| **Значение свойства** | **Эффект** |
| --- | --- |
| Нет | Флажки не отображаются ни на одном узле. Этот параметр используется по умолчанию. |
| корень | Флажок отображается только в корневом узле. |
| Родительский | Флажок отображается только на те узлы, которые могут иметь дочерних узлов. Эти дочерние узлы может быть родительским или конечные узлы. |
| Конечный | Флажок отображается только на те узлы, которые не имеют дочерних узлов. |
| Все | Флажок отображается на всех узлах. |

Если используются флажки **CheckedNodes** свойство будет возвращать набор узлов TreeView, которые проверяются после обратной передачи.

**ShowExpandCollapse** свойство управляет изображения развернуть/свернуть рядом с узлами корневой и родительской. Если это свойство имеет значение **false**, узлы в TreeView, преобразуются в гиперссылки и развернуть/свернуть, щелкнув ссылку.

**ShowLines** свойство управляет ли строки отображаются соединиться родительские узлы дочерних узлов. Когда **false** (по умолчанию), строки не отображаются. Когда **true**, TreeView-элемент управления будет использовать изображения линий в папке, указанной **LineImagesFolder** свойство.

Чтобы настроить внешний вид линий TreeView, Visual Studio .NET 2005 включает средство конструктора строки. Чтобы открыть это средство, с помощью кнопки смарт-тег на элементе управления TreeView как ниже.


![](data-bound-controls/_static/image1.jpg)

**Рис. 1**


Если флажок **настроить изображения линий** пункт меню будет запускаться конструктора строки которого можно настроить внешний вид линий TreeView.

## <a name="treeview-events"></a>События TreeView

TreeView-элемент управления имеет уникальный следующие события:

- SelectedNodeChanged происходит при выборе узла на основе **SelectAction** свойство.
- TreeNodeCheckChanged происходит, когда изменяется состояние checkboxs узлов.
- TreeNodeExpanded возникает, когда узел развернут на основе **SelectAction** свойство.
- TreeNodeCollapsed происходит при сворачивании узла.
- Граница TreeNodeDataBound происходит, когда узел данных.
- TreeNodePopulate возникает при заполнении узла.

**SelectAction** свойства можно настроить, какие события при выборе узла. Свойство SelectAction предоставляет следующие действия:

- TreeNodeSelectAction.Expand вызывает TreeNodeExpanded при выборе узла.
- TreeNodeSelectAction.None событие не при выборе узла.
- TreeNodeSelectAction.Select событие SelectedNodeChanged при выборе узла.
- TreeNodeSelectAction.SelectExpand вызывает SelectedNodeChanged события и события TreeNodeExpanded при выборе узла.

## <a name="controlling-appearance-with-styles"></a>Управление внешним видом со стилями

TreeView-элемент управления предоставляет множество свойств для управления внешний вид элемента управления с помощью стилей. Доступны следующие свойства.

| **Имя свойства** | **Элементы управления** |
| --- | --- |
| HoverNodeStyle | Определяет стиль узлов при наведении курсора мыши над ними. |
| LeafNodeStyle | Определяет стиль конечных узлов. |
| NodeStyle | Определяет стиль для всех узлов. Стили конкретного узла (например, LeafNodeStyle) переопределить этот стиль. |
| ParentNodeStyle | Определяет стиль для всех родительских узлов. |
| RootNodeStyle | Определяет стиль для корневого узла. |
| SelectedNodeStyle | Определяет стиль для выбранного узла. |

Каждое из этих свойств доступен только для чтения. Тем не менее, они будут каждого возвращаемого **TreeNodeStyle** объектов и свойств этого объекта можно изменить, используя *подсвойства свойства* формат. Например, чтобы задать **ForeColor** свойство **SelectedNodeStyle**, используется следующий синтаксис:

[!code-aspx[Main](data-bound-controls/samples/sample8.aspx)]

Обратите внимание, что выше тег не закрыт. Это, так как при использовании декларативного синтаксиса, показанные здесь, следует включить в HTML-код, а также узлов элементов TreeView.

В коде с помощью также можно задать свойства стиля *property.subproperty* формат. Например, чтобы задать **ForeColor** свойство **RootNodeStyle** в коде, можно использовать следующий синтаксис:

[!code-csharp[Main](data-bound-controls/samples/sample9.cs)]

> [!NOTE]
> Полный список различных свойств стиля см. в документации MSDN в объекте TreeNodeStyle.


## <a name="the-sitemappath-control"></a>Элемент управления SiteMapPath

Элемент управления SiteMapPath предоставляет элемент управления навигации навигации хлеб для разработчиков ASP.NET. Как и других элементов управления навигацией его можно легко данные, привязанные к иерархическим данным источников, таких как SiteMapDataSource или XmlDataSource.

Элемент управления SiteMapPath состоит из SiteMapNodeItem объектов. Существует три типа узлов; Корневой узел, родительские узлы и текущего узла. Корневой узел является узлом в верхней части иерархической структуры. Текущий узел представляет текущую страницу. Все остальные узлы являются родительских узлов.

## <a name="controlling-the-operation-of-the-sitemappath-control"></a>Управление работой элемента управления SiteMapPath

Свойства, управляющие работы элемента управления SiteMapPath выглядят следующим образом:

| **Свойство** | **Описание свойства** |
| --- | --- |
| ParentLevelsDisplayed | Определяет отображаемые сколько родительских узлов. Значение по умолчанию — -1, который налагает ограничения на количество отображаемых родительских узлов. |
| PathDirection | Определяет направление SiteMapPath. Допустимые значения: RootToCurrent (по умолчанию) и CurrentToRoot. |
| PathSeparator | Строка, которая определяет символ, разделяющий узлы в элементе управления SiteMapPath. Значение по умолчанию:. |
| RenderCurrentNodeAsLink | Логическое значение, управляющее того, является ли текущий узел отображается в виде ссылки. Значение по умолчанию — False. |
| SkipLinkText | Помогает специальных возможностей при просмотре страницы программами чтения с экрана. Это свойство позволяет пропустить управления SiteMapPath средства чтения с экрана. Чтобы отключить эту функцию, свойства значение String.Empty. |

## <a name="templated-sitemappath-controls"></a>Элементы управления SiteMapPath на основе шаблонов

SiteMapControl является шаблонный элемент управления, и таким образом, можно определить различные шаблоны для использования при отображении элемента управления. Для правки шаблонов в элементе управления SiteMapPath, нажмите кнопку смарт-тег на элементе управления и выберите в меню Правка шаблонов. Откроется меню SiteMapTasks, как показано ниже, где можно выбрать различные шаблоны, доступные.


![](data-bound-controls/_static/image2.jpg)

**Рис. 2**


**NodeTemplate** шаблона ссылается на любой узел в SiteMapPath. Если узел является корневым узлом, ни текущего узла и **RootNodeTemplate** или **CurrentNodeTemplate** будет настроена, NodeTemplate переопределяется.

## <a name="sitemappath-events"></a>События SiteMapPath

Элемент управления SiteMapPath имеет два события, которые не являются производными от класса элемента управления. **ItemCreated** событий и **ItemDataBound** событий. Событие ItemCreated возникает в том случае, когда создается элемент SiteMapPath. ItemDataBound возникает при вызове метода DataBind во время привязки данных SiteMapPath узла. Объект **SiteMapNodeItemEventArgs** предоставляет доступ к определенной SiteMapNodeItem через свойство элемента.

## <a name="controlling-appearance-with-styles"></a>Управление внешним видом со стилями

Для форматирования элемента управления SiteMapPath доступны следующие стили.

| **Имя свойства** | **Элементы управления** |
| --- | --- |
| CurrentNodeStyle | Определяет стиль текста для текущего узла. |
| RootNodeStyle | Определяет стиль текста для корневого узла. |
| NodeStyle | Определяет стиль текста для всех узлов, при условии, что CurrentNodeStyle или RootNodeStyle не применяется. |

Свойство NodeStyle переопределяется CurrentNodeStyle или RootNodeStyle. Каждое из этих свойств доступен только для чтения и возвращает **стиль** объекта. Влияет на внешний вид узла, с помощью одного из этих свойств, необходимо задать свойства объекта стиля, которое возвращается. Например приведенный ниже код изменяет свойства forecolor текущего узла.

[!code-aspx[Main](data-bound-controls/samples/sample10.aspx)]

Свойство также можно применить программным способом, как показано ниже:

[!code-csharp[Main](data-bound-controls/samples/sample11.cs)]

> [!NOTE]
> При применении шаблона стиля не применяются.


## <a name="lab-1-configuring-an-aspnet-menu-control"></a>Практическое занятие 1: Настройка элемента управления меню ASP.NET

1. Создайте новый веб-сайт.
2. Добавьте файл карты веб-узла, выбрав файл, создать, файл и выбрав карта сайта из списка шаблонов файлов.
3. Открытие карты сайта (Web.sitemap по умолчанию) и измените его, чтобы он выглядел ниже списка. Страницы, для которых создается ссылка в файле карты сайта действительно не существуют, однако, не будет проблемой для этого упражнения.

    [!code-xml[Main](data-bound-controls/samples/sample12.xml)]
4. Откройте веб-форму по умолчанию в режиме конструктора.
5. Добавьте новый элемент управления меню из области навигации панели элементов на страницу.
6. Добавьте Новый SiteMapDataSource раздел данных панели элементов. SiteMapDataSource автоматически будет использовать файл Web.sitemap сайта. (Файл Web.sitemap *должен* находиться в корневой папке сайта.)
7. Щелкните элемент управления меню и затем нажмите кнопку для отображения диалогового окна Задачи меню смарт-тега.
8. В раскрывающемся списке выберите источник данных выберите SiteMapDataSource1.
9. Щелкните ссылку Автоформат и выберите формат для меню.
10. В панели «Свойства» присвойте **StaticDisplayLevels** равным 2. Элемент управления меню должно отображаться узел Home, продуктов и служб в конструкторе.
11. Просмотреть страницу в браузере для использования в меню. (Так как страницы, можно хранить добавляются на карту сайта фактически не существует, вы увидите ошибку при попытке перейти к ним.)

Поэкспериментировать с изменением StaticDisplayLevels и MaximumDynamicDisplayLevels свойствами и их влияние на способ отображения меню в разделе.

## <a name="lab-2-dynamically-binding-a-treeview-control"></a>Лабораторное занятие 2: Динамическая привязка элемента управления TreeView

В этом упражнении предполагается наличие SQL Server, работающий локально и на экземпляре SQL Server, базы данных Northwind. Если эти условия не выполняются, измените строку подключения в образце. Обратите внимание, что также может потребоваться использовать проверку подлинности SQL Server вместо доверенного соединения.

1. Создайте новый веб-сайт.
2. Переключитесь в представление кода для Default.aspx и замените весь код и код, приведенный ниже. 

    [!code-aspx[Main](data-bound-controls/samples/sample13.aspx)]
3. Сохраните ее как treeview.aspx.
4. Просмотреть страницу.
5. При первом отображении страницы, просмотрите исходный код страницы в браузере. Обратите внимание, что только видимых узлов были отправлены клиенту.
6. Щелкните знак «плюс» рядом с любого узла.
7. Просмотр исходного кода на странице еще раз. Обратите внимание, что узлы вновь отображаемых сейчас.

## <a name="lab-3-details-view-and-editing-data-using-a-gridview-and-detailsview"></a>Лабораторное занятие 3: Дополнительные сведения об Просмотр и изменение данных с помощью GridView и DetailsView

1. Создайте новый веб-сайт.
2. Добавьте новый файл web.config веб-сайта.
3. Добавьте строку подключения в файле web.config, как показано ниже: 

    [!code-xml[Main](data-bound-controls/samples/sample14.xml)]

    > [!NOTE]
    > Может потребоваться изменить строку подключения, в зависимости от среды.
4. Сохраните изменения и закройте файл web.config.
5. Откройте страницу Default.aspx и добавьте новый элемент управления SqlDataSource.
6. Измените идентификатор элемента управления SqlDataSource для **продуктов**.
7. В **Задачи SqlDataSource** меню, нажмите кнопку **Настройка источника данных**.
8. Выберите **Northwind** в раскрывающемся списке, соединение и нажмите кнопку Далее.
9. Выберите **продуктов** из **имя** раскрывающийся список и проверьте **ProductID**, **ProductName**, **UnitPrice**, и **UnitsInStock** флажки, как показано ниже. 

![](data-bound-controls/_static/image3.jpg)

    **Figure 3**
10. Нажмите кнопку **Далее**.
11. Нажмите кнопку **Готово**.
12. Переключитесь в режим конструктора и изучите код, который был создан. Обратите внимание **SelectCommand**, **DeleteCommand**, **InsertCommand**, и **UpdateCommand** , были добавлены в SqlDataSource элемент управления. Кроме параметров, которые были добавлены.
13. Переключитесь в представление конструктора и добавьте новый элемент управления GridView к странице.
14. Выберите **продуктов** из **Выбор источника данных** раскрывающегося списка.
15. Проверьте **включить разбиение на страницы** и **разрешить выделение** как показано ниже. 

![](data-bound-controls/_static/image4.jpg)

    **Figure 4**
16. Нажмите кнопку **Правка столбцов** ссылку и убедитесь, что **автоматически создавать поля** проверяется.
17. Нажмите кнопку **ОК**.
18. С выбранным элементом управления GridView, нажмите кнопку рядом с **DataKeyNames** свойства в панели «Свойства».
19. Выберите **ProductID** из **доступные поля данных** списке и нажмите кнопку  **&gt;**  кнопку, чтобы добавить его.
20. Нажмите кнопку ОК.
21. Добавьте новый элемент управления SqlDataSource на страницу.
22. Измените идентификатор элемента управления SqlDataSource для **сведения**.
23. Выберите в меню Задачи SqlDataSource **Настройка источника данных**.
24. Выберите **Northwind** из раскрывающегося списка и нажмите кнопку **Далее**.
25. Выберите **продуктов** из **имя** раскрывающийся список и проверьте  **\***  флажок в **столбцы** listbox.
26. Нажмите кнопку **ГДЕ** кнопки.
27. Выберите **ProductID** из **столбца** раскрывающегося списка.
28. Выберите  **=**  в раскрывающемся списке оператор.
29. Выберите **управления** из **источника** раскрывающегося списка.
30. Выберите **GridView1** из **идентификатор элемента управления** раскрывающегося списка.
31. Нажмите кнопку **добавить** кнопку, чтобы добавить предложение WHERE.
32. Нажмите кнопку **ОК**.
33. Нажмите кнопку **Дополнительно** кнопку и проверьте **создать инструкции INSERT, UPDATE и DELETE инструкции** флажок.
34. Нажмите кнопку **ОК**.
35. Нажмите кнопку **Далее** и нажмите кнопку **Готово**.
36. Добавление элемента управления DetailsView на страницу.
37. В **Выбор источника данных** раскрывающийся список, выберите **сведения**.
38. Проверьте **Разрешить изменение** флажок, как показано ниже. 

![](data-bound-controls/_static/image1.gif)

    **Figure 5**
39. Сохраните страницу и найдите файл Default.aspx.
40. Нажмите кнопку **выберите** ссылку рядом с разных записей для просмотра в DetailsView обновления автоматически.
41. Нажмите кнопку **изменить** ссылки в элементе управления DetailsView.
42. Внесите изменения в запись и нажмите кнопку **обновление**.
