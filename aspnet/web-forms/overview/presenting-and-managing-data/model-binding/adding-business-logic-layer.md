---
uid: web-forms/overview/presenting-and-managing-data/model-binding/adding-business-logic-layer
title: Добавление бизнес-логики для проекта, использующего привязки модели и веб-форм | Документы Microsoft
author: tfitzmac
description: Этот учебник ряд демонстрирует основные аспекты использования привязки модели в проекте веб-форм ASP.NET. Привязка модели позволяет взаимодействия с данными дополнительные прямые-...
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/27/2014
ms.topic: article
ms.assetid: 7ef664b3-1cc8-4cbf-bb18-9f0f3a3ada2b
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/presenting-and-managing-data/model-binding/adding-business-logic-layer
msc.type: authoredcontent
ms.openlocfilehash: 25e887bdc316abf65c780bb6c8d075e938e85064
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="adding-business-logic-layer-to-a-project-that-uses-model-binding-and-web-forms"></a>Добавление бизнес-логики для проекта, использующего привязки модели и веб-форм
====================
по [Tom FitzMacken](https://github.com/tfitzmac)

> Этот учебник ряд демонстрирует основные аспекты использования привязки модели в проекте веб-форм ASP.NET. Привязка модели позволяет взаимодействия с данными более прост, чем работе с данными источника объектов (например, элемент управления ObjectDataSource или SqlDataSource). Эта серия начинается с вводный материал и перемещает на следующих занятиях рассматривается более сложных понятиях.
> 
> Этот учебник демонстрируется использование привязки модели с слой бизнес-логики. Необходимо задать элемент OnCallingDataMethods, чтобы указать, что объект, отличный от текущей странице используется для вызова методов работы с данными.
> 
> Этот учебник построен на проект, созданный в [более ранних](retrieving-data.md) части ряда.
> 
> Вы можете [загрузки](https://go.microsoft.com/fwlink/?LinkId=286116) весь проект C# или Visual Basic. Загружаемый код работает с Visual Studio 2012 или Visual Studio 2013. Она использует шаблон Visual Studio 2012, который немного отличается от шаблона Visual Studio 2013, показанными в данном руководстве.


## <a name="what-youll-build"></a>Мы создадим

Привязка модели позволяет помещать код взаимодействия данных в файл кода для веб-страницы или в класс отдельные бизнес-логики. Предыдущих учебниках показано, как использовать файлы кода для кода взаимодействия данных. Этот способ подходит для небольших сайтов, но он может привести к кода повторов и затруднение при поддержке больших сайта. Также может быть очень сложно программным путем тестирования кода, который находится в коде программной части файлов, так как нет уровень абстракции.

Для централизации кода взаимодействия данных, можно создать слой бизнес-логики, который содержит всю необходимую логику для взаимодействия с данными. Затем вызовите уровня бизнес-логики от веб-страниц. Этого учебника показано, как переместить весь код, написанный на предыдущих уроках в слой бизнес-логики, а затем использовать этот код из страниц.

В этом учебнике вы сможете:

1. Переместить код из файлов кода в слой бизнес-логики
2. Изменение элементов управления с привязкой к данным для вызова методов в бизнес-логики

## <a name="create-business-logic-layer"></a>Создание уровня бизнес-логики

Теперь необходимо создать класс, вызываемой из веб-страниц. Методы в этом классе выглядеть аналогично методах, использованных в предыдущих учебниках и включать атрибуты поставщика значения.

Сначала добавьте новую папку с именем **уровень бизнес-ЛОГИКИ**.

![Добавить папку](adding-business-logic-layer/_static/image1.png)

В папке уровень бизнес-ЛОГИКИ, создайте новый класс с именем **SchoolBL.cs**. Он содержит список всех операций с данными, которые первоначально находились в файлах кода. Методы схожих как методы в файле кода, но будет содержать некоторые изменения.

Наиболее важное изменение, следует отметить, — больше не выполняются в экземпляре код из **страницы** класса. Содержит класс страницы **TryUpdateModel** метод и **ModelState** свойство. Этот код был перемещен слой бизнес-логики, больше не нужна экземпляр класса страницы для вызова этих членов. Чтобы обойти эту проблему, необходимо добавить **ModelMethodContext** параметр с любым методом, который обращается к TryUpdateModel или ModelState. Этот параметр ModelMethodContext используется для вызова TryUpdateModel или получить ModelState. Необходимо вносит изменения в веб-страницы с учетом этого нового параметра.

Замените код в SchoolBL.cs следующим кодом.

[!code-csharp[Main](adding-business-logic-layer/samples/sample1.cs)]

## <a name="revise-existing-pages-to-retrieve-data-from-business-logic-layer"></a>Изменения существующих страниц для извлечения данных из уровня бизнес-логики

Наконец преобразование страниц Students.aspx, AddStudent.aspx и Courses.aspx с помощью запросов в файл кода с помощью бизнес-логики.

В файлах кода для учащихся, AddStudent и курсы удалите или закомментируйте следующие методы запроса:

- studentsGrid\_GetData
- studentsGrid\_UpdateItem
- studentsGrid\_DeleteItem
- addStudentForm\_InsertItem
- coursesGrid\_GetData

Теперь следует не имеется кода в файле кода, относящиеся к операции с данными.

**OnCallingDataMethods** обработчик событий можно указать объект, используемый для методов работы с данными. В Students.aspx добавьте значение для этого обработчика событий и измените имена методов работы с данными на имена методов в классе логику.

[!code-aspx[Main](adding-business-logic-layer/samples/sample2.aspx?highlight=3-4,8)]

В файле кода программной части для Students.aspx Определите обработчик событий для события CallingDataMethods. В этом обработчике событий задать классе логику для операций с данными.

[!code-csharp[Main](adding-business-logic-layer/samples/sample3.cs)]

В AddStudent.aspx внести соответствующие изменения.

[!code-aspx[Main](adding-business-logic-layer/samples/sample4.aspx?highlight=3-4)]

[!code-csharp[Main](adding-business-logic-layer/samples/sample5.cs)]

В Courses.aspx внести соответствующие изменения.

[!code-aspx[Main](adding-business-logic-layer/samples/sample6.aspx?highlight=3-4)]

[!code-csharp[Main](adding-business-logic-layer/samples/sample7.cs)]

Запустите приложение и обратите внимание, что все страницы работать так, как они имели ранее. Логика проверки также работает правильно.

## <a name="conclusion"></a>Заключение

В этом учебнике повторно структуру приложения для использования уровня доступа к данным и бизнес-логики. Вы указали, что элементы управления данными использовать объект, который не является текущей страницы для операций с данными.

> [!div class="step-by-step"]
> [Назад](using-query-string-values-to-retrieve-data.md)
