---
uid: web-forms/overview/presenting-and-managing-data/model-binding/retrieving-data
title: Извлечение и отображение данных с помощью модели привязки и веб-формы | Документы Microsoft
author: tfitzmac
description: Этот учебник ряд демонстрирует основные аспекты использования привязки модели в проекте веб-форм ASP.NET. Привязка модели позволяет взаимодействия с данными дополнительные прямые-...
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/27/2014
ms.topic: article
ms.assetid: 9f24fb82-c7ac-48da-b8e2-51b3da17e365
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/presenting-and-managing-data/model-binding/retrieving-data
msc.type: authoredcontent
ms.openlocfilehash: 26873efa5dbfdbdab39a52cfb9cfd5a65c8231a3
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30889099"
---
<a name="retrieving-and-displaying-data-with-model-binding-and-web-forms"></a>Извлечение и отображение данных с помощью привязки модели и веб-форм
====================
по [Tom FitzMacken](https://github.com/tfitzmac)

> Этот учебник ряд демонстрирует основные аспекты использования привязки модели в проекте веб-форм ASP.NET. Привязка модели позволяет взаимодействия с данными более прост, чем работе с данными источника объектов (например, элемент управления ObjectDataSource или SqlDataSource). Эта серия начинается с вводный материал и перемещает на следующих занятиях рассматривается более сложных понятиях.
> 
> Шаблон привязки «модель» работает с любой технологии доступа к данным. В этом руководстве используется Entity Framework, но может использовать технологии доступа к данным, который вам знакома. Из элемента управления с привязкой к данным сервера, например в элементе управления ListView, GridView, DetailsView или FormView укажите имена методов для выбора, обновления, удаления и создания данных. В этом учебнике будет задать значение для SelectMethod.
> 
> В этом методе предоставляют логику для получения данных. В следующем уроке будет устанавливать значения UpdateMethod и DeleteMethod InsertMethod.
> 
> Вы можете [загрузки](https://go.microsoft.com/fwlink/?LinkId=286116) весь проект C# или Visual Basic. Загружаемый код работает с Visual Studio 2012 или Visual Studio 2013. Она использует шаблон Visual Studio 2012, который немного отличается от шаблона Visual Studio 2013, показанными в данном руководстве.
> 
> В этом учебнике вы запустите приложение в Visual Studio. Вы можете также сделать приложение доступным через Интернет, развертывая ее поставщика услуг размещения. Корпорация Майкрософт предлагает бесплатные веб-размещения для до 10 веб-сайтов  
>  [освободить пробной учетной записи Azure](https://azure.microsoft.com/free/?WT.mc_id=A443DD604). Сведения о развертывании веб-проекта Visual Studio для веб-приложениях службы приложений Azure см. в разделе [ASP.NET веб-развертывания с помощью Visual Studio](../../deployment/visual-studio-web-deployment/introduction.md) рядов. Этот учебник также показано, как использовать Entity Framework Code First Migrations для развертывания базы данных SQL Server к базе данных SQL Azure.
> 
> ## <a name="software-versions-used-in-the-tutorial"></a>Версии программного обеспечения, используемая в этом учебнике
> 
> 
> - Microsoft Visual Studio 2013 или Microsoft Visual Studio Express 2013 для Web
>   
> 
> Этот учебник также работает с Visual Studio 2012, но некоторые отличия в пользовательский интерфейс и проекта шаблон.


## <a name="what-youll-build"></a>Мы создадим

В этом учебнике вы сможете:

1. Построить объекты данных, которые отражают университет с учащихся, зарегистрированных в курсов
2. Построение таблиц базы данных из объектов
3. Заполнить базу данных теста
4. Отображение данных в веб-формы

## <a name="set-up-project"></a>Настройка проекта

В Visual Studio 2013, создайте новый **веб-приложение ASP.NET** вызывается **ContosoUniversityModelBinding**.

![Создание проекта](retrieving-data/_static/image2.png)

Выберите шаблон веб-форм и оставьте значения по умолчанию. Нажмите кнопку ОК, чтобы проект установки.

![Выберите веб-форм](retrieving-data/_static/image3.png)

Во-первых вы сможете принять ряд небольшие изменения в настройки внешнего вида сайта. Откройте **Site.Master** файл и измените заголовок для включения университета Contoso вместо Мое приложение ASP.NET.

[!code-aspx[Main](retrieving-data/samples/sample1.aspx?highlight=1)]

Затем измените текст заголовка из **имя_приложения** для **университета Contoso**.

[!code-aspx[Main](retrieving-data/samples/sample2.aspx?highlight=7)]

Также в Site.Master, измените ссылки навигации, которое отображается в заголовке, чтобы отразить страниц, которые относятся к этому сайту. Вам не потребуется либо **о** страницы или **контакт** страницы, чтобы удалить эти ссылки. Вместо этого вам потребуется ссылку на страницу с именем **учащихся**. Эта страница не была создана ранее.

[!code-aspx[Main](retrieving-data/samples/sample3.aspx)]

Сохраните и закройте Site.Master.

Теперь вы создадите веб-формы для отображения данных учащихся. Щелкните правой кнопкой мыши проект, и **добавить** **новый элемент**. Выберите **веб-форма с главной страницы** шаблона и назовите его **Students.aspx**.

![Страница «Создание»](retrieving-data/_static/image5.png)

Выберите **Site.Master** как Главная страница для нового веб-формы.

## <a name="create-the-data-models-and-database"></a>Создание модели данных и базы данных

Code First Migrations будет использовать для создания объектов и соответствующие таблицы базы данных. Эти таблицы сохраняет информацию о студентов и их курсы.

В папку Models, добавьте новый класс с именем **UniversityModels.cs**.

![Создание класса модели](retrieving-data/_static/image7.png)

В этом файле определения классов SchoolContext, студентов, регистрации и курса следующим образом:

[!code-csharp[Main](retrieving-data/samples/sample4.cs)]

Класс SchoolContext является производным от DbContext, которой управляет подключения к базе данных и изменений в данных.

Обратите внимание класса Student, атрибуты, которые были применены к **FirstName**, **LastName**, и **год** свойства. Эти атрибуты будут использоваться для проверки данных в этом учебнике. Для упрощения кода для данного проекта демонстрации, только эти свойства были отмечены атрибуты проверки данных. В реальном проекте можно применить атрибуты проверки для всех свойств, которые требуются проверенные данные, такие как свойства в классах регистрации и курс.

Сохраните UniversityModels.cs.

Средства для миграции Code First будет использовать для настройки базы данных, основанные на этих классах.

В **консоль диспетчера пакетов**, выполните команду:  
`enable-migrations -ContextTypeName ContosoUniversityModelBinding.Models.SchoolContext`

Если успешного завершения команды вы получите сообщение о том, что включена миграции

![включить миграции](retrieving-data/_static/image8.png)

Обратите внимание, что новый файл с именем **Configuration.cs** был создан. В Visual Studio этот файл автоматически открывается после его создания. Содержит класс конфигурации **начальное значение** метод, который позволяет предварительно заполнить таблицы базы данных с тестовыми данными.

Добавьте следующий код в метод начальное значение. Вам потребуется добавить **с помощью** инструкции для **ContosoUniversityModelBinding.Models** пространства имен.

[!code-csharp[Main](retrieving-data/samples/sample5.cs)]

Сохраните Configuration.cs.

В консоли диспетчера пакетов выполните команду `add-migration initial`.

Выполните команду `update-database`.

Если получено исключение при выполнении этой команды, возможна значения идентификатором StudentID и CourseID изменяются в зависимости от значений в методе начальное значение. Откройте эти таблицы в базе данных и найдите существующие значения идентификатором StudentID и CourseID. Добавьте эти значения в код для заполнения таблицы регистраций.

Файл базы данных был добавлен, но в настоящее время он скрыт в проекте. Нажмите кнопку **Показать все файлы** для отображения файла.

![Показать все файлы](retrieving-data/_static/image10.png)

Появится MDF-файл в приложении\_папки данных.

![файл базы данных](retrieving-data/_static/image12.png)

Дважды щелкните файл MDF-файл и откройте в обозревателе сервера. Теперь существуют и таблицы заполняются данными.

![таблицы баз данных](retrieving-data/_static/image14.png)

## <a name="display-data-from-students-and-related-tables"></a>Отображение данных из связанных таблиц и студентов

С данными в базе данных теперь вы готовы для получения данных и его отображения на веб-странице. Вы воспользуетесь **GridView** элемента управления для отображения данных в столбцах и строках.

Откройте Students.aspx и найдите **тегу** заполнителя. Внутри заполнителей, добавьте **GridView** элемент управления, который включает следующий код.

[!code-aspx[Main](retrieving-data/samples/sample6.aspx)]

Существует несколько важных понятий в этом коде разметки, вам следует обратить внимание. Во-первых, обратите внимание, что значение установлено для **SelectMethod** свойства в элементе GridView. Это значение задает имя метода, который используется для получения данных для GridView. В следующем шаге вы создадите этот метод. Во-вторых, обратите внимание, что **ItemType** является свойство класса Student, которое было создано ранее. Если задать это значение, могут ссылаться на свойства этого класса в коде разметки. Например класс Student содержит коллекцию с именем регистраций. Можно использовать **Item.Enrollments** для извлечения этой коллекции и затем для получения суммы зарегистрированных кредиты для каждого студента с помощью синтаксиса LINQ.

В файле кода, необходимо добавить метод, указанный для **SelectMethod** значение. Откройте **Students.aspx.cs**и добавьте **с помощью** инструкции для **ContosoUniversityModelBinding.Models** и **System.Data.Entity**пространства имен.

[!code-csharp[Main](retrieving-data/samples/sample7.cs)]

Добавьте следующий метод. Обратите внимание, что имя этого метода совпадает с именем, предоставленные для SelectMethod.

[!code-csharp[Main](retrieving-data/samples/sample8.cs)]

**Include** предложение улучшает производительность запроса, но не является необходимым для запроса для работы. Без предложения Include данные будут извлечены с помощью отложенной загрузки, которая используется для отправки отдельный запрос к базе данных каждый раз, связанных с выборки данных. Предоставляя предложения Include, данные получаются с помощью упреждающую, что означает все связанные данные извлекаются с помощью одного запроса базы данных. В случаях, когда большая часть связанных данных не используется, и активная загрузка является менее эффективным, так как получить дополнительные данные. Однако в этом случае упреждающую обеспечивает наилучшую производительность поскольку взаимосвязанные данные отображаются для каждой записи.

Дополнительные сведения о вопросы производительности при загрузке связанных данных, см. раздел **Lazy Eager и явной загрузки связанных данных** в [чтение связанных данных с платформой Entity Framework в среде ASP Приложение .NET MVC](../../../../mvc/overview/getting-started/getting-started-with-ef-using-mvc/reading-related-data-with-the-entity-framework-in-an-asp-net-mvc-application.md) раздела.

По умолчанию данные отсортированы по значениям свойства помечен в качестве ключа. Можно добавить предложение OrderBy, чтобы указать другое значение для сортировки. В этом примере свойство по умолчанию идентификатором StudentID используется для сортировки. В [сортировка, разбиение по страницам и фильтрация данных](sorting-paging-and-filtering-data.md) разделе позволит пользователю выбрать столбец для сортировки.

Запустите веб-приложения и перейдите на страницу учащихся. Студенты страницы отображаются следующие сведения студента.

![Отображение данных](retrieving-data/_static/image16.png)

## <a name="automatic-generation-of-model-binding-methods"></a>Автоматическое создание методы привязки модели

При работе с этого учебника ряда, можно просто скопируйте код из учебника в проект. Недостаток этого подхода то, что вы может не распознать функции, предоставляемые Visual Studio, чтобы автоматически создавать код для методы привязки модели. При работе в собственных проектах, автоматическое создание кода может сэкономить время и получить представление о том, как реализовать операцию. Этот раздел описывает функцию создания кода. В этом разделе информационное и не содержит любой код, необходимо реализовать в своем проекте.

При установке значения для **SelectMethod**, **UpdateMethod**, **InsertMethod**, или **DeleteMethod** свойства в коде разметки можно выбрать **создайте новый метод** параметр.

![Создайте новый метод](retrieving-data/_static/image18.png)

Visual Studio не только создает метод в коде с правильной подписью, но также создает код реализации для упрощения выполнения операции. Если сначала установить **ItemType** свойство перед использованием функции создания кода, созданный код будет использовать этот тип для операции. Например при задании свойства UpdateMethod, автоматически создается следующий код:

[!code-csharp[Main](retrieving-data/samples/sample9.cs)]

Опять же приведенный выше код не добавлен в проект. В следующем уроке будет реализовывать методы для обновления, удаления и добавления новых данных.

## <a name="conclusion"></a>Заключение

В этом учебнике вы создания классы модели данных и формирования базы данных из этих классов. Таблицы базы данных, заполненный тестовых данных. Используется привязка модели для получения данных из базы данных и затем отображаются данные в элементе управления GridView.

В следующем [учебника](updating-deleting-and-creating-data.md) этой серии будет включить обновление, удаление и создание данных.

> [!div class="step-by-step"]
> [Вперед](updating-deleting-and-creating-data.md)
