---
uid: web-forms/overview/getting-started/code-editing-in-web-forms-pages
title: "Редактирование кода веб-форм ASP.NET в Visual Studio 2013 | Документы Microsoft"
author: Erikre
description: 
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/03/2014
ms.topic: article
ms.assetid: 5344b74e-b888-479a-92bc-601a33bd61a2
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/getting-started/code-editing-in-web-forms-pages
msc.type: authoredcontent
ms.openlocfilehash: 8714f673cb0434189ca23d2dda14035d8652a051
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2018
---
<a name="code-editing-aspnet-web-forms-in-visual-studio-2013"></a>Код редактирования веб-форм ASP.NET в Visual Studio 2013
====================
По [Эрик Reitan](https://github.com/Erikre)

Во многих страницах веб-форма ASP.NET код пишется в Visual Basic, C# или другого языка. Редактор кода в Visual Studio может помочь быстро написать код и избежать ошибок. Кроме того редактор предоставляет способ создания многократно используемого кода позволяет снизить объем работы, которую необходимо выполнить.

В этом пошаговом руководстве показаны различные возможности в редакторе кода Visual Studio.

В этом пошаговом руководстве описаны следующие процедуры.

- Правильный встроенные ошибки в коде.
- Оптимизировать и переименовывать код.
- Переименуйте переменные и объекты.
- Вставка фрагментов кода.

## <a name="prerequisites"></a>Предварительные требования


Для выполнения данного пошагового руководства требуется:

- [Microsoft Visual Studio 2013](https://www.microsoft.com/visualstudio/11/downloads#vs) или [Microsoft Visual Studio Express 2013 для Web](https://www.microsoft.com/visualstudio/11/downloads#express-web). Платформа .NET Framework устанавливается автоматически. 

    > [!NOTE] 
    > 
    > Microsoft Visual Studio 2013 и Microsoft Visual Studio Express 2013 для Web будет часто называться Visual Studio на протяжении этого учебника ряда.  
    >   
    > При использовании Visual Studio это пошаговое руководство предполагает, что выбрана **веб-разработки** набор параметров при первом запуске Visual Studio. Дополнительные сведения см. в разделе [как: выберите параметры среды веб-разработки](https://msdn.microsoft.com/library/ff521558.aspx).

 Введение в Visual Studio и ASP.NET, в разделе [Создание базовой страницы веб-форм ASP.NET 4.5 в Visual Studio 2013](creating-a-basic-web-forms-page.md).   
 

## <a name="creating-a-web-application-project-and-a-page"></a>Создание проекта веб-приложения и страницы

<a id="sectionToggle0"></a>

В этой части пошагового руководства будет создать проект веб-приложения и добавление новой страницы.

### <a name="to-create-a-web-application-project"></a>Чтобы создать проект веб-приложения

1. Откройте Microsoft Visual Studio.
2. В меню **Файл** выберите **Создать проект**.  
    ![Меню "файл"](code-editing-in-web-forms-pages/_static/image1.png)

    Откроется диалоговое окно **Новый проект** .
3. Выберите **шаблоны**  - &gt; **Visual C#**  - &gt; **Web** группа шаблонов в левой части экрана.
4. Выберите **веб-приложение ASP.NET** шаблона в центральном столбце.
5. Присвойте проекту имя ***BasicWebApp*** и нажмите кнопку **ОК** кнопки.   
![Диалоговое окно нового проекта](code-editing-in-web-forms-pages/_static/image2.png)
6. Затем выберите **Web Forms** шаблона и нажмите кнопку **ОК** кнопку, чтобы создать проект.  
![Диалоговое окно Новый проект ASP.NET](code-editing-in-web-forms-pages/_static/image3.png)  

    Visual Studio создает новый проект, включающий стандартные функциональные возможности на основе шаблона веб-форм.


## <a name="creating-a-new-aspnet-web-forms-page"></a>Создание нового страница веб-форм ASP.NET


При создании нового приложения веб-форм с помощью **веб-приложение ASP.NET** шаблон проекта Visual Studio добавляет страницы ASP.NET (страницы веб-форм) с именем *Default.aspx*, также как несколько файлов и папки. Можно использовать *Default.aspx* страницу в качестве домашней страницы для веб-приложения. Однако в данном пошаговом руководстве будет создать и работать с новой страницы.

### <a name="to-add-a-page-to-the-web-application"></a>Добавление страницы в веб-приложение


1. В **обозревателе решений**, щелкните правой кнопкой мыши имя веб-приложения (в этом учебнике, имя приложения — **BasicWebSite**), а затем нажмите кнопку **добавить**  - &gt; **Новый элемент**.   
Откроется диалоговое окно **Добавление нового элемента**.
2. Выберите **Visual C#**  - &gt; **Web** группа шаблонов в левой части экрана. Выберите **веб-форму** из середины списка и назовите его *FirstWebPage.aspx*.   
    ![Добавить новый элемент-диалоговое окно](code-editing-in-web-forms-pages/_static/image4.png)
3. Нажмите кнопку **добавить** Добавление страницы веб-формы в проект.  
 Visual Studio создаст новую страницу и открывает его.
4. Затем задайте этой новой странице в качестве стартовой страницы по умолчанию. В **обозревателе решений**, щелкните правой кнопкой мыши новую страницу с именем *FirstWebPage.aspx* и выберите **задать в качестве начальной страницы**. При очередном запуске этого приложения, чтобы проверить ход работы, автоматически появится эта новая страница в браузере.


## <a name="correcting-inline-coding-errors"></a>Исправление ошибки в коде встроенной


Редактор кода в Visual Studio помогает избежать ошибок при написании кода и при внесении ошибки редактор кода позволяет исправить ошибку. В этой части пошагового руководства вы напишете строку кода, иллюстрирующие возможности исправления ошибок в редакторе.

### <a name="to-correct-simple-coding-errors-in-visual-studio"></a>Исправление ошибок простого кода в Visual Studio


1. В **разработки** дважды щелкните пустую страницу, чтобы создать обработчик для **нагрузки** событий для страницы.   
Обработчик событий используется только как место для написания кода.
2. В обработчике, введите следующую строку, которая содержит ошибку и нажмите клавишу **ввод**:

    [!code-csharp[Main](code-editing-in-web-forms-pages/samples/sample1.cs)]

 При нажатии клавиши **ввод**, редактор кода помещает зеленый и красное подчеркивание (часто вызывать &quot;волнистая&quot; строки) в группе областей в коде, имеющие проблемы. Предупреждение о зеленой линией. Красная линия указывает, необходимо исправить ошибки. 

    Наведите указатель мыши на `myStr` чтобы увидеть подсказку, информирующее о предупреждении. Кроме того можно навести указатель мыши на красной линией, чтобы просмотреть сообщение об ошибке.

    Ниже приведен код с подчеркивание.

    ![Текст приветствия в режиме конструктора](code-editing-in-web-forms-pages/_static/image5.png "текст приветствия в режиме конструктора")  
 Ошибка должна быть исправлена путем добавления запятой `;` до конца строки. Предупреждение просто уведомляет вы не использовали `myStr` еще переменной.  

    > [!NOTE] 
    > 
    > Просмотреть текущий код форматирования параметров в Visual Studio, выбрав **средства**  - &gt; **параметры**  - &gt; **шрифты и Цвета**.


## <a name="refactoring-and-renaming"></a>Оптимизация кода и переименование

Рефакторинг — программным методом, включающим реструктуризацию кода, чтобы сделать проще для понимания и обслуживания, сохраняя его функциональность. Простой пример может быть писать код в обработчик событий для получения данных из базы данных. При разработке на странице, вы обнаружите, требуется доступ к данным из нескольких разных обработчиков. Таким образом путем создания метода доступа к данным на странице и вставка вызовы метода в обработчиках рефакторинга кода страницы.

Редактор кода включает средства, которые помогают выполнять различные задачи оптимизации кода. В этом пошаговом руководстве будет работать два метода оптимизации кода: переименование переменных, а также методы извлечения. Другие параметры оптимизации кода включают инкапсуляцию полей, превращение локальных переменных в параметры метода и управление параметрами метода. Доступность этих параметров оптимизации зависит от местоположения в коде.

### <a name="refactoring-code"></a>Рефакторинг кода

Обычным сценарием оптимизации кода является создание (извлечение) метода из кода, который находится внутри другого элемента, например, метода. Это уменьшает размер исходного элемента и делает извлеченного кода для повторного использования.

В этой части пошагового руководства будет написан простой код и затем извлечь метод из него. Оптимизация кода поддерживается для C#, поэтому вы создадите страницы, который используется в качестве языка программирования C#.

### <a name="to-extract-a-method-in-a-c-page"></a>Извлечение метода на странице C#

1. Переключитесь в **разработки** представления.
2. В **элементов**, из **Стандартная** вкладки, перетащите [кнопку](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.aspx) на страницу.
3. Дважды щелкните **кнопку** управления, чтобы создать обработчик для его [нажмите кнопку](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.click.aspx) события, а затем добавьте следующий выделенный код:

    [!code-csharp[Main](code-editing-in-web-forms-pages/samples/sample2.cs?highlight=3-16)]

 Код создает **ArrayList** использует цикл для загрузки его со значениями объекта и затем использует другой цикл для отображения содержимого **ArrayList** объекта.
4. Нажмите клавишу **CTRL + F5** для запуска страницы и нажмите кнопку **кнопку** чтобы убедиться в том, что можно увидеть следующие результаты:   

    [!code-html[Main](code-editing-in-web-forms-pages/samples/sample3.html)]
5. Вернуться в редактор кода, а затем выберите следующие строки в обработчике событий.   

    [!code-html[Main](code-editing-in-web-forms-pages/samples/sample4.html)]
6. Правой кнопкой мыши щелкните **рефакторинг**, а затем выберите **извлечение метода**. 

    **Извлечение метода** откроется диалоговое окно.
7. В **имя нового метода** введите **DisplayArray**, а затем нажмите кнопку **ОК**. 

    Редактор кода создаст новый метод с именем `DisplayArray`и помещает в новый метод в вызов **щелкните** обработчика, где изначально находился цикл.

    [!code-csharp[Main](code-editing-in-web-forms-pages/samples/sample5.cs?highlight=12)]
8. Нажмите клавишу **CTRL + F5** снова запустить страницу, а затем нажмите кнопку **кнопку**.

    Страница работает так же, как раньше. `DisplayArray` Метод теперь может быть вызов из любого места в классе страницы.

## <a name="renaming-variables"></a>Переименование переменных

При работе с переменными, а также объекты, можно переименовать их после уже заданы в коде. Тем не менее переименование, переменные и объекты может вызвать код нарушиться, если будет пропущено переименование одной из ссылок. Таким образом можно использовать оптимизацию кода для выполнения переименования.

### <a name="to-use-refactoring-to-rename-a-variable"></a>Использование рефакторинга для переименования переменной


1. В **щелкните** обработчика событий, найдите следующую строку:

    [!code-csharp[Main](code-editing-in-web-forms-pages/samples/sample6.cs)]
2. Щелкните правой кнопкой мыши имя переменной `alist`, выберите **рефакторинг**, а затем выберите **переименование**.

    **Переименование** откроется диалоговое окно.
3. В **новое имя** введите **ArrayList1** и убедитесь, что **Предварительный просмотр изменений ссылок** установлен флажок. Затем нажмите кнопку **ОК**.

    **Просмотр изменений** диалоговое окно отображается, а отображается дерево, содержащее все ссылки на переменную, которая выполняется переименование.
4. Нажмите кнопку **применить** закрыть **Просмотр изменений** диалоговое окно.

    Переменные, которые ссылаются специально для выбранного экземпляра будут переименованы. Обратите внимание, что переменная `alist` в следующей строке, не переименовывается.

    [!code-csharp[Main](code-editing-in-web-forms-pages/samples/sample7.cs)]

    Переменная `alist` в этой строке не переименован, поскольку он не представляет то же значение, что и переменная `alist` , был переименован. Переменная `alist` в `DisplayArray` объявление является локальной переменной для этого метода. Это показывает, что с помощью рефакторинга для переименования переменные отличается от простого действия поиска и замены в редакторе. Рефакторинг переименовывает переменные с переменной, которой он работает с учетом семантики.


## <a name="inserting-snippets"></a>Вставка фрагментов кода

Поскольку существует много задач кодирования, которые часто возникает необходимость выполнить разработчики веб-форм, редактор кода предоставляет библиотеку фрагментов, или блоков предварительно написанного кода. Эти фрагменты кода можно вставить в страницу.

Каждый язык, используемый в Visual Studio имеет небольшие различия в способе вставки фрагментов кода. Сведения о вставке фрагментов см. в разделе [фрагментов кода Visual Basic](https://msdn.microsoft.com/library/18yz4be4.aspx). Сведения о вставке фрагментов кода в Visual C# см. в разделе [фрагменты кода Visual C#](https://msdn.microsoft.com/library/z41h7fat.aspx).

## <a name="next-steps"></a>Следующие шаги

В этом пошаговом руководстве показаны базовые возможности редактора кода Visual Studio 2010 для исправления ошибок в коде, рефакторинга кода, переименование переменных и вставки фрагментов кода в код. Дополнительные возможности в редакторе можно сделать и ускорить разработку приложений. Например, можно сделать следующее:

- Дополнительные сведения о возможностях IntelliSense, таких как изменение параметров IntelliSense, управление фрагментами кода и поиск фрагментов кода в Интернете. Дополнительные сведения см. в статье [Using IntelliSense](https://msdn.microsoft.com/library/hcw1s69b.aspx) (Использование IntelliSense).
- Научитесь создавать собственные фрагменты кода. Дополнительные сведения см. в разделе [Создание и использование фрагментов кода IntelliSense](https://msdn.microsoft.com/library/ms165392.aspx)
- Дополнительные сведения о функциях языка Visual Basic фрагменты кода IntelliSense, таких как настройка фрагментов и устранение неполадок. Дополнительные сведения см. в разделе [фрагменты кода IntelliSense в Visual Basic](https://msdn.microsoft.com/library/18yz4be4.aspx)
- Дополнительные сведения о C#-отдельных функций IntelliSense, таких как рефакторинга и фрагментов кода. Дополнительные сведения см. в разделе [IntelliSense для Visual C#](https://msdn.microsoft.com/library/43f44291.aspx).
