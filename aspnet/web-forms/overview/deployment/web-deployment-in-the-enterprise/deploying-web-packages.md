---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/deploying-web-packages
title: Развертывание веб-пакеты | Документы Microsoft
author: jrjlee
description: В этом разделе описывается, как публиковать веб-развертывания пакетов на удаленный сервер, используя средство Internet Information Services (IIS) веб-развертывания (Web...
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/04/2012
ms.topic: article
ms.assetid: a5c5eed2-8683-40a5-a2e1-35c9f8d17c29
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/deploying-web-packages
msc.type: authoredcontent
ms.openlocfilehash: 5d3af0fdcc6e7ae20194ba658e0cf72ad22c1234
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30887507"
---
<a name="deploying-web-packages"></a>Развертывание веб-пакеты
====================
по [Джейсон Lee](https://github.com/jrjlee)

[Скачать PDF](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> В этом разделе описывается, как публиковать веб-развертывания пакетов на удаленный сервер, используя средство Internet Information Services (IIS) веб-развертывания (Web Deploy) 2.0.
> 
> Существует два основных способа, в которых можно развернуть веб-пакет на удаленном сервере:
> 
> - Можно использовать служебную программу командной строки MSDeploy.exe напрямую.
> - Можно запустить *.deploy.cmd [имя проекта]* файл, создаваемый в процессе построения.
> 
> В результате одинаково независимо от того, какой подход использовать. По существу, все *. deploy.cmd* файл заключается в запуске MSDeploy.exe с некоторые предварительно определенные значения, чтобы не нужно предоставлять гораздо меньше сведений для развертывания пакета. Это упрощает процесс развертывания. С другой стороны использование MSDeploy.exe непосредственно предоставляет гораздо большую гибкость по точно способа развертывания пакета.
> 
> Подходов зависит от множества факторов, включая степени контроля, требующим через процесс развертывания и ли целевой службы агента веб-развертывания удаленных или веб-развертывания обработчик. В этом разделе объясняется, как использовать оба этих подхода и определяет, когда каждый подход лучше всего подходит.
> 
> Задачи и пошаговые руководства в этом разделе предполагается, что:
> 
> - После построения и упаковки вашего веб-приложения, как описано в [построения и упаковки проектов веб-приложений](building-and-packaging-web-application-projects.md).
> - Измененный *SetParameters.xml* файл для предоставления правильных параметров для целевой среды, как описано в [Настройка параметров для пакета развертывания веб-](configuring-parameters-for-web-package-deployment.md).


Запуск [*имя проекта*]*. deploy.cmd* файл является самым простым способом развертывания веб-пакета. В частности, использование *. deploy.cmd* файл обеспечивает следующие преимущества по сравнению с использованием MSDeploy.exe напрямую:

- Укажите расположение пакета веб-развертывания не требуется&#x2014; *. deploy.cmd* файла уже известен, где он находится.
- Не требуется задать расположение *SetParameters.xml* файл&#x2014; *. deploy.cmd* файла уже известен, где он находится.
- Не требуется для указания источника и назначения поставщиков MSDeploy&#x2014; *. deploy.cmd* файла уже известно, какие значения следует использовать.
- Не нужно указать параметры операции MSDeploy&#x2014; *. deploy.cmd* файла добавляет значения часто требуется команда MSDeploy.exe автоматически.

Прежде чем использовать *. deploy.cmd* файл для развертывания веб-пакет, следует убедиться, что:

- *. Deploy.cmd* файла [*имя проекта*]. *SetParameters.xml* файл и веб-пакета ([*имя проекта*]. *Почтовый*) находятся в той же папке.
- На компьютере, на котором установлен Web Deploy (MSDeploy.exe) *. deploy.cmd* файла.

*. Deploy.cmd* файл поддерживает различные параметры командной строки. При запуске файла из командной строки, это базовый синтаксис:


[!code-console[Main](deploying-web-packages/samples/sample1.cmd)]


Необходимо указать либо **/t** флаг или **/Y** флаг для указания, нужно ли выполнять запуск пробной версии или динамической развертывания соответственно (не используйте обоих флагов в одной команде). В следующей таблице показано назначение каждой из этих флагов.

| Flag | Описание |
| --- | --- |
| **/T** | Вызывает MSDeploy.exe с **– whatif** флаг, указывающий запуска пробной версии. Вместо развертывания пакета, он создает отчет о том, что может произойти, если развертывание было выполнено пакета. |
| **/Y** | Вызывает MSDeploy.exe без **– whatif** флаг. Это развертывает пакет на локальном компьютере или указанный целевой сервер. |
| **/M** | Указывает конечный сервер имя или URL-адрес службы. Дополнительные сведения о значениях, здесь можно указать в разделе **вопросы конечной точки** в этой статье. Если не указан **/m** флаг, пакет будет развернут на локальном компьютере. |
| **/A** | Указывает тип проверки подлинности, который MSDeploy.exe следует использовать для выполнения развертывания. Возможными значениями являются **NTLM** и **основные**. Если не указан **/A** флаг, тип проверки подлинности по умолчанию **NTLM** для развертывания на службу агента веб-развертывания удаленных и **основные** для развертывания на веб-развертывания Обработчик. |
| **/U** | Указывает имя пользователя. Это применяется только в том случае, если используется обычная проверка подлинности. |
| **/P** | Задает пароль. Это применяется только в том случае, если используется обычная проверка подлинности. |
| **/L** | Указывает развертывания пакета для локального экземпляра IIS Express. |
| **/G** | Указывает, что пакет развертывается с помощью [параметр поставщика tempAgent](https://technet.microsoft.com/library/ee517345(WS.10).aspx). Если не указан **/G** флаг, используется значение по умолчанию **false**. |

> [!NOTE]
> Каждый раз при сборке создаются веб-пакет, он также создает файл с именем *[имя проекта] .deploy-readme.txt* с объяснением эти варианты развертывания.


Помимо эти флаги можно указать параметры операции веб-развертывания в качестве дополнительных *. deploy.cmd* параметров. Любые дополнительные параметры, указываемые просто передается для базовой команды MSDeploy.exe. Дополнительные сведения об этих параметрах см. в разделе [веб-развертывание параметров операции](https://technet.microsoft.com/library/dd569089(WS.10).aspx).

Предположим, что вы хотите развернуть проект ContactManager.Mvc веб-приложения в тестовой среде, запустив *. deploy.cmd* файла. Использовать службу агента веб-развертывания удаленных настроен тестовой среды, как описано в [Настройка веб-сервера для веб-развертывания публикации (удаленный агент)](../configuring-server-environments-for-web-deployment/configuring-a-web-server-for-web-deploy-publishing-remote-agent.md). Чтобы развернуть веб-приложение, необходимо выполнить следующие шаги.

**Для развертывания веб-приложения с использованием. cmd-файл**

1. Выполните сборку и упаковку проекта веб-приложения, как описано в [построения и упаковки проектов веб-приложений](building-and-packaging-web-application-projects.md).
2. Изменить *ContactManager.Mvc.SetParameters.xml* файл, содержащий правильные значения параметров для тестовой среды, как описано в [Настройка параметров для пакета развертывания веб-](configuring-parameters-for-web-package-deployment.md).
3. Откройте окно командной строки и перейдите к расположению *ContactManager.Mvc.deploy.cmd* файла.
4. Введите следующую команду и нажмите клавишу ВВОД:

    [!code-console[Main](deploying-web-packages/samples/sample2.cmd)]

В этом примере:

- **/Y** флаг указывает, требуется фактическое развертывание пакета, а не выполнить это на пробную версию.
- **/M** флаг указывает, что вы хотите развернуть пакет на сервере с именем TESTWEB1. По этому значению MSDeploy.exe будет предпринята попытка развернуть пакет на службу агента веб-развертывания удаленного http://TESTWEB1/MSDeployAgentService.
- **/A** флаг указывает, что используется проверка подлинности NTLM. Таким образом не нужно указывать имя пользователя и пароль.

Чтобы проиллюстрировать том, каким образом *. deploy.cmd* файл упрощает процесс развертывания, взгляните на MSDeploy.exe команду, которая получает создаваться и выполняться при запуске *ContactManager.Mvc.deploy.cmd* используя параметры, приведенные выше.


[!code-console[Main](deploying-web-packages/samples/sample3.cmd)]


Дополнительные сведения об использовании *. deploy.cmd* файл, чтобы развернуть веб-пакет см. в разделе [как: установка, развертывание пакета с помощью deploy.cmd файл](https://msdn.microsoft.com/library/ff356104.aspx).

## <a name="using-msdeployexe"></a>С помощью MSDeploy.exe

Хотя использование *. deploy.cmd* файла, как правило, упрощает процесс развертывания, существуют ситуации, когда предпочтительнее использовать MSDeploy.exe напрямую. Пример:

- Если вы хотите развернуть на веб-развертывания обработчик как пользователь без прав администратора, нельзя использовать *. deploy.cmd* файла. Это вызвано ошибкой в Web Deploy 2.0, как описано в разделе **вопросы конечной точки**.
- Если вы хотите вручную переключиться между различными *SetParameters.xml* файлы в разных местах, можно напрямую использовать MSDeploy.exe.
- Если вы хотите переопределить несколько MSDeploy.exe командной строки, можно напрямую использовать MSDeploy.exe.

При использовании MSDeploy.exe необходимо указать три основных элемента информации:

- Объект **— источник** параметр, указывающий, где будут поступать данные из.
- Объект **— dest** параметр, указывающий, где будет данных.
- Объект **— команда** параметр, указывающий [операции](https://technet.microsoft.com/library/dd568989(WS.10).aspx) требуется выполнить.

Использует MSDeploy.exe [поставщики веб-развертывания](https://technet.microsoft.com/library/dd569040(WS.10).aspx) для обработки данных источника и назначения. Веб-развертывания включает множество поставщиков, которые представляют диапазон приложений и источников данных, она может работать с&#x2014;например, существуют поставщики для баз данных SQL Server, веб-серверы IIS, сертификаты, сборки глобальный кэш СБОРОК, различные различные файлы конфигурации и множество других типов данных. Оба **— источник** параметр и **— dest** параметра необходимо указать поставщика, в форме **— источник**: [*providerName*] = [*расположение*]. При развертывании веб-пакета на веб-сайт IIS, следует использовать следующие значения:

- **— Источник** всегда является поставщик [пакета](https://technet.microsoft.com/library/dd569019(WS.10).aspx). Пример:

    [!code-console[Main](deploying-web-packages/samples/sample4.cmd)]
- **— Dest** всегда является поставщик [автоматически](https://technet.microsoft.com/library/dd569016(WS.10).aspx). Пример:

    [!code-console[Main](deploying-web-packages/samples/sample5.cmd)]
- **— Команда** всегда **синхронизации**.

    [!code-console[Main](deploying-web-packages/samples/sample6.cmd)]

Кроме того, необходимо будет указать различные другие [параметры поставщика](https://technet.microsoft.com/library/dd569001(WS.10).aspx) и Общие [параметры операции](https://technet.microsoft.com/library/dd569089(WS.10).aspx). Например предположим, что вы хотите развернуть ContactManager.Mvc веб-приложение в промежуточной среде. Развертывание веб-развертывания обработчик, будут обрабатываться и необходимо использовать обычную проверку подлинности. Чтобы развернуть веб-приложение, необходимо выполнить следующие шаги.

**Для развертывания веб-приложения с помощью MSDeploy.exe**

1. Выполните сборку и упаковку проекта веб-приложения, как описано в [построения и упаковки проектов веб-приложений](building-and-packaging-web-application-projects.md).
2. Изменить *ContactManager.Mvc.SetParameters.xml* файл, содержащий правильные значения параметров для промежуточной среды, как описано в [Настройка параметров для пакета развертывания веб-](configuring-parameters-for-web-package-deployment.md).
3. Откройте окно командной строки и перейдите к нужному MSDeploy.exe. Обычно это происходит в %PROGRAMFILES%\IIS\Microsoft V2\msdeploy.exe развертывание Web.
4. Введите следующую команду и нажмите клавишу ВВОД (пренебречь разрывов строки):

    [!code-console[Main](deploying-web-packages/samples/sample7.cmd)]

В этом примере:

- **— Источник** указывает **пакета** поставщика и указывает расположение веб-пакета.
- **— Dest** указывает **автоматически** поставщика. **ComputerName** предоставляет URL-адрес службы веб-развертывания обработчик на целевом сервере. **Authtype** параметр указывает, что вы хотите использовать обычную проверку подлинности, и таким образом, необходимо предоставить **username** и **пароль**. Наконец **includeAcls = «False»** параметр указывает, что вы не хотите скопировать списки управления доступом (ACL) файлов в веб-приложении исходного на конечный сервер.
- **— Команда: синхронизации** аргумент указывает, что вы хотите реплицировать исходное содержимое на целевом сервере.
- **— DisableLink** указывать аргументы не требуется реплицировать пулы приложений, конфигурацию виртуального каталога и сертификаты Secure Sockets Layer (SSL) на целевом сервере. Дополнительные сведения см. в разделе [расширений связи веб-развертывания](https://technet.microsoft.com/library/dd569028(WS.10).aspx).
- **— SetParamFile** параметр предоставляет расположение *SetParameters.xml* файла.
- **– AllowUntrusted** указывает, что веб-развертывания должен принимать SSL-сертификаты, которые не был выдан доверенным центром сертификации. Если необходимо развернуть веб-развертывания обработчик и используется самозаверяющий сертификат для защиты URL-адрес службы, необходимо включить этот параметр.

## <a name="automating-web-package-deployment"></a>Автоматизация пакета веб-развертывания

В большом объеме корпоративных сценариев необходимо развертывать пакеты web как часть большего один шаг или автоматического развертывания. Независимо от того, выбрана ли развертывать пакеты web, запустив *. deploy.cmd* файл или напрямую с помощью MSDeploy.exe, вы можете Параметризуйте команды и вызывать их из целевого объекта в "Microsoft Build Engine" (MSBuild) файл проекта.

Пример решения диспетчера контактов, взгляните на **PublishWebPackages** целевых *Publish.proj* файла. Этот целевой объект выполняется один раз для каждого *. deploy.cmd* файлу, определяемому список элементов с именем **PublishPackages**. Конечный объект использует для построения полного набора значений аргументов для каждого свойства и метаданные элемента *. deploy.cmd* файл, а затем использует **Exec** задачи для выполнения команды.


[!code-xml[Main](deploying-web-packages/samples/sample8.xml)]


> [!NOTE]
> Широкий обзор модели файла проекта в образец решения, а также вводные сведения о настраиваемом проекте файлов в общем см. [основные сведения о файле проекта](understanding-the-project-file.md) и [основные сведения о процессе построения](understanding-the-build-process.md).


## <a name="endpoint-considerations"></a>Рекомендации по конечной точки

Независимо от того, где развернут веб-пакет, запустив *. deploy.cmd* файл или напрямую с помощью MSDeploy.exe, необходимо указать имя компьютера или конечную точку службы для развертывания.

Если целевой веб-сервер настроен для развертывания с помощью службы агента веб-развертывания удаленного, указываются URL-адрес целевой службы к назначению.


[!code-console[Main](deploying-web-packages/samples/sample9.cmd)]


Кроме того можно указать только имя сервера как конечную папку и веб-развертывания выведет URL-адрес службы удаленного агента.


[!code-console[Main](deploying-web-packages/samples/sample10.cmd)]


Если целевой веб-сервер настроен для развертывания с помощью веб-развертывания обработчик, необходимо указать адрес конечной точки службы IIS веб-управления (WMSvc) в качестве места расположения. По умолчанию это принимает форму:


[!code-console[Main](deploying-web-packages/samples/sample11.cmd)]


Можно выбрать любой из этих конечных точек с помощью целевую *. deploy.cmd* файл или напрямую MSDeploy.exe. Тем не менее если вы хотите развернуть на веб-развертывания обработчик как пользователь без прав администратора, как описано в [Настройка веб-сервера для веб-развертывания публикации (веб-развертывания обработчик)](../configuring-server-environments-for-web-deployment/configuring-a-web-server-for-web-deploy-publishing-web-deploy-handler.md), необходимо добавить строку запроса с адресом конечной точки службы.


[!code-console[Main](deploying-web-packages/samples/sample12.cmd)]


Это так, как пользователь без прав администратора не имеет доступа на уровне сервера в IIS; он или она имеет доступ только к конкретному веб-сайту IIS. Во время записи, из-за ошибки в Web публикации конвейера (WPP), невозможно запустить *. deploy.cmd* текстовый файл с помощью адреса конечной точки, которая включает строку запроса. В этом сценарии необходимо развернуть веб-пакет напрямую с помощью MSDeploy.exe.

> [!NOTE]
> Дополнительные сведения о агента веб-развертывания удаленной службы и веб-развертывания обработчик в разделе [Выбор оптимального подхода справа для веб-развертывания](../configuring-server-environments-for-web-deployment/choosing-the-right-approach-to-web-deployment.md). Для получения рекомендаций по настройке файлы проекта среды для развертывания на эти конечные точки в разделе [настройки свойств развертывания для целевой среды](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).


## <a name="authentication-considerations"></a>Вопросы проверки подлинности

Независимо от того, где развернут веб-пакет, запустив *. deploy.cmd* файл или напрямую с помощью MSDeploy.exe, необходимо указать тип проверки подлинности. Веб-развертывание принимает два возможных значения: **NTLM** или **основные**. При указании обычной проверки подлинности, необходимо также указать имя пользователя и пароль. Существуют различные факторы, которые необходимо учитывать при выборе типа проверки подлинности:

- При развертывании агента веб-развертывания удаленной службе, необходимо использовать проверку подлинности NTLM. Служба удаленного агента не принимает учетные данные обычной проверки подлинности.
- При развертывании веб-развертывания обработчик можно использовать NTLM или обычную проверку подлинности. Значение по умолчанию — обычную проверку подлинности. Несмотря на то, что Обычная проверка подлинности зависит от того, имена пользователей и пароли передаются в виде обычного текста, учетные данные защищены как веб-развертывания обработчик всегда использует шифрование SSL.
- Если веб-пакет содержит базу данных и веб-сервер и сервер базы данных, в отдельные компьютеры, невозможно развернуть базу данных с использованием проверки подлинности NTLM из-за [ограничение «двойного прыжка» NTLM](https://go.microsoft.com/?linkid=9805120). Необходимо использовать учетные данные SQL Server в строке подключения развертывания или ввести учетные данные обычной проверки подлинности для веб-развертывания. Эта проблема описана более подробно в [развертывание базы данных членства для корпоративных средах](../advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments.md).

## <a name="conclusion"></a>Заключение

В этом разделе описано, как можно развернуть веб-пакета либо путем выполнения *. deploy.cmd* файл или напрямую с помощью MSDeploy.exe. Когда каждый подход может быть целесообразным, и оно описано, как можно параметризовать и выполнить команду развертывания как часть большего процесса построения один шаг или автоматических его рассматривается.

## <a name="further-reading"></a>Дополнительные сведения

Руководство для создания и параметризовать пакет веб-развертывания см. в разделе [построения и упаковки проектов веб-приложений](building-and-packaging-web-application-projects.md) и [Настройка параметров для пакета развертывания веб-](configuring-parameters-for-web-package-deployment.md). Руководство для создания и развертывания веб-пакеты из экземпляра Team Foundation Server (TFS) см. в разделе [настройки Team Foundation Server для автоматического развертывания веб-](../configuring-team-foundation-server-for-web-deployment/configuring-team-foundation-server-for-web-deployment.md). Сведения о настройке и устранение неполадок в процессе развертывания см. в разделе [за исключением файлов и папок из развертывания](../advanced-enterprise-web-deployment/excluding-files-and-folders-from-deployment.md).

> [!div class="step-by-step"]
> [Назад](configuring-parameters-for-web-package-deployment.md)
> [Вперед](deploying-database-projects.md)
