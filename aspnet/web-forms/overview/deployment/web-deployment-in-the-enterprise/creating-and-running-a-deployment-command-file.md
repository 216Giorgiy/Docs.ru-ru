---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/creating-and-running-a-deployment-command-file
title: Создание и запуск развертывания файл команды | Документы Microsoft
author: jrjlee
description: Описывается, как построить командный файл, который позволит вам выполнить развертывание, с помощью Microsoft Build Engine (MSBuild) файлы проектов как один шаг...
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/04/2012
ms.topic: article
ms.assetid: c61560e9-9f6c-4985-834a-08a3eabf9c3c
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/creating-and-running-a-deployment-command-file
msc.type: authoredcontent
ms.openlocfilehash: e5fb034a67bc9f2ea549af269eae51a49acc4d98
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="creating-and-running-a-deployment-command-file"></a>Создание и запуск командный файл развертывания
====================
по [Джейсон Lee](https://github.com/jrjlee)

[Скачать PDF](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> В этом разделе описывается создание командный файл, который позволит вам выполнения с помощью Microsoft Build Engine (MSBuild) файлы проектов как один шаг, repeatable процесс развертывания.


Этот раздел входит в состав серию учебников, исходя из требования к развертыванию enterprise вымышленная компания Fabrikam, Inc. Этот учебник ряд использует образец решения&#x2014; [диспетчера контактов](the-contact-manager-solution.md) решения&#x2014;для представления веб-приложения с реалистичных уровень сложности, включая приложения ASP.NET MVC 3, Windows Communication Служба Foundation (WCF) и проект базы данных.

Метод развертывания, в основе этих учебников основан на разбиение проекта файл подход, описанный в [основные сведения о процессе построения](understanding-the-build-process.md), в которой процесс построения управляется двух файлов проекта&#x2014;один с построение инструкции, которые применяются для каждой целевой среде и, содержащий параметры построения и развертывания конкретной среды. Во время построения файла проекта среды объединяется в файл проекта зависит от среды, образуют полный набор инструкций построения.

## <a name="process-overview"></a>Общие сведения о процессе

В этом разделе вы узнаете, как создать и запустить командный файл, который использует эти файлы проекта для развертывания repeatable целевой среде. По существу, командный файл просто должен содержать команду MSBuild:

- Сообщает MSBuild для независимой от среды выполнения *Publish.proj* файла.
- Сообщает *Publish.proj* файл, файл, который содержит параметры проекта для конкретной среды и где его найти.

## <a name="create-an-msbuild-command"></a>Создайте команду MSBuild

Как описано в [основные сведения о процессе построения](understanding-the-build-process.md), файл проекта среды&#x2014;, *Env Dev.proj*&#x2014;предназначена для импорта в независимой от среды *Publish.proj* файл во время построения. Вместе эти файлы предоставляют полный набор инструкций, которые задают MSBuild для построения и развертывания решения.

*Publish.proj* файле используется **импорта** элемента, который требуется импортировать файл проекта для конкретной среды.


[!code-xml[Main](creating-and-running-a-deployment-command-file/samples/sample1.xml)]


Таким образом при использовании MSBuild.exe для построения и развертывания решений диспетчера контактов, вы должны:

- Проведение MSBuild.exe *Publish.proj* файла.
- Укажите расположение файла проекта для конкретной среды, указав параметр командной строки с именем **TargetEnvPropsFile**.

Чтобы сделать это, команде MSBuild должна выглядеть следующим образом:


[!code-console[Main](creating-and-running-a-deployment-command-file/samples/sample2.cmd)]


Здесь это простой шаг, чтобы переместить repeatable, один шаг развертывания. Вам нужно всего Добавление MSBuild команду cmd-файл. В решении диспетчера контактов, в папку публикации содержит файл с именем *Dev.cmd публикации* , который выполняет именно это.


[!code-console[Main](creating-and-running-a-deployment-command-file/samples/sample3.cmd)]


> [!NOTE]
> **/Fl** служебная программа MSBuild для создания файла журнала с именем *msbuild.log* в рабочем каталоге, в котором был вызван MSBuild.exe.


Для развертывания или повторного развертывания решения диспетчера контактов, вам нужно лишь запустить *Dev.cmd публикации* файла. При запуске файла будет MSBuild:

- Построение всех проектов в решении.
- Создание развертывания веб-пакетов для проектов веб-приложений.
- Создавать файлы расширением DBSCHEMA и .deploymanifest для проектов баз данных.
- Развертывание веб-пакеты на веб-сервер.
- Развертывание базы данных на сервере базы данных.

## <a name="run-the-deployment"></a>Выполните развертывание

При создании командного файла для целевой среде необходимо для завершения всего развертывания, просто запустив файл.

**Чтобы развернуть решение диспетчера контактов для тестовой среды**

1. На компьютере разработчика откройте проводник Windows и перейдите к расположению *Dev.cmd публикации* файла.
2. Дважды щелкните файл для его запуска.
3. Если **открыть файл — предупреждение системы безопасности** диалоговое окно, нажмите кнопку **запуска**.
4. Если настроить параметры конфигурации и тестовые серверы правильно, окно командной строки будет отображаться **построение выполнено успешно** сообщение после завершения обработки файлов проекта MSBuild.

    ![](creating-and-running-a-deployment-command-file/_static/image1.png)
5. Если это первый раз, после развертывания решения в этой среде, необходимо добавить тест web server учетную запись компьютера для **db\_datawriter** и **db\_datareader**роли на **ContactManager** базы данных. Эта процедура описана в [Настройка сервера базы данных для развертывания веб-публикаций](../configuring-server-environments-for-web-deployment/configuring-a-database-server-for-web-deploy-publishing.md).

    > [!NOTE]
    > Необходимо назначить эти разрешения, при создании базы данных. По умолчанию процесс построения не будет воссоздать базу данных на каждом развертывании&#x2014;вместо этого будет сравнить существующей базы данных до самой последней схемы и сделать только необходимые изменения. Поэтому следует только необходимо сопоставить этих ролей базы данных в первый раз при развертывании решения.
6. Откройте Internet Explorer и перейдите к URL-адрес диспетчера контактов приложения (например, `http://testweb1:85/ContactManager/`).
7. Убедитесь, что приложение работает правильно, и вы можете добавлять контакты.

    ![](creating-and-running-a-deployment-command-file/_static/image2.png)

## <a name="conclusion"></a>Заключение

Создав командный файл, содержащий инструкции MSBuild обеспечивает быстрый и простой способ построения и развертывания многопроектное решение в среде определенное место назначения. Если необходимо повторно развернуть решение в различных средах назначения, можно создать несколько командных файлов. В каждый командный файл команды MSBuild создаст один и тот же файл универсального проекта, но он будет указать файл проекта другой среды. Например командный файл для публикации разработчика или тестовой среде может содержать эта команда MSBuild.


[!code-console[Main](creating-and-running-a-deployment-command-file/samples/sample4.cmd)]


Командный файл для публикации в среде промежуточного хранения может содержать эта команда MSBuild.


[!code-console[Main](creating-and-running-a-deployment-command-file/samples/sample5.cmd)]


> [!NOTE]
> Рекомендации по настройке файлы проекта, относящихся к среде для серверных сред см. в разделе [настройки свойств развертывания для целевой среды](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).


Можно также настроить процесс построения для каждой среды путем переопределения свойств, а также другими параметрами в команде MSBuild. Дополнительные сведения см. в разделе [Справочник по командной строке MSBuild](https://msdn.microsoft.com/library/ms164311.aspx).

> [!div class="step-by-step"]
> [Назад](deploying-database-projects.md)
> [Вперед](manually-installing-web-packages.md)
