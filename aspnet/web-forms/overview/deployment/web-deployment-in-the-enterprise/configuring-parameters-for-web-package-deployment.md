---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/configuring-parameters-for-web-package-deployment
title: "Настройка параметров для развертывания веб-пакета | Документы Microsoft"
author: jrjlee
description: "Описывается, как задать значения параметров, таких как имена веб-приложений Internet Information Services (IIS), строки подключения и конечные точки службы..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/04/2012
ms.topic: article
ms.assetid: 37947d79-ab1e-4ba9-9017-52e7a2757414
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/configuring-parameters-for-web-package-deployment
msc.type: authoredcontent
ms.openlocfilehash: dd1ae266740ea4728c0624b1833a98ac262e0e5a
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="configuring-parameters-for-web-package-deployment"></a>Настройка параметров для развертывания веб-пакета
====================
по [Джейсон Lee](https://github.com/jrjlee)

[Скачать PDF](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> Описывается, как задать значения параметров, таких как имена веб-приложений Internet Information Services (IIS), строки подключения и конечные точки службы, при развертывании веб-пакета на удаленном веб-сервере IIS.


При построении проекта веб-приложения, построения и обработки пакетов создает три файла ключа:

- Объект *.zip [имя проекта]* файл. Это пакет веб-развертывания для проекта веб-приложения. Этот пакет содержит все сборки, файлы, скрипты базы данных и ресурсов, необходимых для повторного создания веб-приложения на удаленном веб-сервере IIS.
- Объект *.deploy.cmd [имя проекта]* файл. Содержит набор параметризованные команды, Web Deploy (MSDeploy.exe), которые публикуют веб-пакет развертывания на удаленном веб-сервере IIS.
- Объект *[имя проекта]. SetParameters.xml* файла. Это предоставляет набор значений параметров для команды MSDeploy.exe. Можно обновить значения в этот файл и передать его на веб-развертывания как параметр командной строки при развертывании веб-пакет.

> [!NOTE]
> Дополнительные сведения о сборке и обработки пакетов см. в разделе [построения и упаковки проектов веб-приложений](building-and-packaging-web-application-projects.md).


*SetParameters.xml* создан динамически файл проекта веб-приложения и файлы конфигурации в рамках проекта. После построения и упаковки проекте конвейера публикации Web (WPP) автоматически определяет множество переменных, которые могут измениться сред развертывания, таких как целевой веб-приложения IIS и любые строки подключения базы данных. Эти значения, автоматически параметризованы в пакет веб-развертывания и добавляются в *SetParameters.xml* файла. Например, если добавить строку подключения к *web.config* файл в проект веб-приложения, процесс построения обнаружит это изменение и будет добавлена запись для *SetParameters.xml* файла соответствующим образом.

В большинстве случаев это автоматической параметризации, будет достаточно. Однако, если вашим пользователям требуется для изменения других параметров между средами развертывания, таких как параметры приложения или URL-адреса конечной точки службы, необходимо сообщить WPP параметризовать эти значения в пакете развертывания и добавить соответствующие записи *SetParameters.xml* файла. В последующих разделах объясняется, как это сделать.

### <a name="automatic-parameterization"></a>Автоматическая параметризация

При построении и пакет веб-приложении WPP будет автоматической параметризации следующие действия:

- Назначение IIS веб-приложения путь и имя.
- Строки любого подключения в вашей *web.config* файла.
- Строки подключения для всех баз данных, добавить в **упаковка и публикация SQL** на вкладке страницы свойств проекта.

Например, если вы выполните сборку и упаковку [диспетчера контактов](the-contact-manager-solution.md) образец решения, не касаясь процесс параметризации никоим образом WPP влекущих *ContactManager.Mvc.SetParameters.xml* файла:


[!code-xml[Main](configuring-parameters-for-web-package-deployment/samples/sample1.xml)]


В этом случае:

- **Имя веб-приложения IIS** параметр — это путь IIS, где вы хотите развернуть веб-приложение. Значение по умолчанию берется из **Пакет/Публикация веб-сайта** страницы на страницах свойств проекта.
- **Строка подключения ApplicationServices Web.config** параметр был создан из **connectionStrings или добавления** элемент в *web.config* файла. Он представляет строку подключения, приложение должно использовать для связи базы данных членства. Значение, укажите здесь будут заменены в развернутой *web.config* файла. Значение по умолчанию берется из перед развертыванием *web.config* файла.

Также WPP параметризует этих свойств в формируемые им пакет развертывания. Можно указать значения для этих свойств при установке пакета развертывания. Если установить пакет вручную через диспетчер IIS, как описано в [вручную Установка веб-пакеты](manually-installing-web-packages.md), мастер установки попросит указать значения для всех параметров. При установке пакета удаленно с помощью *. deploy.cmd* файла, как описано в [веб-развертывание пакетов](deploying-web-packages.md), веб-развертывание будет отображаться для этого *SetParameters.xml* файл Укажите значения параметров. Можно изменить значения в *SetParameters.xml* файл вручную, или файл, можно настроить как часть автоматизированного процесса построения и развертывания. Этот процесс описан более подробно далее в этом разделе.

### <a name="custom-parameterization"></a>Пользовательские параметризации

Для более сложных сценариев развертывания будут часто требуется параметризовать дополнительные свойства до развертывания проекта. Вообще говоря следует параметризовать все свойства и настройки, зависит от целевой среды. Например:

- Конечные точки в службы *web.config* файла.
- Параметры приложения в *web.config* файла.
- Другие декларативный свойства, которые вы хотите предлагать пользователям указать.

Для параметризации эти свойства проще всего добавить *parameters.xml* файл в корневой папке проекта веб-приложения. Например, в решении диспетчера контактов ContactManager.Mvc проект включает *parameters.xml* файл в корневой папке.

![](configuring-parameters-for-web-package-deployment/_static/image1.png)

Если открыть этот файл, вы увидите, что она содержит один **параметр** входа. Запись используется язык XML Path (XPath) запрос для поиска и параметризовать URL-адрес конечной точки службы ContactService Windows Communication Foundation (WCF) в *web.config* файла.


[!code-xml[Main](configuring-parameters-for-web-package-deployment/samples/sample2.xml)]


Помимо параметризации URL-адрес конечной точки в пакет развертывания, WPP также добавляется соответствующая запись для *SetParameters.xml* файл, который получает созданный вместе с пакет развертывания.


[!code-xml[Main](configuring-parameters-for-web-package-deployment/samples/sample3.xml)]


Если вручную установить пакет развертывания диспетчера служб IIS предложит ввести адрес конечной точки службы наряду с свойства, которые были параметризованы автоматически. Если установить пакет развертывания, запустив *. deploy.cmd* файл, можно изменить *SetParameters.xml* файл, чтобы предоставить значение для адрес конечной точки службы, а также значения для свойства, которые были параметризованы автоматически.

Полные сведения о создании *parameters.xml* файла см. в разделе [как: используются параметры для настройки параметров при пакет развертывания установлен](https://msdn.microsoft.com/en-us/library/ff398068.aspx). Процедура, с именем **использование параметров развертывания для параметров файла Web.config** пошаговые инструкции.

## <a name="modifying-the-setparametersxml-file"></a>Изменение файла SetParameters.xml

Если вы планируете развернуть пакет веб-приложения вручную & #x 2014; либо путем выполнения *. deploy.cmd* файла или путем запуска MSDeploy.exe из командной строки & #x 2014; нет ничего останавливать вручную изменив *SetParameters.xml* файлу до развертывания. Тем не менее если вы работаете в рамках решения корпоративного уровня, может потребоваться развернуть веб-приложение пакет как часть большего размера, автоматизированный процесс построения и развертывания. В этом сценарии, необходимые Microsoft Build Engine (MSBuild), чтобы изменить *SetParameters.xml* файл автоматически. Это можно сделать с помощью MSBuild **XmlPoke** задачи.

[Диспетчера контактов образец решения](the-contact-manager-solution.md) иллюстрирует этот процесс. Чтобы отобразить только те сведения, которые относятся к этому примеру были изменены приведенных ниже примерах кода.

> [!NOTE]
> Широкий обзор модели файла проекта в образец решения, а также вводные сведения о настраиваемом проекте файлов в общем см. [основные сведения о файле проекта](understanding-the-project-file.md) и [основные сведения о процессе построения](understanding-the-build-process.md).


Во-первых, значения параметров интерес определяются как свойства в файле проекта, относящихся к среде (например, *Env Dev.proj*).


[!code-xml[Main](configuring-parameters-for-web-package-deployment/samples/sample4.xml)]


> [!NOTE]
> Рекомендации по настройке файлы проекта, относящихся к среде для серверных сред см. в разделе [настройки свойств развертывания для целевой среды](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).


Далее, *Publish.proj* файл импортирует эти свойства. Поскольку каждый *SetParameters.xml* файлов, связанных с *. deploy.cmd* файла и мы в конечном счете должны файл проекта для каждого вызова *. deploy.cmd* файла проекта MSBuild создает файл *элемент* для каждого *. deploy.cmd* файла и определение свойств интерес как *метаданные элемента*.


[!code-xml[Main](configuring-parameters-for-web-package-deployment/samples/sample5.xml)]


В этом случае:

- **ParametersXml** значение метаданных указывает расположение *SetParameters.xml* файла.
- **IisWebAppName** значением является путь IIS, к которому вы хотите развернуть веб-приложение.
- **MembershipDBConnectionString** значением является строка подключения для базы данных членства и **MembershipDBConnectionName** значение **имя** атрибута соответствующего параметра в *SetParameters.xml* файла.
- **ServiceEndpointValue** значение — это адрес конечной точки для службы WCF на целевом сервере и **ServiceEndpointParamName** значение атрибута имени соответствующего параметра в *SetParameters.xml* файла.

Наконец, в *Publish.proj* файл **PublishWebPackages** целевой использует **XmlPoke** задач, чтобы изменить эти значения в *SetParameters.xml* файл.


[!code-xml[Main](configuring-parameters-for-web-package-deployment/samples/sample6.xml)]


Обратите внимание, что каждый **XmlPoke** задача определяет четыре значения атрибутов:

- **XmlInputPath** атрибут сообщает задачи, где можно найти файл, который необходимо изменить.
- **Запроса** атрибут является запрос XPath для идентификации узла XML, необходимо изменить.
- **Значение** атрибут — это новое значение, которое нужно вставить в выбранный узел XML.
- **Условие** атрибут является условия, на которых должны выполняться или выполняться задачи. В этих случаях условие гарантирует не пытайтесь вставить значение null или пустое значение в *SetParameters.xml* файла.

## <a name="conclusion"></a>Заключение

В этом разделе описывается роль *SetParameters.xml* файла и объясняется, как оно создается при построении проекта веб-приложения. Описано, как можно параметризировать путем добавления дополнительных параметров *parameters.xml* файл в проект. Также описывается, как изменять *SetParameters.xml* файла в рамках процесса построения большего размера, автоматизированные с помощью **XmlPoke** задач в файлах проекта.

Следующий раздел [веб-развертывание пакетов](deploying-web-packages.md), описывает, как можно развертывать веб-пакета либо путем выполнения *. deploy.cmd* файл или напрямую с помощью MSDeploy.exe команд. В обоих случаях можно указать вашей *SetParameters.xml* файла в качестве параметра развертывания.

## <a name="further-reading"></a>Дополнительные сведения

Сведения по созданию веб-пакетов см. в разделе [построения и упаковки проектов веб-приложений](building-and-packaging-web-application-projects.md). Руководство для фактического развертывания веб-пакета см. в разделе [веб-развертывание пакетов](deploying-web-packages.md). Пошаговое руководство по созданию *parameters.xml* файла см. в разделе [как: используются параметры для настройки параметров при пакет развертывания установлен](https://msdn.microsoft.com/en-us/library/ff398068.aspx).

Дополнительные общие сведения о параметризации в веб-развертывания см. в разделе [Web развертывание параметризации в действии](https://go.microsoft.com/?linkid=9805119) (запись блога).

>[!div class="step-by-step"]
[Назад](building-and-packaging-web-application-projects.md)
[Вперед](deploying-web-packages.md)
