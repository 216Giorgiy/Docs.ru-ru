---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/excluding-files-and-folders-from-deployment
title: Исключение файлов и папок из развертывания | Документы Microsoft
author: jrjlee
description: В этом разделе описывается, как можно исключить файлы и папки из веб-пакета развертывания при построении и упаковать проект веб-приложения.
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/04/2012
ms.topic: article
ms.assetid: f4cc2d40-6a78-429b-b06f-07d000d4caad
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/excluding-files-and-folders-from-deployment
msc.type: authoredcontent
ms.openlocfilehash: c435448bf057bbef9127d66ffda24a07729f2322
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="excluding-files-and-folders-from-deployment"></a>Исключение файлов и папок из развертывания
====================
по [Джейсон Lee](https://github.com/jrjlee)

[Скачать PDF](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> В этом разделе описывается, как можно исключить файлы и папки из веб-пакета развертывания при построении и упаковать проект веб-приложения.


Этот раздел входит в состав серию учебников, исходя из требования к развертыванию enterprise вымышленная компания Fabrikam, Inc. Этот учебник ряд использует образец решения&#x2014; [решения диспетчера контактов](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;для представления веб-приложения с реалистичных уровень сложности, включая приложения ASP.NET MVC 3, Windows Communication Служба Foundation (WCF) и проект базы данных.

Метод развертывания, в основе этих учебников основан на разбиение проекта файл подход, описанный в [основные сведения о файле проекта](../web-deployment-in-the-enterprise/understanding-the-project-file.md), в которой процесс построения управляется двух файлов проекта&#x2014;один с построение инструкции, которые применяются для каждой целевой среде и, содержащий параметры построения и развертывания конкретной среды. Во время построения файла проекта среды объединяется в файл проекта зависит от среды, образуют полный набор инструкций построения.

## <a name="overview"></a>Обзор

При построении проекта веб-приложения в Visual Studio 2010 конвейера публикации Web (WPP) позволяет расширять такой процесс сборки, упаковав скомпилированного веб-приложения в веб-развертывания пакета. Затем можно использовать средство Internet Information Services (IIS) веб-развертывания (Web Deploy) для развертывания этого веб-пакета на удаленном веб-сервере IIS или импортировать веб-пакет вручную через диспетчер IIS. Подробно описан этот процесс упаковки [построения и упаковки проектов веб-приложений](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md).

Так как вы управляете, что возвращает включено в веб-пакет? Параметры проекта в Visual Studio с помощью базового файла проекта, обеспечивает достаточного контроля над для множество сценариев. Однако в некоторых случаях может потребоваться настроить содержимое веб-пакет на указанном конечном среды. Например может потребоваться включить папку для файлов журнала, при развертывания приложения в среде тестирования, но исключить папки, при развертывании приложения в промежуточной или рабочей среде. В этом разделе будет показано, как это сделать.

## <a name="what-gets-included-by-default"></a>Что возвращает включено по умолчанию?

При настройке свойства проекта вашего веб-приложения в Visual Studio **развертываемые элементы** списке **упаковка и публикация веб** страница позволяет указать, требуется включить в развертывание web пакет. По умолчанию он равен **только файлы, необходимые для запуска этого приложения**.

![](excluding-files-and-folders-from-deployment/_static/image1.png)

При выборе **только файлы, необходимые для запуска этого приложения**, WPP попытается определить, какие файлы должны быть добавлены к веб-пакета. В том числе следующее:

- Выходные данные построения для проекта.
- Все файлы, отмеченные действие построения **содержимого**.

> [!NOTE]
> В этом файле содержится логику, которая определяет, какие файлы для добавления:   
> *%ProgramFiles%\MSBuild\Microsoft\VisualStudio\v10.0\Web\ Microsoft.Web.Publishing.OnlyFilesToRunTheApp.targets*


## <a name="excluding-specific-files-and-folders"></a>Исключение определенных файлов и папок

В некоторых случаях нужно более детализированный контроль, по которому развертываются файлы и папки. Если вы знаете, какие файлы, чтобы исключить опережают время и за счет применяется ко всем средам назначения, достаточно просто задать **действие при построении** для каждого файла на **нет**.

**Чтобы исключить определенные файлы из развертывания**

1. В **обозревателе решений** окно, щелкните правой кнопкой мыши файл и нажмите кнопку **свойства**.
2. В **свойства** окна в **действие при построении** строк, выберите **нет**.

Однако такой подход не всегда удобно. Например вы можете изменять какие файлы и папки включены, в соответствии с целевой среде, а также из вне Visual Studio. Например образец решения диспетчера контактов, взгляните на содержимое ContactManager.Mvc проекта:

![](excluding-files-and-folders-from-deployment/_static/image2.png)

- Внутренняя папка содержит некоторые сценарии SQL, которые разработчик использует для создания, удаления и заполнения локальных баз данных в целях разработки. Ничего не в этой папке необходимо развернуть в промежуточной или производственной среде.
- Папка скриптов содержит несколько файлов JavaScript. Большое количество этих файлов входят исключительно для поддержки отладки или обеспечить поддержку технологии IntelliSense в Visual Studio. Некоторые из этих файлов не должны развертываться в тестовой или производственной среды. Тем не менее можно развернуть их в тестовой среде разработчика, чтобы упростить устранение неполадок.

Хотя возможность управлять файлы проекта, чтобы исключить определенные файлы и папки, есть более простой способ. WPP включает механизм для исключения файлов и папок при построении списков элементов с именем **ExcludeFromPackageFolders** и **ExcludeFromPackageFiles**. Этот механизм можно расширить путем добавления собственных элементов этих списков. Чтобы сделать это, необходимо выполнить следующие общие действия:

1. Создайте файл пользовательский проект с именем *.wpp.targets [имя проекта]* в одной папке с файлом проекта.

    > [!NOTE]
    > *. Wpp.targets* файл необходимо перейти в той же папке, как файл проекта веб-приложения&#x2014;, *ContactManager.Mvc.csproj*&#x2014;, а не в той же папке настраиваемых файлы проекта, используемого для управления процессом построения и развертывания.
2. В *. wpp.targets* файл, добавьте **ItemGroup** элемента.
3. В **ItemGroup** элемента, добавьте **ExcludeFromPackageFolders** и **ExcludeFromPackageFiles** элементы, чтобы исключить определенные файлы и папки при необходимости.

Это базовая структура *. wpp.targets* файла:


[!code-xml[Main](excluding-files-and-folders-from-deployment/samples/sample1.xml)]


Обратите внимание, что каждый элемент содержит элемент метаданных с именем **FromTarget**. Это необязательное значение, которое не влияет на процесс построения; он просто служит для указания того, почему были опущены конкретные файлы или папки, если кто-то просматривает журнал сборки.

## <a name="excluding-files-and-folders-from-a-web-package"></a>Исключение файлов и папок из веб-пакета

Следующая процедура демонстрирует добавление *. wpp.targets* файл в проект веб-приложения и как использовать файл, чтобы исключить определенные файлы и папки из веб-пакета при построении проекта.

**Чтобы исключить файлы и папки из пакета веб-развертывания**

1. Откройте решение в Visual Studio 2010.
2. В **обозревателе решений** окно, щелкните правой кнопкой мыши узел проекта приложения web (например, **ContactManager.Mvc**), пункты **добавить**и нажмите кнопку **Новый элемент**.
3. В **Добавление нового элемента** выберите **XML-файл** шаблона.
4. В **имя** введите *[имя проекта] ***.wpp.targets** (например, **ContactManager.Mvc.wpp.targets**), а затем нажмите кнопку **добавить**.

    ![](excluding-files-and-folders-from-deployment/_static/image3.png)

    > [!NOTE]
    > При добавлении нового элемента на корневой узел проекта, файл создается в той же папке, что и файл проекта. Это можно проверить, перейдите в папку в проводнике Windows.
5. Добавьте в файл, **проекта** элемент и **ItemGroup** элемента:

    [!code-xml[Main](excluding-files-and-folders-from-deployment/samples/sample2.xml)]
6. Если вы хотите исключить папки из веб-пакета, добавьте **ExcludeFromPackageFolders** элемент **ItemGroup** элемента:

   1. В **Include** атрибута, приводится список разделенных точкой с запятой папки, которую требуется исключить.
   2. В **FromTarget** элемент метаданных предоставляют значимое значение, указывающее, почему папки исключаются, такие как имя *. wpp.targets* файл.

      [!code-xml[Main](excluding-files-and-folders-from-deployment/samples/sample3.xml)]
7. Если вы хотите исключить файлы из веб-пакета, добавьте **ExcludeFromPackageFiles** элемент **ItemGroup** элемента:

   1. В **Include** атрибута, приводится список разделенных точкой с запятой файлов, которые требуется исключить.
   2. В **FromTarget** элемент метаданных предоставляют значимое значение, указывающее, почему файлы исключаются, такие как имя *. wpp.targets* файл.

      [!code-xml[Main](excluding-files-and-folders-from-deployment/samples/sample4.xml)]
8. *.Wpp.targets [имя проекта]* файл должен выглядеть это:

    [!code-xml[Main](excluding-files-and-folders-from-deployment/samples/sample5.xml)]
9. Сохраните и закройте *.wpp.targets [имя проекта]* файл.

При повторном сборки и пакет проекта веб-приложения, WPP автоматически обнаруживает *. wpp.targets* файл. Все файлы и папки, указанные будет отсутствовать в веб-пакет.

## <a name="conclusion"></a>Заключение

В этом разделе описано, как исключить определенные файлы и папки при создании веб-пакета с помощью пользовательского *. wpp.targets* файл в той же папке, как файл проекта веб-приложения.

## <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения об использовании пользовательских файлов проекта Microsoft Build Engine (MSBuild) для управления процессом развертывания см. в разделе [основные сведения о файле проекта](../web-deployment-in-the-enterprise/understanding-the-project-file.md) и [основные сведения о процессе построения](../web-deployment-in-the-enterprise/understanding-the-build-process.md). Дополнительные сведения об упаковке и развертывании процесса см. в разделе [построения и упаковки проектов веб-приложений](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md), [Настройка параметров для пакета развертывания веб-](../web-deployment-in-the-enterprise/configuring-parameters-for-web-package-deployment.md), и [ Развертывание веб-пакеты](../web-deployment-in-the-enterprise/deploying-web-packages.md).

> [!div class="step-by-step"]
> [Назад](deploying-membership-databases-to-enterprise-environments.md)
> [Вперед](taking-web-applications-offline-with-web-deploy.md)
