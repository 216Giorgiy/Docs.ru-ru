---
uid: web-forms/overview/deployment/visual-studio-web-deployment/deploying-extra-files
title: 'ASP.NET веб-развертывания с помощью Visual Studio: развертывание дополнительных файлов | Документы Microsoft'
author: tdykstra
description: Этот учебник ряд показано развертывание ASP.NET (публикации) веб-приложения для веб-приложениях службы приложений Azure или стороннего поставщика услуг размещения, Пол...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/23/2015
ms.topic: article
ms.assetid: 1cd91055-84bc-42c6-9d80-646f41429d4d
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/deployment/visual-studio-web-deployment/deploying-extra-files
msc.type: authoredcontent
ms.openlocfilehash: 5cefcedde7715844a7d7a9db1455193564ef9805
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30881767"
---
<a name="aspnet-web-deployment-using-visual-studio-deploying-extra-files"></a><span data-ttu-id="e9c2b-103">ASP.NET веб-развертывания с помощью Visual Studio: развертывание дополнительных файлов</span><span class="sxs-lookup"><span data-stu-id="e9c2b-103">ASP.NET Web Deployment using Visual Studio: Deploying Extra Files</span></span>
====================
<span data-ttu-id="e9c2b-104">по [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="e9c2b-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

[<span data-ttu-id="e9c2b-105">Загрузите начальный проект</span><span class="sxs-lookup"><span data-stu-id="e9c2b-105">Download Starter Project</span></span>](http://go.microsoft.com/fwlink/p/?LinkId=282627)

> <span data-ttu-id="e9c2b-106">Этот учебник ряд показано развертывание ASP.NET (публикации) веб-приложения для веб-приложениях службы приложений Azure или стороннего поставщика услуг размещения, с помощью Visual Studio 2012 или Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-106">This tutorial series shows you how to deploy (publish) an ASP.NET web application to Azure App Service Web Apps or to a third-party hosting provider, by using Visual Studio 2012 or Visual Studio 2010.</span></span> <span data-ttu-id="e9c2b-107">Сведения о последовательности см. в разделе [в первом учебнике ряда](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="e9c2b-107">For information about the series, see [the first tutorial in the series](introduction.md).</span></span>


## <a name="overview"></a><span data-ttu-id="e9c2b-108">Обзор</span><span class="sxs-lookup"><span data-stu-id="e9c2b-108">Overview</span></span>

<span data-ttu-id="e9c2b-109">Этот учебник показывает, как для расширения Visual Studio, веб-публикация конвейера для выполнения дополнительных задач во время развертывания.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-109">This tutorial shows how to extend the Visual Studio web publish pipeline to do an additional task during deployment.</span></span> <span data-ttu-id="e9c2b-110">Задача заключается в копировании лишние файлы, которые не находятся в папке проекта веб-узел назначения.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-110">The task is to copy extra files that are not in the project folder to the destination web site.</span></span>

<span data-ttu-id="e9c2b-111">В этом учебнике предстоит скопировать один дополнительный файл: *robots.txt*.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-111">For this tutorial you'll copy one extra file: *robots.txt*.</span></span> <span data-ttu-id="e9c2b-112">Необходимо развернуть этот файл для промежуточного хранения, но не в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-112">You want to deploy this file to staging but not to production.</span></span> <span data-ttu-id="e9c2b-113">В [развертывание в рабочей среде](deploying-to-production.md) учебника, можно добавить этот файл в проект и настройки производства профиль, чтобы исключить его публикации.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-113">In [the Deploying to Production](deploying-to-production.md) tutorial, you added this file to the project and configured the Production publish profile to exclude it.</span></span> <span data-ttu-id="e9c2b-114">В этом учебнике вы увидите альтернативный метод для обработки этой ситуации, в который будут использоваться для всех файлов, которые требуется развернуть, но не требуется включать в проект.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-114">In this tutorial you'll see an alternative method to handle this situation, one that will be useful for any files that you want to deploy but don't want to include in the project.</span></span>

## <a name="move-the-robotstxt-file"></a><span data-ttu-id="e9c2b-115">Переместите файл robots.txt</span><span class="sxs-lookup"><span data-stu-id="e9c2b-115">Move the robots.txt file</span></span>

<span data-ttu-id="e9c2b-116">Для подготовки к другой метод обработки *robots.txt*, в этом разделе учебника переместить файл в папку, не включенные в проект и удалении *robots.txt* из промежуточного хранения Среда.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-116">To prepare for a different method of handling *robots.txt*, in this section of the tutorial you move the file to a folder that is not included in the project, and you delete *robots.txt* from the staging environment.</span></span> <span data-ttu-id="e9c2b-117">Это необходимо удалить файл из промежуточного хранения, чтобы мог проверить правильность работы нового метода развертывания файла для этой среды.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-117">It is necessary to delete the file from staging so that you can verify that your new method of deploying the file to that environment is working correctly.</span></span>

1. <span data-ttu-id="e9c2b-118">В **обозревателе решений**, щелкните правой кнопкой мыши *robots.txt* файла и нажмите кнопку **исключить из проекта**.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-118">In **Solution Explorer**, right-click the *robots.txt* file and click **Exclude From Project**.</span></span>
2. <span data-ttu-id="e9c2b-119">Используя проводник Windows, создайте новую папку в папке решения и назовите его *ExtraFiles*.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-119">Using Windows File Explorer, create a new folder in the solution folder and name it *ExtraFiles*.</span></span>
3. <span data-ttu-id="e9c2b-120">Переместить *robots.txt* файл из *ContosoUniversity* папку проекта для *ExtraFiles* папки.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-120">Move the *robots.txt* file from the *ContosoUniversity* project folder to the *ExtraFiles* folder.</span></span>

    ![Папка ExtraFiles](deploying-extra-files/_static/image1.png)
4. <span data-ttu-id="e9c2b-122">Используя инструмент FTP, удалить *robots.txt* файл из промежуточного веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-122">Using your FTP tool, delete the *robots.txt* file from the staging web site.</span></span>

    <span data-ttu-id="e9c2b-123">В качестве альтернативы можно выбрать **удалить дополнительные файлы в месте назначения** под **параметры публикации файлов** на **параметры** вкладке профиля публикации для промежуточного хранения, и Повторная публикация для промежуточного хранения.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-123">As an alternative, you can select **Remove additional files at destination** under **File Publish Options** on the **Settings** tab of the Staging publish profile, and republish to staging.</span></span>

## <a name="update-the-publish-profile-file"></a><span data-ttu-id="e9c2b-124">Обновить файл профиля публикации</span><span class="sxs-lookup"><span data-stu-id="e9c2b-124">Update the publish profile file</span></span>

<span data-ttu-id="e9c2b-125">Требуется только *robots.txt* в промежуточной, поэтому промежуточная только профиль публикации, необходимо обновить, чтобы развернуть его.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-125">You only need *robots.txt* in staging, so the only publish profile you need to update in order to deploy it is Staging.</span></span>

1. <span data-ttu-id="e9c2b-126">В Visual Studio откройте *Staging.pubxml*.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-126">In Visual Studio, open *Staging.pubxml*.</span></span>
2. <span data-ttu-id="e9c2b-127">В конце файла перед закрывающей `</Project>` , добавьте следующую разметку:</span><span class="sxs-lookup"><span data-stu-id="e9c2b-127">At the end of the file, before the closing `</Project>` tag, add the following markup:</span></span>

    [!code-xml[Main](deploying-extra-files/samples/sample1.xml)]

    <span data-ttu-id="e9c2b-128">Этот код создает новый *целевой* , будет собирать дополнительные файлы для развертывания.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-128">This code creates a new *target* that will collect additional files to be deployed.</span></span> <span data-ttu-id="e9c2b-129">Цель состоит из одного или несколько задач, MSBuild выполнит на основании указанных вами условий.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-129">A target is composed of one or more tasks that MSBuild will execute based on conditions you specify.</span></span>

    <span data-ttu-id="e9c2b-130">`Include` Атрибут указывает, что папка, в которой для поиска файлов, *ExtraFiles*, расположенную на том же уровне, что и папка проекта.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-130">The `Include` attribute specifies that the folder in which to find the files is *ExtraFiles*, located at the same level as the project folder.</span></span> <span data-ttu-id="e9c2b-131">MSBuild будет собирать все файлы в этой папке и рекурсивно из вложенных (двойная звездочка указывает рекурсивные вложенные папки).</span><span class="sxs-lookup"><span data-stu-id="e9c2b-131">MSBuild will collect all files from that folder and recursively from any subfolders (the double asterisk specifies recursive subfolders).</span></span> <span data-ttu-id="e9c2b-132">Этот код можно поместить несколько файлов и файлов во вложенных папках внутри *ExtraFiles* папки и всех будет развертываться.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-132">With this code you could put multiple files, and files in subfolders inside the *ExtraFiles* folder, and all will be deployed.</span></span>

    <span data-ttu-id="e9c2b-133">`DestinationRelativePath` Элемент указывает, что файлы и папки должны копироваться в корневую папку веб-сайта назначения в ту же структуру файлов и папок найденные в *ExtraFiles* папки.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-133">The `DestinationRelativePath` element specifies that the folders and files should be copied to the root folder of the destination web site, in the same file and folder structure as they are found in the *ExtraFiles* folder.</span></span> <span data-ttu-id="e9c2b-134">Если нужно скопировать *ExtraFiles* саму папку `DestinationRelativePath` значение будет *ExtraFiles\%(RecursiveDir)%(Filename)%(Extension)*.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-134">If you wanted to copy the *ExtraFiles* folder itself, the `DestinationRelativePath` value would be *ExtraFiles\%(RecursiveDir)%(Filename)%(Extension)*.</span></span>
3. <span data-ttu-id="e9c2b-135">В конце файла перед закрывающей `</Project>` , добавьте следующую разметку, указывающее, когда следует выполнить новую цель.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-135">At the end of the file, before the closing `</Project>` tag, add the following markup that specifies when to execute the new target.</span></span>

    [!code-xml[Main](deploying-extra-files/samples/sample2.xml)]

    <span data-ttu-id="e9c2b-136">Этот код вызывает новый `CustomCollectFiles` целевой должно выполняться каждый раз, когда выполняется целевой объект, который копирует файлы в папку назначения.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-136">This code causes the new `CustomCollectFiles` target to be executed whenever the target that copies files to the destination folder is executed.</span></span> <span data-ttu-id="e9c2b-137">Существует отдельный целевой объект для публикации и создания пакета развертывания, а новый целевой встраивается в обе целевые объекты в случае, если вы решили развернуть с помощью пакета развертывания вместо публикации.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-137">There is a separate target for publish versus deployment package creation, and the new target is injected in both targets in case you decide to deploy by using a deployment package instead of publishing.</span></span>

    <span data-ttu-id="e9c2b-138">*.Pubxml* файлов теперь выглядит как в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="e9c2b-138">The *.pubxml* file now looks like the following example:</span></span>

    [!code-xml[Main](deploying-extra-files/samples/sample3.xml?highlight=53-71)]
4. <span data-ttu-id="e9c2b-139">Сохраните и закройте *Staging.pubxml* файла.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-139">Save and close the *Staging.pubxml* file.</span></span>

## <a name="publish-to-staging"></a><span data-ttu-id="e9c2b-140">Публикация для промежуточного хранения</span><span class="sxs-lookup"><span data-stu-id="e9c2b-140">Publish to staging</span></span>

<span data-ttu-id="e9c2b-141">С помощью одного щелчка мыши опубликовать или из командной строки, публикации приложения с помощью профиля промежуточного хранения.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-141">Using one-click publish or the command line, publish the application by using the Staging profile.</span></span>

<span data-ttu-id="e9c2b-142">При использовании одним щелчком публикации, можно проверить в **предварительного просмотра** окна, *robots.txt* будут скопированы.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-142">If you use one-click publish, you can verify in the **Preview** window that *robots.txt* will be copied.</span></span> <span data-ttu-id="e9c2b-143">В противном случае использовать средством FTP и убедитесь, что *robots.txt* файл находится в корневой папке веб-сайта после развертывания.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-143">Otherwise, use your FTP tool to verify that the *robots.txt* file is in the root folder of the web site after deployment.</span></span>

## <a name="summary"></a><span data-ttu-id="e9c2b-144">Сводка</span><span class="sxs-lookup"><span data-stu-id="e9c2b-144">Summary</span></span>

<span data-ttu-id="e9c2b-145">На этом завершается, серию учебников по развертыванию веб-приложению ASP.NET для стороннего поставщика услуг размещения.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-145">This completes this series of tutorials on deploying an ASP.NET web application to a third-party hosting provider.</span></span> <span data-ttu-id="e9c2b-146">Дополнительные сведения об этих подразделах, рассматриваемых в этих учебниках см. в разделе [Карта содержимого развертывания ASP.NET](https://go.microsoft.com/fwlink/p/?LinkId=282413).</span><span class="sxs-lookup"><span data-stu-id="e9c2b-146">For more information about any of the topics covered in these tutorials, see the [ASP.NET Deployment Content Map](https://go.microsoft.com/fwlink/p/?LinkId=282413).</span></span>

## <a name="more-information"></a><span data-ttu-id="e9c2b-147">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="e9c2b-147">More information</span></span>

<span data-ttu-id="e9c2b-148">Если вы знаете, как работать с файлами MSBuild, можно автоматизировать многие другие задачи развертывания путем написания кода в *.pubxml* файлов (для задачи, связанные с профилем) или проекта *. wpp.targets* файла (для задачи, применяется ко всем профилям).</span><span class="sxs-lookup"><span data-stu-id="e9c2b-148">If you know how to work with MSBuild files, you can automate many other deployment tasks by writing code in *.pubxml* files (for profile-specific tasks) or the project *.wpp.targets* file (for tasks that apply to all profiles).</span></span> <span data-ttu-id="e9c2b-149">Дополнительные сведения о *.pubxml* и *. wpp.targets* файлов, в разделе [как: изменение параметров развертывания в файлы профилей публикации (.pubxml) и. wpp.targets файл в Visual Studio Web Проекты](https://msdn.microsoft.com/library/ff398069).</span><span class="sxs-lookup"><span data-stu-id="e9c2b-149">For more information about *.pubxml* and *.wpp.targets* files, see [How to: Edit Deployment Settings in Publish Profile (.pubxml) Files and the .wpp.targets File in Visual Studio Web Projects](https://msdn.microsoft.com/library/ff398069).</span></span> <span data-ttu-id="e9c2b-150">Основные сведения о MSBuild кода, в разделе **составляющие файл проекта** в [корпоративного развертывания ряда: основные сведения о файле проекта](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span><span class="sxs-lookup"><span data-stu-id="e9c2b-150">For a basic introduction to MSBuild code, see **The Anatomy of a Project File** in [Enterprise Deployment Series: Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span></span> <span data-ttu-id="e9c2b-151">Чтобы научиться работать с файлами MSBuild для выполнения задач собственные сценарии, см. в данной книге: [внутри Microsoft Build Engine: с помощью MSBuild и Team Foundation Build](http://msbuildbook.com) Sayed Ibraham Hashimi и Уильям Bartholomew.</span><span class="sxs-lookup"><span data-stu-id="e9c2b-151">To learn how to work with MSBuild files to perform tasks for your own scenarios, see this book: [Inside the Microsoft Build Engine: Using MSBuild and Team Foundation Build](http://msbuildbook.com) by Sayed Ibraham Hashimi and William Bartholomew.</span></span>

## <a name="acknowledgements"></a><span data-ttu-id="e9c2b-152">Благодарности</span><span class="sxs-lookup"><span data-stu-id="e9c2b-152">Acknowledgements</span></span>

<span data-ttu-id="e9c2b-153">Я хочу поблагодарить следующих людям, которые вносили свой вклад значительные к содержимому этого учебника ряда:</span><span class="sxs-lookup"><span data-stu-id="e9c2b-153">I would like to thank the following people who made significant contributions to the content of this tutorial series:</span></span>

- [<span data-ttu-id="e9c2b-154">Alberto Poblacion, MVP &amp; MCT, Испания</span><span class="sxs-lookup"><span data-stu-id="e9c2b-154">Alberto Poblacion, MVP &amp; MCT, Spain</span></span>](https://mvp.microsoft.com/mvp/Alberto%20Poblacion%20Bolano-36772)
- <span data-ttu-id="e9c2b-155">Фергюсон Jarod, MVP разработки платформы данных, Соединенных Штатов</span><span class="sxs-lookup"><span data-stu-id="e9c2b-155">Jarod Ferguson, Data Platform Development MVP, United States</span></span>
- <span data-ttu-id="e9c2b-156">Резкого Mittal, корпорация Майкрософт</span><span class="sxs-lookup"><span data-stu-id="e9c2b-156">Harsh Mittal, Microsoft</span></span>
- <span data-ttu-id="e9c2b-157">[Джон Гэллоуэй](https://weblogs.asp.net/jgalloway) (twitter: [ @jongalloway ](http://twitter.com/jongalloway))</span><span class="sxs-lookup"><span data-stu-id="e9c2b-157">[Jon Galloway](https://weblogs.asp.net/jgalloway) (twitter: [@jongalloway](http://twitter.com/jongalloway))</span></span>
- [<span data-ttu-id="e9c2b-158">Олсон Kristina, корпорация Майкрософт</span><span class="sxs-lookup"><span data-stu-id="e9c2b-158">Kristina Olson, Microsoft</span></span>](https://blogs.iis.net/krolson/default.aspx)
- [<span data-ttu-id="e9c2b-159">Эти протоколы Майк, корпорация Майкрософт</span><span class="sxs-lookup"><span data-stu-id="e9c2b-159">Mike Pope, Microsoft</span></span>](http://www.mikepope.com/blog/DisplayBlog.aspx)
- <span data-ttu-id="e9c2b-160">Шривастав Mohit, корпорация Майкрософт</span><span class="sxs-lookup"><span data-stu-id="e9c2b-160">Mohit Srivastava, Microsoft</span></span>
- [<span data-ttu-id="e9c2b-161">Raffaele Rialdi, Италия</span><span class="sxs-lookup"><span data-stu-id="e9c2b-161">Raffaele Rialdi, Italy</span></span>](http://www.iamraf.net/)
- [<span data-ttu-id="e9c2b-162">Рик Андерсон, корпорация Майкрософт</span><span class="sxs-lookup"><span data-stu-id="e9c2b-162">Rick Anderson, Microsoft</span></span>](https://blogs.msdn.com/b/rickandy/)
- <span data-ttu-id="e9c2b-163">[Sayed Hashimi, корпорация Майкрософт](http://sedodream.com/default.aspx)(twitter: [ @sayedihashimi ](http://twitter.com/sayedihashimi))</span><span class="sxs-lookup"><span data-stu-id="e9c2b-163">[Sayed Hashimi, Microsoft](http://sedodream.com/default.aspx)(twitter: [@sayedihashimi](http://twitter.com/sayedihashimi))</span></span>
- <span data-ttu-id="e9c2b-164">[Скотт Хансельман](http://www.hanselman.com/blog/) (twitter: [ @shanselman ](http://twitter.com/shanselman))</span><span class="sxs-lookup"><span data-stu-id="e9c2b-164">[Scott Hanselman](http://www.hanselman.com/blog/) (twitter: [@shanselman](http://twitter.com/shanselman))</span></span>
- <span data-ttu-id="e9c2b-165">[Скотт Хантер, корпорация Майкрософт](https://blogs.msdn.com/b/scothu/) (twitter: [ @coolcsh ](http://twitter.com/coolcsh))</span><span class="sxs-lookup"><span data-stu-id="e9c2b-165">[Scott Hunter, Microsoft](https://blogs.msdn.com/b/scothu/) (twitter: [@coolcsh](http://twitter.com/coolcsh))</span></span>
- [<span data-ttu-id="e9c2b-166">Srđan Božović, Сербия</span><span class="sxs-lookup"><span data-stu-id="e9c2b-166">Srđan Božović, Serbia</span></span>](http://msforge.net/blogs/zmajcek/)
- <span data-ttu-id="e9c2b-167">[Вишал Joshi, корпорация Майкрософт](http://vishaljoshi.blogspot.com/) (twitter: [ @vishalrjoshi ](http://twitter.com/vishalrjoshi))</span><span class="sxs-lookup"><span data-stu-id="e9c2b-167">[Vishal Joshi, Microsoft](http://vishaljoshi.blogspot.com/) (twitter: [@vishalrjoshi](http://twitter.com/vishalrjoshi))</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e9c2b-168">[Назад](command-line-deployment.md)
> [Вперед](troubleshooting.md)</span><span class="sxs-lookup"><span data-stu-id="e9c2b-168">[Previous](command-line-deployment.md)
[Next](troubleshooting.md)</span></span>
