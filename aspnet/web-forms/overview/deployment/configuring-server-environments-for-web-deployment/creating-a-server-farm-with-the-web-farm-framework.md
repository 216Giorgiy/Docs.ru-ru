---
uid: web-forms/overview/deployment/configuring-server-environments-for-web-deployment/creating-a-server-farm-with-the-web-farm-framework
title: "Создание фермы серверов с помощью Web Farm Framework | Документы Microsoft"
author: jrjlee
description: "В этом разделе описывается использование веб-фермы (WFF) 2.0 для создания и настройки сервера веб-фермы с набора серверов."
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/04/2012
ms.topic: article
ms.assetid: 656dd06d-806c-467c-863d-9fc45e5ba3ab
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/deployment/configuring-server-environments-for-web-deployment/creating-a-server-farm-with-the-web-farm-framework
msc.type: authoredcontent
ms.openlocfilehash: c592ed78a7332834923ce2290af77919fb3c7576
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2018
---
<a name="creating-a-server-farm-with-the-web-farm-framework"></a>Создание фермы серверов с помощью платформы веб-фермы
====================
по [Джейсон Lee](https://github.com/jrjlee)

[Скачать PDF](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> В этом разделе описывается использование веб-фермы (WFF) 2.0 для создания и настройки сервера веб-фермы с набора серверов.


WFF позволяет синхронизировать веб-платформы продуктов и компонентов, веб-приложений, веб-сайтов и параметров конфигурации на несколько серверов с балансировкой нагрузки web. В сценариях, где требуется более одного веб-сервере, например промежуточной и производственной средах это может значительно упростить процесс развертывания и настройки. Можно развернуть веб-приложения на одном сервере & #x 2014; *сервера-источника*& #x 2014; и WFF будут автоматически реплицируются, веб-приложения на все другие серверы в ферме серверов.

## <a name="understanding-the-web-farm-framework"></a>Основные сведения о Web Farm Framework

WFF 2.0 можно использовать для подготовки, управления и развертывания содержимого в группу веб-серверов. Развертывания WFF состоит из трех ролей ключа сервера.

- *Сервера контроллера*. Использовать этот сервер для создания и настройки фермы серверов WFF. Сервер контроллера управляет синхронизацией компоненты веб-платформы, параметры конфигурации и приложений между веб-серверами в ферме серверов. Установите WFF 2.0 на сервере контроллера и сервера контроллера в свою очередь будет установлен агент WFF на каждом из серверов в ферме серверов. Сервер контроллера не принадлежит концептуально любой WFF ферму серверов, и сервер одного контроллера можно управлять нескольких фермах серверов. В этом сценарии используется один сервер контроллера WFF для создания и управления промежуточной фермы серверов и рабочей ферме серверов.
- *Сервера-источника*. На каждой ферме серверов WFF включает в себя один сервер-источник. При установке компоненты веб-платформы и развертывать приложения на сервере-источнике, WFF синхронизирует изменения ко всем другим серверам в ферме серверов.
- *Сервера-получателя*. На каждой ферме серверов WFF включает один или несколько серверов-получателей. Любые изменения, вносимые на сервере-источнике, реплицируются в каждый дополнительный сервер в ферме серверов.

Это показывает, как связаны Fabrikam, Inc. промежуточной и производственной средах этих ролей сервера:

![](creating-a-server-farm-with-the-web-farm-framework/_static/image1.png)

В этом сценарии промежуточной среде и в рабочей среде настроены как WFF ферм серверов. Один сервер контроллера WFF управляет обоих ферм. В пределах каждой ферме любые изменения на сервере-источнике реплицируются на каждый сервер-получатель.

Перед началом настройки промежуточных и производственных сред рекомендуется прочитать следующие статьи, чтобы ознакомиться с основными понятиями WFF 2.0:

- [Общие сведения о Web Farm Framework 2.0 для IIS 7](https://go.microsoft.com/?linkid=9805126)
- [Настройка фермы серверов с веб-фермы Framework 2.0 для IIS 7](https://go.microsoft.com/?linkid=9805127)
- [Системы и требования к платформе для Web Farm Framework 2.0 для IIS 7](https://go.microsoft.com/?linkid=9805128)

## <a name="task-overview"></a>Общие сведения о задаче

Для выполнения задач и пошаговых инструкций в этом разделе, необходимо по крайней мере три серверы & #x 2014; один контроллер WFF одного основного веб-сервера для фермы серверов и одного или нескольких получателей веб-серверов, которые для фермы серверов. Можно добавить дополнительные серверы-получатели к ферме серверов WFF в любое время. На высоком уровне, для создания и настройки фермы серверов WFF для промежуточной или производственной среды, вам потребуется:

- Создайте сервер контроллера, установив Internet Information Services (IIS) 7.5 и WFF 2.0.
- Подготовка основного и дополнительного серверов путем создания обычной учетной записи администратора и настройки исключений брандмауэра.
- Настройка фермы серверов с помощью диспетчера служб IIS на сервере контроллера.
- Настройка балансировки нагрузки с помощью IIS маршрутизации запросов приложений (ARR) или альтернативное технология балансировки нагрузки.

Задачи и пошаговые руководства в этом разделе предполагается, вы начинаете с построениями чистого сервера под управлением Windows Server 2008 R2. Прежде чем начать, для каждого сервера, убедитесь, что:

- Windows Server 2008 R2 с пакетом обновления 1 и все доступные обновления установлены.
- Сервер присоединен к домену.
- Сервер имеет статический IP-адрес.

> [!NOTE]
> Дополнительные сведения о присоединении к домену компьютеров см. в разделе [присоединение компьютеров к домену и вход](https://technet.microsoft.com/library/cc725618(v=WS.10).aspx). Дополнительные сведения о настройке статических IP-адресов см. в разделе [настроить статический IP-адрес](https://technet.microsoft.com/library/cc754203(v=ws.10).aspx).


## <a name="create-the-wff-controller-server"></a>Создайте сервер контроллера WFF

Создайте сервер контроллера WFF, необходимо установить службы IIS 7 или более поздней версии и WFF 2.0 или более поздней версии. На самом деле WFF использует средство IIS веб-развертывания (Web Deploy) 2.x для синхронизации серверов в ферме. При использовании установщика веб-платформы для установки WFF, программа установки будет автоматическую загрузку и установку веб-развертывания для вас.

**Чтобы создать сервер контроллера WFF**

1. Загрузите и установите [Web Platform Installer](https://go.microsoft.com/?linkid=9739157).
2. В верхней части **веб-платформы 3.0 установщика** окно, нажмите кнопку **продуктов**.
3. В левой части окна в области навигации выберите **сервера**.
4. В **конфигурации рекомендуется IIS 7** щелкните **добавить**.
5. В **веб-фермы Framework 2. *** x* щелкните **добавить**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image2.png)
6. Нажмите кнопку **Установить**. Обратите внимание, что установщик веб-платформы добавил к списку установки средство веб-развертывания вместе с различных других зависимостей.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image3.png)
7. Ознакомьтесь с условиями лицензии и, если вы согласны с условиями, щелкните **принимаю**.
8. После завершения установки нажмите кнопку **Готово**, а затем закройте **веб-платформы 3.0 установщика** окна.

## <a name="configure-the-primary-and-secondary-servers"></a>Настройте основной и дополнительный серверы

Прежде чем создавать WFF фермы серверов, следует выполнить некоторые задачи подготовки на веб-серверах, которые составляют фермы:

- Добавление исключений брандмауэра, чтобы разрешить **основ сетей**, **удаленного администрирования**, и **к файлам и принтерам** компоненты для связи с сервером контроллера WFF .
- Создайте учетную запись домена (например, **FABRIKAM\stagingfarm**) в Active Directory и добавьте его в группу локальных администраторов на каждом сервере. Эта учетная запись будет использоваться как учетная запись администратора фермы серверов при создания фермы серверов.

Дополнительные сведения о настройке этих исключений брандмауэра в брандмауэре Windows см. в разделе [системы и требования к платформе для веб-фермы Framework 2.0 для IIS 7](https://go.microsoft.com/?linkid=9805128). Для других систем брандмауэра обратитесь к документации продукта.

Чтобы добавить учетную запись домена в группу локальных администраторов в Windows Server 2008 R2, можно использовать следующую процедуру. Данную процедуру следует выполнять на каждом сервере, который требуется добавить в ферму серверов & #x 2014; другими словами, добавьте учетную запись домена в группу локальных администраторов на основном сервере и на каждом сервере-получателе.

**Чтобы добавить учетную запись домена в группу локальных администраторов**

1. На **запустить** последовательно выберите пункты **Администрирование**, а затем нажмите кнопку **диспетчера сервера**.
2. В **диспетчера сервера** разверните окно в области представления дерева **конфигурации**, разверните **локальные пользователи и группы**и нажмите кнопку **группы**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image4.png)
3. В **группы** панели, дважды щелкните **Администраторы**.
4. В **свойства администратора** диалоговое окно, нажмите кнопку **добавить**.
5. В **Выбор пользователей, компьютеров, учетных записей служб или групп** диалоговое окно «» введите (или найдите) в учетную запись домена (например, **FABRIKAM\stagingfarm**) и нажмите кнопку **ОК**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image5.png)
6. В **свойства администратора** диалоговое окно, нажмите кнопку **ОК**.

Серверы теперь готовы для добавления к ферме серверов. В случае с основного сервера, можно настроить сервер для удовлетворения требований приложения до или после создания фермы серверов & #x 2014; в обоих случаях WFF будет синхронизировать серверов, развернув же продуктов, компонентов, или Конфигурация с серверами-получателями. Для простоты в этом учебнике предполагается предстоит настроить основной сервер после завершения создания фермы серверов.

## <a name="create-the-wff-server-farm"></a>Создание фермы серверов WFF

На этом этапе все серверы можно добавить в ферму серверов WFF:

- WFF установленной на сервере контроллера.
- Настройки исключений брандмауэра для основного и дополнительного веб-серверов.
- Вы добавили учетную запись домена в группу локальных администраторов на первичных и вторичных веб-серверов.

Следующим шагом является создание фермы серверов в WFF. Этого можно из диспетчера служб IIS на сервере контроллера WFF.

**Чтобы создать ферму серверов WFF**

1. На сервере контроллера WFF на **запустить** последовательно выберите пункты **Администрирование**, а затем нажмите кнопку **Диспетчер Internet Information Services (IIS)**.
2. В **подключений** разверните узел локального сервера, щелкните правой кнопкой мыши **ферм серверов**, а затем нажмите кнопку **создания фермы серверов**.
3. В **создания фермы серверов** диалогового окна введите понятное имя для фермы серверов (например, **фермы промежуточной**) и выберите **подготовки фермы серверов**.
4. Введите имя пользователя и пароль учетной записи домена, добавленного в группу локальных администраторов на каждом сервере.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image6.png)
5. Нажмите кнопку **Далее**.
6. На **Добавление серверов** введите полное доменное имя (FQDN) сервера-источника, выберите **сервера-источника**, а затем нажмите кнопку **добавить**.
7. На этом этапе WFF попытается связаться с основным сервером, используя предоставленные учетные данные. Если соединение успешно установлено, сервер-источник будет добавляться в таблицу **Добавление серверов** страницы.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image7.png)

    > [!NOTE]
    > Вы могли заметить, **сервер доступен для балансировки нагрузки** выбран по умолчанию. WFF использует модуль IIS ARR для реализации балансировки нагрузки и тем самым распределения запросов на веб-серверах в ферме серверов. В большинстве случаев только снимите **сервер доступен для балансировки нагрузки** вариант, если вы хотите использовать решение балансировки нагрузки сторонних разработчиков.
8. На **Добавление серверов** введите полное доменное имя вашего первого сервера-получателя и нажмите кнопку **добавить**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image8.png)
9. Повторите шаг 7 для все дополнительные серверы в ферме, а затем нажмите кнопку **Готово**.

Ферма серверов WFF — теперь настроен и работает. Любой веб-платформы продуктов или компонентов, установленных на сервере-источнике и любой веб-приложений или содержимого, развертываемого на сервере-источнике, будут автоматически подготовлен на все дополнительные серверы.

WFF — тема широкие и сложные и Дополнительные сведения об этом можно узнать на [Framework Microsoft веб-фермы 2.0 для IIS 7](https://go.microsoft.com/?linkid=9805129) веб-сайта. На данный момент, однако существует две области функции, которые необходимо иметь в виду:

- *Подготовка приложения* — это процесс, реплицирует содержимое с сервера-источника, таких как веб-приложения и параметры конфигурации по все дополнительные серверы в ферме серверов. Например при развертывании диспетчера контактов примера решения для промежуточного сервера-источника процесс подготовки WFF приложения будет развернуть это решение все дополнительные серверы промежуточного. По умолчанию процесс подготовки приложения запускается каждые 30 секунд.
- *Подготовка платформы* — это процесс, который синхронизирует веб-платформы продуктов и компонентов с сервера-источника для всех серверов-получателей в ферме серверов. Например если установить ASP.NET MVC 3 на промежуточном сервере-источнике, процесс подготовки платформы будет использоваться установщика веб-платформы для установки ASP.NET MVC 3 на все дополнительные серверы промежуточного. По умолчанию процесс подготовки платформы выполняется каждые пять минут.

Можно управлять основного приложения и параметры подготовки платформы с помощью диспетчера служб IIS на вашем сервере контроллера WFF.

**Исследовать приложения и платформы, параметры подготовки**

1. В диспетчере служб IIS в **подключений** панели выберите фермы серверов.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image9.png)
2. В **фермы серверов** панели, дважды щелкните **Подготовка приложения**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image10.png)
3. Как видите, ферма серверов настроено для синхронизации веб-содержимого и конфигурации параметров между основной сервер и сервер-получатель каждые 30 секунд.
4. Нажмите кнопку **обратно**, а затем дважды щелкните **подготовка платформы**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image11.png)
5. Как видите, ферма серверов настроено для синхронизации веб-платформы продуктов и компонентов, между основной сервер и сервер-получатель каждые пять минут.
6. Нажмите кнопку **обратно**.
7. Чтобы принудительно фермы серверов для синхронизации веб-платформы продуктов немедленно, в **действия** области, нажмите кнопку **подготовки платформы**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image12.png)

    > [!NOTE]
    > Подготовка платформы может занять некоторое время. Процесс установки выполняется в фоновом режиме на серверах-получателях на ферме серверов.
8. После разрешен достаточно времени для завершения процесса подготовки, вы можете проверить, что продуктов и компонентов, которые добавлены для основного сервера теперь были реплицированы на серверах-получателях. Например, войдите на сервер-получатель и использовать **диспетчера сервера** окна, чтобы убедиться, что установлена роль веб-сервера.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image13.png)
9. Можно также проверить список установленных программ, чтобы убедиться, что были добавлены различные компоненты веб-платформы.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image14.png)

## <a name="configure-load-balancing"></a>Настройка балансировки нагрузки

При создании веб-фермы, необходимо настроить определенные виды балансировки для распределения запросов HTTP между веб-серверов. Это может быть IIS ARR, балансировка нагрузки сети Windows Server 2008 или решение балансировки нагрузки программных или аппаратных сторонних разработчиков.

WFF предназначен для тесно интегрировать маршрутизации запросов приложений IIS. Чтобы воспользоваться преимуществом такой интеграции, необходимо установить модуль маршрутизации запросов Приложений на сервере контроллера WFF. Можно направлять все веб-трафика на сервер контроллера, обычно путем настройки записей доменных имен (DNS). Сервер контроллера будет распределять входящие запросы между серверами в ферме, на основе доступности сервера и другим критериям.

> [!NOTE]
> Нет необходимости использовать ARR с WFF; Вы можете настроить WFF для работы с решения балансировки нагрузки сторонних разработчиков. Дополнительные сведения см. в разделе [Общие сведения о веб-фермы Framework 2.0 для IIS 7](https://go.microsoft.com/?linkid=9805126).


Балансировка нагрузки с помощью ARR — сложная тема, наиболее которого выходит за рамки данного руководства. Тем не менее можно использовать следующую процедуру для установки модуля маршрутизации запросов Приложений и приступить к работе с балансировкой нагрузки.

**Настройка балансировки нагрузки на сервер контроллера WFF**

1. На сервере контроллера WFF запустите установщик веб-платформы.
2. В верхней части **веб-платформы 3.0 установщика** окно, нажмите кнопку **продуктов**.
3. В левой части окна в области навигации выберите **сервера**.
4. В **2.5 маршрутизации запросов приложений** щелкните **добавить**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image15.png)
5. Нажмите кнопку **установить**, а затем следуйте инструкциям в разделе **Установка веб-платформы** окна.
6. После завершения установки запустите диспетчер IIS и в **подключений** области, щелкните узел фермы сервера. Обратите внимание, что были добавлены несколько новых значков **фермы серверов** области.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image16.png)
7. В **фермы серверов** панели, дважды щелкните **Балансировка нагрузки**.
8. В **средства балансировки нагрузки** алгоритм балансировки нагрузки выберите (например, **бы текущего запроса**).

    > [!NOTE]
    > Дополнительные сведения о балансировки нагрузки алгоритмы и других параметров конфигурации см. в разделе [модуль маршрутизации запросов приложений](https://go.microsoft.com/?linkid=9805130).

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image17.png)
9. В **действия** области, нажмите кнопку **применить**.

Теперь вы настроили основные балансировку нагрузки для серверов в ферме серверов. Если можно направлять все веб-фермы трафика на сервер контроллера, запросы распределяются между серверами в ферме, в соответствии с доступностью и алгоритма балансировки нагрузки, выбранный.

Дополнительные сведения о настройке балансировки нагрузки с помощью ARR см. в разделе [модуль маршрутизации запросов приложений](https://go.microsoft.com/?linkid=9805130).

## <a name="monitor-the-server-farm"></a>Монитор фермы серверов

Можно отслеживать работоспособность фермы серверов в любое время диспетчере IIS на сервере контроллера. В **подключений** разверните фермы серверов и нажмите кнопку **серверов**. На центральной панели будет Показать сводку каждого сервера в ферме вместе с последней активности журнала трассировки.

![](creating-a-server-farm-with-the-web-farm-framework/_static/image18.png)

## <a name="conclusion"></a>Заключение

Ферма серверов WFF теперь должен быть запущен и работает. Можно настроить для поддержки независимо от подхода к развертыванию вы предпочитаете & #x 2014 сервера-источника, см. в разделе Дополнительные материалы, сведения & #x 2014; и конфигурации, будут реплицированы на каждом сервере-получателе в ферме серверов.

## <a name="further-reading"></a>Дополнительные сведения

Дополнительные рекомендации по настройке и использовании WFF все аспекты см. в разделе [Framework Microsoft веб-фермы 2.0 для IIS 7](https://go.microsoft.com/?linkid=9805129) веб-сайта.

>[!div class="step-by-step"]
[Назад](configuring-a-database-server-for-web-deploy-publishing.md)
[Вперед](configuring-deployment-properties-for-a-target-environment.md)
