---
uid: web-forms/overview/data-access/custom-button-actions-with-the-datalist-and-repeater/custom-buttons-in-the-datalist-and-repeater-cs
title: "Пользовательские кнопки в DataList и повторителя (C#) | Документы Microsoft"
author: rick-anderson
description: "В этом учебнике мы создадим интерфейс, который используется повторитель для получения списка категорий в системе, с помощью каждой категории, предоставляя кнопки, чтобы показать его associ..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 11/13/2006
ms.topic: article
ms.assetid: 1f42e332-78dc-438b-9e35-0c97aa0ad929
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/custom-button-actions-with-the-datalist-and-repeater/custom-buttons-in-the-datalist-and-repeater-cs
msc.type: authoredcontent
ms.openlocfilehash: 9a072ae18bbb19d086eb825c6e72b68d40b2e429
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2018
---
<a name="custom-buttons-in-the-datalist-and-repeater-c"></a><span data-ttu-id="45ab1-103">Пользовательские кнопки в DataList и повторителя (C#)</span><span class="sxs-lookup"><span data-stu-id="45ab1-103">Custom Buttons in the DataList and Repeater (C#)</span></span>
====================
<span data-ttu-id="45ab1-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="45ab1-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="45ab1-105">[Загрузить пример приложения](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_46_CS.exe) или [скачать PDF](custom-buttons-in-the-datalist-and-repeater-cs/_static/datatutorial46cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="45ab1-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_46_CS.exe) or [Download PDF](custom-buttons-in-the-datalist-and-repeater-cs/_static/datatutorial46cs1.pdf)</span></span>

> <span data-ttu-id="45ab1-106">В этом учебнике мы создадим интерфейс, который используется повторитель для получения списка категорий в системе, с помощью каждой категории, предоставляя кнопку, чтобы отобразить соответствующие продукты с помощью элемента управления маркированный список.</span><span class="sxs-lookup"><span data-stu-id="45ab1-106">In this tutorial we'll build an interface that uses a Repeater to list the categories in the system, with each category providing a button to show its associated products using a BulletedList control.</span></span>


## <a name="introduction"></a><span data-ttu-id="45ab1-107">Вступление</span><span class="sxs-lookup"><span data-stu-id="45ab1-107">Introduction</span></span>

<span data-ttu-id="45ab1-108">На протяжении последних семнадцать DataList и повторителя учебники мы хранять создан как примеры только для чтения и редактирования и удаления примеры.</span><span class="sxs-lookup"><span data-stu-id="45ab1-108">Throughout the past seventeen DataList and Repeater tutorials, we ve created both read-only examples and editing and deleting examples.</span></span> <span data-ttu-id="45ab1-109">Чтобы упростить редактирование и удаление возможностей в DataList, мы добавили кнопки DataList s `ItemTemplate` , при щелчке вызвал обратную передачу и возникает событие DataList, соответствующий кнопку s `CommandName` свойство.</span><span class="sxs-lookup"><span data-stu-id="45ab1-109">To facilitate editing and deleting capabilities within a DataList, we added buttons to the DataList s `ItemTemplate` that, when clicked, caused a postback and raised a DataList event corresponding to the button s `CommandName` property.</span></span> <span data-ttu-id="45ab1-110">Например, добавив в `ItemTemplate` с `CommandName` свойство редактирования значении DataList s `EditCommand` для срабатывания на обратной передачи; с `CommandName` удалить вызывает `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="45ab1-110">For example, adding a button to the `ItemTemplate` with a `CommandName` property value of Edit causes the DataList s `EditCommand` to fire on postback; one with the `CommandName` Delete raises the `DeleteCommand`.</span></span>

<span data-ttu-id="45ab1-111">Дополнительно на изменение и удаление кнопки, элементы управления DataList и повторителя могут также включать кнопок, элементов управления LinkButton и ImageButtons, при щелчке выполнять определенную настраиваемую логику на стороне сервера.</span><span class="sxs-lookup"><span data-stu-id="45ab1-111">In addition to Edit and Delete buttons, the DataList and Repeater controls can also include Buttons, LinkButtons, or ImageButtons that, when clicked, perform some custom server-side logic.</span></span> <span data-ttu-id="45ab1-112">В этом учебнике мы создадим интерфейс, который используется повторитель, чтобы вывести список категорий в системе.</span><span class="sxs-lookup"><span data-stu-id="45ab1-112">In this tutorial we'll build an interface that uses a Repeater to list the categories in the system.</span></span> <span data-ttu-id="45ab1-113">Для каждой категории повторителя будут содержаться кнопки, чтобы показать категории продуктов, связанные с помощью элемента управления маркированный список (см. рис. 1).</span><span class="sxs-lookup"><span data-stu-id="45ab1-113">For each category, the Repeater will include a button to show the category s associated products using a BulletedList control (see Figure 1).</span></span>


<span data-ttu-id="45ab1-114">[![Щелкнув отображает ссылку продуктов Показать s категории продуктов в виде маркированного списка](custom-buttons-in-the-datalist-and-repeater-cs/_static/image2.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="45ab1-114">[![Clicking the Show Products Link Displays the Category s Products in a Bulleted List](custom-buttons-in-the-datalist-and-repeater-cs/_static/image2.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image1.png)</span></span>

<span data-ttu-id="45ab1-115">**Рис. 1**: щелкнув отображает Показать связи продукты категории s продуктов в виде маркированного списка ([Просмотр полноразмерное изображение](custom-buttons-in-the-datalist-and-repeater-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="45ab1-115">**Figure 1**: Clicking the Show Products Link Displays the Category s Products in a Bulleted List ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-cs/_static/image3.png))</span></span>


## <a name="step-1-adding-the-custom-button-tutorial-web-pages"></a><span data-ttu-id="45ab1-116">Шаг 1: Добавление пользовательской кнопки учебника веб-страницы</span><span class="sxs-lookup"><span data-stu-id="45ab1-116">Step 1: Adding the Custom Button Tutorial Web Pages</span></span>

<span data-ttu-id="45ab1-117">Прежде чем мы рассмотрим способы добавления настраиваемой кнопки позволяют s сначала занять некоторое время для создания страниц ASP.NET в данном проекте веб-сайта, он понадобится для этого учебника.</span><span class="sxs-lookup"><span data-stu-id="45ab1-117">Before we look at how to add a custom button, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial.</span></span> <span data-ttu-id="45ab1-118">Начните с добавления в новую папку с именем `CustomButtonsDataListRepeater`.</span><span class="sxs-lookup"><span data-stu-id="45ab1-118">Start by adding a new folder named `CustomButtonsDataListRepeater`.</span></span> <span data-ttu-id="45ab1-119">Добавьте следующие две страницы ASP.NET в этой папке, убедитесь, что связать каждую страницу с `Site.master` главной страницы:</span><span class="sxs-lookup"><span data-stu-id="45ab1-119">Next, add the following two ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `CustomButtons.aspx`


![Добавление страниц ASP.NET для пользовательских кнопок руководств](custom-buttons-in-the-datalist-and-repeater-cs/_static/image4.png)

<span data-ttu-id="45ab1-121">**На рисунке 2**: Добавление страницы ASP.NET для пользовательских кнопок руководств</span><span class="sxs-lookup"><span data-stu-id="45ab1-121">**Figure 2**: Add the ASP.NET Pages for the Custom Buttons-Related Tutorials</span></span>


<span data-ttu-id="45ab1-122">Как и в других папках, `Default.aspx` в `CustomButtonsDataListRepeater` папки будут перечислены учебники в своем разделе.</span><span class="sxs-lookup"><span data-stu-id="45ab1-122">Like in the other folders, `Default.aspx` in the `CustomButtonsDataListRepeater` folder will list the tutorials in its section.</span></span> <span data-ttu-id="45ab1-123">Помните, что `SectionLevelTutorialListing.ascx` пользовательский элемент управления предоставляет следующие функциональные возможности.</span><span class="sxs-lookup"><span data-stu-id="45ab1-123">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="45ab1-124">Этот пользовательский элемент управления, чтобы добавить `Default.aspx` , перетащив его из обозревателя решений на странице s представление конструктора.</span><span class="sxs-lookup"><span data-stu-id="45ab1-124">Add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="45ab1-125">[![Добавление Default.aspx SectionLevelTutorialListing.ascx пользовательского элемента управления](custom-buttons-in-the-datalist-and-repeater-cs/_static/image6.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="45ab1-125">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](custom-buttons-in-the-datalist-and-repeater-cs/_static/image6.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image5.png)</span></span>

<span data-ttu-id="45ab1-126">**Рис. 3**: добавление `SectionLevelTutorialListing.ascx` пользовательский элемент управления `Default.aspx` ([Просмотр полноразмерное изображение](custom-buttons-in-the-datalist-and-repeater-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="45ab1-126">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-cs/_static/image7.png))</span></span>


<span data-ttu-id="45ab1-127">Наконец, добавления страниц, как операции для `Web.sitemap` файла.</span><span class="sxs-lookup"><span data-stu-id="45ab1-127">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="45ab1-128">В частности, добавьте следующую разметку после разбиения по страницам и сортировка с DataList и повторителя `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="45ab1-128">Specifically, add the following markup after the Paging and Sorting with the DataList and Repeater `<siteMapNode>`:</span></span>


[!code-xml[Main](custom-buttons-in-the-datalist-and-repeater-cs/samples/sample1.xml)]

<span data-ttu-id="45ab1-129">После обновления `Web.sitemap`, занять некоторое время для просмотра учебников веб-сайт с помощью браузера.</span><span class="sxs-lookup"><span data-stu-id="45ab1-129">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="45ab1-130">В левом меню теперь включает элементы для редактирования, вставки и удаления учебники.</span><span class="sxs-lookup"><span data-stu-id="45ab1-130">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>


![Карта сайта теперь включает записи для пользовательских кнопок учебника](custom-buttons-in-the-datalist-and-repeater-cs/_static/image8.png)

<span data-ttu-id="45ab1-132">**Рис. 4**: карта сайта теперь включает записи для пользовательских кнопок учебника</span><span class="sxs-lookup"><span data-stu-id="45ab1-132">**Figure 4**: The Site Map Now Includes the Entry for the Custom Buttons Tutorial</span></span>


## <a name="step-2-adding-the-list-of-categories"></a><span data-ttu-id="45ab1-133">Шаг 2: Добавление в список категорий</span><span class="sxs-lookup"><span data-stu-id="45ab1-133">Step 2: Adding the List of Categories</span></span>

<span data-ttu-id="45ab1-134">В этом учебнике мы должны установить повторителя, в которой перечислены все категории вместе с LinkButton Показать продукты, при нажатии отображает связанные категории s продуктов в виде маркированного списка.</span><span class="sxs-lookup"><span data-stu-id="45ab1-134">For this tutorial we need to create a Repeater that lists all categories along with a Show Products LinkButton that, when clicked, displays the associated category s products in a bulleted list.</span></span> <span data-ttu-id="45ab1-135">Разрешить s сначала создайте простой повторитель, перечислены категории в системе.</span><span class="sxs-lookup"><span data-stu-id="45ab1-135">Let s first create a simple Repeater that lists the categories in the system.</span></span> <span data-ttu-id="45ab1-136">Сначала откройте `CustomButtons.aspx` страницы в `CustomButtonsDataListRepeater` папки.</span><span class="sxs-lookup"><span data-stu-id="45ab1-136">Start by opening the `CustomButtons.aspx` page in the `CustomButtonsDataListRepeater` folder.</span></span> <span data-ttu-id="45ab1-137">Перетащите повторитель из области элементов в область конструктора и задайте его `ID` свойства `Categories`.</span><span class="sxs-lookup"><span data-stu-id="45ab1-137">Drag a Repeater from the Toolbox onto the Designer and set its `ID` property to `Categories`.</span></span> <span data-ttu-id="45ab1-138">Создайте новый элемент управления источником данных в смарт-теге s повторителя.</span><span class="sxs-lookup"><span data-stu-id="45ab1-138">Next, create a new data source control from the Repeater s smart tag.</span></span> <span data-ttu-id="45ab1-139">В частности, создать новый элемент управления ObjectDataSource `CategoriesDataSource` , которая выбирает данные из `CategoriesBLL` класса s `GetCategories()` метод.</span><span class="sxs-lookup"><span data-stu-id="45ab1-139">Specifically, create a new ObjectDataSource control named `CategoriesDataSource` that selects its data from the `CategoriesBLL` class s `GetCategories()` method.</span></span>


<span data-ttu-id="45ab1-140">[![Настройка ObjectDataSource можно использовать метод GetCategories() класса CategoriesBLL s](custom-buttons-in-the-datalist-and-repeater-cs/_static/image10.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="45ab1-140">[![Configure the ObjectDataSource to Use the CategoriesBLL Class s GetCategories() Method](custom-buttons-in-the-datalist-and-repeater-cs/_static/image10.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image9.png)</span></span>

<span data-ttu-id="45ab1-141">**Рис. 5**: Настройка ObjectDataSource для использования `CategoriesBLL` класса s `GetCategories()` метод ([Просмотр полноразмерное изображение](custom-buttons-in-the-datalist-and-repeater-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="45ab1-141">**Figure 5**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class s `GetCategories()` Method ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-cs/_static/image11.png))</span></span>


<span data-ttu-id="45ab1-142">В отличие от управления DataList, для которого по умолчанию Visual Studio создает `ItemTemplate` на основе источника данных, повторителя s шаблоны должны быть определены вручную.</span><span class="sxs-lookup"><span data-stu-id="45ab1-142">Unlike the DataList control, for which Visual Studio creates a default `ItemTemplate` based on the data source, the Repeater s templates must be manually defined.</span></span> <span data-ttu-id="45ab1-143">Кроме того, должно быть создано и редактировать декларативно шаблоны повторителя s (то есть отсутствует s не редактирование шаблонов параметра повторителя s смарт-тега).</span><span class="sxs-lookup"><span data-stu-id="45ab1-143">Furthermore, the Repeater s templates must be created and edited declaratively (that is, there s no Edit Templates option in the Repeater s smart tag).</span></span>

<span data-ttu-id="45ab1-144">Щелкните на вкладке "источник" в левом нижнем углу и добавьте `ItemTemplate` , отображает имя категории s в `<h3>` элемента и его описание в абзаце тег; включить `SeparatorTemplate` , отображает горизонтальную линию (`<hr />`) между каждым Категория.</span><span class="sxs-lookup"><span data-stu-id="45ab1-144">Click on the Source tab in the bottom left corner and add an `ItemTemplate` that displays the category s name in an `<h3>` element and its description in a paragraph tag; include a `SeparatorTemplate` that displays a horizontal rule (`<hr />`) between each category.</span></span> <span data-ttu-id="45ab1-145">Также добавьте LinkButton с его `Text` значение свойства для отображения продуктов.</span><span class="sxs-lookup"><span data-stu-id="45ab1-145">Also add a LinkButton with its `Text` property set to Show Products.</span></span> <span data-ttu-id="45ab1-146">После выполнения этих действий декларативная разметка s страница должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="45ab1-146">After completing these steps, your page s declarative markup should look like the following:</span></span>


[!code-aspx[Main](custom-buttons-in-the-datalist-and-repeater-cs/samples/sample2.aspx)]

<span data-ttu-id="45ab1-147">Рис. 6 показан страниц при просмотре через браузер.</span><span class="sxs-lookup"><span data-stu-id="45ab1-147">Figure 6 shows the page when viewed through a browser.</span></span> <span data-ttu-id="45ab1-148">Отображается каждый название и описание категории.</span><span class="sxs-lookup"><span data-stu-id="45ab1-148">Each category name and description is listed.</span></span> <span data-ttu-id="45ab1-149">Показать продукты при нажатии кнопки, вызывает обратную передачу, но еще не выполняет никаких действий.</span><span class="sxs-lookup"><span data-stu-id="45ab1-149">The Show Products button, when clicked, causes a postback but does not yet perform any action.</span></span>


<span data-ttu-id="45ab1-150">[![Каждая категория s имя и описание отображается, вместе с LinkButton Показать продуктов](custom-buttons-in-the-datalist-and-repeater-cs/_static/image13.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="45ab1-150">[![Each Category s Name and Description is Displayed, Along with a Show Products LinkButton](custom-buttons-in-the-datalist-and-repeater-cs/_static/image13.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image12.png)</span></span>

<span data-ttu-id="45ab1-151">**Рис. 6**: s каждой категории имя и описание отображается, вместе с LinkButton Показать продуктов ([Просмотр полноразмерное изображение](custom-buttons-in-the-datalist-and-repeater-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="45ab1-151">**Figure 6**: Each Category s Name and Description is Displayed, Along with a Show Products LinkButton ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-cs/_static/image14.png))</span></span>


## <a name="step-3-executing-server-side-logic-when-the-show-products-linkbutton-is-clicked"></a><span data-ttu-id="45ab1-152">Шаг 3: Выполнение серверную логику при Показать продуктов LinkButton нажата</span><span class="sxs-lookup"><span data-stu-id="45ab1-152">Step 3: Executing Server-Side Logic When the Show Products LinkButton is Clicked</span></span>

<span data-ttu-id="45ab1-153">Происходит каждый раз, когда нажимается кнопка, LinkButton или ImageButton внутри шаблона в DataList или повторителя обратная передача и s DataList или повторителя `ItemCommand` вызывается событие.</span><span class="sxs-lookup"><span data-stu-id="45ab1-153">Anytime a Button, LinkButton, or ImageButton within a template in a DataList or Repeater is clicked, a postback occurs and the DataList or Repeater s `ItemCommand` event fires.</span></span> <span data-ttu-id="45ab1-154">В дополнение к `ItemCommand` событий DataList управления также может вызвать другой, более конкретные события, если кнопка s `CommandName` свойству присваивается одно из зарезервированных строк (удалять, изменять, "Отмена", обновление и выберите), но `ItemCommand` событие является *всегда* возникает.</span><span class="sxs-lookup"><span data-stu-id="45ab1-154">In addition to the `ItemCommand` event, the DataList control may also raise another, more specific event if the button s `CommandName` property is set to one of the reserved strings ( Delete, Edit, Cancel, Update, or Select ), but the `ItemCommand` event is *always* fired.</span></span>

<span data-ttu-id="45ab1-155">При нажатии кнопки в DataList или повторителя зачастую необходимо передать какая кнопка была нажата (в случае, что может быть несколько кнопок в элементе управления, такие как оба изменения и кнопку «Удалить») и может быть некоторые дополнительные сведения (такие как значению ключа элемента, для которого была нажата).</span><span class="sxs-lookup"><span data-stu-id="45ab1-155">When a button is clicked within a DataList or Repeater, oftentimes we need to pass along which button was clicked (in the case that there may be multiple buttons within the control, such as both an Edit and Delete button) and perhaps some additional information (such as the primary key value of the item whose button was clicked).</span></span> <span data-ttu-id="45ab1-156">Кнопка, LinkButton и ImageButton предоставляют два свойства, значения которого будут переданы `ItemCommand` обработчик событий:</span><span class="sxs-lookup"><span data-stu-id="45ab1-156">The Button, LinkButton, and ImageButton provide two properties whose values are passed to the `ItemCommand` event handler:</span></span>

- <span data-ttu-id="45ab1-157">`CommandName`Строка, обычно используются для определения каждой кнопки в шаблоне</span><span class="sxs-lookup"><span data-stu-id="45ab1-157">`CommandName` a string typically used to identify each button in the template</span></span>
- <span data-ttu-id="45ab1-158">`CommandArgument`обычно используется для хранения значения некоторые поля данных, например значения первичного ключа</span><span class="sxs-lookup"><span data-stu-id="45ab1-158">`CommandArgument` commonly used to hold the value of some data field, such as the primary key value</span></span>

<span data-ttu-id="45ab1-159">В этом примере набор LinkButton s `CommandName` свойство ShowProducts и привязки текущей записи s значения первичного ключа `CategoryID` для `CommandArgument` свойства, используя синтаксис привязки данных `CategoryArgument='<%# Eval("CategoryID") %>'`.</span><span class="sxs-lookup"><span data-stu-id="45ab1-159">For this example, set the LinkButton s `CommandName` property to ShowProducts and bind the current record s primary key value `CategoryID` to the `CommandArgument` property using the databinding syntax `CategoryArgument='<%# Eval("CategoryID") %>'`.</span></span> <span data-ttu-id="45ab1-160">После указания этих свойств, LinkButton s должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="45ab1-160">After specifying these two properties, the LinkButton s declarative syntax should look like the following:</span></span>


[!code-aspx[Main](custom-buttons-in-the-datalist-and-repeater-cs/samples/sample3.aspx)]

<span data-ttu-id="45ab1-161">При нажатии кнопки, обратная передача и s DataList или повторителя `ItemCommand` вызывается событие.</span><span class="sxs-lookup"><span data-stu-id="45ab1-161">When the button is clicked, a postback occurs and the DataList or Repeater s `ItemCommand` event fires.</span></span> <span data-ttu-id="45ab1-162">Обработчик событий передается кнопку s `CommandName` и `CommandArgument` значения.</span><span class="sxs-lookup"><span data-stu-id="45ab1-162">The event handler is passed the button s `CommandName` and `CommandArgument` values.</span></span>

<span data-ttu-id="45ab1-163">Создайте обработчик событий для повторителя s `ItemCommand` событий и обратите внимание на второй параметр, переданный в обработчик событий (с именем `e`).</span><span class="sxs-lookup"><span data-stu-id="45ab1-163">Create an event handler for the Repeater s `ItemCommand` event and note the second parameter passed into the event handler (named `e`).</span></span> <span data-ttu-id="45ab1-164">Этот второй параметр имеет тип [ `RepeaterCommandEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeatercommandeventargs.aspx) и имеет следующие четыре свойства:</span><span class="sxs-lookup"><span data-stu-id="45ab1-164">This second parameter is of type [`RepeaterCommandEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeatercommandeventargs.aspx) and has the following four properties:</span></span>

- <span data-ttu-id="45ab1-165">`CommandArgument`значение нажатой кнопке s `CommandArgument` свойство</span><span class="sxs-lookup"><span data-stu-id="45ab1-165">`CommandArgument` the value of the clicked button s `CommandArgument` property</span></span>
- <span data-ttu-id="45ab1-166">`CommandName`значение кнопки s `CommandName` свойство</span><span class="sxs-lookup"><span data-stu-id="45ab1-166">`CommandName` the value of the button s `CommandName` property</span></span>
- <span data-ttu-id="45ab1-167">`CommandSource`ссылку на элемент управления button, который был щелкнут</span><span class="sxs-lookup"><span data-stu-id="45ab1-167">`CommandSource` a reference to the button control that was clicked</span></span>
- <span data-ttu-id="45ab1-168">`Item`ссылку на [ `RepeaterItem` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem.aspx) , содержащий кнопки, которая была нажата; каждая запись, привязанный к повторителя представляется в виде`RepeaterItem`</span><span class="sxs-lookup"><span data-stu-id="45ab1-168">`Item` a reference to the [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem.aspx) that contains the button that was clicked; each record bound to the Repeater is manifested as a `RepeaterItem`</span></span>

<span data-ttu-id="45ab1-169">С момента выбранной категории s `CategoryID` переданными в виде `CommandArgument` свойства, мы можем получить набор продукты, связанные с выбранной категории в `ItemCommand` обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="45ab1-169">Since the selected category s `CategoryID` is passed in via the `CommandArgument` property, we can get the set of products associated with the selected category in the `ItemCommand` event handler.</span></span> <span data-ttu-id="45ab1-170">Эти продукты затем могут быть привязаны к элементу управления BulletedList в `ItemTemplate` (который мы хранять еще для добавления).</span><span class="sxs-lookup"><span data-stu-id="45ab1-170">These products can then be bound to a BulletedList control in the `ItemTemplate` (which we ve yet to add).</span></span> <span data-ttu-id="45ab1-171">Все остается, затем — добавление маркированный список ссылок на него в `ItemCommand` обработчик событий и привязать к нему набор продуктов для выбранной категории, мы исследуем в этом выпуске на шаге 4.</span><span class="sxs-lookup"><span data-stu-id="45ab1-171">All that remains, then, is to add the BulletedList, reference it in the `ItemCommand` event handler, and bind to it the set of products for the selected category, which we'll tackle in Step 4.</span></span>

> [!NOTE]
> <span data-ttu-id="45ab1-172">Элемент управления DataList s `ItemCommand` обработчик событий передается объект типа [ `DataListCommandEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistcommandeventargs.aspx), который предоставляет те же четыре свойства, как `RepeaterCommandEventArgs` класса.</span><span class="sxs-lookup"><span data-stu-id="45ab1-172">The DataList s `ItemCommand` event handler is passed an object of type [`DataListCommandEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistcommandeventargs.aspx), which offers the same four properties as the `RepeaterCommandEventArgs` class.</span></span>


## <a name="step-4-displaying-the-selected-category-s-products-in-a-bulleted-list"></a><span data-ttu-id="45ab1-173">Шаг 4: Отображение s выбранной категории продуктов в виде маркированного списка</span><span class="sxs-lookup"><span data-stu-id="45ab1-173">Step 4: Displaying the Selected Category s Products in a Bulleted List</span></span>

<span data-ttu-id="45ab1-174">Продукты выбранной категории s может отображаться в повторителя s `ItemTemplate` с помощью любое количество элементов управления.</span><span class="sxs-lookup"><span data-stu-id="45ab1-174">The selected category s products can be displayed within the Repeater s `ItemTemplate` using any number of controls.</span></span> <span data-ttu-id="45ab1-175">Нам удалось добавить другой вложенные повторителя, DataList, DropDownList, GridView и т. д.</span><span class="sxs-lookup"><span data-stu-id="45ab1-175">We could add another nested Repeater, a DataList, a DropDownList, a GridView, and so on.</span></span> <span data-ttu-id="45ab1-176">Поскольку мы хотим для отображения продуктов в виде маркированного списка, менее, мы будем использовать элемент управления маркированный список.</span><span class="sxs-lookup"><span data-stu-id="45ab1-176">Since we want to display the products as a bulleted list, though, we'll use the BulletedList control.</span></span> <span data-ttu-id="45ab1-177">Возврат к `CustomButtons.aspx` s декларативная разметка страницы, добавить элемент управления BulletedList `ItemTemplate` после LinkButton Показать продуктов.</span><span class="sxs-lookup"><span data-stu-id="45ab1-177">Returning to the `CustomButtons.aspx` page s declarative markup, add a BulletedList control to the `ItemTemplate` after the Show Products LinkButton.</span></span> <span data-ttu-id="45ab1-178">Набор BulletedLists s `ID` для `ProductsInCategory`.</span><span class="sxs-lookup"><span data-stu-id="45ab1-178">Set the BulletedLists s `ID` to `ProductsInCategory`.</span></span> <span data-ttu-id="45ab1-179">Маркированный список отображает значение поля данных, указанного с помощью `DataTextField` свойства; поскольку этот элемент управления будет иметь сведения о продукте привязанным к нему, установить `DataTextField` свойства `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="45ab1-179">The BulletedList displays the value of the data field specified via the `DataTextField` property; since this control will have product information bound to it, set the `DataTextField` property to `ProductName`.</span></span>


[!code-aspx[Main](custom-buttons-in-the-datalist-and-repeater-cs/samples/sample4.aspx)]

<span data-ttu-id="45ab1-180">В `ItemCommand` обработчика событий, ссылаются на этот элемент управления с помощью `e.Item.FindControl("ProductsInCategory")` и привязать их к набору продукты, связанные с выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="45ab1-180">In the `ItemCommand` event handler, reference this control using `e.Item.FindControl("ProductsInCategory")` and bind it to the set of products associated with the selected category.</span></span>


[!code-csharp[Main](custom-buttons-in-the-datalist-and-repeater-cs/samples/sample5.cs)]

<span data-ttu-id="45ab1-181">Перед выполнением любого действия в `ItemCommand` обработчика событий, он s, разумным шагом будет сначала проверьте значение входящего `CommandName`.</span><span class="sxs-lookup"><span data-stu-id="45ab1-181">Before performing any action in the `ItemCommand` event handler, it s prudent to first check the value of the incoming `CommandName`.</span></span> <span data-ttu-id="45ab1-182">Поскольку `ItemCommand` обработчик событий применяется при *любой* кнопки, если используется шаблон нескольких кнопок `CommandName` значение для распознавания какое действие необходимо выполнить.</span><span class="sxs-lookup"><span data-stu-id="45ab1-182">Since the `ItemCommand` event handler fires when *any* button is clicked, if there are multiple buttons in the template use the `CommandName` value to discern what action to take.</span></span> <span data-ttu-id="45ab1-183">Проверка `CommandName` Вот получается, так как у нас имеется только одна кнопка, но это хорошая привычка формы.</span><span class="sxs-lookup"><span data-stu-id="45ab1-183">Checking the `CommandName` here is moot, since we only have a single button, but it is a good habit to form.</span></span> <span data-ttu-id="45ab1-184">Далее, `CategoryID` выбранной категории извлекается из `CommandArgument` свойство.</span><span class="sxs-lookup"><span data-stu-id="45ab1-184">Next, the `CategoryID` of the selected category is retrieved from the `CommandArgument` property.</span></span> <span data-ttu-id="45ab1-185">Элемент управления маркированный список в шаблоне является ссылка на, а также к результаты `ProductsBLL` класса s `GetProductsByCategoryID(categoryID)` метод.</span><span class="sxs-lookup"><span data-stu-id="45ab1-185">The BulletedList control in the template is then referenced and bound to the results of the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method.</span></span>

<span data-ttu-id="45ab1-186">В предыдущих учебниках, используемые кнопки в DataList, такие как [Обзор редактирование и удаление данных в DataList](../editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md), мы определили значения первичного ключа данного элемента через `DataKeys` коллекции.</span><span class="sxs-lookup"><span data-stu-id="45ab1-186">In previous tutorials that used the buttons within a DataList, such as [An Overview of Editing and Deleting Data in the DataList](../editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md), we determined the primary key value of a given item via the `DataKeys` collection.</span></span> <span data-ttu-id="45ab1-187">Хотя этот подход хорошо работает с DataList, не предоставляет достаточно повторителя `DataKeys` свойство.</span><span class="sxs-lookup"><span data-stu-id="45ab1-187">While this approach works well with the DataList, the Repeater does not have a `DataKeys` property.</span></span> <span data-ttu-id="45ab1-188">Вместо этого необходимо использовать альтернативный подход для предоставления значения первичного ключа, например через кнопку s `CommandArgument` свойства или путем присвоения значения первичного ключа для скрытых веб-управления Label в шаблоне и чтения его значения в `ItemCommand`при помощи команды `e.Item.FindControl("LabelID")`.</span><span class="sxs-lookup"><span data-stu-id="45ab1-188">Instead, we must use an alternative approach for supplying the primary key value, such as through the button s `CommandArgument` property or by assigning the primary key value to a hidden Label Web control within the template and reading its value back in the `ItemCommand` event handler using `e.Item.FindControl("LabelID")`.</span></span>

<span data-ttu-id="45ab1-189">После завершения `ItemCommand` обработчика событий, теперь пора проверить эту страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="45ab1-189">After completing the `ItemCommand` event handler, take a moment to test out this page in a browser.</span></span> <span data-ttu-id="45ab1-190">Как показано на рис. 7, нажав кнопку Показать продукты ссылка вызывает обратную передачу и отображает для выбранной категории продуктов в маркированный список.</span><span class="sxs-lookup"><span data-stu-id="45ab1-190">As Figure 7 shows, clicking the Show Products link causes a postback and displays the products for the selected category in a BulletedList.</span></span> <span data-ttu-id="45ab1-191">Кроме того Обратите внимание на то что остается эти сведения о продукте, даже при нажатии на другие категории продуктов Показать ссылки.</span><span class="sxs-lookup"><span data-stu-id="45ab1-191">Furthermore, note that this product information remains, even if other categories Show Products links are clicked.</span></span>

> [!NOTE]
> <span data-ttu-id="45ab1-192">Если вы хотите изменить поведение этого отчета таким образом, что только одна категория s продукты отображаются одновременно, просто установите элемент управления маркированный список s `EnableViewState` свойства `False`.</span><span class="sxs-lookup"><span data-stu-id="45ab1-192">If you want to modify the behavior of this report, such that the only one category s products are listed at a time, simply set the BulletedList control s `EnableViewState` property to `False`.</span></span>


<span data-ttu-id="45ab1-193">[![Маркированный список используется для отображения продуктов выбранной категории](custom-buttons-in-the-datalist-and-repeater-cs/_static/image16.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="45ab1-193">[![A BulletedList is used to Display the Products of the Selected Category](custom-buttons-in-the-datalist-and-repeater-cs/_static/image16.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image15.png)</span></span>

<span data-ttu-id="45ab1-194">**Рис. 7**: маркированный список используется для отображения продуктов выбранной категории ([Просмотр полноразмерное изображение](custom-buttons-in-the-datalist-and-repeater-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="45ab1-194">**Figure 7**: A BulletedList is used to Display the Products of the Selected Category ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-cs/_static/image17.png))</span></span>


## <a name="summary"></a><span data-ttu-id="45ab1-195">Сводка</span><span class="sxs-lookup"><span data-stu-id="45ab1-195">Summary</span></span>

<span data-ttu-id="45ab1-196">Элементы управления DataList и повторителя может включать любое количество кнопок, элементов управления LinkButton и ImageButtons в своих шаблонов.</span><span class="sxs-lookup"><span data-stu-id="45ab1-196">The DataList and Repeater controls can include any number of Buttons, LinkButtons, or ImageButtons within their templates.</span></span> <span data-ttu-id="45ab1-197">Такие кнопки при щелчке вызывает обратную передачу и вызвать `ItemCommand` событий.</span><span class="sxs-lookup"><span data-stu-id="45ab1-197">Such buttons, when clicked, cause a postback and raise the `ItemCommand` event.</span></span> <span data-ttu-id="45ab1-198">Чтобы связать настраиваемого действия на стороне сервера с помощью нажатия кнопки, создайте обработчик событий для `ItemCommand` события.</span><span class="sxs-lookup"><span data-stu-id="45ab1-198">To associate custom server-side action with a button being clicked, create an event handler for the `ItemCommand` event.</span></span> <span data-ttu-id="45ab1-199">В этот обработчик событий сначала проверьте входящего `CommandName` значение, чтобы определить, какая кнопка была нажата.</span><span class="sxs-lookup"><span data-stu-id="45ab1-199">In this event handler first check the incoming `CommandName` value to determine which button was clicked.</span></span> <span data-ttu-id="45ab1-200">Дополнительные сведения при необходимости может предоставляться через кнопку s `CommandArgument` свойство.</span><span class="sxs-lookup"><span data-stu-id="45ab1-200">Additional information can optionally be supplied through the button s `CommandArgument` property.</span></span>

<span data-ttu-id="45ab1-201">Программирование довольны!</span><span class="sxs-lookup"><span data-stu-id="45ab1-201">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="45ab1-202">Об авторе</span><span class="sxs-lookup"><span data-stu-id="45ab1-202">About the Author</span></span>

<span data-ttu-id="45ab1-203">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи ASP/ASP.NET и основателя из [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Майкрософт с 1998 года.</span><span class="sxs-lookup"><span data-stu-id="45ab1-203">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="45ab1-204">Скотт — независимый консультант, trainer и записи.</span><span class="sxs-lookup"><span data-stu-id="45ab1-204">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="45ab1-205">Его последняя книга — [ *диспетчерами учат самостоятельно ASP.NET 2.0 в течение 24 часов*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="45ab1-205">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="45ab1-206">Он может быть достигнута по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) или через его блог, который можно найти в [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="45ab1-206">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="45ab1-207">Благодарности</span><span class="sxs-lookup"><span data-stu-id="45ab1-207">Special Thanks To</span></span>

<span data-ttu-id="45ab1-208">Этот учебник ряд прошел проверку многие полезные рецензентов.</span><span class="sxs-lookup"><span data-stu-id="45ab1-208">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="45ab1-209">Основной рецензент этого учебника было Патерсона Деннис.</span><span class="sxs-lookup"><span data-stu-id="45ab1-209">Lead reviewer for this tutorial was Dennis Patterson.</span></span> <span data-ttu-id="45ab1-210">Объясняются моих последующих статей для MSDN?</span><span class="sxs-lookup"><span data-stu-id="45ab1-210">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="45ab1-211">Если Да, напишите мне по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="45ab1-211">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="45ab1-212">Вперед</span><span class="sxs-lookup"><span data-stu-id="45ab1-212">Next</span></span>](custom-buttons-in-the-datalist-and-repeater-vb.md)
