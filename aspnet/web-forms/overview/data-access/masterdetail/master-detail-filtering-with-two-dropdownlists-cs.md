---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-two-dropdownlists-cs
title: "Иерархического фильтрацию с двумя элементами управления DropDownList (C#) | Документы Microsoft"
author: rick-anderson
description: "Этот учебник расширяется связь главного и подчиненного представлений для добавления третий уровень, с использованием двух элементов управления DropDownList для выбора нужного recor родительских и прародителя..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: ac4b0d77-4816-4ded-afd0-88dab667aedd
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-two-dropdownlists-cs
msc.type: authoredcontent
ms.openlocfilehash: c3898158f251daf0fac899fe7c18ac03322114b7
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="masterdetail-filtering-with-two-dropdownlists-c"></a><span data-ttu-id="ea9d7-103">Иерархического фильтрацию с двумя элементами управления DropDownList (C#)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-103">Master/Detail Filtering With Two DropDownLists (C#)</span></span>
====================
<span data-ttu-id="ea9d7-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ea9d7-105">[Загрузить пример приложения](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_8_CS.exe) или [скачать PDF](master-detail-filtering-with-two-dropdownlists-cs/_static/datatutorial08cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-105">[Download Sample App](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_8_CS.exe) or [Download PDF](master-detail-filtering-with-two-dropdownlists-cs/_static/datatutorial08cs1.pdf)</span></span>

> <span data-ttu-id="ea9d7-106">Этот учебник расширяется связь главного и подчиненного представлений для добавления третий уровень, с использованием двух элементов управления DropDownList для выбора нужных записей родительских и прародителя.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-106">This tutorial expands the master/detail relationship to add a third layer, using two DropDownList controls to select the desired parent and grandparent records.</span></span>


## <a name="introduction"></a><span data-ttu-id="ea9d7-107">Вступление</span><span class="sxs-lookup"><span data-stu-id="ea9d7-107">Introduction</span></span>

<span data-ttu-id="ea9d7-108">В [с предыдущим учебником](master-detail-filtering-with-a-dropdownlist-cs.md) мы рассмотрели, как отобразить простой основной подробности отчета с помощью одного DropDownList, заполненный категорий и GridView, показывающая те продукты, которые принадлежат выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-108">In the [previous tutorial](master-detail-filtering-with-a-dropdownlist-cs.md) we examined how to display a simple master/details report using a single DropDownList populated with the categories and a GridView showing those products that belong to the selected category.</span></span> <span data-ttu-id="ea9d7-109">Этот шаблон отчета удобно использовать, когда Отображение записей, которые имеют связь «один ко многим» и может расширяться для работы сценариев, включающих несколько отношений один ко многим.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-109">This report pattern works well when displaying records that have a one-to-many relationship and can easily be extended to work for scenarios that include multiple one-to-many relationships.</span></span> <span data-ttu-id="ea9d7-110">Например система будет иметь таблицы, которые соответствуют клиентов, заказов и строк элементов заказа.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-110">For example, an order entry system would have tables that correspond to customers, orders, and order line items.</span></span> <span data-ttu-id="ea9d7-111">Данный клиент может иметь несколько заказов с каждым заказом, состоящий из нескольких элементов.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-111">A given customer may have multiple orders with each order consisting of multiple items.</span></span> <span data-ttu-id="ea9d7-112">Такие данные могут быть представлены пользователю с двумя элементами управления DropDownList и GridView.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-112">Such data can be presented to the user with two DropDownLists and a GridView.</span></span> <span data-ttu-id="ea9d7-113">Первый элемент DropDownList будет иметь элемент списка для каждого клиента в базе данных со вторым из них содержимое которой заказов выбранного клиента.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-113">The first DropDownList would have a list item for each customer in the database with the second one's contents being the orders placed by the selected customer.</span></span> <span data-ttu-id="ea9d7-114">Элемент управления GridView будет выведен список элементов строк из выбранного заказа.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-114">A GridView would list the line items from the selected order.</span></span>

<span data-ttu-id="ea9d7-115">Хотя базы данных Northwind включает канонические клиента или заказа сведений в его `Customers`, `Orders`, и `Order Details` таблицы, эти таблицы не заносятся в нашей архитектуры.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-115">While the Northwind database include the canonical customer/order/order details information in its `Customers`, `Orders`, and `Order Details` tables, these tables aren't captured in our architecture.</span></span> <span data-ttu-id="ea9d7-116">Тем не менее по-прежнему можно проиллюстрировать с помощью двух зависимых элементами управления DropDownList.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-116">Nonetheless, we can still illustrate using two dependent DropDownLists.</span></span> <span data-ttu-id="ea9d7-117">Первый элемент DropDownList выводит список категорий и второй продуктов, принадлежащих выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-117">The first DropDownList will list the categories and the second the products belonging to the selected category.</span></span> <span data-ttu-id="ea9d7-118">DetailsView будут перечислены сведения о выбранном продукте.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-118">A DetailsView will then list the details of the selected product.</span></span>

## <a name="step-1-creating-and-populating-the-categories-dropdownlist"></a><span data-ttu-id="ea9d7-119">Шаг 1: Создание и заполнение DropDownList категорий</span><span class="sxs-lookup"><span data-stu-id="ea9d7-119">Step 1: Creating and Populating the Categories DropDownList</span></span>

<span data-ttu-id="ea9d7-120">Наша цель первого является добавление DropDownList, перечислены категории.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-120">Our first goal is to add the DropDownList that lists the categories.</span></span> <span data-ttu-id="ea9d7-121">Эти шаги подробно были проверены в предыдущем учебнике, но кратко перечислены ниже для полноты.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-121">These steps were examined in detail in the preceding tutorial, but are summarized here for completeness.</span></span>

<span data-ttu-id="ea9d7-122">Откройте `MasterDetailsDetails.aspx` страницы в `Filtering` набор папок, добавьте на страницу DropDownList его `ID` свойства `Categories`и щелкните ссылку настроить источник данных в его смарт-тег.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-122">Open the `MasterDetailsDetails.aspx` page in the `Filtering` folder, add a DropDownList to the page, set its `ID` property to `Categories`, and then click the Configure Data Source link in its smart tag.</span></span> <span data-ttu-id="ea9d7-123">Мастер настройки источника данных выберите Добавление нового источника данных.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-123">From the Data Source Configuration Wizard choose to add a new data source.</span></span>


<span data-ttu-id="ea9d7-124">[![Добавить новый источник данных для DropDownList](master-detail-filtering-with-two-dropdownlists-cs/_static/image2.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-124">[![Add a New Data Source for the DropDownList](master-detail-filtering-with-two-dropdownlists-cs/_static/image2.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image1.png)</span></span>

<span data-ttu-id="ea9d7-125">**Рис. 1**: добавить новый источник данных для DropDownList ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-125">**Figure 1**: Add a New Data Source for the DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image3.png))</span></span>


<span data-ttu-id="ea9d7-126">Новый источник данных естественно, следует ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-126">The new data source should, naturally, be an ObjectDataSource.</span></span> <span data-ttu-id="ea9d7-127">Назовите этот новый элемент управления ObjectDataSource `CategoriesDataSource` и его вызов `CategoriesBLL` объекта `GetCategories()` метод.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-127">Name this new ObjectDataSource `CategoriesDataSource` and have it invoke the `CategoriesBLL` object's `GetCategories()` method.</span></span>


<span data-ttu-id="ea9d7-128">[![Выберите с помощью класса CategoriesBLL](master-detail-filtering-with-two-dropdownlists-cs/_static/image5.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-two-dropdownlists-cs/_static/image5.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image4.png)</span></span>

<span data-ttu-id="ea9d7-129">**На рисунке 2**: Выбор `CategoriesBLL` класса ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-129">**Figure 2**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image6.png))</span></span>


<span data-ttu-id="ea9d7-130">[![Настройка ObjectDataSource можно использовать метод GetCategories()](master-detail-filtering-with-two-dropdownlists-cs/_static/image8.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-two-dropdownlists-cs/_static/image8.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image7.png)</span></span>

<span data-ttu-id="ea9d7-131">**Рис. 3**: Настройка ObjectDataSource для использования `GetCategories()` метод ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-131">**Figure 3**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image9.png))</span></span>


<span data-ttu-id="ea9d7-132">После настройки ObjectDataSource нам по-прежнему необходимо указать, какие поля источника данных, которые должны отображаться в `Categories` DropDownList и какой из них должны быть настроены как значение элемента списка.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-132">After configuring the ObjectDataSource we still need to specify which data source field should be displayed in the `Categories` DropDownList and which one should be configured as the value for the list item.</span></span> <span data-ttu-id="ea9d7-133">Задать `CategoryName` как отображение и `CategoryID` как значение для каждого элемента списка.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-133">Set the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>


<span data-ttu-id="ea9d7-134">[![Иметь DropDownList отображения поля «Категория» и используйте CategoryID значение](master-detail-filtering-with-two-dropdownlists-cs/_static/image11.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-two-dropdownlists-cs/_static/image11.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image10.png)</span></span>

<span data-ttu-id="ea9d7-135">**Рис. 4**: У отображения DropDownList `CategoryName` и использует `CategoryID` как значение ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-135">**Figure 4**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image12.png))</span></span>


<span data-ttu-id="ea9d7-136">На этом этапе у нас есть элемент управления DropDownList (`Categories`) заполняется записи из `Categories` таблицы.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-136">At this point we have a DropDownList control (`Categories`) that's populated with the records from the `Categories` table.</span></span> <span data-ttu-id="ea9d7-137">Когда пользователь выбирает категорию в выпадающем будем обратную передачу для обновления продукта DropDownList, мы создадим на шаге 2.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-137">When the user chooses a new category from the DropDownList we'll want a postback to occur in order to refresh the product DropDownList that we're going to create in Step 2.</span></span> <span data-ttu-id="ea9d7-138">Таким образом, установите флажок Включить AutoPostBack из `categories` DropDownList смарт-тега.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-138">Therefore, check the Enable AutoPostBack option from the `categories` DropDownList's smart tag.</span></span>


<span data-ttu-id="ea9d7-139">[![Включить AutoPostBack для DropDownList категорий](master-detail-filtering-with-two-dropdownlists-cs/_static/image14.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-139">[![Enable AutoPostBack for the Categories DropDownList](master-detail-filtering-with-two-dropdownlists-cs/_static/image14.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image13.png)</span></span>

<span data-ttu-id="ea9d7-140">**Рис. 5**: Включение AutoPostBack для `Categories` DropDownList ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-140">**Figure 5**: Enable AutoPostBack for the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image15.png))</span></span>


## <a name="step-2-displaying-the-selected-categorys-products-in-a-second-dropdownlist"></a><span data-ttu-id="ea9d7-141">Шаг 2: Отображение выбранной категории продуктов в второй DropDownList</span><span class="sxs-lookup"><span data-stu-id="ea9d7-141">Step 2: Displaying the Selected Category's Products in a Second DropDownList</span></span>

<span data-ttu-id="ea9d7-142">С `Categories` DropDownList завершена, следующим шагом является отображение DropDownList продуктов, относящихся к выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-142">With the `Categories` DropDownList completed, our next step is to display a DropDownList of products belonging to the selected category.</span></span> <span data-ttu-id="ea9d7-143">Для этого добавьте другой элемент DropDownList на страницу с именем `ProductsByCategory`.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-143">To accomplish this, add another DropDownList to the page named `ProductsByCategory`.</span></span> <span data-ttu-id="ea9d7-144">Как и в `Categories` DropDownList, создайте новый элемент управления ObjectDataSource для `ProductsByCategory` DropDownList с именем `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-144">As with the `Categories` DropDownList, create a new ObjectDataSource for the `ProductsByCategory` DropDownList named `ProductsByCategoryDataSource`.</span></span>


<span data-ttu-id="ea9d7-145">[![Добавить новый источник данных для ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-cs/_static/image17.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-145">[![Add a New Data Source for the ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-cs/_static/image17.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image16.png)</span></span>

<span data-ttu-id="ea9d7-146">**Рис. 6**: добавить новый источник данных для `ProductsByCategory` DropDownList ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-146">**Figure 6**: Add a New Data Source for the `ProductsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image18.png))</span></span>


<span data-ttu-id="ea9d7-147">[![Создать новый элемент управления ObjectDataSource ProductsByCategoryDataSource с именем](master-detail-filtering-with-two-dropdownlists-cs/_static/image20.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-147">[![Create a New ObjectDataSource Named ProductsByCategoryDataSource](master-detail-filtering-with-two-dropdownlists-cs/_static/image20.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image19.png)</span></span>

<span data-ttu-id="ea9d7-148">**Рис. 7**: создать новый именованный ObjectDataSource `ProductsByCategoryDataSource` ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-148">**Figure 7**: Create a New ObjectDataSource Named `ProductsByCategoryDataSource` ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image21.png))</span></span>


<span data-ttu-id="ea9d7-149">Поскольку `ProductsByCategory` DropDownList нужно отобразить только те продукты, принадлежащий к выбранной категории имеют ObjectDataSource вызова неуправляемого кода `GetProductsByCategoryID(categoryID)` метод `ProductsBLL` объекта.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-149">Since the `ProductsByCategory` DropDownList needs to display just those products belonging to the selected category, have the ObjectDataSource invoke the `GetProductsByCategoryID(categoryID)` method from the `ProductsBLL` object.</span></span>


<span data-ttu-id="ea9d7-150">[![Выберите с помощью класса ProductsBLL](master-detail-filtering-with-two-dropdownlists-cs/_static/image23.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-150">[![Choose to Use the ProductsBLL Class](master-detail-filtering-with-two-dropdownlists-cs/_static/image23.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image22.png)</span></span>

<span data-ttu-id="ea9d7-151">**Рис. 8**: Выбор `ProductsBLL` класса ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-151">**Figure 8**: Choose to Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image24.png))</span></span>


<span data-ttu-id="ea9d7-152">[![Настройка ObjectDataSource можно использовать метод GetProductsByCategoryID(categoryID)](master-detail-filtering-with-two-dropdownlists-cs/_static/image26.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-152">[![Configure the ObjectDataSource to Use the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-two-dropdownlists-cs/_static/image26.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image25.png)</span></span>

<span data-ttu-id="ea9d7-153">**Рис. 9**: Настройка ObjectDataSource для использования `GetProductsByCategoryID(categoryID)` метод ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-153">**Figure 9**: Configure the ObjectDataSource to Use the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image27.png))</span></span>


<span data-ttu-id="ea9d7-154">На последнем шаге мастера необходимо указать значение  *`categoryID`*  параметра.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-154">In the final step of the wizard we need to specify the value of the *`categoryID`* parameter.</span></span> <span data-ttu-id="ea9d7-155">Назначить этот параметр для выбранного элемента из `Categories` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-155">Assign this parameter to the selected item from the `Categories` DropDownList.</span></span>


<span data-ttu-id="ea9d7-156">[![В выпадающем категорий по запросу categoryID значение параметра](master-detail-filtering-with-two-dropdownlists-cs/_static/image29.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-156">[![Pull the categoryID Parameter Value from the Categories DropDownList](master-detail-filtering-with-two-dropdownlists-cs/_static/image29.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image28.png)</span></span>

<span data-ttu-id="ea9d7-157">**Рис. 10**: по запросу  *`categoryID`*  значение параметра из `Categories` DropDownList ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-157">**Figure 10**: Pull the *`categoryID`* Parameter Value from the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image30.png))</span></span>


<span data-ttu-id="ea9d7-158">Использование ObjectDataSource настроена все, что остается только указать, какие поля источника данных используются для отображения и значения элементов DropDownList.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-158">With the ObjectDataSource configured, all that remains is to specify what data source fields are used for the display and value of the DropDownList's items.</span></span> <span data-ttu-id="ea9d7-159">Отображение `ProductName` поля и использовать `ProductID` поля в качестве значения.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-159">Display the `ProductName` field and use the `ProductID` field as the value.</span></span>


<span data-ttu-id="ea9d7-160">[![Укажите поля источника данных, используемые для текста и значение свойства DropDownList элементов ListItem](master-detail-filtering-with-two-dropdownlists-cs/_static/image32.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-160">[![Specify the Data Source Fields Used for the DropDownList's ListItems' Text and Value Properties](master-detail-filtering-with-two-dropdownlists-cs/_static/image32.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image31.png)</span></span>

<span data-ttu-id="ea9d7-161">**Рис. 11**: Укажите поля источника данных используются для DropDownList `ListItem` s " `Text` и `Value` свойства ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-161">**Figure 11**: Specify the Data Source Fields Used for the DropDownList's `ListItem` s' `Text` and `Value` Properties ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image33.png))</span></span>


<span data-ttu-id="ea9d7-162">Использование ObjectDataSource и `ProductsByCategory` DropDownList настроен нашу страницу отобразит двумя элементами управления DropDownList: первый будут перечислены все категории второй будет перечислять этих продуктов, принадлежащих выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-162">With the ObjectDataSource and `ProductsByCategory` DropDownList configured our page will display two DropDownLists: the first will list all of the categories while the second will list those products belonging to the selected category.</span></span> <span data-ttu-id="ea9d7-163">Когда пользователь выбирает категорию из первого DropDownList, произойдет обратная передача и второй DropDownList будет привязывается, показывающая те продукты, которые принадлежат к категории вновь выбранных.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-163">When the user selects a new category from the first DropDownList, a postback will ensue and the second DropDownList will be rebound, showing those products that belong to the newly selected category.</span></span> <span data-ttu-id="ea9d7-164">Фигуры 12 и 13 Показать `MasterDetailsDetails.aspx` в действии при просмотре через браузер.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-164">Figures 12 and 13 show `MasterDetailsDetails.aspx` in action when viewed through a browser.</span></span>


<span data-ttu-id="ea9d7-165">[![При первом посещении страницы, выбрана категория напитков](master-detail-filtering-with-two-dropdownlists-cs/_static/image35.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-165">[![When First Visiting the Page, the Beverages Category is Selected](master-detail-filtering-with-two-dropdownlists-cs/_static/image35.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image34.png)</span></span>

<span data-ttu-id="ea9d7-166">**Рис. 12**: при первом просмотре страницы, выбрана категория напитков ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-166">**Figure 12**: When First Visiting the Page, the Beverages Category is Selected ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image36.png))</span></span>


<span data-ttu-id="ea9d7-167">[![При выборе другой категории отображаются новой категории продуктов](master-detail-filtering-with-two-dropdownlists-cs/_static/image38.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-167">[![Choosing a Different Category Displays the New Category's Products](master-detail-filtering-with-two-dropdownlists-cs/_static/image38.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image37.png)</span></span>

<span data-ttu-id="ea9d7-168">**Рис. 13**: Выбор новой категории продуктов на разных экранах категории ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-168">**Figure 13**: Choosing a Different Category Displays the New Category's Products ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image39.png))</span></span>


<span data-ttu-id="ea9d7-169">В настоящее время `productsByCategory` DropDownList при изменении *не* вызывает обратную передачу.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-169">Currently the `productsByCategory` DropDownList, when changed, does *not* cause a postback.</span></span> <span data-ttu-id="ea9d7-170">Однако необходимо обратной передачи возникает, когда мы добавляем DetailsView для отображения сведений для выбранного продукта (шаг 3).</span><span class="sxs-lookup"><span data-stu-id="ea9d7-170">However, we will want a postback to occur once we add a DetailsView to display the selected product's details (Step 3).</span></span> <span data-ttu-id="ea9d7-171">Таким образом, установите флажок Включить AutoPostBack из `productsByCategory` DropDownList смарт-тега.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-171">Therefore, check the Enable AutoPostBack checkbox from the `productsByCategory` DropDownList's smart tag.</span></span>


<span data-ttu-id="ea9d7-172">[![Включить функцию AutoPostBack для productsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-cs/_static/image41.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-172">[![Enable the AutoPostBack Feature for the productsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-cs/_static/image41.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image40.png)</span></span>

<span data-ttu-id="ea9d7-173">**Рис. 14**: включить функцию AutoPostBack для `productsByCategory` DropDownList ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-173">**Figure 14**: Enable the AutoPostBack Feature for the `productsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image42.png))</span></span>


## <a name="step-3-using-a-detailsview-to-display-details-for-the-selected-product"></a><span data-ttu-id="ea9d7-174">Шаг 3: С помощью DetailsView для отображения подробных сведений для выбранного продукта</span><span class="sxs-lookup"><span data-stu-id="ea9d7-174">Step 3: Using a DetailsView to Display Details for the Selected Product</span></span>

<span data-ttu-id="ea9d7-175">Последний шаг — отображение сведений для выбранного продукта в DetailsView.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-175">The final step is to display the details for the selected product in a DetailsView.</span></span> <span data-ttu-id="ea9d7-176">Чтобы выполнить это, добавьте на страницу DetailsView, задайте его `ID` свойства `ProductDetails`и создать новый элемент управления ObjectDataSource для него.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-176">To accomplish this, add a DetailsView to the page, set its `ID` property to `ProductDetails`, and create a new ObjectDataSource for it.</span></span> <span data-ttu-id="ea9d7-177">Настройте этот элемент управления ObjectDataSource для извлечения данных из `ProductsBLL` класса `GetProductByProductID(productID)` метода с помощью выбранного значения `ProductsByCategory` DropDownList для значения  *`productID`*  параметра.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-177">Configure this ObjectDataSource to pull its data from the `ProductsBLL` class's `GetProductByProductID(productID)` method using the selected value of the `ProductsByCategory` DropDownList for the value of the *`productID`* parameter.</span></span>


<span data-ttu-id="ea9d7-178">[![Выберите с помощью класса ProductsBLL](master-detail-filtering-with-two-dropdownlists-cs/_static/image44.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-178">[![Choose to Use the ProductsBLL Class](master-detail-filtering-with-two-dropdownlists-cs/_static/image44.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image43.png)</span></span>

<span data-ttu-id="ea9d7-179">**Рис. 15**: Выбор `ProductsBLL` класса ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-179">**Figure 15**: Choose to Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image45.png))</span></span>


<span data-ttu-id="ea9d7-180">[![Настройка ObjectDataSource можно использовать метод GetProductByProductID(productID)](master-detail-filtering-with-two-dropdownlists-cs/_static/image47.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-180">[![Configure the ObjectDataSource to Use the GetProductByProductID(productID) Method](master-detail-filtering-with-two-dropdownlists-cs/_static/image47.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image46.png)</span></span>

<span data-ttu-id="ea9d7-181">**На рисунке 16**: Настройка ObjectDataSource для использования `GetProductByProductID(productID)` метод ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-181">**Figure 16**: Configure the ObjectDataSource to Use the `GetProductByProductID(productID)` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image48.png))</span></span>


<span data-ttu-id="ea9d7-182">[![Значение параметра productID по запросу из ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-cs/_static/image50.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-182">[![Pull the productID Parameter Value from the ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-cs/_static/image50.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image49.png)</span></span>

<span data-ttu-id="ea9d7-183">**Рисунок 17**: по запросу  *`productID`*  значение параметра из `ProductsByCategory` DropDownList ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-183">**Figure 17**: Pull the *`productID`* Parameter Value from the `ProductsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image51.png))</span></span>


<span data-ttu-id="ea9d7-184">Вы можете получить сведения о доступных полей в DetailsView.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-184">You can choose to display any of the available fields in the DetailsView.</span></span> <span data-ttu-id="ea9d7-185">Я решил удалить `ProductID`, `SupplierID`, и `CategoryID` полей и изменят порядок, а остальные поля в формате.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-185">I've opted to remove the `ProductID`, `SupplierID`, and `CategoryID` fields and reordered and formatted the remaining fields.</span></span> <span data-ttu-id="ea9d7-186">Кроме того, снят out DetailsView `Height` и `Width` свойства, позволяя DetailsView развернуть по ширине, необходимые для отображения наиболее свои данные вместо того, он ограничен указанного размера.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-186">In addition, I cleared out the DetailsView's `Height` and `Width` properties, allowing the DetailsView to expand to the width needed to best display its data rather than having it constrained to a specified size.</span></span> <span data-ttu-id="ea9d7-187">Полная разметка появляется ниже:</span><span class="sxs-lookup"><span data-stu-id="ea9d7-187">The full markup appears below:</span></span>


[!code-aspx[Main](master-detail-filtering-with-two-dropdownlists-cs/samples/sample1.aspx)]

<span data-ttu-id="ea9d7-188">Занять некоторое время на ознакомление со `MasterDetailsDetails.aspx` страницы в браузере.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-188">Take a moment to try out the `MasterDetailsDetails.aspx` page in a browser.</span></span> <span data-ttu-id="ea9d7-189">На первый взгляд может показаться, что все работает в случае необходимости, но есть незначительные проблемы.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-189">At first glance it may appear that everything is working as desired, but there's a subtle problem.</span></span> <span data-ttu-id="ea9d7-190">При выборе новой категории `ProductsByCategory` DropDownList обновляется с учетом этих продуктов для выбранной категории, но `ProductDetails` DetailsView продолжает Показать предыдущие сведения о продукте.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-190">When you choose a new category the `ProductsByCategory` DropDownList is updated to include those products for the selected category, but the `ProductDetails` DetailsView continued to show the previous product information.</span></span> <span data-ttu-id="ea9d7-191">DetailsView обновляется при выборе другого продукта для выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-191">The DetailsView is updated when choosing a different product for the selected category.</span></span> <span data-ttu-id="ea9d7-192">Кроме того, если достаточно тщательно протестировать, вы обнаружите, что при выборе постоянно новые категории (такие как выбор Напитки из `Categories` DropDownList, а затем приправы, затем Кондитерские изделия) каждой других выбранной категории вызывает `ProductDetails`DetailsView для обновления.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-192">Furthermore, if you test thoroughly enough, you'll find that if you continually choose new categories (such as choosing Beverages from the `Categories` DropDownList, then Condiments, then Confections) every other category selection causes the `ProductDetails` DetailsView to be refreshed.</span></span>

<span data-ttu-id="ea9d7-193">Чтобы конкретизировать эту проблему, давайте взглянем на конкретный пример.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-193">To help concretize this problem, let's look at a specific example.</span></span> <span data-ttu-id="ea9d7-194">При первом посещении страницы выбрана категория напитков и связанные продукты загружаются в `ProductsByCategory` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-194">When you first visit the page the Beverages category is selected and the related products are loaded in the `ProductsByCategory` DropDownList.</span></span> <span data-ttu-id="ea9d7-195">Chai является выбранного продукта и сведения о нем отображаются в `ProductDetails` DetailsView, как показано на рисунке 18.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-195">Chai is the selected product and its details are displayed in the `ProductDetails` DetailsView, as shown in Figure 18.</span></span>


<span data-ttu-id="ea9d7-196">[![Сведения о продукте выбран отображаются в элементе управления DetailsView](master-detail-filtering-with-two-dropdownlists-cs/_static/image53.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-196">[![The Selected Product's Details are Displayed in a DetailsView](master-detail-filtering-with-two-dropdownlists-cs/_static/image53.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image52.png)</span></span>

<span data-ttu-id="ea9d7-197">**На рисунке 18**: выбранного продукта сведения будут отображены в элементе управления DetailsView ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-197">**Figure 18**: The Selected Product's Details are Displayed in a DetailsView ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image54.png))</span></span>


<span data-ttu-id="ea9d7-198">Происходит при изменении выбранной категории из Напитки приправы обратная передача и `ProductsByCategory` DropDownList обновляется соответствующим образом, но DetailsView по-прежнему отображаются сведения для товара.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-198">If you change the category selection from Beverages to Condiments, a postback occurs and the `ProductsByCategory` DropDownList is updated accordingly, but the DetailsView still displays details for Chai.</span></span>


<span data-ttu-id="ea9d7-199">[![Сведения о ранее выбранного продукта, по-прежнему отображаются](master-detail-filtering-with-two-dropdownlists-cs/_static/image56.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-199">[![The Previously Selected Product's Details are Still Displayed](master-detail-filtering-with-two-dropdownlists-cs/_static/image56.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image55.png)</span></span>

<span data-ttu-id="ea9d7-200">**На рисунке 19**: ранее выбранного элемента сведения о продукте, по-прежнему отображаются ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-200">**Figure 19**: The Previously Selected Product's Details are Still Displayed ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image57.png))</span></span>


<span data-ttu-id="ea9d7-201">Обновляет DetailsView комплектации новый продукт из списка, как ожидалось.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-201">Picking a new product from the list refreshes the DetailsView as expected.</span></span> <span data-ttu-id="ea9d7-202">Если вы выберете новую категорию после изменения продукта, DetailsView снова не обновляется.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-202">If you pick a new category after changing the product, the DetailsView again won't refresh.</span></span> <span data-ttu-id="ea9d7-203">Тем не менее если вместо выбора нового продукта вы выбрали новой категории, будут обновлены DetailsView.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-203">However, if instead of choosing a new product you selected a new category, the DetailsView would refresh.</span></span> <span data-ttu-id="ea9d7-204">В мире происходящем здесь?</span><span class="sxs-lookup"><span data-stu-id="ea9d7-204">What in the world is going on here?</span></span>

<span data-ttu-id="ea9d7-205">Проблема заключается в жизненном цикле страницы ошибки синхронизации.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-205">The problem is a timing issue in the page's lifecycle.</span></span> <span data-ttu-id="ea9d7-206">При каждом запросе страницы, он проходит через ряд действий, как его подготовки к просмотру.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-206">Whenever a page is requested it proceeds through a number of steps as its rendering.</span></span> <span data-ttu-id="ea9d7-207">Одно из следующих действий в ObjectDataSource управляет проверьте, если какие-либо их `SelectParameters` значения были изменены.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-207">In one of these steps the ObjectDataSource controls check to see if any of their `SelectParameters` values have changed.</span></span> <span data-ttu-id="ea9d7-208">Если таким образом, веб-управления, привязанные к ObjectDataSource знает, что необходимо обновить его отображения.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-208">If so, the data Web control bound to the ObjectDataSource knows that it needs to refresh its display.</span></span> <span data-ttu-id="ea9d7-209">Например, при выборе новой категории `ProductsByCategoryDataSource` ObjectDataSource обнаруживает, что его значения параметров были изменены и `ProductsByCategory` DropDownList число повторных привязок, получение продуктов для выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-209">For example, when a new category is selected, the `ProductsByCategoryDataSource` ObjectDataSource detects that its parameter values have changed and the `ProductsByCategory` DropDownList rebinds itself, getting the products for the selected category.</span></span>

<span data-ttu-id="ea9d7-210">Проблема, которая возникает в этой ситуации происходит что точке жизненного цикла страницы, изменения параметров проверки ObjectDataSources *перед* перепривязки связанные данные веб-элементов управления.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-210">The problem that arises in this situation is that the point in the page lifecycle that the ObjectDataSources check for changed parameters occurs *before* the rebinding of the associated data Web controls.</span></span> <span data-ttu-id="ea9d7-211">Таким образом при выборе новой категории `ProductsByCategoryDataSource` ObjectDataSource обнаруживает изменение в его параметр значение.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-211">Therefore, when selecting a new category the `ProductsByCategoryDataSource` ObjectDataSource detects a change in its parameter's value.</span></span> <span data-ttu-id="ea9d7-212">Используемый элемент управления ObjectDataSource `ProductDetails` DetailsView, однако не Обратите внимание, какие-либо изменения из-за `ProductsByCategory` DropDownList еще не привязывается.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-212">The ObjectDataSource used by the `ProductDetails` DetailsView, however, doesn't note any such changes because the `ProductsByCategory` DropDownList has yet to be rebound.</span></span> <span data-ttu-id="ea9d7-213">Далее в жизненном цикле `ProductsByCategory` число повторных привязок DropDownList методы, перехватывая продукты для новой выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-213">Later in the lifecycle the `ProductsByCategory` DropDownList rebinds to its ObjectDataSource, grabbing the products for the newly selected category.</span></span> <span data-ttu-id="ea9d7-214">Хотя `ProductsByCategory` DropDownList значение изменилось, `ProductDetails` DetailsView ObjectDataSource уже было произведено его проверить значение параметра; таким образом, DetailsView отобразит результаты предыдущего.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-214">While the `ProductsByCategory` DropDownList's value has changed, the `ProductDetails` DetailsView's ObjectDataSource has already done its parameter value check; therefore, the DetailsView displays its previous results.</span></span> <span data-ttu-id="ea9d7-215">Это взаимодействие показан на рис. 20.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-215">This interaction is depicted in Figure 20.</span></span>


<span data-ttu-id="ea9d7-216">[![Значение ProductsByCategory DropDownList изменяется после ObjectDataSource ProductDetails DetailsView проверяет наличие изменений](master-detail-filtering-with-two-dropdownlists-cs/_static/image59.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-216">[![The ProductsByCategory DropDownList Value Changes After the ProductDetails DetailsView's ObjectDataSource Checks for Changes](master-detail-filtering-with-two-dropdownlists-cs/_static/image59.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image58.png)</span></span>

<span data-ttu-id="ea9d7-217">**Рис. 20**: `ProductsByCategory` изменений значение DropDownList после `ProductDetails` DetailsView ObjectDataSource проверяет наличие изменений ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-217">**Figure 20**: The `ProductsByCategory` DropDownList Value Changes After the `ProductDetails` DetailsView's ObjectDataSource Checks for Changes ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image60.png))</span></span>


<span data-ttu-id="ea9d7-218">Чтобы исправить это, необходимо явно повторно привязать `ProductDetails` DetailsView после `ProductsByCategory` DropDownList были связаны.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-218">To remedy this we need to explicitly rebind the `ProductDetails` DetailsView after the `ProductsByCategory` DropDownList has been bound.</span></span> <span data-ttu-id="ea9d7-219">Это можно сделать путем вызова `ProductDetails` DetailsView `DataBind()` метод при `ProductsByCategory` DropDownList `DataBound` вызывается событие.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-219">We can accomplish this by calling the `ProductDetails` DetailsView's `DataBind()` method when the `ProductsByCategory` DropDownList's `DataBound` event fires.</span></span> <span data-ttu-id="ea9d7-220">Добавьте следующий код обработчика событий для `MasterDetailsDetails.aspx` на странице кода класса (см. «[программно заданию значений параметров ObjectDataSource](../basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)"сведения о том, как добавить обработчик событий):</span><span class="sxs-lookup"><span data-stu-id="ea9d7-220">Add the following event handler code to the `MasterDetailsDetails.aspx` page's code-behind class (refer to the "[Programmatically Setting the ObjectDataSource's Parameter Values](../basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)" for a discussion on how to add an event handler):</span></span>


[!code-csharp[Main](master-detail-filtering-with-two-dropdownlists-cs/samples/sample2.cs)]

<span data-ttu-id="ea9d7-221">После этого явным вызовом `ProductDetails` DetailsView `DataBind()` был добавлен метод, работы с учебником, работают нормально.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-221">After this explicit call to the `ProductDetails` DetailsView's `DataBind()` method has been added, the tutorial works as expected.</span></span> <span data-ttu-id="ea9d7-222">Выделяет рисунок 21, как это изменить исправить наших предыдущих проблему.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-222">Figure 21 highlights how this changed remedied our earlier problem.</span></span>


<span data-ttu-id="ea9d7-223">[![ProductDetails DetailsView является явным образом обновляется при ProductsByCategory DropDownList вызывается событие с привязкой к данным](master-detail-filtering-with-two-dropdownlists-cs/_static/image62.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-223">[![The ProductDetails DetailsView is Explicitly Refreshed When the ProductsByCategory DropDownList's DataBound Event Fires](master-detail-filtering-with-two-dropdownlists-cs/_static/image62.png)](master-detail-filtering-with-two-dropdownlists-cs/_static/image61.png)</span></span>

<span data-ttu-id="ea9d7-224">**Рисунок 21**: `ProductDetails` DetailsView является явным образом обновляется при `ProductsByCategory` DropDownList `DataBound` события ([Просмотр полноразмерное изображение](master-detail-filtering-with-two-dropdownlists-cs/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="ea9d7-224">**Figure 21**: The `ProductDetails` DetailsView is Explicitly Refreshed When the `ProductsByCategory` DropDownList's `DataBound` Event Fires ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-cs/_static/image63.png))</span></span>


## <a name="summary"></a><span data-ttu-id="ea9d7-225">Сводка</span><span class="sxs-lookup"><span data-stu-id="ea9d7-225">Summary</span></span>

<span data-ttu-id="ea9d7-226">DropDownList является идеальным элементом пользовательского интерфейса для главного и подчиненного представлений отчетов там, где есть один ко многим между главных и подчиненных записях.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-226">The DropDownList serves as an ideal user interface element for master/detail reports where there is a one-to-many relationship between the master and detail records.</span></span> <span data-ttu-id="ea9d7-227">В предыдущем учебнике мы узнали, как использовать один DropDownList для фильтрации отображаемых по выбранной категории продуктов.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-227">In the preceding tutorial we saw how to use a single DropDownList to filter the products displayed by the selected category.</span></span> <span data-ttu-id="ea9d7-228">В этом учебнике мы заменили GridView продуктов с DropDownList и используется для отображения сведений о выбранном продукте DetailsView.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-228">In this tutorial we replaced the GridView of products with a DropDownList, and used a DetailsView to display the details of the selected product.</span></span> <span data-ttu-id="ea9d7-229">Концепции, описанные в этом учебнике можно легко расширить для моделей данных, включающих несколько связей один ко многим, например клиентов, заказов и порядок элементов.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-229">The concepts discussed in this tutorial can easily be extended to data models involving multiple one-to-many relationships, such as customers, orders, and order items.</span></span> <span data-ttu-id="ea9d7-230">Как правило всегда можно добавить DropDownList для каждой сущности «один» в связи один ко многим.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-230">In general, you can always add a DropDownList for each of the "one" entities in the one-to-many relationships.</span></span>

<span data-ttu-id="ea9d7-231">Программирование довольны!</span><span class="sxs-lookup"><span data-stu-id="ea9d7-231">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="ea9d7-232">Об авторе</span><span class="sxs-lookup"><span data-stu-id="ea9d7-232">About the Author</span></span>

<span data-ttu-id="ea9d7-233">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи ASP/ASP.NET и основателя из [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Майкрософт с 1998 года.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-233">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ea9d7-234">Скотт — независимый консультант, trainer и записи.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-234">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ea9d7-235">Его последняя книга — [ *диспетчерами учат самостоятельно ASP.NET 2.0 в течение 24 часов*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="ea9d7-235">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="ea9d7-236">Он может быть достигнута по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) или через его блог, который можно найти в [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="ea9d7-236">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="ea9d7-237">Благодарности</span><span class="sxs-lookup"><span data-stu-id="ea9d7-237">Special Thanks To</span></span>

<span data-ttu-id="ea9d7-238">Этот учебник ряд прошел проверку многие полезные рецензентов.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-238">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ea9d7-239">Основной рецензент этого учебника было – Хилтон Гизнау.</span><span class="sxs-lookup"><span data-stu-id="ea9d7-239">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="ea9d7-240">Объясняются моих последующих статей для MSDN?</span><span class="sxs-lookup"><span data-stu-id="ea9d7-240">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ea9d7-241">Если Да, напишите мне по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-241">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="ea9d7-242">[Назад](master-detail-filtering-with-a-dropdownlist-cs.md)
[Вперед](master-detail-filtering-across-two-pages-cs.md)</span><span class="sxs-lookup"><span data-stu-id="ea9d7-242">[Previous](master-detail-filtering-with-a-dropdownlist-cs.md)
[Next](master-detail-filtering-across-two-pages-cs.md)</span></span>
