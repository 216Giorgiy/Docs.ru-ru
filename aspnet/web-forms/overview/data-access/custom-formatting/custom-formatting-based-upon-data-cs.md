---
uid: web-forms/overview/data-access/custom-formatting/custom-formatting-based-upon-data-cs
title: Настраиваемое форматирование на основе данных (C#) | Документы Microsoft
author: rick-anderson
description: Настройка формата элементов GridView, DetailsView и FormView на основе данных, привязанное к нему может осуществляться несколькими способами. В этом учебнике мы будем l...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: 871a4574-f89c-4214-b786-79253ed3653b
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/custom-formatting/custom-formatting-based-upon-data-cs
msc.type: authoredcontent
ms.openlocfilehash: 31cf628baf2250c2e7e71ab38cd64b218dc927e7
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30876869"
---
<a name="custom-formatting-based-upon-data-c"></a><span data-ttu-id="6b16b-104">Настраиваемое форматирование на основе данных (C#)</span><span class="sxs-lookup"><span data-stu-id="6b16b-104">Custom Formatting Based Upon Data (C#)</span></span>
====================
<span data-ttu-id="6b16b-105">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6b16b-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6b16b-106">[Загрузить пример приложения](http://download.microsoft.com/download/9/6/9/969e5c94-dfb6-4e47-9570-d6d9e704c3c1/ASPNET_Data_Tutorial_11_CS.exe) или [скачать PDF](custom-formatting-based-upon-data-cs/_static/datatutorial11cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="6b16b-106">[Download Sample App](http://download.microsoft.com/download/9/6/9/969e5c94-dfb6-4e47-9570-d6d9e704c3c1/ASPNET_Data_Tutorial_11_CS.exe) or [Download PDF](custom-formatting-based-upon-data-cs/_static/datatutorial11cs1.pdf)</span></span>

> <span data-ttu-id="6b16b-107">Настройка формата элементов GridView, DetailsView и FormView на основе данных, привязанное к нему может осуществляться несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="6b16b-107">Adjusting the format of the GridView, DetailsView, or FormView based upon the data bound to it can be accomplished in multiple ways.</span></span> <span data-ttu-id="6b16b-108">В этом учебнике мы рассмотрим способы выполнения привязана к данным с помощью обработчиков событий с привязкой к данным и RowDataBound форматирование.</span><span class="sxs-lookup"><span data-stu-id="6b16b-108">In this tutorial we'll look at how to accomplish data bound formatting through the use of the DataBound and RowDataBound event handlers.</span></span>


## <a name="introduction"></a><span data-ttu-id="6b16b-109">Вступление</span><span class="sxs-lookup"><span data-stu-id="6b16b-109">Introduction</span></span>

<span data-ttu-id="6b16b-110">Можно настроить внешний вид элементов управления GridView, DetailsView и FormView через множество относящихся к стилю свойств.</span><span class="sxs-lookup"><span data-stu-id="6b16b-110">The appearance of the GridView, DetailsView, and FormView controls can be customized through a myriad of style-related properties.</span></span> <span data-ttu-id="6b16b-111">Такие свойства, как `CssClass`, `Font`, `BorderWidth`, `BorderStyle`, `BorderColor`, `Width`, и `Height`, в частности, определяют общий внешний вид отображаемых элементов управления.</span><span class="sxs-lookup"><span data-stu-id="6b16b-111">Properties like `CssClass`, `Font`, `BorderWidth`, `BorderStyle`, `BorderColor`, `Width`, and `Height`, among others, dictate the general appearance of the rendered control.</span></span> <span data-ttu-id="6b16b-112">Свойства в том числе `HeaderStyle`, `RowStyle`, `AlternatingRowStyle`, и другие разрешают те же параметры стиля, применяемые к различным разделам.</span><span class="sxs-lookup"><span data-stu-id="6b16b-112">Properties including `HeaderStyle`, `RowStyle`, `AlternatingRowStyle`, and others allow these same style settings to be applied to particular sections.</span></span> <span data-ttu-id="6b16b-113">Аналогичным образом эти параметры стиля могут применяться на уровне полей.</span><span class="sxs-lookup"><span data-stu-id="6b16b-113">Likewise, these style settings can be applied at the field level.</span></span>

<span data-ttu-id="6b16b-114">Во многих сценариях, форматирования требования зависят от значения отображаемых данных.</span><span class="sxs-lookup"><span data-stu-id="6b16b-114">In many scenarios though, the formatting requirements depend upon the value of the displayed data.</span></span> <span data-ttu-id="6b16b-115">Например, для привлечения внимания к из купить продукты, отчет, содержащий сведения о продукте задать цвет фона на желтый для этих продуктов, `UnitsInStock` и `UnitsOnOrder` поля являются оба равны 0.</span><span class="sxs-lookup"><span data-stu-id="6b16b-115">For example, to draw attention to out of stock products, a report listing product information might set the background color to yellow for those products whose `UnitsInStock` and `UnitsOnOrder` fields are both equal to 0.</span></span> <span data-ttu-id="6b16b-116">Чтобы выделить дороже продуктов, необходимо отобразить цены на продукты стоимостью более $75.00 полужирным шрифтом.</span><span class="sxs-lookup"><span data-stu-id="6b16b-116">To highlight the more expensive products, we may want to display the prices of those products costing more than $75.00 in a bold font.</span></span>

<span data-ttu-id="6b16b-117">Настройка формата элементов GridView, DetailsView и FormView на основе данных, привязанное к нему может осуществляться несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="6b16b-117">Adjusting the format of the GridView, DetailsView, or FormView based upon the data bound to it can be accomplished in multiple ways.</span></span> <span data-ttu-id="6b16b-118">В этом учебнике мы рассмотрим способы выполнения привязана к данным, форматирование использования `DataBound` и `RowDataBound` обработчики событий.</span><span class="sxs-lookup"><span data-stu-id="6b16b-118">In this tutorial we'll look at how to accomplish data bound formatting through the use of the `DataBound` and `RowDataBound` event handlers.</span></span> <span data-ttu-id="6b16b-119">В следующем уроке мы изучим Альтернативным подходом.</span><span class="sxs-lookup"><span data-stu-id="6b16b-119">In the next tutorial we'll explore an alternative approach.</span></span>

## <a name="using-the-detailsview-controlsdataboundevent-handler"></a><span data-ttu-id="6b16b-120">С помощью элемента управления DetailsView`DataBound`обработчика событий</span><span class="sxs-lookup"><span data-stu-id="6b16b-120">Using the DetailsView Control's`DataBound`Event Handler</span></span>

<span data-ttu-id="6b16b-121">При привязке данных к DetailsView, из элемента управления источником данных, либо путем программного связывания данных для элемента управления `DataSource` и вызова его `DataBind()` метода, происходят следующие действия:</span><span class="sxs-lookup"><span data-stu-id="6b16b-121">When data is bound to a DetailsView, either from a data source control or through programmatically assigning data to the control's `DataSource` property and calling its `DataBind()` method, the following sequence of steps occur:</span></span>

1. <span data-ttu-id="6b16b-122">Данные веб-элемент управления `DataBinding` вызывается событие.</span><span class="sxs-lookup"><span data-stu-id="6b16b-122">The data Web control's `DataBinding` event fires.</span></span>
2. <span data-ttu-id="6b16b-123">Данные, привязанные к данным веб-элемента управления.</span><span class="sxs-lookup"><span data-stu-id="6b16b-123">The data is bound to the data Web control.</span></span>
3. <span data-ttu-id="6b16b-124">Данные веб-элемент управления `DataBound` вызывается событие.</span><span class="sxs-lookup"><span data-stu-id="6b16b-124">The data Web control's `DataBound` event fires.</span></span>

<span data-ttu-id="6b16b-125">Пользовательская логика могут быть добавлены сразу после шаги 1 и 3 посредством обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="6b16b-125">Custom logic can be injected immediately after steps 1 and 3 through an event handler.</span></span> <span data-ttu-id="6b16b-126">Путем создания обработчика событий для `DataBound` событий, можно программным образом определить данные, которые будут привязаны к веб-управления данными и изменять форматирование при необходимости.</span><span class="sxs-lookup"><span data-stu-id="6b16b-126">By creating an event handler for the `DataBound` event we can programmatically determine the data that has been bound to the data Web control and adjust the formatting as needed.</span></span> <span data-ttu-id="6b16b-127">Давайте рассмотрим создание DetailsView, будут отображаться общие сведения о продукте, но будет отображаться `UnitPrice` значение в ***шрифта полужирный, курсив*** , если оно превышает $75.00.</span><span class="sxs-lookup"><span data-stu-id="6b16b-127">To illustrate this let's create a DetailsView that will list general information about a product, but will display the `UnitPrice` value in a ***bold, italic font*** if it exceeds $75.00.</span></span>

## <a name="step-1-displaying-the-product-information-in-a-detailsview"></a><span data-ttu-id="6b16b-128">Шаг 1: Отображение сведений о продукте в элементе управления DetailsView</span><span class="sxs-lookup"><span data-stu-id="6b16b-128">Step 1: Displaying the Product Information in a DetailsView</span></span>

<span data-ttu-id="6b16b-129">Откройте `CustomColors.aspx` страницы в `CustomFormatting` папки, перетащите элемент управления DetailsView из области элементов в конструктор, задайте его `ID` значение свойства `ExpensiveProductsPriceInBoldItalic`и привязать его к новый элемент управления ObjectDataSource, который вызывает `ProductsBLL` класса `GetProducts()` метод.</span><span class="sxs-lookup"><span data-stu-id="6b16b-129">Open the `CustomColors.aspx` page in the `CustomFormatting` folder, drag a DetailsView control from the Toolbox onto the Designer, set its `ID` property value to `ExpensiveProductsPriceInBoldItalic`, and bind it to a new ObjectDataSource control that invokes the `ProductsBLL` class's `GetProducts()` method.</span></span> <span data-ttu-id="6b16b-130">Подробные инструкции для выполнения этой задачи здесь для краткости опущены, так как мы рассмотрели их сведений в предыдущих учебниках.</span><span class="sxs-lookup"><span data-stu-id="6b16b-130">The detailed steps for accomplishing this are omitted here for brevity since we examined them in detail in previous tutorials.</span></span>

<span data-ttu-id="6b16b-131">После ObjectDataSource привязан к DetailsView, занять некоторое время для изменения списка полей.</span><span class="sxs-lookup"><span data-stu-id="6b16b-131">Once you've bound the ObjectDataSource to the DetailsView, take a moment to modify the field list.</span></span> <span data-ttu-id="6b16b-132">Я решил удалить `ProductID`, `SupplierID`, `CategoryID`, `UnitsInStock`, `UnitsOnOrder`, `ReorderLevel`, и `Discontinued` стояли переформатированы оставшиеся стояли и переименовать.</span><span class="sxs-lookup"><span data-stu-id="6b16b-132">I've opted to remove the `ProductID`, `SupplierID`, `CategoryID`, `UnitsInStock`, `UnitsOnOrder`, `ReorderLevel`, and `Discontinued` BoundFields and renamed and reformatted the remaining BoundFields.</span></span> <span data-ttu-id="6b16b-133">Я также очищаются `Width` и `Height` параметры.</span><span class="sxs-lookup"><span data-stu-id="6b16b-133">I also cleared out the `Width` and `Height` settings.</span></span> <span data-ttu-id="6b16b-134">Поскольку DetailsView отображает только одна запись, необходимо включить разбиение на страницы, чтобы разрешить конечным пользователям просматривать все продукты.</span><span class="sxs-lookup"><span data-stu-id="6b16b-134">Since the DetailsView displays only a single record, we need to enable paging in order to allow the end user to view all of the products.</span></span> <span data-ttu-id="6b16b-135">Сделать, установив флажок Включить постраничный просмотр в DetailsView смарт-тега.</span><span class="sxs-lookup"><span data-stu-id="6b16b-135">Do so by checking the Enable Paging checkbox in the DetailsView's smart tag.</span></span>


<span data-ttu-id="6b16b-136">[![Установите флажок Enable постраничного просмотра в DetailsView смарт-тег](custom-formatting-based-upon-data-cs/_static/image2.png)](custom-formatting-based-upon-data-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6b16b-136">[![Check the Enable Paging Checkbox in the DetailsView's Smart Tag](custom-formatting-based-upon-data-cs/_static/image2.png)](custom-formatting-based-upon-data-cs/_static/image1.png)</span></span>

<span data-ttu-id="6b16b-137">**Рис. 1**: установите флажок "Включить" разбиение по страницам в DetailsView смарт-тег ([Просмотр полноразмерное изображение](custom-formatting-based-upon-data-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="6b16b-137">**Figure 1**: Check the Enable Paging Checkbox in the DetailsView's Smart Tag ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image3.png))</span></span>


<span data-ttu-id="6b16b-138">После внесения этих изменений будет DetailsView разметку:</span><span class="sxs-lookup"><span data-stu-id="6b16b-138">After these changes, the DetailsView markup will be:</span></span>


[!code-aspx[Main](custom-formatting-based-upon-data-cs/samples/sample1.aspx)]

<span data-ttu-id="6b16b-139">Теперь пора проверить эту страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="6b16b-139">Take a moment to test out this page in your browser.</span></span>


<span data-ttu-id="6b16b-140">[![Элемент управления DetailsView отображает одного продукта за раз](custom-formatting-based-upon-data-cs/_static/image5.png)](custom-formatting-based-upon-data-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="6b16b-140">[![The DetailsView Control Displays One Product at a Time](custom-formatting-based-upon-data-cs/_static/image5.png)](custom-formatting-based-upon-data-cs/_static/image4.png)</span></span>

<span data-ttu-id="6b16b-141">**На рисунке 2**: DetailsView элемент управления отображает одного продукта за раз ([Просмотр полноразмерное изображение](custom-formatting-based-upon-data-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="6b16b-141">**Figure 2**: The DetailsView Control Displays One Product at a Time ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image6.png))</span></span>


## <a name="step-2-programmatically-determining-the-value-of-the-data-in-the-databound-event-handler"></a><span data-ttu-id="6b16b-142">Шаг 2: Программное определение значений данных в обработчике событий с привязкой к данным</span><span class="sxs-lookup"><span data-stu-id="6b16b-142">Step 2: Programmatically Determining the Value of the Data in the DataBound Event Handler</span></span>

<span data-ttu-id="6b16b-143">Для правильного отображения цены продуктов для шрифта полужирный, курсив, `UnitPrice` значение превышает $75.00, то необходимо сначала сможет программно определить `UnitPrice` значение.</span><span class="sxs-lookup"><span data-stu-id="6b16b-143">In order to display the price in a bold, italic font for those products whose `UnitPrice` value exceeds $75.00, we need to first be able to programmatically determine the `UnitPrice` value.</span></span> <span data-ttu-id="6b16b-144">Для DetailsView, это можно сделать в `DataBound` обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="6b16b-144">For the DetailsView, this can be accomplished in the `DataBound` event handler.</span></span> <span data-ttu-id="6b16b-145">Чтобы создать событие обработчика щелкните DetailsView в конструкторе, затем перейдите в окно «Свойства».</span><span class="sxs-lookup"><span data-stu-id="6b16b-145">To create the event handler click on the DetailsView in the Designer then navigate to the Properties window.</span></span> <span data-ttu-id="6b16b-146">Нажмите клавишу F4, чтобы открыть его, если он не является видимым или перейдите в меню «Вид» и выберите пункт меню в окне "Свойства".</span><span class="sxs-lookup"><span data-stu-id="6b16b-146">Press F4 to bring it up, if it's not visible, or go to the View menu and select the Properties Window menu option.</span></span> <span data-ttu-id="6b16b-147">В окне свойств щелкните значок молнии, чтобы вывести список событий DetailsView.</span><span class="sxs-lookup"><span data-stu-id="6b16b-147">From the Properties window, click on the lightning bolt icon to list the DetailsView's events.</span></span> <span data-ttu-id="6b16b-148">Затем либо дважды щелкните `DataBound` , либо введите имя обработчика событий, нужно создать.</span><span class="sxs-lookup"><span data-stu-id="6b16b-148">Next, either double-click the `DataBound` event or type in the name of the event handler you want to create.</span></span>


![Создайте обработчик событий для события с привязкой к данным](custom-formatting-based-upon-data-cs/_static/image7.png)

<span data-ttu-id="6b16b-150">**Рис. 3**: создайте обработчик событий для `DataBound` событий</span><span class="sxs-lookup"><span data-stu-id="6b16b-150">**Figure 3**: Create an Event Handler for the `DataBound` Event</span></span>


<span data-ttu-id="6b16b-151">Это автоматически создать обработчик событий и перейти к часть кода куда он был добавлен.</span><span class="sxs-lookup"><span data-stu-id="6b16b-151">Doing so will automatically create the event handler and take you to the code portion where it has been added.</span></span> <span data-ttu-id="6b16b-152">На этом этапе можно увидеть:</span><span class="sxs-lookup"><span data-stu-id="6b16b-152">At this point you will see:</span></span>


[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample2.cs)]

<span data-ttu-id="6b16b-153">Данные, привязанные к DetailsView может осуществляться через `DataItem` свойство.</span><span class="sxs-lookup"><span data-stu-id="6b16b-153">The data bound to the DetailsView can be accessed via the `DataItem` property.</span></span> <span data-ttu-id="6b16b-154">Напомним, что элемент управления выполняется привязка к строго типизированный объект DataTable, состоящее из коллекции экземпляров строго типизированных DataRow.</span><span class="sxs-lookup"><span data-stu-id="6b16b-154">Recall that we are binding our controls to a strongly-typed DataTable, which is composed of a collection of strongly-typed DataRow instances.</span></span> <span data-ttu-id="6b16b-155">Когда DataTable привязан к DetailsView, первый DataRow в DataTable назначается DetailsView `DataItem` свойство.</span><span class="sxs-lookup"><span data-stu-id="6b16b-155">When the DataTable is bound to the DetailsView, the first DataRow in the DataTable is assigned to the DetailsView's `DataItem` property.</span></span> <span data-ttu-id="6b16b-156">В частности `DataItem` присваивается `DataRowView` объекта.</span><span class="sxs-lookup"><span data-stu-id="6b16b-156">Specifically, the `DataItem` property is assigned a `DataRowView` object.</span></span> <span data-ttu-id="6b16b-157">Мы используем `DataRowView` `Row` свойство, чтобы получить доступ к базовому объекту DataRow, который является фактически `ProductsRow` экземпляра.</span><span class="sxs-lookup"><span data-stu-id="6b16b-157">We can use the `DataRowView`'s `Row` property to get access to the underlying DataRow object, which is actually a `ProductsRow` instance.</span></span> <span data-ttu-id="6b16b-158">После этого `ProductsRow` мы определить простой проверкой значения свойств объекта экземпляра.</span><span class="sxs-lookup"><span data-stu-id="6b16b-158">Once we have this `ProductsRow` instance we can make our decision by simply inspecting the object's property values.</span></span>

<span data-ttu-id="6b16b-159">Следующий код иллюстрирует, как определить, является ли `UnitPrice` значение, связанное с элементом управления DetailsView больше $75.00:</span><span class="sxs-lookup"><span data-stu-id="6b16b-159">The following code illustrates how to determine whether the `UnitPrice` value bound to the DetailsView control is greater than $75.00:</span></span>


[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample3.cs)]

> [!NOTE]
> <span data-ttu-id="6b16b-160">Так как `UnitPrice` может иметь `NULL` значение в в базе данных, сначала проверьте, чтобы убедиться в том, что мы не дело с `NULL` значение перед обращением к `ProductsRow`в `UnitPrice` свойство.</span><span class="sxs-lookup"><span data-stu-id="6b16b-160">Since `UnitPrice` can have a `NULL` value in the database, we first check to make sure that we're not dealing with a `NULL` value before accessing the `ProductsRow`'s `UnitPrice` property.</span></span> <span data-ttu-id="6b16b-161">Эта проверка важна так как при попытке доступа к `UnitPrice` со `NULL` значение `ProductsRow` выдаст исключение [StrongTypingException исключение](https://msdn.microsoft.com/library/system.data.strongtypingexception.aspx).</span><span class="sxs-lookup"><span data-stu-id="6b16b-161">This check is important because if we attempt to access the `UnitPrice` property when it has a `NULL` value the `ProductsRow` object will throw a [StrongTypingException exception](https://msdn.microsoft.com/library/system.data.strongtypingexception.aspx).</span></span>


## <a name="step-3-formatting-the-unitprice-value-in-the-detailsview"></a><span data-ttu-id="6b16b-162">Шаг 3: Форматирование значения UnitPrice в DetailsView</span><span class="sxs-lookup"><span data-stu-id="6b16b-162">Step 3: Formatting the UnitPrice Value in the DetailsView</span></span>

<span data-ttu-id="6b16b-163">На этом этапе можно определить, является ли `UnitPrice` значение, привязанное к DetailsView имеет значение, превышающее $75.00, но у нас пока для ознакомления с программное изменение DetailsView форматирования, соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="6b16b-163">At this point we can determine whether the `UnitPrice` value bound to the DetailsView has a value that exceeds $75.00, but we've yet to see how to programmatically adjust the DetailsView's formatting accordingly.</span></span> <span data-ttu-id="6b16b-164">Чтобы изменить форматирование всей строки в DetailsView, программным образом обратиться к строки с помощью `DetailsViewID.Rows[index]`; чтобы изменения отдельной ячейки, доступ к используйте `DetailsViewID.Rows[index].Cells[index]`.</span><span class="sxs-lookup"><span data-stu-id="6b16b-164">To modify the formatting of an entire row in the DetailsView, programmatically access the row using `DetailsViewID.Rows[index]`; to modify a particular cell, access use `DetailsViewID.Rows[index].Cells[index]`.</span></span> <span data-ttu-id="6b16b-165">После получения ссылку на строку или ячейку можно затем настроить его внешний вид путем установки его свойств, относящихся к стилю.</span><span class="sxs-lookup"><span data-stu-id="6b16b-165">Once we have a reference to the row or cell we can then adjust its appearance by setting its style-related properties.</span></span>

<span data-ttu-id="6b16b-166">Программный доступ к строки необходимо знать индекс строки, который начинается с 0.</span><span class="sxs-lookup"><span data-stu-id="6b16b-166">Accessing a row programmatically requires that you know the row's index, which starts at 0.</span></span> <span data-ttu-id="6b16b-167">`UnitPrice` Пятый строки в DetailsView, присвоить ей индекса 4 и предоставления программного доступа с помощью `ExpensiveProductsPriceInBoldItalic.Rows[4]`.</span><span class="sxs-lookup"><span data-stu-id="6b16b-167">The `UnitPrice` row is the fifth row in the DetailsView, giving it an index of 4 and making it programmatically accessible using `ExpensiveProductsPriceInBoldItalic.Rows[4]`.</span></span> <span data-ttu-id="6b16b-168">На этом этапе мы может иметь всю строку содержимого, отображаются шрифтом полужирный, курсив, используя следующий код:</span><span class="sxs-lookup"><span data-stu-id="6b16b-168">At this point we could have the entire row's content displayed in a bold, italic font by using the following code:</span></span>


[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample4.cs)]

<span data-ttu-id="6b16b-169">Тем не менее, это сделает *оба* метки (цена) и значение полужирным шрифтом или курсивом.</span><span class="sxs-lookup"><span data-stu-id="6b16b-169">However, this will make *both* the label (Price) and the value bold and italic.</span></span> <span data-ttu-id="6b16b-170">Если мы хотим сделать только значение полужирный и курсивный нам нужно применить это форматирование во вторую ячейку в строке, в которой можно выполнить при помощи следующих:</span><span class="sxs-lookup"><span data-stu-id="6b16b-170">If we want to make just the value bold and italic we need to apply this formatting to the second cell in the row, which can be accomplished using the following:</span></span>


[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample5.cs)]

<span data-ttu-id="6b16b-171">Поскольку мы старались сих с помощью таблицы стилей поддерживать четкое разделение отображения разметки и сведений, относящихся к стилю, вместо задания свойства определенного стиля, как показано выше давайте вместо этого используйте класс CSS.</span><span class="sxs-lookup"><span data-stu-id="6b16b-171">Since our tutorials thus far have used stylesheets to maintain a clean separation between the rendered markup and style-related information, rather than setting the specific style properties as shown above let's instead use a CSS class.</span></span> <span data-ttu-id="6b16b-172">Откройте `Styles.css` таблицы стилей и добавьте новый класс CSS `ExpensivePriceEmphasis` со следующим определением:</span><span class="sxs-lookup"><span data-stu-id="6b16b-172">Open the `Styles.css` stylesheet and add a new CSS class named `ExpensivePriceEmphasis` with the following definition:</span></span>


[!code-css[Main](custom-formatting-based-upon-data-cs/samples/sample6.css)]

<span data-ttu-id="6b16b-173">Затем в `DataBound` обработчика событий, укажите в ячейке `CssClass` свойства `ExpensivePriceEmphasis`.</span><span class="sxs-lookup"><span data-stu-id="6b16b-173">Then, in the `DataBound` event handler, set the cell's `CssClass` property to `ExpensivePriceEmphasis`.</span></span> <span data-ttu-id="6b16b-174">В следующем коде показано `DataBound` обработчик событий в полном объеме:</span><span class="sxs-lookup"><span data-stu-id="6b16b-174">The following code shows the `DataBound` event handler in its entirety:</span></span>


[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample7.cs)]

<span data-ttu-id="6b16b-175">При просмотре Chai, который стоит меньше $75.00, цена отображается обычным шрифтом (см. рис. 4).</span><span class="sxs-lookup"><span data-stu-id="6b16b-175">When viewing Chai, which costs less than $75.00, the price is displayed in a normal font (see Figure 4).</span></span> <span data-ttu-id="6b16b-176">Однако при просмотре Mishi Kobe Niku имеет цену 97.00 долларов, цена отображается шрифтом полужирный, курсив (см. рис. 5).</span><span class="sxs-lookup"><span data-stu-id="6b16b-176">However, when viewing Mishi Kobe Niku, which has a price of $97.00, the price is displayed in a bold, italic font (see Figure 5).</span></span>


<span data-ttu-id="6b16b-177">[![Цены меньше $75.00 отображаются в обычный шрифт](custom-formatting-based-upon-data-cs/_static/image9.png)](custom-formatting-based-upon-data-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="6b16b-177">[![Prices Less than $75.00 are Displayed in a Normal Font](custom-formatting-based-upon-data-cs/_static/image9.png)](custom-formatting-based-upon-data-cs/_static/image8.png)</span></span>

<span data-ttu-id="6b16b-178">**Рис. 4**: цены меньше $75.00 отображаются шрифтом Normal ([Просмотр полноразмерное изображение](custom-formatting-based-upon-data-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="6b16b-178">**Figure 4**: Prices Less than $75.00 are Displayed in a Normal Font ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image10.png))</span></span>


<span data-ttu-id="6b16b-179">[![Цена дорогих продуктов отображаются в полужирный, курсив шрифта](custom-formatting-based-upon-data-cs/_static/image12.png)](custom-formatting-based-upon-data-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="6b16b-179">[![Expensive Products' Prices are Displayed in a Bold, Italic Font](custom-formatting-based-upon-data-cs/_static/image12.png)](custom-formatting-based-upon-data-cs/_static/image11.png)</span></span>

<span data-ttu-id="6b16b-180">**Рис. 5**: цена дорогих продуктов отображаются в полужирный, курсив шрифта ([Просмотр полноразмерное изображение](custom-formatting-based-upon-data-cs/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="6b16b-180">**Figure 5**: Expensive Products' Prices are Displayed in a Bold, Italic Font ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image13.png))</span></span>


## <a name="using-the-formview-controlsdataboundevent-handler"></a><span data-ttu-id="6b16b-181">С помощью элемента управления FormView`DataBound`обработчика событий</span><span class="sxs-lookup"><span data-stu-id="6b16b-181">Using the FormView Control's`DataBound`Event Handler</span></span>

<span data-ttu-id="6b16b-182">Процедура определения базовых данных, привязанных к FormView идентичны для создания DetailsView `DataBound` , присвойте `DataItem` свойство в тип соответствующего объекта привязки к элементу управления и определения дальнейших действий.</span><span class="sxs-lookup"><span data-stu-id="6b16b-182">The steps for determining the underlying data bound to a FormView are identical to those for a DetailsView create a `DataBound` event handler, cast the `DataItem` property to the appropriate object type bound to the control, and determine how to proceed.</span></span> <span data-ttu-id="6b16b-183">FormView и DetailsView различаются, однако обновление внешнего вида собственный пользовательский интерфейс.</span><span class="sxs-lookup"><span data-stu-id="6b16b-183">The FormView and DetailsView differ, however, in how their user interface's appearance is updated.</span></span>

<span data-ttu-id="6b16b-184">FormView не содержит любые стояли и поэтому не имеет `Rows` коллекции.</span><span class="sxs-lookup"><span data-stu-id="6b16b-184">The FormView does not contain any BoundFields and therefore lacks the `Rows` collection.</span></span> <span data-ttu-id="6b16b-185">Вместо этого FormView состоит из шаблонов, которые могут содержать смесь статического кода HTML, веб-элементов управления и синтаксис привязки данных.</span><span class="sxs-lookup"><span data-stu-id="6b16b-185">Instead, a FormView is composed of templates, which can contain a mix of static HTML, Web controls, and databinding syntax.</span></span> <span data-ttu-id="6b16b-186">Настройка стиля элемента FormView обычно состоит в настройке стиля из одного или нескольких веб-элементов управления в шаблоны FormView.</span><span class="sxs-lookup"><span data-stu-id="6b16b-186">Adjusting the style of a FormView typically involves adjusting the style of one or more of the Web controls within the FormView's templates.</span></span>

<span data-ttu-id="6b16b-187">Чтобы проиллюстрировать это, давайте FormView для списка продуктов как и в предыдущем примере, но на этот раз давайте отображения используется только имя продукта и единиц на складе с использованием единиц на складе, отображаются красным цветом, если это значение меньше или равно 10.</span><span class="sxs-lookup"><span data-stu-id="6b16b-187">To illustrate this, let's use a FormView to list products like in the previous example, but this time let's display just the product name and units in stock with the units in stock displayed in a red font if it is less than or equal to 10.</span></span>

## <a name="step-4-displaying-the-product-information-in-a-formview"></a><span data-ttu-id="6b16b-188">Шаг 4: Отображение сведений о продукте в FormView</span><span class="sxs-lookup"><span data-stu-id="6b16b-188">Step 4: Displaying the Product Information in a FormView</span></span>

<span data-ttu-id="6b16b-189">Добавить FormView для `CustomColors.aspx` странице ниже DetailsView и задайте его `ID` свойства `LowStockedProductsInRed`.</span><span class="sxs-lookup"><span data-stu-id="6b16b-189">Add a FormView to the `CustomColors.aspx` page beneath the DetailsView and set its `ID` property to `LowStockedProductsInRed`.</span></span> <span data-ttu-id="6b16b-190">Привязать элемент управления ObjectDataSource, созданный на предыдущем шаге FormView.</span><span class="sxs-lookup"><span data-stu-id="6b16b-190">Bind the FormView to the ObjectDataSource control created from the previous step.</span></span> <span data-ttu-id="6b16b-191">Это создаст `ItemTemplate`, `EditItemTemplate`, и `InsertItemTemplate` для FormView.</span><span class="sxs-lookup"><span data-stu-id="6b16b-191">This will create an `ItemTemplate`, `EditItemTemplate`, and `InsertItemTemplate` for the FormView.</span></span> <span data-ttu-id="6b16b-192">Удалить `EditItemTemplate` и `InsertItemTemplate` и упрощения `ItemTemplate` для включения только `ProductName` и `UnitsInStock` значений, каждое в своих собственных с соответствующим именем метки элементов управления.</span><span class="sxs-lookup"><span data-stu-id="6b16b-192">Remove the `EditItemTemplate` and `InsertItemTemplate` and simplify the `ItemTemplate` to include just the `ProductName` and `UnitsInStock` values, each in their own appropriately-named Label controls.</span></span> <span data-ttu-id="6b16b-193">С помощью DetailsView из примера выше, также установите флажок Включить постраничный просмотр в FormView смарт-тег.</span><span class="sxs-lookup"><span data-stu-id="6b16b-193">As with the DetailsView from the earlier example, also check the Enable Paging checkbox in the FormView's smart tag.</span></span>

<span data-ttu-id="6b16b-194">После этих изменений в FormView должна выглядеть следующим:</span><span class="sxs-lookup"><span data-stu-id="6b16b-194">After these edits your FormView's markup should look similar to the following:</span></span>


[!code-aspx[Main](custom-formatting-based-upon-data-cs/samples/sample8.aspx)]

<span data-ttu-id="6b16b-195">Обратите внимание, что `ItemTemplate` содержит:</span><span class="sxs-lookup"><span data-stu-id="6b16b-195">Note that the `ItemTemplate` contains:</span></span>

- <span data-ttu-id="6b16b-196">**Статическим HTML** текст «продукта:» и «единиц на складе:» вместе с `<br />` и `<b>` элементы.</span><span class="sxs-lookup"><span data-stu-id="6b16b-196">**Static HTML** the text "Product:" and "Units In Stock:" along with the `<br />` and `<b>` elements.</span></span>
- <span data-ttu-id="6b16b-197">**Веб-элементы управления** два элемента управления Label `ProductNameLabel` и `UnitsInStockLabel`.</span><span class="sxs-lookup"><span data-stu-id="6b16b-197">**Web controls** the two Label controls, `ProductNameLabel` and `UnitsInStockLabel`.</span></span>
- <span data-ttu-id="6b16b-198">**Синтаксис привязки данных** `<%# Bind("ProductName") %>` и `<%# Bind("UnitsInStock") %>` синтаксис, который присваивает значения из этих полей к элементам управления Label `Text` свойства.</span><span class="sxs-lookup"><span data-stu-id="6b16b-198">**Databinding syntax** the `<%# Bind("ProductName") %>` and `<%# Bind("UnitsInStock") %>` syntax, which assigns the values from these fields to the Label controls' `Text` properties.</span></span>

## <a name="step-5-programmatically-determining-the-value-of-the-data-in-the-databound-event-handler"></a><span data-ttu-id="6b16b-199">Шаг 5: Программное определение значений данных в обработчике событий с привязкой к данным</span><span class="sxs-lookup"><span data-stu-id="6b16b-199">Step 5: Programmatically Determining the Value of the Data in the DataBound Event Handler</span></span>

<span data-ttu-id="6b16b-200">С FormView готова, следующим шагом является программным способом определить, если `UnitsInStock` значение меньше или равно 10.</span><span class="sxs-lookup"><span data-stu-id="6b16b-200">With the FormView's markup complete, the next step is to programmatically determine if the `UnitsInStock` value is less than or equal to 10.</span></span> <span data-ttu-id="6b16b-201">Это можно сделать с FormView точно так же, как в DetailsView.</span><span class="sxs-lookup"><span data-stu-id="6b16b-201">This is accomplished in the exact same manner with the FormView as it was with the DetailsView.</span></span> <span data-ttu-id="6b16b-202">Начните с создания обработчика событий для FormView `DataBound` событий.</span><span class="sxs-lookup"><span data-stu-id="6b16b-202">Start by creating an event handler for the FormView's `DataBound` event.</span></span>


![Создание обработчика событий с привязкой к данным](custom-formatting-based-upon-data-cs/_static/image14.png)

<span data-ttu-id="6b16b-204">**Рис. 6**: создание `DataBound` обработчика событий</span><span class="sxs-lookup"><span data-stu-id="6b16b-204">**Figure 6**: Create the `DataBound` Event Handler</span></span>


<span data-ttu-id="6b16b-205">События обработчика приведение FormView `DataItem` свойства `ProductsRow` экземпляр и определить ли `UnitsInPrice` значение — таким образом, что нам нужно отобразить ее красным цветом.</span><span class="sxs-lookup"><span data-stu-id="6b16b-205">In the event handler cast the FormView's `DataItem` property to a `ProductsRow` instance and determine whether the `UnitsInPrice` value is such that we need to display it in a red font.</span></span>


[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample9.cs)]

## <a name="step-6-formatting-the-unitsinstocklabel-label-control-in-the-formviews-itemtemplate"></a><span data-ttu-id="6b16b-206">Шаг 6: Форматирование в элементе управления UnitsInStockLabel Label в FormView ItemTemplate</span><span class="sxs-lookup"><span data-stu-id="6b16b-206">Step 6: Formatting the UnitsInStockLabel Label Control in the FormView's ItemTemplate</span></span>

<span data-ttu-id="6b16b-207">Последним шагом является выделение значения `UnitsInStock` значение отображается красным цветом, если значение не превышает 10.</span><span class="sxs-lookup"><span data-stu-id="6b16b-207">The final step is to format the displayed `UnitsInStock` value in a red font if the value is 10 or less.</span></span> <span data-ttu-id="6b16b-208">Для этого нужно получить программный доступ к `UnitsInStockLabel` управления `ItemTemplate` и задать его свойства стиля, чтобы его текст отображается красным цветом.</span><span class="sxs-lookup"><span data-stu-id="6b16b-208">To accomplish this we need to programmatically access the `UnitsInStockLabel` control in the `ItemTemplate` and set its style properties so that its text is displayed in red.</span></span> <span data-ttu-id="6b16b-209">Чтобы получить доступ к веб-элемента управления в шаблоне, используйте `FindControl("controlID")` метод следующим образом:</span><span class="sxs-lookup"><span data-stu-id="6b16b-209">To access a Web control in a template, use the `FindControl("controlID")` method like this:</span></span>


[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample10.cs)]

<span data-ttu-id="6b16b-210">В нашем примере мы хотим получить доступ к метку элемент управления `ID` значение `UnitsInStockLabel`, мы используем:</span><span class="sxs-lookup"><span data-stu-id="6b16b-210">For our example we want to access a Label control whose `ID` value is `UnitsInStockLabel`, so we'd use:</span></span>


[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample11.cs)]

<span data-ttu-id="6b16b-211">После получения программный ссылку на веб-элемент управления, при необходимости можно изменять его относящихся к стилю свойств.</span><span class="sxs-lookup"><span data-stu-id="6b16b-211">Once we have a programmatic reference to the Web control, we can modify its style-related properties as needed.</span></span> <span data-ttu-id="6b16b-212">Как в прошлом примере мы создали класс CSS в `Styles.css` с именем `LowUnitsInStockEmphasis`.</span><span class="sxs-lookup"><span data-stu-id="6b16b-212">As with the earlier example, I've created a CSS class in `Styles.css` named `LowUnitsInStockEmphasis`.</span></span> <span data-ttu-id="6b16b-213">Чтобы применить этот стиль для элемента управления Label, установите его `CssClass` свойство соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="6b16b-213">To apply this style to the Label Web control, set its `CssClass` property accordingly.</span></span>


[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample12.cs)]

> [!NOTE]
> <span data-ttu-id="6b16b-214">Синтаксис для форматирования программный доступ к веб-элемента управления с помощью шаблона `FindControl("controlID")` и задание его свойств, относящихся к стилю может также использоваться при использовании [TemplateFields](https://msdn.microsoft.com/library/system.web.ui.webcontrols.templatefield(VS.80).aspx) в DetailsView или GridView элементы управления.</span><span class="sxs-lookup"><span data-stu-id="6b16b-214">The syntax for formatting a template programmatically accessing the Web control using `FindControl("controlID")` and then setting its style-related properties can also be used when using [TemplateFields](https://msdn.microsoft.com/library/system.web.ui.webcontrols.templatefield(VS.80).aspx) in the DetailsView or GridView controls.</span></span> <span data-ttu-id="6b16b-215">В следующем учебном курсе мы изучим TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="6b16b-215">We'll examine TemplateFields in our next tutorial.</span></span>


<span data-ttu-id="6b16b-216">Фигуры. 7 показана FormView при отображении продукта которого `UnitsInStock` значение больше 10, а продукт на рис. 8 имеет его значение меньше 10.</span><span class="sxs-lookup"><span data-stu-id="6b16b-216">Figures 7 shows the FormView when viewing a product whose `UnitsInStock` value is greater than 10, while the product in Figure 8 has its value less than 10.</span></span>


<span data-ttu-id="6b16b-217">[![Для продуктов с достаточно большой Units In Stock настраиваемое форматирование не применяется](custom-formatting-based-upon-data-cs/_static/image16.png)](custom-formatting-based-upon-data-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="6b16b-217">[![For Products With a Sufficiently Large Units In Stock, No Custom Formatting is Applied](custom-formatting-based-upon-data-cs/_static/image16.png)](custom-formatting-based-upon-data-cs/_static/image15.png)</span></span>

<span data-ttu-id="6b16b-218">**Рис. 7**: для продуктов с достаточно большой Units In Stock, настраиваемое форматирование не применяется ([Просмотр полноразмерное изображение](custom-formatting-based-upon-data-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="6b16b-218">**Figure 7**: For Products With a Sufficiently Large Units In Stock, No Custom Formatting is Applied ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image17.png))</span></span>


<span data-ttu-id="6b16b-219">[![Для тех продуктов со значения 10 или меньше единицы в биржевой номер отображается красным цветом](custom-formatting-based-upon-data-cs/_static/image19.png)](custom-formatting-based-upon-data-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="6b16b-219">[![The Units in Stock Number is Shown in Red for Those Products With Values of 10 or Less](custom-formatting-based-upon-data-cs/_static/image19.png)](custom-formatting-based-upon-data-cs/_static/image18.png)</span></span>

<span data-ttu-id="6b16b-220">**Рис. 8**: для тех продуктов со значения 10 или меньше единицы в биржевой номер отображается красным цветом ([Просмотр полноразмерное изображение](custom-formatting-based-upon-data-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="6b16b-220">**Figure 8**: The Units in Stock Number is Shown in Red for Those Products With Values of 10 or Less ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image20.png))</span></span>


## <a name="formatting-with-the-gridviewsrowdataboundevent"></a><span data-ttu-id="6b16b-221">Форматирование с GridView`RowDataBound`событий</span><span class="sxs-lookup"><span data-stu-id="6b16b-221">Formatting with the GridView's`RowDataBound`Event</span></span>

<span data-ttu-id="6b16b-222">Ранее мы рассмотрели последовательность шагов DetailsView и FormView управляет ходом выполнения с помощью во время привязки данных.</span><span class="sxs-lookup"><span data-stu-id="6b16b-222">Earlier we examined the sequence of steps the DetailsView and FormView controls progress through during databinding.</span></span> <span data-ttu-id="6b16b-223">Давайте посмотрим на эти шаги еще раз ее вспомним.</span><span class="sxs-lookup"><span data-stu-id="6b16b-223">Let's look over these steps once again as a refresher.</span></span>

1. <span data-ttu-id="6b16b-224">Данные веб-элемент управления `DataBinding` вызывается событие.</span><span class="sxs-lookup"><span data-stu-id="6b16b-224">The data Web control's `DataBinding` event fires.</span></span>
2. <span data-ttu-id="6b16b-225">Данные, привязанные к данным веб-элемента управления.</span><span class="sxs-lookup"><span data-stu-id="6b16b-225">The data is bound to the data Web control.</span></span>
3. <span data-ttu-id="6b16b-226">Данные веб-элемент управления `DataBound` вызывается событие.</span><span class="sxs-lookup"><span data-stu-id="6b16b-226">The data Web control's `DataBound` event fires.</span></span>

<span data-ttu-id="6b16b-227">Эти три простых шагов достаточны для DetailsView и FormView, так как они отображают только одна запись.</span><span class="sxs-lookup"><span data-stu-id="6b16b-227">These three simple steps are sufficient for the DetailsView and FormView because they display only a single record.</span></span> <span data-ttu-id="6b16b-228">Для GridView, отображающий *все* записи, привязанные к нему (а не только первую), шаг 2 немного сложнее.</span><span class="sxs-lookup"><span data-stu-id="6b16b-228">For the GridView, which displays *all* records bound to it (not just the first), step 2 is a bit more involved.</span></span>

<span data-ttu-id="6b16b-229">На шаге 2 GridView перечисляет источник данных и создает для каждой записи `GridViewRow` и привязывает текущую запись в него.</span><span class="sxs-lookup"><span data-stu-id="6b16b-229">In step 2 the GridView enumerates the data source and, for each record, creates a `GridViewRow` instance and binds the current record to it.</span></span> <span data-ttu-id="6b16b-230">Для каждого `GridViewRow` добавлен к GridView, возникают два события:</span><span class="sxs-lookup"><span data-stu-id="6b16b-230">For each `GridViewRow` added to the GridView, two events are raised:</span></span>

- <span data-ttu-id="6b16b-231">**`RowCreated`** срабатывает после `GridViewRow` был создан</span><span class="sxs-lookup"><span data-stu-id="6b16b-231">**`RowCreated`** fires after the `GridViewRow` has been created</span></span>
- <span data-ttu-id="6b16b-232">**`RowDataBound`** вызывается после привязки текущей записи к `GridViewRow`.</span><span class="sxs-lookup"><span data-stu-id="6b16b-232">**`RowDataBound`** fires after the current record has been bound to the `GridViewRow`.</span></span>

<span data-ttu-id="6b16b-233">Для GridView затем, привязка данных является более точно описанные следующую последовательность шагов:</span><span class="sxs-lookup"><span data-stu-id="6b16b-233">For the GridView, then, data binding is more accurately described by the following sequence of steps:</span></span>

1. <span data-ttu-id="6b16b-234">GridView `DataBinding` вызывается событие.</span><span class="sxs-lookup"><span data-stu-id="6b16b-234">The GridView's `DataBinding` event fires.</span></span>
2. <span data-ttu-id="6b16b-235">Данные будут привязаны к GridView.</span><span class="sxs-lookup"><span data-stu-id="6b16b-235">The data is bound to the GridView.</span></span>   
  
   <span data-ttu-id="6b16b-236">Для каждой записи в источнике данных</span><span class="sxs-lookup"><span data-stu-id="6b16b-236">For each record in the data source</span></span> 

    1. <span data-ttu-id="6b16b-237">Создание `GridViewRow` объекта</span><span class="sxs-lookup"><span data-stu-id="6b16b-237">Create a `GridViewRow` object</span></span>
    2. <span data-ttu-id="6b16b-238">Пожара `RowCreated` событий</span><span class="sxs-lookup"><span data-stu-id="6b16b-238">Fire the `RowCreated` event</span></span>
    3. <span data-ttu-id="6b16b-239">Запись привязывается к `GridViewRow`</span><span class="sxs-lookup"><span data-stu-id="6b16b-239">Bind the record to the `GridViewRow`</span></span>
    4. <span data-ttu-id="6b16b-240">Пожара `RowDataBound` событий</span><span class="sxs-lookup"><span data-stu-id="6b16b-240">Fire the `RowDataBound` event</span></span>
    5. <span data-ttu-id="6b16b-241">Добавить `GridViewRow` для `Rows` коллекции</span><span class="sxs-lookup"><span data-stu-id="6b16b-241">Add the `GridViewRow` to the `Rows` collection</span></span>
3. <span data-ttu-id="6b16b-242">GridView `DataBound` вызывается событие.</span><span class="sxs-lookup"><span data-stu-id="6b16b-242">The GridView's `DataBound` event fires.</span></span>

<span data-ttu-id="6b16b-243">Для настройки формата отдельных записей в GridView, после этого необходимо создать обработчик событий для `RowDataBound` события.</span><span class="sxs-lookup"><span data-stu-id="6b16b-243">To customize the format of the GridView's individual records, then, we need to create an event handler for the `RowDataBound` event.</span></span> <span data-ttu-id="6b16b-244">Чтобы проиллюстрировать это, добавим GridView к `CustomColors.aspx` страницу, которая возвращает имя, категория и цена для каждого продукта, выделите эти продукты, цена которых меньше, чем 10,00 $ с на желтом фоне.</span><span class="sxs-lookup"><span data-stu-id="6b16b-244">To illustrate this, let's add a GridView to the `CustomColors.aspx` page that lists the name, category, and price for each product, highlighting those products whose price is less than $10.00 with a yellow background color.</span></span>

## <a name="step-7-displaying-product-information-in-a-gridview"></a><span data-ttu-id="6b16b-245">Шаг 7: Отображение сведений о продукте в элементе управления GridView</span><span class="sxs-lookup"><span data-stu-id="6b16b-245">Step 7: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="6b16b-246">Добавьте элемент управления GridView под FormView из предыдущего примера и задайте его `ID` свойства `HighlightCheapProducts`.</span><span class="sxs-lookup"><span data-stu-id="6b16b-246">Add a GridView beneath the FormView from the previous example and set its `ID` property to `HighlightCheapProducts`.</span></span> <span data-ttu-id="6b16b-247">Поскольку у нас уже есть ObjectDataSource, который возвращает все продукты на странице, привязать GridView.</span><span class="sxs-lookup"><span data-stu-id="6b16b-247">Since we already have an ObjectDataSource that returns all products on the page, bind the GridView to that.</span></span> <span data-ttu-id="6b16b-248">Наконец измените стояли GridView для включения только продукта имена, категории и цены.</span><span class="sxs-lookup"><span data-stu-id="6b16b-248">Finally, edit the GridView's BoundFields to include just the products' names, categories, and prices.</span></span> <span data-ttu-id="6b16b-249">После этого разметка GridView разметки должно иметь вид:</span><span class="sxs-lookup"><span data-stu-id="6b16b-249">After these edits the GridView's markup should look like:</span></span>


[!code-aspx[Main](custom-formatting-based-upon-data-cs/samples/sample13.aspx)]

<span data-ttu-id="6b16b-250">Рис. 9 показан ход работы на данный момент, при просмотре через браузер.</span><span class="sxs-lookup"><span data-stu-id="6b16b-250">Figure 9 shows our progress to this point when viewed through a browser.</span></span>


<span data-ttu-id="6b16b-251">[![GridView указаны имя, категория и цена для каждого продукта](custom-formatting-based-upon-data-cs/_static/image22.png)](custom-formatting-based-upon-data-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="6b16b-251">[![The GridView Lists the Name, Category, and Price For Each Product](custom-formatting-based-upon-data-cs/_static/image22.png)](custom-formatting-based-upon-data-cs/_static/image21.png)</span></span>

<span data-ttu-id="6b16b-252">**Рис. 9**: GridView указаны имя, категория и цена для каждого продукта ([Просмотр полноразмерное изображение](custom-formatting-based-upon-data-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="6b16b-252">**Figure 9**: The GridView Lists the Name, Category, and Price For Each Product ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image23.png))</span></span>


## <a name="step-8-programmatically-determining-the-value-of-the-data-in-the-rowdatabound-event-handler"></a><span data-ttu-id="6b16b-253">Шаг 8: Программное определение значений данных в обработчике событий RowDataBound</span><span class="sxs-lookup"><span data-stu-id="6b16b-253">Step 8: Programmatically Determining the Value of the Data in the RowDataBound Event Handler</span></span>

<span data-ttu-id="6b16b-254">Когда `ProductsDataTable` привязывается к GridView его `ProductsRow` экземпляры, перечисления и для каждого `ProductsRow` `GridViewRow` создается.</span><span class="sxs-lookup"><span data-stu-id="6b16b-254">When the `ProductsDataTable` is bound to the GridView its `ProductsRow` instances are enumerated and for each `ProductsRow` a `GridViewRow` is created.</span></span> <span data-ttu-id="6b16b-255">`GridViewRow` `DataItem` Свойство назначено конкретного `ProductRow`, после чего GridView `RowDataBound` вызывается обработчик события.</span><span class="sxs-lookup"><span data-stu-id="6b16b-255">The `GridViewRow`'s `DataItem` property is assigned to the particular `ProductRow`, after which the GridView's `RowDataBound` event handler is raised.</span></span> <span data-ttu-id="6b16b-256">Чтобы определить `UnitPrice` значение для каждого продукта, привязанное к GridView, после чего необходимо создать обработчик событий для элемента GridView `RowDataBound` событий.</span><span class="sxs-lookup"><span data-stu-id="6b16b-256">To determine the `UnitPrice` value for each product bound to the GridView, then, we need to create an event handler for the GridView's `RowDataBound` event.</span></span> <span data-ttu-id="6b16b-257">В этом обработчике событий можно проверять `UnitPrice` значение для текущего `GridViewRow` и принять решение о форматировании для этой строки.</span><span class="sxs-lookup"><span data-stu-id="6b16b-257">In this event handler we can inspect the `UnitPrice` value for the current `GridViewRow` and make a formatting decision for that row.</span></span>

<span data-ttu-id="6b16b-258">Этот обработчик событий могут создаваться выполнить те же действия, что с FormView и DetailsView.</span><span class="sxs-lookup"><span data-stu-id="6b16b-258">This event handler can be created using the same series of steps as with the FormView and DetailsView.</span></span>


![Создайте обработчик событий для события RowDataBound GridView](custom-formatting-based-upon-data-cs/_static/image24.png)

<span data-ttu-id="6b16b-260">**Рис. 10**: Создание обработчика событий для элемента GridView `RowDataBound` событий</span><span class="sxs-lookup"><span data-stu-id="6b16b-260">**Figure 10**: Create an Event Handler for the GridView's `RowDataBound` Event</span></span>


<span data-ttu-id="6b16b-261">Создание обработчика событий таким образом вызывает следующий код, чтобы автоматически добавить в коде страницы ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6b16b-261">Creating the event hander in this manner will cause the following code to be automatically added to the ASP.NET page's code portion:</span></span>


[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample14.cs)]

<span data-ttu-id="6b16b-262">Когда `RowDataBound` события обработчик событий передается в качестве второго параметра объект типа `GridViewRowEventArgs`, который имеет свойство с именем `Row`.</span><span class="sxs-lookup"><span data-stu-id="6b16b-262">When the `RowDataBound` event fires, the event handler is passed as its second parameter an object of type `GridViewRowEventArgs`, which has a property named `Row`.</span></span> <span data-ttu-id="6b16b-263">Это свойство возвращает ссылку на `GridViewRow` это было просто с привязкой к данным.</span><span class="sxs-lookup"><span data-stu-id="6b16b-263">This property returns a reference to the `GridViewRow` that was just data bound.</span></span> <span data-ttu-id="6b16b-264">Чтобы получить доступ к `ProductsRow` экземпляра привязан к `GridViewRow` мы используем `DataItem` свойства следующим образом:</span><span class="sxs-lookup"><span data-stu-id="6b16b-264">To access the `ProductsRow` instance bound to the `GridViewRow` we use the `DataItem` property like so:</span></span>


[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample15.cs)]

<span data-ttu-id="6b16b-265">При работе с `RowDataBound` обработчик событий, важно помнить, что GridView состоит из различных типов строк и что это событие вызывается для *все* типов строк.</span><span class="sxs-lookup"><span data-stu-id="6b16b-265">When working with the `RowDataBound` event handler it is important to keep in mind that the GridView is composed of different types of rows and that this event is fired for *all* row types.</span></span> <span data-ttu-id="6b16b-266">Объект `GridViewRow`на тип можно определить с помощью его `RowType` свойство и может иметь одно из значений:</span><span class="sxs-lookup"><span data-stu-id="6b16b-266">A `GridViewRow`'s type can be determined by its `RowType` property, and can have one of the possible values:</span></span>

- <span data-ttu-id="6b16b-267">`DataRow` строку, которая привязана к записи из GridView `DataSource`</span><span class="sxs-lookup"><span data-stu-id="6b16b-267">`DataRow` a row that is bound to a record from the GridView's `DataSource`</span></span>
- <span data-ttu-id="6b16b-268">`EmptyDataRow` строки, отображаемой, если GridView `DataSource` пуст</span><span class="sxs-lookup"><span data-stu-id="6b16b-268">`EmptyDataRow` the row displayed if the GridView's `DataSource` is empty</span></span>
- <span data-ttu-id="6b16b-269">`Footer` строки нижнего колонтитула; отображается, если GridView `ShowFooter` свойству `true`</span><span class="sxs-lookup"><span data-stu-id="6b16b-269">`Footer` the footer row; shown if the GridView's `ShowFooter` property is set to `true`</span></span>
- <span data-ttu-id="6b16b-270">`Header` Строка заголовка; отображается, если GridView ShowHeader задано значение `true` (по умолчанию)</span><span class="sxs-lookup"><span data-stu-id="6b16b-270">`Header` the header row; shown if the GridView's ShowHeader property is set to `true` (the default)</span></span>
- <span data-ttu-id="6b16b-271">`Pager` для элемента GridView, которые реализуют разбиение по страницам, строку, отображающую интерфейс разбиения по страницам</span><span class="sxs-lookup"><span data-stu-id="6b16b-271">`Pager` for GridView's that implement paging, the row that displays the paging interface</span></span>
- <span data-ttu-id="6b16b-272">`Separator` не используется для управления GridView, однако используется `RowType` Свойства DataList и повторителя управляет двумя данных веб-элементов управления, мы обсудим в будущих учебниках</span><span class="sxs-lookup"><span data-stu-id="6b16b-272">`Separator` not used for the GridView, but used by the `RowType` properties for the DataList and Repeater controls, two data Web controls we'll discuss in future tutorials</span></span>

<span data-ttu-id="6b16b-273">Поскольку `EmptyDataRow`, `Header`, `Footer`, и `Pager` не связаны с `DataSource` записей, они всегда будет `null` значение для их `DataItem` свойство.</span><span class="sxs-lookup"><span data-stu-id="6b16b-273">Since the `EmptyDataRow`, `Header`, `Footer`, and `Pager` rows aren't associated with a `DataSource` record, they will always have a `null` value for their `DataItem` property.</span></span> <span data-ttu-id="6b16b-274">По этой причине, прежде чем работать с текущим `GridViewRow` `DataItem` свойства, нам нужно убедиться, что мы имеем дело с `DataRow`.</span><span class="sxs-lookup"><span data-stu-id="6b16b-274">For this reason, before attempting to work with the current `GridViewRow`'s `DataItem` property, we first must make sure that we're dealing with a `DataRow`.</span></span> <span data-ttu-id="6b16b-275">Это можно сделать, проверив `GridViewRow` `RowType` свойства следующим образом:</span><span class="sxs-lookup"><span data-stu-id="6b16b-275">This can be accomplished by checking the `GridViewRow`'s `RowType` property like so:</span></span>


[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample16.cs)]

## <a name="step-9-highlighting-the-row-yellow-when-the-unitprice-value-is-less-than-1000"></a><span data-ttu-id="6b16b-276">Шаг 9: Выделение строки желтым при значении UnitPrice — меньше, чем 10,00 $</span><span class="sxs-lookup"><span data-stu-id="6b16b-276">Step 9: Highlighting the Row Yellow When the UnitPrice Value is Less than $10.00</span></span>

<span data-ttu-id="6b16b-277">Последний шаг — программными методами выделить весь `GridViewRow` Если `UnitPrice` для этой строки равно меньше $10.00.</span><span class="sxs-lookup"><span data-stu-id="6b16b-277">The last step is to programmatically highlight the entire `GridViewRow` if the `UnitPrice` value for that row is less than $10.00.</span></span> <span data-ttu-id="6b16b-278">Синтаксис для доступа к строк или ячеек элемента управления GridView выглядит так же, как DetailsView `GridViewID.Rows[index]` для доступа к всей строки, `GridViewID.Rows[index].Cells[index]` для доступа к отдельной ячейки.</span><span class="sxs-lookup"><span data-stu-id="6b16b-278">The syntax for accessing a GridView's rows or cells is the same as with the DetailsView `GridViewID.Rows[index]` to access the entire row, `GridViewID.Rows[index].Cells[index]` to access a particular cell.</span></span> <span data-ttu-id="6b16b-279">Тем не менее, когда `RowDataBound` обработчик событий вызывается с привязкой к данным `GridViewRow` еще не добавлены к GridView `Rows` коллекции.</span><span class="sxs-lookup"><span data-stu-id="6b16b-279">However, when the `RowDataBound` event handler fires the data bound `GridViewRow` has yet to be added to the GridView's `Rows` collection.</span></span> <span data-ttu-id="6b16b-280">Таким образом не может обращаться к текущей `GridViewRow` экземпляра из `RowDataBound` обработчика событий с помощью коллекции строк.</span><span class="sxs-lookup"><span data-stu-id="6b16b-280">Therefore you cannot access the current `GridViewRow` instance from the `RowDataBound` event handler using the Rows collection.</span></span>

<span data-ttu-id="6b16b-281">Вместо `GridViewID.Rows[index]`, мы создаем ссылку на текущий `GridViewRow` экземпляра в `RowDataBound` при помощи команды `e.Row`.</span><span class="sxs-lookup"><span data-stu-id="6b16b-281">Instead of `GridViewID.Rows[index]`, we can reference the current `GridViewRow` instance in the `RowDataBound` event handler using `e.Row`.</span></span> <span data-ttu-id="6b16b-282">То есть, чтобы выделить текущий `GridViewRow` экземпляра из `RowDataBound` мы будет использовать обработчик событий:</span><span class="sxs-lookup"><span data-stu-id="6b16b-282">That is, in order to highlight the current `GridViewRow` instance from the `RowDataBound` event handler we would use:</span></span>


[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample17.cs)]

<span data-ttu-id="6b16b-283">Вместо установки `GridViewRow`в `BackColor` свойство напрямую, пока что будем придерживаться с использованием классов CSS.</span><span class="sxs-lookup"><span data-stu-id="6b16b-283">Rather than set the `GridViewRow`'s `BackColor` property directly, let's stick with using CSS classes.</span></span> <span data-ttu-id="6b16b-284">Мы создали класс CSS с именем `AffordablePriceEmphasis` , задает цвет фона на желтый.</span><span class="sxs-lookup"><span data-stu-id="6b16b-284">I've created a CSS class named `AffordablePriceEmphasis` that sets the background color to yellow.</span></span> <span data-ttu-id="6b16b-285">Завершенный `RowDataBound` будет выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="6b16b-285">The completed `RowDataBound` event handler follows:</span></span>


[!code-csharp[Main](custom-formatting-based-upon-data-cs/samples/sample18.cs)]


<span data-ttu-id="6b16b-286">[![Наиболее доступной продуктов, которые выделяются желтым](custom-formatting-based-upon-data-cs/_static/image26.png)](custom-formatting-based-upon-data-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="6b16b-286">[![The Most Affordable Products are Highlighted Yellow](custom-formatting-based-upon-data-cs/_static/image26.png)](custom-formatting-based-upon-data-cs/_static/image25.png)</span></span>

<span data-ttu-id="6b16b-287">**Рис. 11**: самое недорогим продуктов, которые выделяются желтым ([Просмотр полноразмерное изображение](custom-formatting-based-upon-data-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="6b16b-287">**Figure 11**: The Most Affordable Products are Highlighted Yellow ([Click to view full-size image](custom-formatting-based-upon-data-cs/_static/image27.png))</span></span>


## <a name="summary"></a><span data-ttu-id="6b16b-288">Сводка</span><span class="sxs-lookup"><span data-stu-id="6b16b-288">Summary</span></span>

<span data-ttu-id="6b16b-289">В этом учебнике мы узнали, как форматировать GridView, DetailsView и FormView на основе данных, связанных с элементом управления.</span><span class="sxs-lookup"><span data-stu-id="6b16b-289">In this tutorial we saw how to format the GridView, DetailsView, and FormView based on the data bound to the control.</span></span> <span data-ttu-id="6b16b-290">Для этого мы создали обработчик событий для `DataBound` или `RowDataBound` событий, где базовых данных было проанализировать вместе с необходимые изменения, при необходимости.</span><span class="sxs-lookup"><span data-stu-id="6b16b-290">To accomplish this we created an event handler for the `DataBound` or `RowDataBound` events, where the underlying data was examined along with a formatting change, if needed.</span></span> <span data-ttu-id="6b16b-291">Для доступа к данным, привязанным к DetailsView или FormView, мы используем `DataItem` свойство в `DataBound` обработчик событий; для элемента управления GridView каждого `GridViewRow` экземпляра `DataItem` свойство содержит данные, привязанные к этой строке, которая доступна в `RowDataBound` обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="6b16b-291">To access the data bound to a DetailsView or FormView, we use the `DataItem` property in the `DataBound` event handler; for a GridView, each `GridViewRow` instance's `DataItem` property contains the data bound to that row, which is available in the `RowDataBound` event handler.</span></span>

<span data-ttu-id="6b16b-292">Синтаксис программной настройки форматирования веб-элемента управления зависит от веб-элемента управления и отображения данных для форматирования.</span><span class="sxs-lookup"><span data-stu-id="6b16b-292">The syntax for programmatically adjusting the data Web control's formatting depends upon the Web control and how the data to be formatted is displayed.</span></span> <span data-ttu-id="6b16b-293">Элементы управления, строк и ячеек может осуществляться для DetailsView и GridView по порядковому номеру индекса.</span><span class="sxs-lookup"><span data-stu-id="6b16b-293">For DetailsView and GridView controls, the rows and cells can be accessed by an ordinal index.</span></span> <span data-ttu-id="6b16b-294">Для FormView, который использует шаблоны, `FindControl("controlID")` метод часто используется для поиска веб-элемента управления из шаблона.</span><span class="sxs-lookup"><span data-stu-id="6b16b-294">For the FormView, which uses templates, the `FindControl("controlID")` method is commonly used to locate a Web control from within the template.</span></span>

<span data-ttu-id="6b16b-295">В следующем уроке мы рассмотрим способы использования шаблонов с GridView и DetailsView.</span><span class="sxs-lookup"><span data-stu-id="6b16b-295">In the next tutorial we'll look at how to use templates with the GridView and DetailsView.</span></span> <span data-ttu-id="6b16b-296">Кроме того мы увидим другой способ настройки форматирования на основе базовых данных.</span><span class="sxs-lookup"><span data-stu-id="6b16b-296">Additionally, we'll see another technique for customizing the formatting based on the underlying data.</span></span>

<span data-ttu-id="6b16b-297">Программирование довольны!</span><span class="sxs-lookup"><span data-stu-id="6b16b-297">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="6b16b-298">Об авторе</span><span class="sxs-lookup"><span data-stu-id="6b16b-298">About the Author</span></span>

<span data-ttu-id="6b16b-299">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи ASP/ASP.NET и основателя из [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Майкрософт с 1998 года.</span><span class="sxs-lookup"><span data-stu-id="6b16b-299">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="6b16b-300">Скотт — независимый консультант, trainer и записи.</span><span class="sxs-lookup"><span data-stu-id="6b16b-300">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="6b16b-301">Его последняя книга — [ *диспетчерами учат самостоятельно ASP.NET 2.0 в течение 24 часов*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="6b16b-301">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="6b16b-302">Он может быть достигнута по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) или через его блог, который можно найти в [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="6b16b-302">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="6b16b-303">Благодарности</span><span class="sxs-lookup"><span data-stu-id="6b16b-303">Special Thanks To</span></span>

<span data-ttu-id="6b16b-304">Этот учебник ряд прошел проверку многие полезные рецензентов.</span><span class="sxs-lookup"><span data-stu-id="6b16b-304">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="6b16b-305">Основными редакторами этого учебника были E.R.</span><span class="sxs-lookup"><span data-stu-id="6b16b-305">Lead reviewers for this tutorial were E.R.</span></span> <span data-ttu-id="6b16b-306">Gilmore, Деннис Патерсона и (Dan Jagers).</span><span class="sxs-lookup"><span data-stu-id="6b16b-306">Gilmore, Dennis Patterson, and Dan Jagers.</span></span> <span data-ttu-id="6b16b-307">Объясняются моих последующих статей для MSDN?</span><span class="sxs-lookup"><span data-stu-id="6b16b-307">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="6b16b-308">Если Да, напишите мне по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6b16b-308">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="6b16b-309">Вперед</span><span class="sxs-lookup"><span data-stu-id="6b16b-309">Next</span></span>](using-templatefields-in-the-gridview-control-cs.md)
