---
uid: web-forms/overview/data-access/introduction/creating-a-data-access-layer-vb
title: Создание уровня доступа к данным (Visual Basic) | Документы Microsoft
author: rick-anderson
description: В этом учебнике мы будем запустите с самого начала и создайте данных Access Layer (DAL), с помощью типизированных наборов данных, доступ к сведениям в базе данных.
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/05/2010
ms.topic: article
ms.assetid: 6227233a-6254-4b6b-9a89-947efef22330
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-data-access-layer-vb
msc.type: authoredcontent
ms.openlocfilehash: 5cf1a430d6fe94174a877beb04b930409bdbf084
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30891972"
---
<a name="creating-a-data-access-layer-vb"></a>Создание уровня доступа к данным (Visual Basic)
====================
по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Загрузить пример приложения](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_1_VB.exe) или [скачать PDF](creating-a-data-access-layer-vb/_static/datatutorial01vb1.pdf)

> В этом учебнике мы будем запустите с самого начала и создайте данных Access Layer (DAL), с помощью типизированных наборов данных, доступ к сведениям в базе данных.


## <a name="introduction"></a>Вступление

Веб-разработчиков нашей жизни связана с работой с данными. Мы создаем базы данных для хранения данных, код для извлечения и изменения и веб-страницы для сбора и обобщения. Это в первом учебнике ряд, будут рассмотрены приемы реализации этих распространенных схем в ASP.NET 2.0. Мы начнем с создания [архитектура программного обеспечения](http://en.wikipedia.org/wiki/Software_architecture) состоит из данных Access Layer (DAL) с помощью типизированных наборов данных, слой бизнес-логики (BLL), в котором принудительно пользовательских бизнес-правил и состоит из ASP.NET уровня представления страниц, совместно использовать общий макет страницы. После этого внутреннего фундамента, мы перейдем к созданию отчетов, показывающий, как отобразить, суммировать, собирать и проверять данные из веб-приложения. Эти учебники предназначены для краткого и содержат пошаговые инструкции с множеством снимков экранов, дающих процесс визуально. В каждом учебнике доступен в C# и Visual Basic версии и загрузить полный код, используемый. (Первый учебный курс довольно длинный, но остальные будут представлены в значительно снизилось фрагментов).

Эти руководства мы будем работать с Microsoft SQL Server 2005 Express Edition версию базы данных Northwind, помещаются в `App_Data` каталога. В дополнение к файлу базы данных `App_Data` папка также содержит скрипты SQL для создания базы данных, в случае, если вы хотите использовать версию другой базе данных. Эти сценарии могут также быть [загружаются непосредственно от корпорации Майкрософт](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), если вы хотите использовать. При использовании другой версии SQL Server, базы данных Northwind, необходимо обновить `NORTHWNDConnectionString` в приложения `Web.config` файла. Веб-приложения был создан с помощью Visual Studio 2005 Professional Edition как проект веб-сайта на основе системы файла. Однако все части руководства будут работать одинаково хорошо с бесплатная версия Visual Studio 2005 [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).

В этом учебнике мы запустить с самого начала и создания данных доступа Layer (DAL), а затем создав [слой бизнес-логики (BLL)](creating-a-business-logic-layer-vb.md) во вторые учебника и работает над [макета инавигациистраницы](master-pages-and-site-navigation-vb.md) в третьем. После третий будет основываться на фундаменте учебников упорядочивается в первых трех. У нас есть много в первом учебнике, поэтому запускайте Visual Studio и давайте начнем!

## <a name="step-1-creating-a-web-project-and-connecting-to-the-database"></a>Шаг 1: Создание веб-проекта и подключение к базе данных

Прежде чем создавать наш слой доступа к данным (DAL), сначала необходимо создать веб-сайт и настроить базу данных. Начните с создания нового файла на основе системы веб-сайт ASP.NET. Чтобы сделать это, перейдите в меню «файл» и выберите новый веб-сайт, отображает диалоговое окно нового веб-сайта. Выберите шаблон веб-сайт ASP.NET, указывает расположение раскрывающегося списка в файловой системе, выберите папку для размещения веб-сайта и выбранный язык Visual Basic.


[![Создать новый файл на основе системы веб-сайта](creating-a-data-access-layer-vb/_static/image2.png)](creating-a-data-access-layer-vb/_static/image1.png)

**Рис. 1**: Создание веб-сайта New File System-Based ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image3.png))


Это создаст новый веб-сайт с `Default.aspx` страницы ASP.NET, `App_Data` папки и `Web.config` файла.

Созданный веб-сайт создан следующим шагом является добавление ссылки на базу данных в обозревателе серверов Visual Studio. Путем добавления базы данных в обозревателе серверов можно добавить таблицы, хранимые процедуры, представления и т. д. все это выполняется из среды Visual Studio. Также можно просматривать табличные данные или создавать собственные запросы вручную или графически через построитель запросов. Кроме того при конструировании типизированных наборов данных для DAL нам нужно будет переключить Visual Studio в базу данных, из которого можно составить типизированных наборов данных. Хотя имеется возможность предоставить эти сведения о подключении на момент времени, Visual Studio автоматически заполняет список раскрывающегося списка баз данных, уже зарегистрирован в обозревателе серверов.

Шаги для добавления базы данных Northwind в обозреватель сервера зависят от того, требуется ли использовать базу данных SQL Server 2005, экспресс-выпуск в `App_Data` папке или при наличии Microsoft SQL Server 2000 или Настройка сервера баз данных 2005, который вы хотите использовать Вместо этого.

## <a name="using-a-database-in-theappdatafolder"></a>Использование базы данных в`App_Data`папки

Если у вас SQL Server 2000 или 2005 сервер базы данных для подключения к или просто хотите избежать добавления базы данных на сервере базы данных, можно использовать версию SQL Server 2005, экспресс-выпуск базы данных Northwind, расположенного в загруженный websit e's `App_Data` папку (`NORTHWND.MDF`).

База данных, помещенная в `App_Data` , автоматически добавляется в обозреватель серверов. Если предположить, что SQL Server 2005 Express Edition установлены на компьютере должна появиться узел с именем NORTHWND. MDF в обозревателе серверов, которые можно развернуть и изучить его таблицы, представления, хранимые процедуры и т. д (см. рис. 2).

`App_Data` Могут содержаться также Microsoft Access `.mdb` файлы, которые, как их аналоги SQL Server, автоматически добавляются в обозревателе серверов. Если вы не хотите использовать любые из параметров SQL Server, вы всегда можете [загрузить версию файла базы данных "Борей" Microsoft Access](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) в `App_Data` каталога. Необходимо помнить, однако, базы данных Access не так многофункциональны, как SQL Server и не предназначен для использования в сценариях веб-сайта. Кроме того несколько учебников 35 + будет использовать некоторые функции уровня базы данных, не поддерживаемые доступа.

## <a name="connecting-to-the-database-in-a-microsoft-sql-server-2000-or-2005-database-server"></a>Подключение к базе данных на сервере базы данных Microsoft SQL Server 2000 или 2005

Кроме того можно подключиться к базе данных Northwind, установленной на сервере базы данных. Если сервер базы данных еще не установлены базы данных Northwind, сначала необходимо добавить его к серверу базы данных, запустив сценарий установки, входящий в этом учебнике для загрузки или с помощью [загрузки версии SQL Server 2000 для данных "Борей" и сценария установки](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) непосредственно с веб-сайта корпорации Майкрософт.

После установки базы данных, перейдите в обозреватель серверов в Visual Studio, щелкните правой кнопкой мыши узел подключения данных и выберите Добавить подключение. Если вы не видите перейдите в представление обозревателя серверов / обозревателя серверов, или нажмите сочетание клавиш Ctrl + Alt + S. Откроется диалоговое окно Добавить подключение, в котором можно указать сервер для подключения, сведения для проверки подлинности и имя базы данных. После успешно настроить соединение с базой данных и нажатии кнопки «ОК», базе данных будет добавлен как узел в узле подключения к данным. Можно развернуть узел базы данных для просмотра таблиц, представлений, хранимых процедур и т. д.


![Добавить подключение к базе данных сервера базы данных "Борей"](creating-a-data-access-layer-vb/_static/image4.png)

**На рисунке 2**: добавить подключение к базе данных сервера базы данных "Борей"


## <a name="step-2-creating-the-data-access-layer"></a>Шаг 2: Создание уровня доступа к данным

При работе с данным один вариант — встраивать логику конкретных данных непосредственно в слой представления (в веб-приложения образуют уровень представления страниц ASP.NET). Это может занять виде написания кода ADO.NET в часть кода страницы ASP.NET или с помощью элемента управления SqlDataSource из части, содержащей разметку. В любом случае этот подход жестко связывает логики доступа к данным со слоем представления. Рекомендуемый подход, то для разделения логики доступа к данным от уровня представления. Этот отдельный уровень называется уровня доступа к данным, коротко DAL и обычно реализуется в виде отдельного проекта библиотеки классов. Подробно описаны преимущества этой многоуровневой архитектуры (см. раздел «Дополнительные материалы» в конце этого учебника, чтобы сведения об этих преимуществах) и является подход, который будет использоваться в этой серии.

Весь код, определенных в базовом источнике данных, например для создания подключения к базе данных, выполнив `SELECT`, `INSERT`, `UPDATE`, и `DELETE` команды и т. д должен находиться в каталоге DAL. Уровень представления не должно содержать все ссылки на такой код доступа к данным, но вместо этого следует выполнять вызовы DAL для всех запросов. Слои доступа к данным обычно содержат методы для доступа к данным базы данных. Например, базы данных Northwind, имеет `Products` и `Categories` которых регистрируются продукты для продажи и категории, к которым они принадлежат. В DAL имеются методы, такие как:

- `GetCategories(),` который возвращает сведения обо всех категорий
- `GetProducts()`, который возвращает сведения обо всех продуктов
- `GetProductsByCategoryID(categoryID)`, который возвращает все продукты, принадлежащие к указанной категории
- `GetProductByProductID(productID)`, который возвращает сведения об определенном продукте

При вызове этих методов подключения к базе данных, создать соответствующий запрос и возвращают результаты. Важно способ возврата результатов. Эти методы могут просто вернуть набор данных или DataReader, заполненный посредством запроса к базе данных, но в идеале данные должны быть возвращены результаты с помощью *строго типизированных объектов*. Строго типизированный объект является одним, схема которого жестко определяется во время компиляции, в то время как противоположность слабо типизированный объект является одним, схема которой не известен до времени выполнения.

Например DataReader и DataSet (по умолчанию) являются слабо типизированных объектов, поскольку их схема определяется столбцов, возвращаемых запросом к базе данных, используемые для их заполнения. Для доступа к определенному столбцу из слабо типизированный объект DataTable, необходимо использовать следующий синтаксис: `DataTable.Rows(index)("columnName")`. В этом примере нестрогая типизация объекта DataTable проявляется тот факт, что нам нужно получить доступ к имени столбца, с помощью строка или порядковый номер. Строго типизированный объект DataTable, с другой стороны, будут иметь все его столбцы реализованы в виде свойств, возникающие в коде, который выглядит следующим образом: `DataTable.Rows(index).columnName`.

Чтобы вернуть строго типизированных объектов, разработчики можно создать собственные настраиваемые бизнес-объекты или использовать типизированные наборы данных. Бизнес-объект реализуется разработчиком как представляет класс, как правило, свойства которого отражают столбцы базовой таблицы базы данных бизнес-объекта. Типизированный набор данных — это класс, созданный Visual Studio, на основе схемы базы данных и, члены которого являются строго типизированными в соответствии с этой схемы. Типизированные сам набор данных состоит из классов, расширяющих классы ADO.NET DataSet, DataTable и DataRow. Помимо строго типизированных объектов DataTable типизированные наборы данных теперь также включают адаптеры таблиц TableAdapter, которые являются классы, методы для заполнения таблицы данных набора данных и внесения изменений, сделанных в объектах DataTable в базе данных.

> [!NOTE]
> Дополнительные сведения о преимуществах и недостатках использования типизированных наборов данных и пользовательских бизнес-объектов см. [проектирование компоненты уровня данных и передачи данных через уровни](https://msdn.microsoft.com/library/ms978496.aspx).


Эти учебники по архитектуре, мы будем использовать строго типизированных наборов данных. На рисунке 3 показан рабочий процесс между различными уровнями приложения, использующего типизированные наборы данных.


[![Все код доступа к данным делегированием компонента DAL](creating-a-data-access-layer-vb/_static/image6.png)](creating-a-data-access-layer-vb/_static/image5.png)

**Рис. 3**: все код доступа к данным делегированием компонента DAL ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image7.png))


## <a name="creating-a-typed-dataset-and-table-adapter"></a>Создание типизированного набора данных и адаптера таблиц

Чтобы начать создание DAL, начнем с добавления типизированного набора данных в свой проект. Для этого щелкните правой кнопкой мыши узел проекта в обозревателе решений и выберите команду Добавить новый элемент. Выберите параметр набора данных из списка шаблонов и назовите его `Northwind.xsd`.


[![Добавить новый набор данных в проект](creating-a-data-access-layer-vb/_static/image9.png)](creating-a-data-access-layer-vb/_static/image8.png)

**Рис. 4**: добавить в проект новый набор данных ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image10.png))


После нажатия кнопки Добавить, когда будет предложено добавить набор данных `App_Code` папку, выберите "Да". Конструктор для типизированного набора данных будет отображаться и запустится мастер настройки адаптера таблицы, позволяя добавлять первый адаптер TableAdapter к типизированному DataSet.

Типизированный набор данных служит в качестве строго типизированной коллекции данных. он состоит из строго типизированных экземпляров таблицы DataTable, в свою очередь каждый из которых состоит из строго типизированных экземпляров строки DataRow. Мы создадим строго типизированный объект DataTable для каждого из базовых таблиц базы данных, необходимых для работы с этой серии учебники. Начнем с создания таблицы DataTable для `Products` таблицы.

Имейте в виду, что строго типизированных объектов DataTable не включены сведения о том, как получить доступ к данным из их базовой таблицы базы данных. Для получения данных для заполнения таблицы данных, мы используем класс TableAdapter, который действует как наш уровень доступа к данным. Для наших `Products` DataTable, адаптера таблицы будет содержать методы `GetProducts()`, `GetProductByCategoryID(categoryID)`и так далее, будут вызываться из уровня представления. Роль объекта DataTable, — в качестве строго типизированных объектов, используемым для передачи данных между слоями.

Мастер настройки адаптера таблицы начинается с приглашением выбрать базу данных для работы с. Раскрывающемся списке показаны эти базы данных в обозревателе серверов. Если базы данных Northwind не добавляется в обозреватель серверов, можно нажмите кнопку новое подключение в данный момент для этого.


[![Выберите из раскрывающегося списка базу данных Northwind](creating-a-data-access-layer-vb/_static/image12.png)](creating-a-data-access-layer-vb/_static/image11.png)

**Рис. 5**: выберите из раскрывающегося списка базу данных Northwind ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image13.png))


После выбора базы данных и нажмите кнопку Далее, запрашивается Если вы хотите сохранить строку подключения в `Web.config` файла. Сохранение строки подключения позволяет избежать внесения ее жестких закодированных классов TableAdapter, что упрощает ситуацию, если в будущем изменяет строку подключения. Если вы решили сохранить строку подключения в файле конфигурации, он помещается в `<connectionStrings>` секции, которая может быть [при необходимости зашифрованные](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) для повышения безопасности или последующего изменения посредством новой страницы свойств ASP.NET 2.0 в Средства администрирования IIS графического пользовательского интерфейса, которое более идеально подходит для администраторов.


[![Сохранение строки подключения в файле Web.config](creating-a-data-access-layer-vb/_static/image15.png)](creating-a-data-access-layer-vb/_static/image14.png)

**Рис. 6**: сохранить строку подключения для `Web.config` ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image16.png))


Далее необходимо определить схему для первой строго типизированный объект DataTable и предоставить первый метод для наших адаптера таблицы для использования при заполнении строго типизированного набора данных. Следующие два действия выполняются одновременно, создав запрос, который возвращает столбцы из таблицы, которые требуется отразить в нашем объекте DataTable. В конце работы мастера мы указываем имя метода для этого запроса. Если, завершены, этот метод может вызываться из слоя представления. Метод будет выполнить определенный запрос и заполните строго типизированный объект DataTable.

Чтобы приступить к определению запроса SQL, сначала необходимо указать как мы хотим TableAdapter будет выдавать запрос. Мы можно использовать инструкцию SQL ad-hoc, создать новую хранимую процедуру или использовать существующую хранимую процедуру. Эти руководства мы будем использовать специализированные инструкции SQL. Ссылаться на [Брайан Нойс](http://briannoyes.net/)в статью, [сборки уровня доступа к данным с помощью конструктора набора данных Visual Studio 2005](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) пример использования хранимых процедур.


[![Запрос данных с помощью инструкции SQL Ad-Hoc](creating-a-data-access-layer-vb/_static/image18.png)](creating-a-data-access-layer-vb/_static/image17.png)

**Рис. 7**: запрос данных с помощью инструкции SQL Ad-Hoc ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image19.png))


На этом этапе можно ввести запрос SQL вручную. При создании первого метода в адаптере таблиц обычно требуется запрос возвращает те столбцы, которые должны выражаться в соответствующем объекте DataTable. Это можно сделать, создав запрос, возвращающий все столбцы и строки из `Products` таблицы:


[![Введите запрос SQL в текстовое поле](creating-a-data-access-layer-vb/_static/image21.png)](creating-a-data-access-layer-vb/_static/image20.png)

**Рис. 8**: Введите SQL запрос в текстовое поле ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image22.png))


Можно также использовать построитель запросов и графически конструирования запроса, как показано на рис. 9.


[![Создайте запрос графически посредством редактора запросов](creating-a-data-access-layer-vb/_static/image24.png)](creating-a-data-access-layer-vb/_static/image23.png)

**Рис. 9**: создайте запрос графически посредством редактора запросов ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image25.png))


После создания запроса, но до перехода к следующему экрану нажмите кнопку Дополнительно. В проектах веб-сайта «создать инструкции Insert, Update и Delete инструкции» является единственным дополнительный параметр выбран по умолчанию. Если запустить этот мастер из библиотеки классов или проекта Windows также выбирается параметр «Использовать оптимистичный параллелизм». Не устанавливайте параметр «Использовать оптимистичный параллелизм» флажок сейчас. Мы рассмотрим оптимистичного параллелизма в будущих учебниках.


[![Только создать инструкции Insert, Update и Delete инструкции SELECT параметр](creating-a-data-access-layer-vb/_static/image27.png)](creating-a-data-access-layer-vb/_static/image26.png)

**Рис. 10**: только создать инструкции Insert, Update и Delete инструкции Select параметр ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image28.png))


Проверив Дополнительные параметры, нажмите кнопку Далее, чтобы перейти к последней странице. Здесь мы будет предложено выбрать, какие методы для добавления в адаптер таблицы. Существует два варианта внесения данных:

- **Заполнить таблицу данных** при таком подходе создается метод, принимающий DataTable в качестве параметра и заполняющий его на основе результатов запроса. Класс ADO.NET DataAdapter, например, реализует этот шаблон, с его `Fill()` метод.
- **Вернуть таблицу данных** при таком подходе метод создает и заполняет DataTable и возвращает его в качестве возвращаемого значения метода.

Может иметь TableAdapter реализовывать один или оба этих способа. Можно также переименовать приведенные здесь методы. Оставим установленными оба флажка, несмотря на то, что мы будем только использовать второй вариант в этих учебниках. Кроме того, переименуем довольно общий `GetData` метод `GetProducts`.

Если этот флажок установлен, последний флажок «GenerateDBDirectMethods», создает `Insert()`, `Update()`, и `Delete()` методы адаптера таблицы. Если этот флажок не установлен, все обновления потребуется сделать с помощью адаптера таблицы единственная `Update()` метод, который принимает типизированного набора DataSet, DataTable, отдельный объект DataRow или массив объектов DataRow. (Если вы уже снят флажок «Создать инструкции Insert, Update и Delete операторы» параметр из дополнительных свойств на рис. 9 этот флажок параметра не повлияет.) Давайте оставить этот флажок установленным.


[![Измените имя метода GetData для GetProducts](creating-a-data-access-layer-vb/_static/image30.png)](creating-a-data-access-layer-vb/_static/image29.png)

**Рис. 11**: измените имя метода `GetData` для `GetProducts` ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image31.png))


Завершите работу мастера, нажав кнопку Готово. После завершения работы мастера мы возвращаются конструктора наборов данных, которые показаны только что созданный объект DataTable. Можно просмотреть список столбцов в `Products` DataTable (`ProductID`, `ProductName`и так далее), а также методы `ProductsTableAdapter` (`Fill()` и `GetProducts()`).


[![DataTable продуктов и ProductsTableAdapter были добавлены к типизированному DataSet](creating-a-data-access-layer-vb/_static/image33.png)](creating-a-data-access-layer-vb/_static/image32.png)

**Рис. 12**: `Products` DataTable и `ProductsTableAdapter` были добавлены к типизированному DataSet ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image34.png))


На этом этапе у нас есть типизированного набора данных с одним объектом DataTable (`Northwind.Products`) и строго типизированный класс DataAdapter (`NorthwindTableAdapters.ProductsTableAdapter`) с `GetProducts()` метод. Эти объекты можно использовать для доступа к списку всех продуктов из кода следующего вида:

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample1.vb)]

Этот код не требует от нас написать один бит кода, характерного для доступа к данным. Нам не нужно создать все классы ADO.NET, нам не пришлось ссылаться на любые строки подключения SQL-запросов или хранимых процедур. Вместо этого TableAdapter предоставляет код доступа к данным на нижнем уровне для нас.

Каждый объект, используемый в этом примере также является строго типизированным, что позволяет Visual Studio для обеспечения поддержки технологии IntelliSense и проверки типов во время компиляции. И лучшее из всех таблиц данных, возвращенных адаптера таблицы могут быть привязаны к данным ASP.NET веб-элементов управления GridView, DetailsView, DropDownList, CheckBoxList и несколько других. В следующем примере демонстрируется привязка DataTable, возвращенный `GetProducts()` к GridView в только что просмотров три строки кода в `Page_Load` обработчика событий.

AllProducts.aspx

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample2.aspx)]

AllProducts.aspx.vb

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample3.vb)]


[![Список продуктов, отображаемый в GridView](creating-a-data-access-layer-vb/_static/image36.png)](creating-a-data-access-layer-vb/_static/image35.png)

**Рис. 13**: список продуктов, отображаемый в элементе управления GridView ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image37.png))


Хотя в этом примере потребовалось написать три строки кода в странице ASP.NET `Page_Load` обработчик событий, в будущих учебниках мы изучим, как использовать элемент управления ObjectDataSource для декларативного извлечения данных из DAL. Использование ObjectDataSource вам не придется писать код и получите поддержку разбиения по страницам и сортировки!

## <a name="step-3-adding-parameterized-methods-to-the-data-access-layer"></a>Шаг 3: Добавление параметризованных методы для доступа к данным

На этом этапе нашей `ProductsTableAdapter` обладает всего лишь один метод `GetProducts()`, который возвращает все продукты в базе данных. Возможность работы со всеми продуктами определенно полезен, бывают ситуации, когда нам требуется получить сведения о определенному продукту или все продукты, относящиеся к определенной категории. Добавление таких функций к слою доступа данных можно добавить параметризованные методы в адаптер таблицы.

Давайте добавим `GetProductsByCategoryID(categoryID)` метод. Для добавления нового метода DAL, вернитесь в конструкторе наборов данных, щелкните правой кнопкой мыши `ProductsTableAdapter` и выберите Добавить запрос.


![Щелкните правой кнопкой мыши в TableAdapter и выберите команду Добавить запрос](creating-a-data-access-layer-vb/_static/image38.png)

**Рис. 14**: щелкните правой кнопкой мыши в TableAdapter и выберите команду Добавить запрос


Мы сначала будет предложено мы хотим получить доступ к базе данных с помощью нерегламентированных инструкций SQL или новой или существующей хранимой процедуры. Давайте решено использовать инструкции SQL ad-hoc еще раз. Затем запрашивается тип запроса SQL, мы хотели бы использовать. Поскольку нам требуется возвратить все продукты, принадлежащие к указанной категории, нам потребуется написать `SELECT` инструкции, которая возвращает строки.


[![Выберите для создания инструкции SELECT, возвращающая строки](creating-a-data-access-layer-vb/_static/image40.png)](creating-a-data-access-layer-vb/_static/image39.png)

**Рис. 15**: выберите, чтобы создать `SELECT` инструкции которого возвращает строки ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image41.png))


Следующим шагом является определение SQL-запрос, используемый для доступа к данным. Поскольку нам требуется возвратить только те продукты, которые принадлежат определенной категории, используйте тот же `SELECT` инструкции от `GetProducts()`, но с добавлением следующего `WHERE` предложение: `WHERE CategoryID = @CategoryID`. `@CategoryID` Параметр указывает Мастер TableAdapter, что мы создаем метод будет требуется входной параметр соответствующего типа (а именно неотрицательного целого).


[![Введите запрос, чтобы возвращать только продуктов в указанной категории](creating-a-data-access-layer-vb/_static/image43.png)](creating-a-data-access-layer-vb/_static/image42.png)

**На рисунке 16**: Введите запрос только возвращают продукты в категории указано ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image44.png))


На последнем шаге можно выбрать которой шаблоны для использования, а также настроить имена создаваемых методов доступа к данным. Для шаблона Fill изменим имя `FillByCategoryID` и для возврата объекта DataTable возвращенное шаблон ( `GetX` методы), воспользуемся `GetProductsByCategoryID`.


[![Выберите имена для методы адаптера таблицы](creating-a-data-access-layer-vb/_static/image46.png)](creating-a-data-access-layer-vb/_static/image45.png)

**Рисунок 17**: выберите имена для методы адаптера таблицы ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image47.png))


По завершении работы мастера конструктор набора данных включает в себя новые методы адаптера таблицы.


![Теперь продукты можно запрашивать по категории](creating-a-data-access-layer-vb/_static/image48.png)

**На рисунке 18**: теперь продукты можно запрашивать по категории


Теперь пора добавить `GetProductByProductID(productID)` метод таким же способом.

Эти параметризованные запросы можно протестировать непосредственно из конструктора наборов данных. Щелкните правой кнопкой мыши метод в TableAdapter и выберите данные для предварительного просмотра. Затем введите значения для параметров и нажмите кнопку просмотра.


[![Показаны эти продукты, принадлежащие к категории напитков](creating-a-data-access-layer-vb/_static/image50.png)](creating-a-data-access-layer-vb/_static/image49.png)

**На рисунке 19**: отображаются те продукты, принадлежащие к категории «Напитки» ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image51.png))


С `GetProductsByCategoryID(categoryID)` метод в DAL, теперь можно создать страницы ASP.NET, которая отображает только те продукты, в указанной категории. В следующем примере показано все продукты в категории "Напитки", которые имеют `CategoryID` 1.

Beverages.aspx

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample4.aspx)]

Beverages.aspx.vb

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample5.vb)]


[![Отображаются продукты в категории «Напитки»](creating-a-data-access-layer-vb/_static/image53.png)](creating-a-data-access-layer-vb/_static/image52.png)

**Рис. 20**: отображаются те продукты в категории «Напитки» ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image54.png))


## <a name="step-4-inserting-updating-and-deleting-data"></a>Шаг 4: Вставка, обновление и удаление данных

Существует два варианта, обычно используется для вставки, обновления и удаления данных. Первый шаблон, который мы будем называть непосредственной схемы базы данных, включает в себя создание методов, которые при вызове проблема `INSERT`, `UPDATE`, или `DELETE` команды в базу данных, работающая на запись в одной базе данных. Такие методы обычно передается в виде последовательности скалярных значений (целые числа, строки, логические значения, даты и т. д.), соответствующие значения для вставки, обновления или удаления. Например, с помощью этого шаблона для `Products` принимает целочисленный параметр, метод удаления таблицы, указывающее, `ProductID` записи для удаления, а метод insert принимает строковое значение `ProductName`, десятичное значение для `UnitPrice`, целое число для `UnitsOnStock`, и т. д.


[![Для базы данных немедленно отправляется каждой вставки, обновления и запрос на удаление](creating-a-data-access-layer-vb/_static/image56.png)](creating-a-data-access-layer-vb/_static/image55.png)

**Рисунок 21**: каждой вставки, обновления и запроса на удаление отправляется базы данных немедленно ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image57.png))


Другая схема, которую я буду называть пакетного обновления шаблон, является обновление всей DataSet, DataTable или коллекции из DataRow в один вызов метода. С этим шаблоном разработчик удаляет, вставка и изменение объектов DataRow в DataTable и затем передает эти DataRow или DataTable в метод обновления. Затем этот метод перечисляет переданные DataRow, определяет ли они были изменены, добавленных или удаленных (через DataRow [свойства RowState](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) значение) и отправляет запрос к соответствующей базе данных для каждой записи.


[![Все изменения синхронизируются с базой данных при вызове метода обновления](creating-a-data-access-layer-vb/_static/image59.png)](creating-a-data-access-layer-vb/_static/image58.png)

**На рисунке 22**: все изменения синхронизируются с базой данных при вызове метода Update ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image60.png))


Адаптер таблицы по умолчанию используется схема пакетного обновления, но также поддерживает непосредственной схемы. Поскольку мы выбран параметр «Создать инструкции Insert, Update и Delete инструкции» из дополнительные свойства при создании TableAdapter, `ProductsTableAdapter` содержит `Update()` метод, который реализует схему пакетного обновления. В частности, TableAdapter содержит `Update()` метод, который может быть передан типизированного набора данных, строго типизированный объект DataTable или один или несколько строк DataRow. Если параметр «GenerateDBDirectMethods» флажок установлен, при первоначальном создании TableAdapter непосредственная схема базы данных также будет реализована через `Insert()`, `Update()`, и `Delete()` методы.

Обе схемы изменения данных используют свойства `InsertCommand`, `UpdateCommand`, и `DeleteCommand` свойства для выдачи их `INSERT`, `UPDATE`, и `DELETE` команды в базу данных. Можно проверять и изменять `InsertCommand`, `UpdateCommand`, и `DeleteCommand` свойства, щелкнув адаптера таблицы в конструкторе наборов данных, а затем перейдите в окне «Свойства». (Убедитесь, что выбран TableAdapter и что `ProductsTableAdapter` объект является выбранный в раскрывающемся списке в окне «Свойства».)


[![Адаптер таблицы имеет InsertCommand, UpdateCommand и DeleteCommand свойства](creating-a-data-access-layer-vb/_static/image62.png)](creating-a-data-access-layer-vb/_static/image61.png)

**На рисунке 23**: имеет TableAdapter `InsertCommand`, `UpdateCommand`, и `DeleteCommand` свойства ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image63.png))


Чтобы просмотреть или изменить любые из этих свойств команды базы данных, нажмите кнопку `CommandText` вложенное свойство, чтобы открыть построитель запросов.


[![Настройка в построителе запросов INSERT, UPDATE и DELETE инструкции](creating-a-data-access-layer-vb/_static/image65.png)](creating-a-data-access-layer-vb/_static/image64.png)

**Рис. 24**: Настройка `INSERT`, `UPDATE`, и `DELETE` операторы в построителе запросов ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image66.png))


В следующем примере кода показано, как использовать схему пакетного обновления выполнить удвоение цены всех продуктов, не поддерживаются и имеют 25 единиц на складе или менее:

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample6.vb)]

В следующем примере кода показано, как использовать программно удалить конкретный продукт, а затем обновить один непосредственной схемы, а затем добавьте новое:

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample7.vb)]

## <a name="creating-custom-insert-update-and-delete-methods"></a>Создание пользовательских вставки, обновления и удаления методов

`Insert()`, `Update()`, И `Delete()` методы, созданные с непосредственным методом базы данных может быть немного сложно, особенно для таблиц с большим числом столбцов. Просмотрев в предыдущем примере без функции IntelliSense помочь неясно, особенно то, что `Products` сопоставляет каждый входной параметр `Update()` и `Insert()` методы. Могут возникнуть ситуации, когда требуется только обновить один или два столбца или требуется настраиваемый `Insert()` метод, возможно, будет возвращать значение вновь вставленной записи `IDENTITY` поля (с автоматическим приращением).

Чтобы создать пользовательский метод, вернитесь в конструктор набора данных. Щелкните правой кнопкой мыши в TableAdapter и выберите Добавить запрос, возврат к мастеру TableAdapter. На второй экран мы указываем тип создаваемого запроса. Давайте создадим метод, который добавляет новый продукт и возвращает значение вновь добавленной записи `ProductID`. Таким образом, попробовать создать `INSERT` запроса.


[![Создайте метод для добавления новой строки к таблице Products](creating-a-data-access-layer-vb/_static/image68.png)](creating-a-data-access-layer-vb/_static/image67.png)

**Рис. 25**: создать метод, чтобы добавить новые строки `Products` таблицы ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image69.png))


На следующем экране `InsertCommand` `CommandText` отображается. Расширить этот запрос, добавив `SELECT SCOPE_IDENTITY()` в конце запроса, который возвращает последнее значение идентификатора, вставленное в `IDENTITY` столбец в той же области. (См. [технической документации](https://msdn.microsoft.com/library/ms190315.aspx) Дополнительные сведения о `SCOPE_IDENTITY()` и поэтому может потребоваться [использовать область\_IDENTITY() вместо @@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Убедитесь, что завершить `INSERT` инструкция точкой с запятой перед добавлением `SELECT` инструкции.


[![Запрос должен возвращать значение SCOPE_IDENTITY() дополнения](creating-a-data-access-layer-vb/_static/image71.png)](creating-a-data-access-layer-vb/_static/image70.png)

**Рис. 26**: дополнять запроса для возврата `SCOPE_IDENTITY()` значение ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image72.png))


Наконец, назовите новый метод `InsertProduct`.


[![Задайте имя нового метода InsertProduct](creating-a-data-access-layer-vb/_static/image74.png)](creating-a-data-access-layer-vb/_static/image73.png)

**Рис. 27**: присвоено имя нового метода `InsertProduct` ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image75.png))


При возвращении в конструкторе наборов данных можно увидеть, `ProductsTableAdapter` содержит новый метод `InsertProduct`. Если этого нового метода нет параметра для каждого столбца в `Products` таблицы, скорее всего, вы забыли завершить `INSERT` инструкция точкой с запятой. Настройка `InsertProduct` метод и убедиться в наличии операторы `INSERT` и `SELECT` инструкции.

По умолчанию вставьте методы без запросов методы проблему, это означает, что они возвращают количество задействованных строк. Тем не менее, мы хотим `InsertProduct` метод для возврата значения, возвращенные запросом, не число обработанных строк. Для этого настройте `InsertProduct` метода `ExecuteMode` свойства `Scalar`.


[![Измените свойство ExecuteMode скалярных](creating-a-data-access-layer-vb/_static/image77.png)](creating-a-data-access-layer-vb/_static/image76.png)

**Рис. 28**: изменение `ExecuteMode` свойства `Scalar` ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image78.png))


В следующем коде показан этот новый `InsertProduct` метод в действии:

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample8.vb)]

## <a name="step-5-completing-the-data-access-layer"></a>Шаг 5: Завершение работы на уровне доступа к данным

Обратите внимание, что `ProductsTableAdapters` возвращает `CategoryID` и `SupplierID` значения из `Products` таблицы, но не включает `CategoryName` столбец из `Categories` таблицы или `CompanyName` столбец из `Suppliers` Таблица, несмотря на то, что это скорее всего столбцы, которые необходимо отобразить при выводе информации о продукте. Можно расширить исходный метод адаптера таблицы, `GetProducts()`, чтобы включить оба `CategoryName` и `CompanyName` значений столбцов, что приведет к обновлению строго типизированный объект DataTable для включения этих новых столбцов.

Это может оказаться сложной задачей, тем не менее, как методы адаптера таблицы для вставки, обновления и удаления данных зависят от вне этого исходного метода. К счастью, создаваемые автоматически методы для вставки, обновления и удаления не влияет подзапросы в `SELECT` предложения. При этом не забудьте добавить наши запросы к `Categories` и `Suppliers` как подзапросы, а не `JOIN` s, мы не придется переделывать эти методы изменения данных. Щелкните правой кнопкой мыши `GetProducts()` метод в `ProductsTableAdapter` и выберите команду Настройка. Затем измените `SELECT` предложение, чтобы он выглядел как:

[!code-sql[Main](creating-a-data-access-layer-vb/samples/sample9.sql)]


[![Обновить эту инструкцию SELECT для метода GetProducts()](creating-a-data-access-layer-vb/_static/image80.png)](creating-a-data-access-layer-vb/_static/image79.png)

**Рис. 29**: обновление `SELECT` инструкции для `GetProducts()` метод ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image81.png))


После обновления `GetProducts()` способ использования этого нового запроса, таблицы данных будет включать два новых столбца: `CategoryName` и `SupplierName`.


![Продукты DataTable содержит два новых столбца](creating-a-data-access-layer-vb/_static/image82.png)

**Рис. 30**: `Products` DataTable содержит два новых столбца


Теперь пора обновление `SELECT` предложения в `GetProductsByCategoryID(categoryID)` также метод.

При обновлении `GetProducts()` `SELECT` с помощью `JOIN` синтаксиса конструктора наборов данных не сможет автоматически создавать методы для вставки, обновления и удаления базы данных с помощью базы данных направить шаблон. Вместо этого необходимо создать их вручную гораздо, как мы сделали с `InsertProduct` метод ранее в этом учебнике. Кроме того, вы будете вручную должны предоставить `InsertCommand`, `UpdateCommand`, и `DeleteCommand` значения свойств, если вы хотите использовать схему пакетного обновления.

## <a name="adding-the-remaining-tableadapters"></a>Добавление оставшиеся адаптеры таблиц TableAdapter

До сих пор мы только рассмотрели работа с адаптер для одной таблицы базы данных. Однако базы данных Northwind содержит несколько связанных таблиц, нам нужно будет работать с нашей веб-приложения. Типизированный набор данных может содержать несколько связанных таблиц DataTable. Таким образом чтобы завершить DAL необходимо добавить таблицы данных для других таблиц, которые мы будем использовать в этих учебниках. Чтобы добавить новый адаптер таблицы типизированного набора данных, откройте конструктор наборов данных, щелкните правой кнопкой мыши в конструкторе и выберите Добавить / TableAdapter. Будет создан новый объект DataTable и TableAdapter и пошаговыми руководствами мастер, который мы рассмотрели ранее в этом учебнике.

Занять несколько минут, чтобы создать следующие адаптеры таблиц TableAdapter и методы, с помощью следующих запросов. Обратите внимание, что запросы в `ProductsTableAdapter` включают вложенные запросы, для извлечения имен категорию и поставщика каждого продукта. Кроме того, если вы выполняли, вы уже добавили `ProductsTableAdapter` класса `GetProducts()` и `GetProductsByCategoryID(categoryID)` методы.

- **ProductsTableAdapter**

  - **GetProducts**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample10.sql)]
  - **GetProductsByCategoryID**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample11.sql)]
  - **GetProductsBySupplierID**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample12.sql)]
  - **GetProductByProductID**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample13.sql)]
- **CategoriesTableAdapter**

  - **GetCategories**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample14.sql)]
  - **GetCategoryByCategoryID**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample15.sql)]
- **SuppliersTableAdapter**

  - **GetSuppliers**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample16.sql)]
  - **GetSuppliersByCountry**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample17.sql)]
  - **GetSupplierBySupplierID**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample18.sql)]
- **EmployeesTableAdapter**

  - **GetEmployees**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample19.sql)]
  - **GetEmployeesByManager**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample20.sql)]
  - **GetEmployeeByEmployeeID**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample21.sql)]


[![Конструктор наборов данных после добавления четырех адаптеров таблиц](creating-a-data-access-layer-vb/_static/image84.png)](creating-a-data-access-layer-vb/_static/image83.png)

**Рис. 31**: набора данных конструктор после четырех адаптеров таблиц были добавлены ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image85.png))


## <a name="adding-custom-code-to-the-dal"></a>Добавление пользовательского кода в DAL

Адаптеры таблиц TableAdapter и добавить в типизированный набор данных DataTables выражаются в виде файла определения схемы XML (`Northwind.xsd`). Эти данные схемы можно просмотреть, щелкнув правой кнопкой мыши `Northwind.xsd` в обозревателе решений и выбрав команду Просмотреть код.


[![Файл схемы XML (XSD) определение для Northwinds типизированного набора данных](creating-a-data-access-layer-vb/_static/image87.png)](creating-a-data-access-layer-vb/_static/image86.png)

**Рис. 32**: файл определения схемы XML (XSD) для типизированного набора данных Northwinds ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image88.png))


Эти сведения схемы преобразуются в код C# или Visual Basic во время разработки при компиляции или во время выполнения (при необходимости), после чего можно пройти по с помощью отладчика. Чтобы просмотреть этот автоматически созданный код перейдите в представление классов и детализации для классов TableAdapter или типизированного набора данных. Если вы не видите представления классов, на экране, перейдите в меню "Вид" и выберите его оттуда или нажмите сочетание клавиш Ctrl + Shift + C. Из представления классов, вы увидите, свойства, методы и события классов типизированного набора данных и адаптера таблицы. Просмотр кода для конкретного метода, или дважды щелкните имя метода в представлении классов щелкните его правой кнопкой мыши и выберите перейти к определению.


![Проверьте автоматически созданный код, выбрав перейти к определению из представления классов](creating-a-data-access-layer-vb/_static/image89.png)

**На рисунке 33**: Проверьте автоматически созданный код, выбрав перейти к определению из представления классов


Автоматически созданный код может быть сэкономить много времени, часто очень универсальный код и необходимо настроить в соответствии с потребностями приложения. Риск расширение автоматически создаваемый код, — что средства, создавшего код может решить, что пора «восстановить» и перезаписать сделанные настройки. С .NET 2.0 новая концепция разделяемый класс можно легко разделить класс в нескольких файлах. Это позволяет добавлять собственные методы, свойства и события для автоматически создаваемые классы не нужно беспокоиться о перезаписи сделанных настроек Visual Studio.

Чтобы продемонстрировать, как настроить DAL, добавим `GetProducts()` метод `SuppliersRow` класса. `SuppliersRow` Класс представляет одну запись в `Suppliers` таблица; каждый поставщик может ноль для многих продуктов, поэтому `GetProducts()` возвращает все продукты указанного поставщика. Для выполнения этого создавать новый файл класса в `App_Code` папку с именем `SuppliersRow.vb` и добавьте следующий код:

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample22.vb)]

Этот разделяемый класс указывает компилятору что при построении `Northwind.SuppliersRow` класса для включения `GetProducts()` только определенный метод. Если сборка проекта, а затем вернитесь в представление класса вы увидите `GetProducts()` теперь указана как метод `Northwind.SuppliersRow`.


![Метод GetProducts() является теперь входит в класс Northwind.SuppliersRow](creating-a-data-access-layer-vb/_static/image90.png)

**Рисунок 34**: `GetProducts()` метод входит теперь `Northwind.SuppliersRow` класса


`GetProducts()` Метод теперь может использоваться для перечисления набора продуктов для конкретного поставщика, как показано в следующем коде:

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample23.vb)]

Эти данные также могут отображаться в любом из ASP. Данные в NET веб-элементов управления. На следующей странице используется элемент управления GridView с двумя полями:

- Отображает имя каждого поставщика, BoundField и
- Содержащий элемент управления маркированный список, к которому привязан результаты, возвращенные TemplateField `GetProducts()` для каждого поставщика.

Мы рассмотрим способы отображения таких отчетов основной подробности в будущих учебниках. Теперь этот пример предназначен для иллюстрации использования пользовательского метода, добавленного к `Northwind.SuppliersRow` класса.

SuppliersAndProducts.aspx

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample24.aspx)]

SuppliersAndProducts.aspx.vb

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample25.vb)]


[![Название компании-поставщика, перечисленные в столбце слева их продуктов в правом](creating-a-data-access-layer-vb/_static/image92.png)](creating-a-data-access-layer-vb/_static/image91.png)

**На рисунке 35**: название компании-поставщика, перечисленные в столбце слева их продуктов в правом ([Просмотр полноразмерное изображение](creating-a-data-access-layer-vb/_static/image93.png))


## <a name="summary"></a>Сводка

При построении веб-приложения, создание DAL должно быть на одной из первых этапов, до начала создания слоя представления. С помощью Visual Studio слой DAL на основе типизированных наборов — это задача, можно выполнить без написания кода 10 – 15 минут. Учебники, продвижение вперед, будут созданы на основе этого DAL. В [следующее руководство](creating-a-business-logic-layer-vb.md) мы определен ряд бизнес-правил и способы их реализации в отдельном уровне бизнес-логики.

Программирование довольны!

## <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения по темам, рассматриваемые в этом учебнике см. в следующих ресурсах:

- [Построение DAL, с помощью строго типизированные адаптеры таблицы и таблицы данных в VS 2005 и ASP.NET 2.0](https://weblogs.asp.net/scottgu/435498)
- [Проектирование компоненты уровня данных и передачи данных через уровни](https://msdn.microsoft.com/library/ms978496.aspx)
- [Построение слой доступа к данным с помощью конструктора набора данных Visual Studio 2005](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner)
- [Шифрование данных конфигурации в ASP.NET 2.0 приложений](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)
- [Общие сведения об адаптере таблиц](https://msdn.microsoft.com/library/bz9tthwx.aspx)
- [Работа с типизированного набора данных](https://msdn.microsoft.com/library/esbykkzb.aspx)
- [С помощью доступа к строго типизированным данным в Visual Studio 2005 и ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/020806-1.aspx)
- [Способы расширения методы адаптера таблицы](https://blogs.msdn.com/vbteam/archive/2005/05/04/ExtendingTableAdapters.aspx)
- [Извлечение скалярных данных из хранимой процедуры](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a>Видео на разделы, содержащиеся в этом учебнике

- [Уровни доступа к данным в приложениях ASP.NET](../../../videos/data-access/adonet-data-services/data-access-layers-in-aspnet-applications.md)
- [Как вручную связать набор данных в элемент управления Datagrid](../../../videos/data-access/adonet-data-services/how-to-manually-bind-a-dataset-to-a-datagrid.md)
- [Порядок работы с наборами данных и фильтры приложения ASP](../../../videos/data-access/adonet-data-services/how-to-work-with-datasets-and-filters-from-an-asp-application.md)

## <a name="about-the-author"></a>Об авторе

[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи ASP/ASP.NET и основателя из [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Майкрософт с 1998 года. Скотт — независимый консультант, trainer и записи. Его последняя книга — [ *диспетчерами учат самостоятельно ASP.NET 2.0 в течение 24 часов*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco). Он может быть достигнута по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) или через его блог, который можно найти в [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).

## <a name="special-thanks-to"></a>Благодарности

Этот учебник ряд прошел проверку многие полезные рецензентов. Основными редакторами этого учебника были Николай зеленый, – Хилтон Гизнау, Деннис Патерсона, (Liz Shulok), метка Gomez и Карлос Сантос. Объясняются моих последующих статей для MSDN? Если Да, напишите мне по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)

> [!div class="step-by-step"]
> [Назад](master-pages-and-site-navigation-cs.md)
> [Вперед](creating-a-business-logic-layer-vb.md)
