---
uid: web-forms/overview/data-access/introduction/master-pages-and-site-navigation-vb
title: Главные страницы и навигации веб-узла (VB) | Документы Microsoft
author: rick-anderson
description: Отличительной удобной для пользователей веб-сайтов является наличие схему стабильное и сайта страницы макета и навигации. В этом учебнике рассматривается как y...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: 022801d8-a327-4d0c-8780-6094c9cee00d
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/introduction/master-pages-and-site-navigation-vb
msc.type: authoredcontent
ms.openlocfilehash: 45fdbf70f7981c0faefef2603d21f913022e2a8f
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30887565"
---
<a name="master-pages-and-site-navigation-vb"></a>Главные страницы и навигации веб-узла (Visual Basic)
====================
по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Загрузить пример приложения](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_3_VB.exe) или [скачать PDF](master-pages-and-site-navigation-vb/_static/datatutorial03vb1.pdf)

> Отличительной удобной для пользователей веб-сайтов является наличие схему стабильное и сайта страницы макета и навигации. В учебнике показано, как можно создавать согласованного внешнего вида и поведения на всех страницах, которые легко могут быть обновлены.


## <a name="introduction"></a>Вступление

Отличительной удобной для пользователей веб-сайтов является наличие схему стабильное и сайта страницы макета и навигации. ASP.NET 2.0 появились две новые возможности, которые существенно упрощают реализации оба сайта страницы макета и навигации схему: главные страницы и навигация по сайту. Главные страницы позволяют разработчикам создавать шаблон сайта с назначенного редактируемые области. Этот шаблон применима к страницам ASP.NET на сайте. Такие страницы ASP.NET необходимо предоставить только содержимое, для главной страницы, заданные редактируемые области все остальные элементы главной страницы будут одинаковыми для всех страниц ASP.NET с использованием главной страницы. Эта модель позволяет разработчикам определить и централизации макета страницы для всего веб-узла, тем самым упрощая создание согласованного внешнего вида и поведения на всех страницах, которые легко могут быть обновлены.

[Перехода системы сайта](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx) предоставляется как механизм для разработчиков страниц карты сайта и API-Интерфейс для этой карты сайта должны запрашиваться программными средствами. Новый навигации веб-элементов управления, меню, TreeView и SiteMapPath упрощают отображения всей или части карты узла в общих навигации элемент пользовательского интерфейса. Мы будем использовать поставщик узла навигации по умолчанию, это означает, что определены карта узла в XML-файл.

Для иллюстрации этих основных понятий и сделать удобным в нашем сайте учебники, давайте тратят урока Определение макета страницы для всего сайта, реализации карты узла и добавления навигации пользовательского интерфейса. В конце этого учебника мы еще проектирования профессиональный веб-сайта для построения наш учебник веб-страниц.


[![В результате этого учебника](master-pages-and-site-navigation-vb/_static/image2.png)](master-pages-and-site-navigation-vb/_static/image1.png)

**Рис. 1**: End результат из этого учебника ([Просмотр полноразмерное изображение](master-pages-and-site-navigation-vb/_static/image3.png))


## <a name="step-1-creating-the-master-page"></a>Шаг 1: Создание главной страницы

Первым шагом является создание главной страницы сайта. Сейчас наш веб-сайт содержит только для типизированного набора данных (`Northwind.xsd`в `App_Code` папки), классы уровень бизнес-ЛОГИКИ (`ProductsBLL.vb`, `CategoriesBLL.vb`, и т. д., на `App_Code` папки), базы данных (`NORTHWND.MDF`в `App_Data` папка) в файле конфигурации (`Web.config`) и таблицы стилей CSS-файла (`Styles.css`). Мы удалили файлы, демонстрирующие использование DAL и уровень бизнес-ЛОГИКИ первые два учебника, так как мы будет которыми более подробно в будущих учебниках.


![Файлы проекта](master-pages-and-site-navigation-vb/_static/image4.png)

**На рисунке 2**: файлы проекта


Чтобы создать главную страницу, щелкните правой кнопкой мыши имя проекта в обозревателе решений и выберите команду Добавить новый элемент. Затем выберите тип главной страницы из списка шаблонов и назовите его `Site.master`.


[![Добавление новой главной страницы на веб-сайт](master-pages-and-site-navigation-vb/_static/image6.png)](master-pages-and-site-navigation-vb/_static/image5.png)

**Рис. 3**: Добавление новой главной страницы на веб-сайт ([Просмотр полноразмерное изображение](master-pages-and-site-navigation-vb/_static/image7.png))


Определите макет для сайта всех страниц на главной странице. Можно использовать представление проектирования и добавьте любые макета или веб-элементы управления, или можно вручную добавить разметку вручную в представлении источника. На главной странице использовать [каскадных таблиц стилей](http://www.w3schools.com/css/default.asp) для положения и параметры CSS, определенные во внешнем файле `Style.css`. Пока не удастся найти из приведенной ниже разметки, определенные правила CSS таким образом, что Навигация `<div>`элемента содержимого с абсолютным позиционированием, чтобы он отображается слева и имеет фиксированную ширину 200 пикселей.

Site.master


[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample1.aspx)]

На главной странице определяются как статические, так и области, которые можно изменить с помощью страниц ASP.NET, в которых используется Главная страница. Изменяемые области обозначаются управления ContentPlaceHolder, который можно увидеть в содержимом `<div>`. Наш Главная страница имеет один ContentPlaceHolder (`MainContent`), но главная страница может быть и несколько.

С разметки, введенного выше переключением в представление конструирования отображается макет главной страницы. Все страницы ASP.NET, использующие этот главной страницы будет иметь этот универсальный макет с возможностью указать разметку для `MainContent` области.


[![Главная страница, при просмотре в режиме конструктора](master-pages-and-site-navigation-vb/_static/image9.png)](master-pages-and-site-navigation-vb/_static/image8.png)

**Рис. 4**: главной страницы, при просмотре через конструктор ([Просмотр полноразмерное изображение](master-pages-and-site-navigation-vb/_static/image10.png))


## <a name="step-2-adding-a-homepage-to-the-website"></a>Шаг 2: Добавление домашней страницы на веб-сайт

С главную страницу все готово для добавления страниц ASP.NET, веб-сайта. Давайте начнем с добавления `Default.aspx`, домашняя страница наш веб-сайт. Щелкните правой кнопкой мыши имя проекта в обозревателе решений и выберите команду Добавить новый элемент. Выберите вариант веб-формы, в списке шаблон и имя файла `Default.aspx`. Кроме того установите флажок «Выбрать главную страницу».


[![Добавьте новый веб-форму, проверка выберите флажок главной страницы](master-pages-and-site-navigation-vb/_static/image12.png)](master-pages-and-site-navigation-vb/_static/image11.png)

**Рис. 5**: добавьте новый веб-форму проверки выбрать главную страницу Checkbox ([Просмотр полноразмерное изображение](master-pages-and-site-navigation-vb/_static/image13.png))


После нажатия кнопки ОК появится запрос выбрать главную страницу для этой новой странице ASP.NET следует использовать. При наличии нескольких главных страниц в проекте у нас есть только один.


[![Выберите главной страницы для этой страницы ASP.NET](master-pages-and-site-navigation-vb/_static/image15.png)](master-pages-and-site-navigation-vb/_static/image14.png)

**Рис. 6**: Выбор главной страницы для этого использования следует страницы ASP.NET ([Просмотр полноразмерное изображение](master-pages-and-site-navigation-vb/_static/image16.png))


После выбора главной страницы, на странице ASP.NET будет содержать следующую разметку:

Default.aspx


[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample2.aspx)]

В `@Page` директива является ссылкой на файл используемой главной страницы (`MasterPageFile="~/Site.master"`), и разметка страницы ASP.NET содержит элемент управления содержимым для каждого из элементов управления ContentPlaceHolder, определенных на главной странице с элементом управления `ContentPlaceHolderID` сопоставление содержимого элемента управления для конкретных ContentPlaceHolder. Элемент управления содержимым является расположения разметка будет отображаться в соответствующего ContentPlaceHolder. Задать `@Page` директивы `Title` атрибута в корневой папке и добавьте в элемент управления содержимым Приветствуем содержимое:

Default.aspx


[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample3.aspx)]

`Title` Атрибута в `@Page` директива позволяет задать заголовок страницы на странице ASP.NET, даже если `<title>` элемент определен в главной страницы. Мы также заголовок можно установить программно, с помощью `Page.Title`. Также Обратите внимание, что главной страницы ссылки на таблицы стилей (такие как `Style.css`) автоматически обновляются, чтобы они работали на любой странице ASP.NET, независимо от того, какой каталог, на странице ASP.NET в относительно главной страницы.

Переключение в режим конструктора, вы увидите, как созданная страница будет выглядеть в браузере. Обратите внимание, что в конструкторе просмотра для страницы ASP.NET, можно редактировать, только изменяемые области не ContentPlaceHolder разметки, определенные на главной странице отображается серым цветом.


[![Редактируемые и нередактируемые области показан режим конструктора для страницы ASP.NET](master-pages-and-site-navigation-vb/_static/image18.png)](master-pages-and-site-navigation-vb/_static/image17.png)

**Рис. 7**: режим конструктора для ASP.NET страницы показано, как Editable и Non-Editable областей ([Просмотр полноразмерное изображение](master-pages-and-site-navigation-vb/_static/image19.png))


Когда `Default.aspx` посещенные страницы в браузере, ASP.NET engine автоматически добавляет содержимое главной страницы страницы и ASP. NET, содержимое и отображает объединенное содержимое в HTML-код, отправляемое браузеру. При обновлении содержимого главной страницы, все страницы ASP.NET, в которых используется эта главная страница будет выполнено при очередном они запрашиваются новой главной страницы содержимого. Иными словами, такая модель позволяет на одной странице шаблон макета для определенных (главной страницы), изменения немедленно отражаются на всем сайте.

## <a name="adding-additional-aspnet-pages-to-the-website"></a>Добавление других страниц ASP.NET на веб-сайт

Давайте немного для добавления дополнительных заглушки страницы ASP.NET для сайта, со временем будут размещаться демонстрационные. Будет больше, чем 35 примеров в итоге поэтому вместо создания всех страниц заглушки Давайте просто создать несколькими. Поскольку также будет много категорий демонстрациям, для лучшего управления демонстрационные Добавление папки для категорий. Теперь добавьте следующие три папки:

- `BasicReporting`
- `Filtering`
- `CustomFormatting`

Наконец добавьте новые файлы, как показано в обозревателе решений на рисунке 8. При добавлении каждого файла, не забудьте установите флажок «Выбрать главную страницу».


![Добавьте следующие файлы](master-pages-and-site-navigation-vb/_static/image20.png)

**Рис. 8**: добавьте следующие файлы


## <a name="step-2-creating-a-site-map"></a>Шаг 2: Создание карты узла

Одна из задач управления веб-сайта, состоящий из более чем небольшое число страниц предоставляет простой и понятный способ посетителям перемещаться по сайту. Вначале должны быть определены структуры переходов веб-узла. Затем эта структура должны быть переведены в рабочих элементах интерфейса, такие как меню или деревьях. Наконец это весь процесс должен поддерживать и обновлять по мере добавления новых страниц к сайту и удаления старых. До ASP.NET 2.0 разработчикам приходилось самим создавать структуры переходов веб-узла, его обслуживание и преобразовывать в рабочих элементах интерфейса. С помощью ASP.NET 2.0 тем не менее, разработчикам использовать очень гибкий встроенного в систему переходов.

Системой перемещения ASP.NET 2.0 предоставляет средства для разработчиков для определения карты узла и работать с полученной информацией через программный интерфейс API. ASP.NET поставляется с поставщиком карты сайта, который ожидает данных карты сайта для сохранения в XML-файл в особом формате. Но, поскольку структура переходов строится на [модель поставщика](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx) ее можно расширить для поддержки альтернативных методов для сериализации информации карты узла. Джефф Просайз статья [SQL узел карты поставщика вы кто уже были ожидания для](https://msdn.microsoft.com/msdnmag/issues/06/02/WickedCode/default.aspx) показано, как для создания поставщика карты веб-узла, хранящего карту в базе данных SQL Server; другой вариант — Создать [на основе поставщика карты веб-узла Структура файловой системы](http://aspnet.4guysfromrolla.com/articles/020106-1.aspx).

В этом учебнике тем не менее, воспользуемся поставщика карты сайта по умолчанию, который поставляется с ASP.NET 2.0. Для создания карты сайта, просто щелкните правой кнопкой мыши имя проекта в обозревателе решений, выберите команду Добавить новый элемент и выберите параметр карты сайта. Оставьте имя, `Web.sitemap` и нажмите кнопку Добавить.


[![Добавление карты узла в проект](master-pages-and-site-navigation-vb/_static/image22.png)](master-pages-and-site-navigation-vb/_static/image21.png)

**Рис. 9**: Добавление карты узла в проект ([Просмотр полноразмерное изображение](master-pages-and-site-navigation-vb/_static/image23.png))


Файл карты узла — XML-файл. Обратите внимание, что Visual Studio предоставляет IntelliSense для структуре карты сайта. Файл карты сайта должен иметь `<siteMap>` узел в качестве корневого узла, который должен содержать точно один `<siteMapNode>` дочерний элемент. Первый элемент `<siteMapNode>` элемент может содержать неограниченное число вложенных `<siteMapNode>` элементов.

Определите карты сайта, чтобы имитировать Структура файловой системы. То есть добавьте `<siteMapNode>` элемент для каждого из трех папок и дочерних `<siteMapNode>` элементы для каждой из страниц ASP.NET в этих папках следующим образом:

Web.sitemap


[!code-xml[Main](master-pages-and-site-navigation-vb/samples/sample4.xml)]

Карта узла определяет структуру переходов веб-сайта, — это иерархия, описаны различные разделы веб-узла. Каждый `<siteMapNode>` элемент в `Web.sitemap` представляет раздел в структуры переходов веб-узла.


[![Карта сайта представляет иерархическую структуру навигации](master-pages-and-site-navigation-vb/_static/image25.png)](master-pages-and-site-navigation-vb/_static/image24.png)

**Рис. 10**: карта сайта представляет иерархическую структуру навигации ([Просмотр полноразмерное изображение](master-pages-and-site-navigation-vb/_static/image26.png))


ASP.NET предоставляет структура карты сайта до .NET Framework [SiteMap класса](https://msdn.microsoft.com/library/system.web.sitemap.aspx). Этот класс имеет `CurrentNode` свойство, которое возвращает сведения о разделе пользователь в настоящее время посещения; `RootNode` свойство возвращает корневой узел карты (Home, в нашей карты сайта). Как `CurrentNode` и `RootNode` возвращаемого свойства [SiteMapNode](https://msdn.microsoft.com/library/system.web.sitemapnode.aspx) экземпляров, которые имеют свойства, как `ParentNode`, `ChildNodes`, `NextSibling`, `PreviousSibling`и так далее, которые позволяют карты сайта иерархия, который необходимо рассмотреть.

## <a name="step-3-displaying-a-menu-based-on-the-site-map"></a>Шаг 3: Отображение меню, в соответствии с карты сайта

Доступ к данным в ASP.NET 2.0 можно осуществить программным образом, как в ASP.NET 1.x, или декларативно, с помощью нового [элементами управления источниками данных](https://msdn.microsoft.com/library/ms227679.aspx). Существует несколько встроенных источников данных как элемент управления SqlDataSource для доступа к реляционным базам данных, элемент управления ObjectDataSource, для доступа к данным из классов и другие. Можно даже создать свой собственный [элементами управления источниками данных пользовательских](https://msdn.microsoft.com/asp.net/reference/data/default.aspx?pull=/library/dnvs05/html/DataSourceCon1.asp).

Элементы управления источниками данных выступают в роли посредника между страницей ASP.NET и базовых данных. Для правильного отображения полученных данных элемента управления источником данных, мы обычно добавить на страницу другого веб-элемента управления и привязать его к элементу управления источника данных. Чтобы привязать веб-элемент управления к элементу управления источником данных, просто установите веб-элемента управления `DataSourceID` значение элемента управления источника данных свойства `ID` свойство.

Для упрощения работы с данными карты веб-узла ASP.NET включает управления SiteMapDataSource, которые позволяет привязать веб-элемент управления в карте узла наш веб-сайт. Два веб-элементы управления TreeView и меню обычно используются для предоставления пользовательского интерфейса навигации. Чтобы привязать данные карты узла к одному из этих двух элементов управления, просто добавьте SiteMapDataSource страницы вместе с TreeView или элемент управления меню `DataSourceID` свойству соответствующим образом. Например мы добавим элемент управления Menu на главную страницу, используя следующую разметку:


[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample5.aspx)]

Для более точного степень контроля над полученным кодом HTML, мы привязать элемент управления SiteMapDataSource в элементе управления повторителем следующим образом:


[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample6.aspx)]

Элемент управления SiteMapDataSource Возвращает уровень иерархии один карты сайта по одному, начиная с корневого узла (Home, в нашем), затем следующий уровень (Базовые отчеты, фильтрация отчетов и настройка форматирования) и т. д. При привязке SiteMapDataSource повторитель, она перечисляет первый уровень возвращаются и создает `ItemTemplate` для каждого `SiteMapNode` экземпляр на первом уровне. Для доступа к свойству определенного `SiteMapNode`, мы можем использовать `Eval(propertyName)`, являющееся получить, к примеру `SiteMapNode` `Url` и `Title` свойства для элемента управления HyperLink.

В приведенном выше примере повторителя будет следующую разметку:


[!code-html[Main](master-pages-and-site-navigation-vb/samples/sample7.html)]

Эти узлов карты (Базовые отчеты, фильтрация отчетов и настройка форматирования) составляют *второй* карты веб-узла, который готовится к просмотру, не первого уровня. Это обусловлено SiteMapDataSource `ShowStartingNode` свойство имеет значение False, поэтому элемент SiteMapDataSource для обхода корневого узла и начинает на втором уровне в иерархии.

Чтобы отобразить дочерние элементы для Базовые отчеты, фильтрация отчетов и настройка форматирования `SiteMapNode` s, мы можем добавить другой повторителя начальной повторителя `ItemTemplate`. Этот второй повторителя будет привязан к `SiteMapNode` экземпляра `ChildNodes` свойства следующим образом:


[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample8.aspx)]

Эти два знаки повторения привести следующую разметку (некоторую разметку был удален для краткости):


[!code-html[Main](master-pages-and-site-navigation-vb/samples/sample9.html)]

Помощи стилей CSS, выбранный из [Rachel Эндрю](http://www.rachelandrew.co.uk/)в книге [Anthology CSS: 101 важные советы, рекомендации, &amp; взломает](https://www.amazon.com/gp/product/0957921888/qid=1137565739/sr=8-1/ref=pd_bbs_1/103-0562306-3386214?n=507846&amp;s=books&amp;v=glance), `<ul>` и `<li>` оформленных элементов таким образом, что Разметка выводятся следующие данные visual:


![Меню, состоящих из двух знаки повторения и некоторые CSS](master-pages-and-site-navigation-vb/_static/image27.png)

**Рис. 11**: меню состоит из двух знаки повторения и некоторые CSS


Это меню в главной страницы и привязан к карте веб-узла, определенного в `Web.sitemap`, то есть немедленно отражаются любое изменение карты узла на всех страниц, использующих `Site.master` главной страницы.

## <a name="disabling-viewstate"></a>Отключение ViewState

Все элементы управления ASP.NET могут хранить свое состояние в [состояние представления](https://msdn.microsoft.com/msdnmag/issues/03/02/CuttingEdge/), который сериализуется в качестве скрытого поля формы в HTML. Состояние представления используется элементами управления для запоминания их программно изменить состояние во время обратной передачи, таких как данные, привязанные к веб-управления. Хотя состояния просмотра позволяет запоминать данные, увеличивает размер разметку, должны быть отправлены клиенту и может привести к Раздувание страницы, если не точно отслеживать. Данные веб-элементов управления в первую очередь GridView имеют дурную добавлять десятки килобайтов к разметке на страницу. Хотя такие увеличение может быть незначительной пользователям широкополосного подключения или интрасети, состояние представления можно добавить несколько секунд кругового пути для пользователей удаленного доступа.

Чтобы увидеть влияние состояния представления, посетите страницу в браузере и затем просмотреть источник, отправленных веб-страницы (в Internet Explorer, перейдите в меню «Вид» и выберите параметр источника). Также можно включить [трассировку](https://msdn.microsoft.com/library/sfbfw58f.aspx) для просмотра выделения состояния представления, используемых каждым из элементов управления на странице. Сведения о состоянии представления сериализуется в скрытом поле `__VIEWSTATE`, расположенного в `<div>` сразу после открытия элемента `<form>` тег. Состояние представления сохраняются только в том случае, если имеется веб-форма; Если страница ASP.NET не имеет `<form runat="server">` его декларативный синтаксис, не будет `__VIEWSTATE` скрытое поле формы в создаваемой разметки.

`__VIEWSTATE` Поля формы, созданные на главную страницу добавляет примерно на 1800 байт созданный разметку страницы. Это обусловлена в основном элементе управления повторителем как содержимое элемента SiteMapDataSource сохраняется в состоянии представления. Лишние 1800 байт не может показаться так много для получения нравится, при использовании элемента управления GridView с множество полей и записи, состояние представления можно легко увеличиваться в 10 или более.

Состояние представления можно отключить на уровне страницы или элемента управления, задав `EnableViewState` свойства `False`, тем самым уменьшив размер для отображения разметки. Поскольку в состоянии представления для данных сохраняет данные, привязанные к данным веб-элемента управления во время обратной передачи элемент управления Web при отключении состояния представления для данных элемента управления веб-данных должен быть привязан при каждой обратной передаче. В ASP.NET версии 1.x эта обязанность ложилась на плечи разработчика. в ASP.NET 2.0 тем не менее, веб-элементы управления данными будет повторно привязать их элементу управления источником данных при каждой обратной передаче при необходимости.

Для уменьшения состояния просмотра страницы позволяет задать элементе управления повторителем `EnableViewState` свойства `False`. Это можно сделать в окне «Свойства» в конструкторе) или декларативно (в представлении источника. После этого изменения повторителя должна выглядеть как:


[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample10.aspx)]

После этого изменения страницы в визуализации представления, что размер состояния сжатия для простое размер в представлении состояния 52 байтов, экономия 97%! В учебниках по всему этой серии будет отключено состояние представления данных веб-элементов управления по умолчанию для уменьшения размера для отображения разметки. В большинстве примеров `EnableViewState` свойству будет присвоено `False` и сделано без упоминание. Единственный случай, когда мы обсудим состояние представления — в сценариях, где должны включаться в порядке для данных веб-элемента управления для правильной работы.

## <a name="step-4-adding-breadcrumb-navigation"></a>Шаг 4: Добавление строки навигации

Чтобы завершить главной страницы, добавим элемент иерархической навигации пользовательского интерфейса на каждую страницу. Навигации позволяет быстро увидеть пользователей их текущее положение в иерархии сайтов. Добавление только навигатора в ASP.NET 2.0 можно легко добавить управления SiteMapPath на страницу; код не требуется.

Мы добавим этот элемент управления заголовка `<div>`:


[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample11.aspx)]

Навигатор показывает текущую страницу пользователя, посетив вплоть до корня иерархии карты узла, а также в этот узел карты узла «предков,» (Home, в нашей карты сайта).


![Навигации выводит текущую страницу и сопоставления его предков узла иерархии](master-pages-and-site-navigation-vb/_static/image28.png)

**Рис. 12**: навигации выводит текущую страницу и сопоставления его предков узла иерархии


## <a name="step-5-adding-the-default-page-for-each-section"></a>Шаг 5: Добавление страницы по умолчанию для каждого раздела

Учебники в нашем сайте разбиваются по различным категориям Базовые отчеты, фильтрация, настраиваемое форматирование, и т. д с папку для каждой категории и руководства страница ASP.NET в этой папке. Кроме того, каждая папка содержит `Default.aspx` страницы. Для этой страницы по умолчанию давайте показаны все учебники для текущего раздела. То есть для `Default.aspx` в `BasicReporting` папку нам пришлось бы ссылки на `SimpleDisplay.aspx`, `DeclarativeParams.aspx`, и `ProgrammaticParams.aspx`. Здесь снова можно использовать `SiteMap` определять класс и данных веб-элемент управления для отображения карты сайта на основе сведений в `Web.sitemap`.

Позволяет отобразить неупорядоченный список с помощью повторитель снова, но на этот раз мы будем отобразить заголовок и описание руководства. Так как разметка и код для выполнения данной должны повторяться для каждого `Default.aspx` страницы, мы инкапсуляции этой логики пользовательского интерфейса в [пользовательский элемент управления](https://msdn.microsoft.com/library/y6wb1a0e.aspx). Создайте папку на веб-сайте называется `UserControls` и добавьте в этот новый элемент типа веб-элемента управления пользователя с именем `SectionLevelTutorialListing.ascx`и добавьте следующую разметку:


[![Добавление нового пользователя веб-элемент управления в папку элементы управления UserControl](master-pages-and-site-navigation-vb/_static/image30.png)](master-pages-and-site-navigation-vb/_static/image29.png)

**Рис. 13**: Добавление новых пользователей веб-элемент управления для `UserControls` папку ([Просмотр полноразмерное изображение](master-pages-and-site-navigation-vb/_static/image31.png))


SectionLevelTutorialListing.ascx


[!code-aspx[Main](master-pages-and-site-navigation-vb/samples/sample12.aspx)]

SectionLevelTutorialListing.ascx.vb


[!code-vb[Main](master-pages-and-site-navigation-vb/samples/sample13.vb)]

В предыдущем примере повторителя привязан `SiteMap` данные повторителя декларативно; `SectionLevelTutorialListing` пользовательский элемент управления, однако делает это программными средствами. В `Page_Load` обработчика событий, проверяется, чтобы убедиться, что эта страница s сопоставляет URL-адрес узла карты сайта. Если используется этот пользовательский элемент управления на странице, не имеет соответствующего `<siteMapNode>` запись `SiteMap.CurrentNode` вернет `Nothing` и данные не будут привязаны к повторителя. При условии, что у нас есть `CurrentNode`, мы привязать его `ChildNodes` коллекции повторителя. Так как карта узла настроено таким образом, что `Default.aspx` в каждом разделе служит родительским узлом всех учебники в этом разделе, этот код будет отображать ссылки на и описания всех руководства данного раздела, как показано в приведенном ниже снимке экрана.

После создания этого повторителя откройте `Default.aspx` страниц в каждой папки, перейдите в режим конструктора и просто перетащите пользовательский элемент управления из обозревателя решений в область конструктора где должен быть список для отображения.


[![Пользовательский элемент управления был добавлен на Default.aspx](master-pages-and-site-navigation-vb/_static/image33.png)](master-pages-and-site-navigation-vb/_static/image32.png)

**Рис. 14**: пользовательскому элементу управления был добавлен в `Default.aspx` ([Просмотр полноразмерное изображение](master-pages-and-site-navigation-vb/_static/image34.png))


[![Перечислены базовые учебники отчетов](master-pages-and-site-navigation-vb/_static/image36.png)](master-pages-and-site-navigation-vb/_static/image35.png)

**Рис. 15**: перечислены базовые учебники Reporting ([Просмотр полноразмерное изображение](master-pages-and-site-navigation-vb/_static/image37.png))


## <a name="summary"></a>Сводка

Определения карты узла и создания главных страниц мы публикуем согласованные страницы макета и схему переходов для наших руководств. Независимо от того, сколько страниц, мы добавим наш сайт обновление данных всех страниц узла навигации выполняется быстро и просто из-за этих сведений централизованное. В частности, сведения о макете страницы определяется на главной странице `Site.master` и сопоставления в сайт `Web.sitemap`. Нам не нужно писать *любой* кода для достижения этого механизма макет и навигации страницы сайта, и мы храним полной WYSIWYG поддержка конструктора в Visual Studio.

Прохождения уровня доступа к данным и бизнес-логики и having согласованного макета и сайт навигацию по страницам определен, мы готовы к работе с распространенными шаблонами отчетов. В трех следующих руководствах мы рассмотрим основные задачи создания отчетов, отображение данных из МЕТОДА в элементах управления GridView, DetailsView и FormView.

Программирование довольны!

## <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения по темам, рассматриваемые в этом учебнике см. в следующих ресурсах:

- [Страницах](https://msdn.microsoft.com/library/wtxbf3hh.aspx)
- [Главные страницы в ASP.NET 2.0](http://odetocode.com/Articles/419.aspx)
- [Шаблоны ASP.NET 2.0 разработки](https://msdn.microsoft.com/asp.net/reference/design/templates/default.aspx)
- [Общие сведения о навигации веб-узла ASP.NET](https://msdn.microsoft.com/library/e468hxky.aspx)
- [Изучение ASP.NET 2.0, навигации веб-узла](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)
- [Функции навигации ASP.NET 2.0 сайта](https://weblogs.asp.net/scottgu/archive/2005/11/20/431019.aspx)
- [Общие сведения о состоянии представления ASP.NET](https://msdn.microsoft.com/library/default.asp?url=/library/dnaspp/html/viewstate.asp)
- [Как: Включение трассировки для страницы ASP.NET](https://msdn.microsoft.com/library/94c55d08%28VS.80%29.aspx)
- [Пользовательские элементы управления ASP.NET](https://msdn.microsoft.com/library/y6wb1a0e.aspx)

## <a name="about-the-author"></a>Об авторе

[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи ASP/ASP.NET и основателя из [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Майкрософт с 1998 года. Скотт — независимый консультант, trainer и записи. Его последняя книга — [ *диспетчерами учат самостоятельно ASP.NET 2.0 в течение 24 часов*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco). Он может быть достигнута по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) или через его блог, который можно найти в [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).

## <a name="special-thanks-to"></a>Благодарности

Этот учебник ряд прошел проверку многие полезные рецензентов. Основными редакторами этого учебника были (Liz Shulok), Деннис Патерсона и – Хилтон Гизнау. Объясняются моих последующих статей для MSDN? Если Да, напишите мне по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)

> [!div class="step-by-step"]
> [Назад](creating-a-business-logic-layer-vb.md)
