---
uid: web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
title: "Сортировка данных в DataList или управления повторителем (C#) | Документы Microsoft"
author: rick-anderson
description: "В этом учебнике мы рассмотрим, как для включения поддержки в DataList и повторителя сортировки, а также как создать DataList или повторителя, данные которого можно..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 11/13/2006
ms.topic: article
ms.assetid: f52c302a-1b7c-46fe-8a13-8412c95cbf6d
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
msc.type: authoredcontent
ms.openlocfilehash: cfd0cdb0afe3bf71686715c0b1891adfbbd5019a
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2018
---
<a name="sorting-data-in-a-datalist-or-repeater-control-c"></a><span data-ttu-id="aa314-103">Сортировка данных в DataList или управления повторителем (C#)</span><span class="sxs-lookup"><span data-stu-id="aa314-103">Sorting Data in a DataList or Repeater Control (C#)</span></span>
====================
<span data-ttu-id="aa314-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="aa314-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="aa314-105">[Загрузить пример приложения](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe) или [скачать PDF](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="aa314-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe) or [Download PDF](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span></span>

> <span data-ttu-id="aa314-106">В этом учебнике мы рассмотрим, как для включения поддержки в DataList и повторителя сортировки, а также как создать DataList или повторителя, данные можно разбиением на страницы и сортировки.</span><span class="sxs-lookup"><span data-stu-id="aa314-106">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>


## <a name="introduction"></a><span data-ttu-id="aa314-107">Вступление</span><span class="sxs-lookup"><span data-stu-id="aa314-107">Introduction</span></span>

<span data-ttu-id="aa314-108">В [с предыдущим учебником](paging-report-data-in-a-datalist-or-repeater-control-cs.md) мы рассмотрели, как добавить поддержку разбиения по страницам в DataList.</span><span class="sxs-lookup"><span data-stu-id="aa314-108">In the [previous tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to add paging support to a DataList.</span></span> <span data-ttu-id="aa314-109">Мы создали новый метод в `ProductsBLL` класса (`GetProductsAsPagedDataSource`), которые вернули `PagedDataSource` объекта.</span><span class="sxs-lookup"><span data-stu-id="aa314-109">We created a new method in the `ProductsBLL` class (`GetProductsAsPagedDataSource`) that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="aa314-110">При привязке к DataList или повторителя, DataList или повторителя бы отобразить запрошенную страницу данных.</span><span class="sxs-lookup"><span data-stu-id="aa314-110">When bound to a DataList or Repeater, the DataList or Repeater would display just the requested page of data.</span></span> <span data-ttu-id="aa314-111">Этот метод аналогичен чего используется внутренне элементами управления GridView, DetailsView и FormView для функционирования подкачки встроенного по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="aa314-111">This technique is similar to what is used internally by the GridView, DetailsView, and FormView controls to provide their built-in default paging functionality.</span></span>

<span data-ttu-id="aa314-112">Помимо предложения поддержка разбиения на страницы, GridView также включает без дополнительной настройки, поддержки сортировки.</span><span class="sxs-lookup"><span data-stu-id="aa314-112">In addition to offering paging support, the GridView also includes out of the box sorting support.</span></span> <span data-ttu-id="aa314-113">DataList ни повторителя предоставляет встроенные функциональные возможности сортировки; Тем не менее функциям сортировки могут быть добавлены с большой объем кода.</span><span class="sxs-lookup"><span data-stu-id="aa314-113">Neither the DataList nor Repeater provides built-in sorting functionality; however, sorting features can be added with a bit of code.</span></span> <span data-ttu-id="aa314-114">В этом учебнике мы рассмотрим, как для включения поддержки в DataList и повторителя сортировки, а также как создать DataList или повторителя, данные можно разбиением на страницы и сортировки.</span><span class="sxs-lookup"><span data-stu-id="aa314-114">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="a-review-of-sorting"></a><span data-ttu-id="aa314-115">Просмотрите сортировки</span><span class="sxs-lookup"><span data-stu-id="aa314-115">A Review of Sorting</span></span>

<span data-ttu-id="aa314-116">Как мы видели в [разбиение по страницам и сортировка данных отчета](../paging-and-sorting/paging-and-sorting-report-data-cs.md) , элемент управления GridView учебник без дополнительной настройки, поддержки сортировки.</span><span class="sxs-lookup"><span data-stu-id="aa314-116">As we saw in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-cs.md) tutorial, the GridView control provides out of the box sorting support.</span></span> <span data-ttu-id="aa314-117">Каждое поле GridView имеет связанный с ним `SortExpression`, указывающая поле данных, по которому будут сортироваться данные.</span><span class="sxs-lookup"><span data-stu-id="aa314-117">Each GridView field can have an associated `SortExpression`, which indicates the data field by which to sort the data.</span></span> <span data-ttu-id="aa314-118">Когда GridView s `AllowSorting` свойству `true`, каждое поле GridView с `SortExpression` его к просмотру в виде LinkButton заголовок имеет значение свойства.</span><span class="sxs-lookup"><span data-stu-id="aa314-118">When the GridView s `AllowSorting` property is set to `true`, each GridView field that has a `SortExpression` property value has its header rendered as a LinkButton.</span></span> <span data-ttu-id="aa314-119">Когда пользователь щелкает определенного заголовка s поле GridView, обратная передача и данных сортируется в соответствии с выбранной поле s `SortExpression`.</span><span class="sxs-lookup"><span data-stu-id="aa314-119">When a user clicks a particular GridView field s header, a postback occurs and the data is sorted according to the clicked field s `SortExpression`.</span></span>

<span data-ttu-id="aa314-120">У элемента управления GridView `SortExpression` свойства, которое хранит `SortExpression` поля GridView данные отсортированы по.</span><span class="sxs-lookup"><span data-stu-id="aa314-120">The GridView control has a `SortExpression` property as well, which stores the `SortExpression` of the GridView field the data is sorted by.</span></span> <span data-ttu-id="aa314-121">Кроме того `SortDirection` свойство указывает, является ли данные должны быть отсортированы в порядке возрастания или убывания (если пользователь нажимает кнопку, заменяется значением определенных связей заголовок поля s GridView два раза подряд, порядок сортировки).</span><span class="sxs-lookup"><span data-stu-id="aa314-121">Additionally, a `SortDirection` property indicates whether the data is to be sorted in ascending or descending order (if a user clicks a particular GridView field s header link twice in succession, the sort order is toggled).</span></span>

<span data-ttu-id="aa314-122">Если GridView привязан к элементу управления источника данных, он передает его `SortExpression` и `SortDirection` свойства к данным система управления версиями.</span><span class="sxs-lookup"><span data-stu-id="aa314-122">When the GridView is bound to its data source control, it hands off its `SortExpression` and `SortDirection` properties to the data source control.</span></span> <span data-ttu-id="aa314-123">Элемент управления источником данных извлекает данные и он сортируется в соответствии с предоставленной `SortExpression` и `SortDirection` свойства.</span><span class="sxs-lookup"><span data-stu-id="aa314-123">The data source control retrieves the data and then sorts it according to the supplied `SortExpression` and `SortDirection` properties.</span></span> <span data-ttu-id="aa314-124">После сортировки данных элемента управления источником данных возвращается к GridView.</span><span class="sxs-lookup"><span data-stu-id="aa314-124">After sorting the data, the data source control returns it to the GridView.</span></span>

<span data-ttu-id="aa314-125">Чтобы реплицировать эта функциональность с элементами управления DataList или повторителя, необходимо выполнить следующее.</span><span class="sxs-lookup"><span data-stu-id="aa314-125">To replicate this functionality with the DataList or Repeater controls, we must:</span></span>

- <span data-ttu-id="aa314-126">Создать интерфейс сортировки</span><span class="sxs-lookup"><span data-stu-id="aa314-126">Create a sorting interface</span></span>
- <span data-ttu-id="aa314-127">Помните, поле данных, по которому выполняется сортировка и тип сортировки — по возрастанию или убыванию</span><span class="sxs-lookup"><span data-stu-id="aa314-127">Remember the data field to sort by and whether to sort in ascending or descending order</span></span>
- <span data-ttu-id="aa314-128">Указать ObjectDataSource сортировку по полю данных</span><span class="sxs-lookup"><span data-stu-id="aa314-128">Instruct the ObjectDataSource to sort the data by a particular data field</span></span>

<span data-ttu-id="aa314-129">Мы исследуем в этом выпуске эти три задачи в шагах 3 и 4.</span><span class="sxs-lookup"><span data-stu-id="aa314-129">We'll tackle these three tasks in steps 3 and 4.</span></span> <span data-ttu-id="aa314-130">После этого мы изучим, как включить разбиение по страницам и сортировка в DataList и повторителя поддержки.</span><span class="sxs-lookup"><span data-stu-id="aa314-130">Following that, we'll examine how to include both paging and sorting support in a DataList or Repeater.</span></span>

## <a name="step-2-displaying-the-products-in-a-repeater"></a><span data-ttu-id="aa314-131">Шаг 2: Отображение продукты в повторитель</span><span class="sxs-lookup"><span data-stu-id="aa314-131">Step 2: Displaying the Products in a Repeater</span></span>

<span data-ttu-id="aa314-132">Прежде чем мы беспокоиться о реализации любого из функции, связанные с сортировкой, позволяют s начинается с составления списка продуктов в элементе управления повторителем.</span><span class="sxs-lookup"><span data-stu-id="aa314-132">Before we worry about implementing any of the sorting-related functionality, let s start by listing the products in a Repeater control.</span></span> <span data-ttu-id="aa314-133">Сначала откройте `Sorting.aspx` страницы в `PagingSortingDataListRepeater` папки.</span><span class="sxs-lookup"><span data-stu-id="aa314-133">Start by opening the `Sorting.aspx` page in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="aa314-134">Добавление элемента управления повторителем веб-страницы, установка его `ID` свойства `SortableProducts`.</span><span class="sxs-lookup"><span data-stu-id="aa314-134">Add a Repeater control to the web page, setting its `ID` property to `SortableProducts`.</span></span> <span data-ttu-id="aa314-135">Смарт-тег повторителя s, создайте новый элемент управления ObjectDataSource с именем `ProductsDataSource` и настройте его для получения данных из `ProductsBLL` класса s `GetProducts()` метод.</span><span class="sxs-lookup"><span data-stu-id="aa314-135">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="aa314-136">Выберите (нет) из раскрывающихся списков на вкладках INSERT, UPDATE и DELETE.</span><span class="sxs-lookup"><span data-stu-id="aa314-136">Select the (None) option from the drop-down lists in the INSERT, UPDATE, and DELETE tabs.</span></span>


<span data-ttu-id="aa314-137">[![Создайте ObjectDataSource и настройте его с помощью метода GetProductsAsPagedDataSource()](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-137">[![Create an ObjectDataSource and Configure it to Use the GetProductsAsPagedDataSource() Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span></span>

<span data-ttu-id="aa314-138">**Рис. 1**: ObjectDataSource создайте и настройте его для использования `GetProductsAsPagedDataSource()` метод ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-138">**Figure 1**: Create an ObjectDataSource and Configure it to Use the `GetProductsAsPagedDataSource()` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png))</span></span>


<span data-ttu-id="aa314-139">[![Установите раскрывающихся списков в UPDATE, INSERT и удаление вкладок (нет)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-139">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span></span>

<span data-ttu-id="aa314-140">**На рисунке 2**: установите раскрывающихся списков в UPDATE, INSERT и удаление вкладок (нет) ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-140">**Figure 2**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None) ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png))</span></span>


<span data-ttu-id="aa314-141">В отличие от с DataList, Visual Studio не создает автоматически `ItemTemplate` для управления повторителем после ее привязки к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="aa314-141">Unlike with the DataList, Visual Studio does not automatically create an `ItemTemplate` for the Repeater control after binding it to a data source.</span></span> <span data-ttu-id="aa314-142">Кроме того, необходимо добавить это `ItemTemplate` декларативно, как смарт-тег элемента управления s повторителя отсутствует параметр редактирование шаблонов в DataList s.</span><span class="sxs-lookup"><span data-stu-id="aa314-142">Furthermore, we must add this `ItemTemplate` declaratively, as the Repeater control s smart tag lacks the Edit Templates option found in the DataList s.</span></span> <span data-ttu-id="aa314-143">S позволяют использовать те же `ItemTemplate` с предыдущим учебником, который отображаться название продукта s, поставщиков и категории.</span><span class="sxs-lookup"><span data-stu-id="aa314-143">Let s use the same `ItemTemplate` from the previous tutorial, which displayed the product s name, supplier, and category.</span></span>

<span data-ttu-id="aa314-144">После добавления `ItemTemplate`, повторителя и ObjectDataSource s должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="aa314-144">After adding the `ItemTemplate`, the Repeater and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample1.aspx)]

<span data-ttu-id="aa314-145">На рисунке 3 показана эту страницу при просмотре через браузер.</span><span class="sxs-lookup"><span data-stu-id="aa314-145">Figure 3 shows this page when viewed through a browser.</span></span>


<span data-ttu-id="aa314-146">[![Отображается каждый продукт s имя поставщика и категории](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-146">[![Each Product s Name, Supplier, and Category is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span></span>

<span data-ttu-id="aa314-147">**Рис. 3**: отображается каждый продукт s имя поставщика и категории ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-147">**Figure 3**: Each Product s Name, Supplier, and Category is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png))</span></span>


## <a name="step-3-instructing-the-objectdatasource-to-sort-the-data"></a><span data-ttu-id="aa314-148">Шаг 3: Указание ObjectDataSource для сортировки данных</span><span class="sxs-lookup"><span data-stu-id="aa314-148">Step 3: Instructing the ObjectDataSource to Sort the Data</span></span>

<span data-ttu-id="aa314-149">Чтобы отсортировать данные, отображаемые в повторителя, нам необходимо информировать ObjectDataSource выражения сортировки, с помощью которого данные должны быть отсортированы.</span><span class="sxs-lookup"><span data-stu-id="aa314-149">To sort the data displayed in the Repeater, we need to inform the ObjectDataSource of the sort expression by which the data should be sorted.</span></span> <span data-ttu-id="aa314-150">Прежде, чем элемент управления ObjectDataSource извлекает свои данные, сначала происходит его [ `Selecting` событий](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), который дает возможность указать выражение сортировки.</span><span class="sxs-lookup"><span data-stu-id="aa314-150">Before the ObjectDataSource retrieves its data, it first fires its [`Selecting` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), which provides an opportunity for us to specify a sort expression.</span></span> <span data-ttu-id="aa314-151">`Selecting` Обработчик событий передается объект типа [ `ObjectDataSourceSelectingEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), который имеет свойство с именем [ `Arguments` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) типа [ `DataSourceSelectArguments` ](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span><span class="sxs-lookup"><span data-stu-id="aa314-151">The `Selecting` event handler is passed an object of type [`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), which has a property named [`Arguments`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span></span> <span data-ttu-id="aa314-152">`DataSourceSelectArguments` Класс предназначен для передачи запросов, связанных с данными из объекта-получателя данных в элемент управления источником данных и включает [ `SortExpression` свойства](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span><span class="sxs-lookup"><span data-stu-id="aa314-152">The `DataSourceSelectArguments` class is designed to pass data-related requests from a consumer of data to the data source control, and includes a [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span></span>

<span data-ttu-id="aa314-153">Чтобы передать данные сортировки ObjectDataSource со страницы ASP.NET, создайте обработчик событий для `Selecting` событий и используйте следующий код:</span><span class="sxs-lookup"><span data-stu-id="aa314-153">To pass sorting information from the ASP.NET page to the ObjectDataSource, create an event handler for the `Selecting` event and use the following code:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample2.cs)]

<span data-ttu-id="aa314-154">*SortExpression* имя поля данных для сортировки данных по (например ProductName) должно быть назначено значение.</span><span class="sxs-lookup"><span data-stu-id="aa314-154">The *sortExpression* value should be assigned the name of the data field to sort the data by (such as ProductName ).</span></span> <span data-ttu-id="aa314-155">Нет связанных с направлением свойства сортировки, поэтому, если необходимо отсортировать данные в порядке убывания, добавить строку DESC для *sortExpression* значение (например ProductName DESC).</span><span class="sxs-lookup"><span data-stu-id="aa314-155">There is no sort direction-related property, so if you want to sort the data in descending order, append the string DESC to the *sortExpression* value (such as ProductName DESC ).</span></span>

<span data-ttu-id="aa314-156">Попробуйте некоторые различные жестко запрограммированные значения *sortExpression* и проверить результаты в браузере.</span><span class="sxs-lookup"><span data-stu-id="aa314-156">Go ahead and try some different hard-coded values for *sortExpression* and test the results in a browser.</span></span> <span data-ttu-id="aa314-157">Как показано на рис. 4, при использовании DESC ProductName как *sortExpression*, продукты сортируются по их именам в обратном алфавитном порядке.</span><span class="sxs-lookup"><span data-stu-id="aa314-157">As Figure 4 shows, when using ProductName DESC as the *sortExpression*, the products are sorted by their name in reverse alphabetical order.</span></span>


<span data-ttu-id="aa314-158">[![Продукты сортируются по имени в обратном алфавитном порядке](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-158">[![The Products are Sorted by their Name in Reverse Alphabetical Order](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span></span>

<span data-ttu-id="aa314-159">**Рис. 4**: продукты сортируются по имени в обратном алфавитном порядке ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-159">**Figure 4**: The Products are Sorted by their Name in Reverse Alphabetical Order ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png))</span></span>


## <a name="step-4-creating-the-sorting-interface-and-remembering-the-sort-expression-and-direction"></a><span data-ttu-id="aa314-160">Шаг 4: Создание интерфейса сортировки и запоминание выражение сортировки и направление</span><span class="sxs-lookup"><span data-stu-id="aa314-160">Step 4: Creating the Sorting Interface and Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="aa314-161">Включение поддержки в GridView сортировки преобразует текст заголовка каждого поля сортируемого s в LinkButton, при щелчке сортирует данные соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="aa314-161">Turning on sorting support in the GridView converts each sortable field s header text into a LinkButton that, when clicked, sorts the data accordingly.</span></span> <span data-ttu-id="aa314-162">Сортировки интерфейс смысл GridView, где его аккуратно расположения данных в столбцах.</span><span class="sxs-lookup"><span data-stu-id="aa314-162">Such a sorting interface makes sense for the GridView, where its data is neatly laid out in columns.</span></span> <span data-ttu-id="aa314-163">Для элементов управления DataList и повторителя Однако другой интерфейс сортировки потребуется.</span><span class="sxs-lookup"><span data-stu-id="aa314-163">For the DataList and Repeater controls, however, a different sorting interface is needed.</span></span> <span data-ttu-id="aa314-164">Общий интерфейс сортировки список данных (в отличие от сетки данных), является предоставляет поля, по которым данные могут быть отсортированы в списке.</span><span class="sxs-lookup"><span data-stu-id="aa314-164">A common sorting interface for a list of data (as opposed to a grid of data), is a drop-down list that provides the fields by which the data can be sorted.</span></span> <span data-ttu-id="aa314-165">Разрешить s реализовать такой интерфейс для этого учебника.</span><span class="sxs-lookup"><span data-stu-id="aa314-165">Let s implement such an interface for this tutorial.</span></span>

<span data-ttu-id="aa314-166">Добавить веб-управления DropDownList выше `SortableProducts` повторителя и задайте его `ID` свойства `SortBy`.</span><span class="sxs-lookup"><span data-stu-id="aa314-166">Add a DropDownList Web control above the `SortableProducts` Repeater and set its `ID` property to `SortBy`.</span></span> <span data-ttu-id="aa314-167">В окне свойств нажмите кнопку с многоточием в `Items` свойства Отображение редактора коллекций ListItem.</span><span class="sxs-lookup"><span data-stu-id="aa314-167">From the Properties window, click the ellipses in the `Items` property to bring up the ListItem Collection Editor.</span></span> <span data-ttu-id="aa314-168">Добавить `ListItem` s, чтобы сортировать данные по `ProductName`, `CategoryName`, и `SupplierName` поля.</span><span class="sxs-lookup"><span data-stu-id="aa314-168">Add `ListItem` s to sort the data by the `ProductName`, `CategoryName`, and `SupplierName` fields.</span></span> <span data-ttu-id="aa314-169">Кроме того, добавить `ListItem` Чтобы отсортировать продукты по их именам в обратном алфавитном порядке.</span><span class="sxs-lookup"><span data-stu-id="aa314-169">Also add a `ListItem` to sort the products by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="aa314-170">`ListItem` `Text` Свойства можно задать любое значение (например, имя), но `Value` свойства должно быть присвоено имя поля данных (например, ProductName).</span><span class="sxs-lookup"><span data-stu-id="aa314-170">The `ListItem` `Text` properties can be set to any value (such as Name ), but the `Value` properties must be set to the name of the data field (such as ProductName ).</span></span> <span data-ttu-id="aa314-171">Чтобы отсортировать результаты в порядке убывания, добавьте строку DESC на имя поля данных, например ProductName DESC.</span><span class="sxs-lookup"><span data-stu-id="aa314-171">To sort the results in descending order, append the string DESC to the data field name, like ProductName DESC .</span></span>


![Добавьте элемент ListItem для каждого из полей сортировки данных](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image13.png)

<span data-ttu-id="aa314-173">**Рис. 5**: добавление `ListItem` для каждого из полей сортировки данных</span><span class="sxs-lookup"><span data-stu-id="aa314-173">**Figure 5**: Add a `ListItem` for Each of the Sortable Data Fields</span></span>


<span data-ttu-id="aa314-174">Наконец добавьте кнопку веб-элемент управления справа от DropDownList.</span><span class="sxs-lookup"><span data-stu-id="aa314-174">Finally, add a Button Web control to the right of the DropDownList.</span></span> <span data-ttu-id="aa314-175">Задайте его `ID` для `RefreshRepeater` и его `Text` свойства для обновления.</span><span class="sxs-lookup"><span data-stu-id="aa314-175">Set its `ID` to `RefreshRepeater` and its `Text` property to Refresh .</span></span>

<span data-ttu-id="aa314-176">После создания `ListItem` s и добавление кнопки обновления DropDownList и кнопку s должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="aa314-176">After creating the `ListItem` s and adding the Refresh button, the DropDownList and Button s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample3.aspx)]

<span data-ttu-id="aa314-177">С завершения сортировки DropDownList мы Далее необходимо обновить ObjectDataSource s `Selecting` обработчик событий, что он использует выбранный `SortBy``ListItem` s `Value` свойство, в отличие от выражение сортировки жестко.</span><span class="sxs-lookup"><span data-stu-id="aa314-177">With the sorting DropDownList complete, we next need to update the ObjectDataSource s `Selecting` event handler so that it uses the selected `SortBy``ListItem` s `Value` property as opposed to a hard-coded sort expression.</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample4.cs)]

<span data-ttu-id="aa314-178">На этом этапе при первом просмотре странице продукты будут сначала упорядочены по `ProductName` поля данных, как оно s `SortBy` `ListItem` по умолчанию (см. рис. 6).</span><span class="sxs-lookup"><span data-stu-id="aa314-178">At this point when first visiting the page the products will initially be sorted by the `ProductName` data field, as it s the `SortBy` `ListItem` selected by default (see Figure 6).</span></span> <span data-ttu-id="aa314-179">Выбрать другой параметр, например категории сортировки, а также команда Обновить вызывает обратную передачу и повторно сортировать данные, имя категории, как показано на рис. 7.</span><span class="sxs-lookup"><span data-stu-id="aa314-179">Selecting a different sorting option such as Category and clicking Refresh will cause a postback and re-sort the data by the category name, as Figure 7 shows.</span></span>


<span data-ttu-id="aa314-180">[![Они отсортированы сначала по имени](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-180">[![The Products are Initially Sorted by their Name](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span></span>

<span data-ttu-id="aa314-181">**Рис. 6**: продуктов, которые изначально сортируются по имени ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-181">**Figure 6**: The Products are Initially Sorted by their Name ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png))</span></span>


<span data-ttu-id="aa314-182">[![Они теперь отсортированы по категориям](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-182">[![The Products are Now Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span></span>

<span data-ttu-id="aa314-183">**Рис. 7**: продуктов, которые теперь отсортированы по категориям ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-183">**Figure 7**: The Products are Now Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png))</span></span>


> [!NOTE]
> <span data-ttu-id="aa314-184">Нажав кнопку "Обновить" в результате данные быть автоматически переупорядочены так как состояние просмотра s повторителя была отключена, тем самым вызывая повторителя для повторной привязки к источнику данных для каждой обратной передачи.</span><span class="sxs-lookup"><span data-stu-id="aa314-184">Clicking the Refresh button causes the data to automatically be re-sorted because the Repeater s view state has been disabled, thereby causing the Repeater to rebind to its data source on every postback.</span></span> <span data-ttu-id="aa314-185">Если можно хранить оставить повторителя s состояние представления включен, изменения сортировки раскрывающегося списка, выиграл t повлияет на порядок сортировки.</span><span class="sxs-lookup"><span data-stu-id="aa314-185">If you ve left the Repeater s view state enabled, changing the sorting drop-down list won t have any affect on the sort order.</span></span> <span data-ttu-id="aa314-186">Чтобы исправить это, создайте обработчик событий для кнопки Обновить s `Click` событий и повторную привязку к источнику данных повторителя (путем вызова повторителя s `DataBind()` метода).</span><span class="sxs-lookup"><span data-stu-id="aa314-186">To remedy this, create an event handler for the Refresh Button s `Click` event and rebind the Repeater to its data source (by calling the Repeater s `DataBind()` method).</span></span>


## <a name="remembering-the-sort-expression-and-direction"></a><span data-ttu-id="aa314-187">Запоминание выражение сортировки и направление</span><span class="sxs-lookup"><span data-stu-id="aa314-187">Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="aa314-188">При создании сортируемого DataList или повторителя на странице, где не сортировки связанные обратных передач может произойти, оно императивного s, выражение сортировки и направление запоминать.</span><span class="sxs-lookup"><span data-stu-id="aa314-188">When creating a sortable DataList or Repeater on a page where non-sort related postbacks may occur, it s imperative that the sort expression and direction be remembered across postbacks.</span></span> <span data-ttu-id="aa314-189">Например предположим, что повторителя обновлены в этом учебнике, чтобы включить кнопку «Удалить» с каждого продукта.</span><span class="sxs-lookup"><span data-stu-id="aa314-189">For example, imagine that we updated the Repeater in this tutorial to include a Delete button with each product.</span></span> <span data-ttu-id="aa314-190">Когда пользователь нажимает кнопку удаления мы d выполнять определенный код для удаления выбранного продукта и затем привяжите данные к повторителя.</span><span class="sxs-lookup"><span data-stu-id="aa314-190">When the user clicks the Delete button we d run some code to delete the selected product and then rebind the data to the Repeater.</span></span> <span data-ttu-id="aa314-191">Если параметры сортировки, не сохраняются между обратной передачи, данные, отображаемые на экране будет возвращено исходный порядок сортировки.</span><span class="sxs-lookup"><span data-stu-id="aa314-191">If the sort details are not persisted across postback, the data displayed on screen will revert to the original sort order.</span></span>

<span data-ttu-id="aa314-192">В этом учебнике DropDownList неявно сохраняет сортировки выражения и направление в свое состояние представления для нас.</span><span class="sxs-lookup"><span data-stu-id="aa314-192">For this tutorial, the DropDownList implicitly saves the sort expression and direction in its view state for us.</span></span> <span data-ttu-id="aa314-193">Если мы использовали другой интерфейс сортировки одно с, скажем, элементов управления LinkButton, предоставленный различные параметры сортировки d необходимо уделить особое внимание следует помнить порядка сортировки во время обратной передачи.</span><span class="sxs-lookup"><span data-stu-id="aa314-193">If we were using a different sorting interface one with, say, LinkButtons that provided the various sorting options we d need to take care to remember the sort order across postbacks.</span></span> <span data-ttu-id="aa314-194">Этого можно добиться путем сохранения параметров сортировки в состояние представления страницы s путем включения параметра сортировки в строке запроса или по какой-либо другой подход состояние сохраняемости.</span><span class="sxs-lookup"><span data-stu-id="aa314-194">This could be accomplished by storing the sorting parameters in the page s view state, by including the sort parameter in the querystring, or through some other state persistence technique.</span></span>

<span data-ttu-id="aa314-195">Будущих примеры в этом учебнике исследовать, как сохранить сведения сортировки в состояние просмотра страницы s.</span><span class="sxs-lookup"><span data-stu-id="aa314-195">Future examples in this tutorial explore how to persist the sorting details in the page s view state.</span></span>

## <a name="step-5-adding-sorting-support-to-a-datalist-that-uses-default-paging"></a><span data-ttu-id="aa314-196">Шаг 5: Добавление сортировки поддержки в DataList, использующий разбиения на страницы по умолчанию</span><span class="sxs-lookup"><span data-stu-id="aa314-196">Step 5: Adding Sorting Support to a DataList that Uses Default Paging</span></span>

<span data-ttu-id="aa314-197">В [предыдущего учебника](paging-report-data-in-a-datalist-or-repeater-control-cs.md) мы рассмотрели, как реализовать разбиение на страницы по умолчанию с помощью DataList.</span><span class="sxs-lookup"><span data-stu-id="aa314-197">In the [preceding tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to implement default paging with a DataList.</span></span> <span data-ttu-id="aa314-198">Разрешить s расширить этот предыдущий пример, чтобы включить возможность сортировать разбитых на страницы данных.</span><span class="sxs-lookup"><span data-stu-id="aa314-198">Let s extend this previous example to include the ability to sort the paged data.</span></span> <span data-ttu-id="aa314-199">Сначала откройте `SortingWithDefaultPaging.aspx` и `Paging.aspx` страниц в `PagingSortingDataListRepeater` папки.</span><span class="sxs-lookup"><span data-stu-id="aa314-199">Start by opening the `SortingWithDefaultPaging.aspx` and `Paging.aspx` pages in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="aa314-200">Из `Paging.aspx` щелкните «источник», чтобы просмотреть декларативная разметка страницы s.</span><span class="sxs-lookup"><span data-stu-id="aa314-200">From the `Paging.aspx` page, click on the Source button to view the page s declarative markup.</span></span> <span data-ttu-id="aa314-201">Копировать выделенный текст (см. рис. 8) и вставьте его в декларативной разметке `SortingWithDefaultPaging.aspx` между `<asp:Content>` тегов.</span><span class="sxs-lookup"><span data-stu-id="aa314-201">Copy the selected text (see Figure 8) and paste it into the declarative markup of `SortingWithDefaultPaging.aspx` between the `<asp:Content>` tags.</span></span>


<span data-ttu-id="aa314-202">[![Реплицировать декларативная разметка в &lt;asp: Content&gt; тегов из Paging.aspx SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-202">[![Replicate the Declarative Markup in the &lt;asp:Content&gt; Tags from Paging.aspx to SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span></span>

<span data-ttu-id="aa314-203">**Рис. 8**: реплицировать декларативная разметка в `<asp:Content>` теги из `Paging.aspx` для `SortingWithDefaultPaging.aspx` ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-203">**Figure 8**: Replicate the Declarative Markup in the `<asp:Content>` Tags from `Paging.aspx` to `SortingWithDefaultPaging.aspx` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png))</span></span>


<span data-ttu-id="aa314-204">После копирования декларативная разметка, скопируйте методы и свойства в `Paging.aspx` s кода класса для класса с выделенным кодом для страницы `SortingWithDefaultPaging.aspx`.</span><span class="sxs-lookup"><span data-stu-id="aa314-204">After copying the declarative markup, copy the methods and properties in the `Paging.aspx` page s code-behind class to the code-behind class for `SortingWithDefaultPaging.aspx`.</span></span> <span data-ttu-id="aa314-205">Далее занять некоторое время для просмотра `SortingWithDefaultPaging.aspx` страницы в браузере.</span><span class="sxs-lookup"><span data-stu-id="aa314-205">Next, take a moment to view the `SortingWithDefaultPaging.aspx` page in a browser.</span></span> <span data-ttu-id="aa314-206">Она должна вести себя ту же функциональность и внешний вид, как `Paging.aspx`.</span><span class="sxs-lookup"><span data-stu-id="aa314-206">It should exhibit the same functionality and appearance as `Paging.aspx`.</span></span>

## <a name="enhancing-productsbll-to-include-a-default-paging-and-sorting-method"></a><span data-ttu-id="aa314-207">Улучшение ProductsBLL, чтобы включить разбиение по страницам и метод сортировки по умолчанию</span><span class="sxs-lookup"><span data-stu-id="aa314-207">Enhancing ProductsBLL to Include a Default Paging and Sorting Method</span></span>

<span data-ttu-id="aa314-208">В предыдущем учебнике мы создали `GetProductsAsPagedDataSource(pageIndex, pageSize)` метод в `ProductsBLL` класс, который вернул `PagedDataSource` объекта.</span><span class="sxs-lookup"><span data-stu-id="aa314-208">In the previous tutorial we created a `GetProductsAsPagedDataSource(pageIndex, pageSize)` method in the `ProductsBLL` class that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="aa314-209">Это `PagedDataSource` заполненный объект *все* продуктов (через уровень бизнес-ЛОГИКИ s `GetProducts()` метод), но при привязке к элементу управления DataList только те записи, соответствующий указанному *pageIndex* и *pageSize* отображались входных параметров.</span><span class="sxs-lookup"><span data-stu-id="aa314-209">This `PagedDataSource` object was populated with *all* of the products (via the BLL s `GetProducts()` method), but when bound to the DataList only those records corresponding to the specified *pageIndex* and *pageSize* input parameters were displayed.</span></span>

<span data-ttu-id="aa314-210">Ранее в этом учебнике мы добавили поддержку сортировки, указав выражение сортировки из ObjectDataSource s `Selecting` обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="aa314-210">Earlier in this tutorial we added sorting support by specifying the sort expression from the ObjectDataSource s `Selecting` event handler.</span></span> <span data-ttu-id="aa314-211">Это хорошо работает при ObjectDataSource возвращается объект, который можно сортировать, таких как `ProductsDataTable` возвращенных `GetProducts()` метод.</span><span class="sxs-lookup"><span data-stu-id="aa314-211">This works well when the ObjectDataSource is returned an object that can be sorted, like the `ProductsDataTable` returned by the `GetProducts()` method.</span></span> <span data-ttu-id="aa314-212">Тем не менее `PagedDataSource` объект, возвращаемый `GetProductsAsPagedDataSource` метод не поддерживает сортировку его внутреннее данных источника.</span><span class="sxs-lookup"><span data-stu-id="aa314-212">However, the `PagedDataSource` object returned by the `GetProductsAsPagedDataSource` method does not support sorting of its inner data source.</span></span> <span data-ttu-id="aa314-213">Вместо этого нужно отсортировать результаты, возвращенные `GetProducts()` метод *перед* мы поместили в `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="aa314-213">Instead, we need to sort the results returned from the `GetProducts()` method *before* we put it in the `PagedDataSource`.</span></span>

<span data-ttu-id="aa314-214">Для этого создайте новый метод в `ProductsBLL` класса `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span><span class="sxs-lookup"><span data-stu-id="aa314-214">To accomplish this, create a new method in the `ProductsBLL` class, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span></span> <span data-ttu-id="aa314-215">Чтобы отсортировать `ProductsDataTable` возвращенных `GetProducts()` метод, укажите `Sort` свойство по умолчанию `DataTableView`:</span><span class="sxs-lookup"><span data-stu-id="aa314-215">To sort the `ProductsDataTable` returned by the `GetProducts()` method, specify the `Sort` property of its default `DataTableView`:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample5.cs)]

<span data-ttu-id="aa314-216">`GetProductsSortedAsPagedDataSource` Метод лишь незначительно отличается от `GetProductsAsPagedDataSource` метод, созданный в предыдущем учебнике.</span><span class="sxs-lookup"><span data-stu-id="aa314-216">The `GetProductsSortedAsPagedDataSource` method differs only slightly from the `GetProductsAsPagedDataSource` method created in the previous tutorial.</span></span> <span data-ttu-id="aa314-217">В частности `GetProductsSortedAsPagedDataSource` принимает дополнительный параметр ввода `sortExpression` и присваивает это значение `Sort` свойство `ProductDataTable` s `DefaultView`.</span><span class="sxs-lookup"><span data-stu-id="aa314-217">In particular, `GetProductsSortedAsPagedDataSource` accepts an additional input parameter `sortExpression` and assigns this value to the `Sort` property of the `ProductDataTable` s `DefaultView`.</span></span> <span data-ttu-id="aa314-218">Несколько строк кода в более поздней версии, `PagedDataSource` присваивается объект s DataSource `ProductDataTable` s `DefaultView`.</span><span class="sxs-lookup"><span data-stu-id="aa314-218">A few lines of code later, the `PagedDataSource` object s DataSource is assigned the `ProductDataTable` s `DefaultView`.</span></span>

## <a name="calling-the-getproductssortedaspageddatasource-method-and-specifying-the-value-for-the-sortexpression-input-parameter"></a><span data-ttu-id="aa314-219">Вызов метода GetProductsSortedAsPagedDataSource и указав значение для параметра SortExpression входных данных</span><span class="sxs-lookup"><span data-stu-id="aa314-219">Calling the GetProductsSortedAsPagedDataSource Method and Specifying the Value for the SortExpression Input Parameter</span></span>

<span data-ttu-id="aa314-220">С `GetProductsSortedAsPagedDataSource` метод завершения, следующим шагом является для предоставления значения для этого параметра.</span><span class="sxs-lookup"><span data-stu-id="aa314-220">With the `GetProductsSortedAsPagedDataSource` method complete, the next step is to provide the value for this parameter.</span></span> <span data-ttu-id="aa314-221">ObjectDataSource в `SortingWithDefaultPaging.aspx` настраивается в настоящее время для вызова `GetProductsAsPagedDataSource` метод и передает два входных параметра через его `QueryStringParameters`, которые определены в `SelectParameters` коллекции.</span><span class="sxs-lookup"><span data-stu-id="aa314-221">The ObjectDataSource in `SortingWithDefaultPaging.aspx` is currently configured to call the `GetProductsAsPagedDataSource` method and passes in the two input parameters through its two `QueryStringParameters`, which are specified in the `SelectParameters` collection.</span></span> <span data-ttu-id="aa314-222">Эти два `QueryStringParameters` указывают, что источник для `GetProductsAsPagedDataSource` метод s *pageIndex* и *pageSize* параметры берутся из полей строки запроса `pageIndex` и `pageSize`.</span><span class="sxs-lookup"><span data-stu-id="aa314-222">These two `QueryStringParameters` indicate that the source for the `GetProductsAsPagedDataSource` method s *pageIndex* and *pageSize* parameters come from the querystring fields `pageIndex` and `pageSize`.</span></span>

<span data-ttu-id="aa314-223">Обновить ObjectDataSource s `SelectMethod` свойство, чтобы он вызывал новый `GetProductsSortedAsPagedDataSource` метод.</span><span class="sxs-lookup"><span data-stu-id="aa314-223">Update the ObjectDataSource s `SelectMethod` property so that it invokes the new `GetProductsSortedAsPagedDataSource` method.</span></span> <span data-ttu-id="aa314-224">Добавьте новый `QueryStringParameter` , чтобы *sortExpression* входного параметра осуществляется из поля строки запроса `sortExpression`.</span><span class="sxs-lookup"><span data-stu-id="aa314-224">Then, add a new `QueryStringParameter` so that the *sortExpression* input parameter is accessed from the querystring field `sortExpression`.</span></span> <span data-ttu-id="aa314-225">Задать `QueryStringParameter` s `DefaultValue` для ProductName.</span><span class="sxs-lookup"><span data-stu-id="aa314-225">Set the `QueryStringParameter` s `DefaultValue` to ProductName .</span></span>

<span data-ttu-id="aa314-226">После внесения этих изменений ObjectDataSource s должна выглядеть как:</span><span class="sxs-lookup"><span data-stu-id="aa314-226">After these changes, the ObjectDataSource s declarative markup should look like:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample6.aspx)]

<span data-ttu-id="aa314-227">На этом этапе `SortingWithDefaultPaging.aspx` страницы будут отсортированы результаты в алфавитном порядке по названию продукта (см. рис. 9).</span><span class="sxs-lookup"><span data-stu-id="aa314-227">At this point, the `SortingWithDefaultPaging.aspx` page will sort its results alphabetically by the product name (see Figure 9).</span></span> <span data-ttu-id="aa314-228">Это происходит потому, что по умолчанию значение ProductName передается в качестве `GetProductsSortedAsPagedDataSource` метод s *sortExpression* параметра.</span><span class="sxs-lookup"><span data-stu-id="aa314-228">This is because, by default, a value of ProductName is passed in as the `GetProductsSortedAsPagedDataSource` method s *sortExpression* parameter.</span></span>


<span data-ttu-id="aa314-229">[![По умолчанию результаты сортируются по ProductName](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-229">[![By Default, the Results are Sorted by ProductName](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span></span>

<span data-ttu-id="aa314-230">**Рис. 9**: по умолчанию результаты сортируются по `ProductName` ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-230">**Figure 9**: By Default, the Results are Sorted by `ProductName` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png))</span></span>


<span data-ttu-id="aa314-231">Если вручную добавить `sortExpression` поля строки запроса, таких как `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` результаты будут отсортированы по заданному `sortExpression`.</span><span class="sxs-lookup"><span data-stu-id="aa314-231">If you manually add a `sortExpression` querystring field such as `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` the results will be sorted by the specified `sortExpression`.</span></span> <span data-ttu-id="aa314-232">Тем не менее это `sortExpression` параметр не включается в строке запроса при переходе на другую страницу данных.</span><span class="sxs-lookup"><span data-stu-id="aa314-232">However, this `sortExpression` parameter is not included in the querystring when moving to a different page of data.</span></span> <span data-ttu-id="aa314-233">На самом деле, нажав кнопку Далее или последней страницы кнопок вернетесь нам к `Paging.aspx`!</span><span class="sxs-lookup"><span data-stu-id="aa314-233">In fact, clicking on the Next or Last page buttons takes us back to `Paging.aspx`!</span></span> <span data-ttu-id="aa314-234">Кроме того существует s в настоящее время сортировки интерфейса.</span><span class="sxs-lookup"><span data-stu-id="aa314-234">Furthermore, there s currently no sorting interface.</span></span> <span data-ttu-id="aa314-235">Единственным способом, пользователь может изменить порядок сортировки разбитых на страницы данных — путем изменения непосредственно в строку запроса.</span><span class="sxs-lookup"><span data-stu-id="aa314-235">The only way a user can change the sort order of the paged data is by manipulating the querystring directly.</span></span>

## <a name="creating-the-sorting-interface"></a><span data-ttu-id="aa314-236">Создание интерфейса сортировки</span><span class="sxs-lookup"><span data-stu-id="aa314-236">Creating the Sorting Interface</span></span>

<span data-ttu-id="aa314-237">Необходимо сначала обновить `RedirectUser` метод для отправки пользователю `SortingWithDefaultPaging.aspx` (вместо `Paging.aspx`) и для включения `sortExpression` значение в строке запроса.</span><span class="sxs-lookup"><span data-stu-id="aa314-237">We first need to update the `RedirectUser` method to send the user to `SortingWithDefaultPaging.aspx` (instead of `Paging.aspx`) and to include the `sortExpression` value in the querystring.</span></span> <span data-ttu-id="aa314-238">Также следует добавить только для чтения, уровне страниц с именем `SortExpression` свойство.</span><span class="sxs-lookup"><span data-stu-id="aa314-238">We should also add a read-only, page-level named `SortExpression` property.</span></span> <span data-ttu-id="aa314-239">Это свойство аналогично `PageIndex` и `PageSize` свойства, созданные в предыдущем учебнике возвращает значение `sortExpression` поля строки запроса, если он существует и значение по умолчанию значение (ProductName) в противном случае.</span><span class="sxs-lookup"><span data-stu-id="aa314-239">This property, similar to the `PageIndex` and `PageSize` properties created in the previous tutorial, returns the value of the `sortExpression` querystring field if it exists, and the default value ( ProductName ) otherwise.</span></span>

<span data-ttu-id="aa314-240">В настоящее время `RedirectUser` метод принимает только один входной параметр индекс страницы для отображения.</span><span class="sxs-lookup"><span data-stu-id="aa314-240">Currently the `RedirectUser` method accepts only a single input parameter the index of the page to display.</span></span> <span data-ttu-id="aa314-241">Тем не менее могут возникнуть ситуации, когда мы хотим перенаправит пользователя на определенную страницу данных с помощью выражения сортировки, отличные от какие s, указанный в строке запроса.</span><span class="sxs-lookup"><span data-stu-id="aa314-241">However, there may be times when we want to redirect the user to a particular page of data using a sort expression other than what s specified in the querystring.</span></span> <span data-ttu-id="aa314-242">Позже мы создадим интерфейс сортировки для этой страницы, которая будет содержать несколько кнопку веб-элементов управления для сортировки данных в указанном столбце.</span><span class="sxs-lookup"><span data-stu-id="aa314-242">In a moment we'll create the sorting interface for this page, which will include a series of Button Web controls for sorting the data by a specified column.</span></span> <span data-ttu-id="aa314-243">После нажатия одной из этих кнопок, мы хотим перенаправлять пользователя, передавая значение выражения сортировки, соответствующие.</span><span class="sxs-lookup"><span data-stu-id="aa314-243">When one of those Buttons is clicked, we want to redirect the user passing in the appropriate sort expression value.</span></span> <span data-ttu-id="aa314-244">Для поддержки этой функции, создайте две версии `RedirectUser` метод.</span><span class="sxs-lookup"><span data-stu-id="aa314-244">To provide this functionality, create two versions of the `RedirectUser` method.</span></span> <span data-ttu-id="aa314-245">Первый должен принимать только индекс страницы для отображения, а второй принимает выражение страницы индекса и сортировки.</span><span class="sxs-lookup"><span data-stu-id="aa314-245">The first one should accept just the page index to display, while the second one accepts the page index and sort expression.</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample7.cs)]

<span data-ttu-id="aa314-246">В первом примере в этом учебнике мы создали сортировки интерфейс, с помощью DropDownList.</span><span class="sxs-lookup"><span data-stu-id="aa314-246">In the first example in this tutorial, we created a sorting interface using a DropDownList.</span></span> <span data-ttu-id="aa314-247">В этом примере s позволяют использовать три кнопки веб-элементов управления, расположенный выше DataList один для сортировки по `ProductName`, один для `CategoryName`и один для `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="aa314-247">For this example, let s use three Button Web controls positioned above the DataList one for sorting by `ProductName`, one for `CategoryName`, and one for `SupplierName`.</span></span> <span data-ttu-id="aa314-248">Добавьте три кнопки веб-элементы управления, установка их `ID` и `Text` свойства соответствующим образом:</span><span class="sxs-lookup"><span data-stu-id="aa314-248">Add the three Button Web controls, setting their `ID` and `Text` properties appropriately:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample8.aspx)]

<span data-ttu-id="aa314-249">Создайте `Click` обработчик событий для каждого.</span><span class="sxs-lookup"><span data-stu-id="aa314-249">Next, create a `Click` event handler for each.</span></span> <span data-ttu-id="aa314-250">Обработчики событий должны вызывать `RedirectUser` метод, возврат на первую страницу, с помощью выражения сортировки соответствующего пользователя.</span><span class="sxs-lookup"><span data-stu-id="aa314-250">The event handlers should call the `RedirectUser` method, returning the user to the first page using the appropriate sort expression.</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample9.cs)]

<span data-ttu-id="aa314-251">При первом посещении страницы, данные отсортированы по названию продукта в алфавитном порядке (указывают назад на рис. 9).</span><span class="sxs-lookup"><span data-stu-id="aa314-251">When first visiting the page, the data is sorted by the product name alphabetically (refer back to Figure 9).</span></span> <span data-ttu-id="aa314-252">Нажмите кнопку Далее, чтобы перейти на вторую страницу данных, а затем нажмите кнопку сортировки, кнопка категории.</span><span class="sxs-lookup"><span data-stu-id="aa314-252">Click the Next button to advance to the second page of data and then click the Sort by Category button.</span></span> <span data-ttu-id="aa314-253">Возвращает нам на первую страницу данных, отсортированных по имени категории (см. рис. 10).</span><span class="sxs-lookup"><span data-stu-id="aa314-253">This returns us to the first page of data, sorted by category name (see Figure 10).</span></span> <span data-ttu-id="aa314-254">Аналогичным образом щелкнув кнопкой поставщиков сортировки сортирует данные по поставщикам, начиная с первой страницы данных.</span><span class="sxs-lookup"><span data-stu-id="aa314-254">Likewise, clicking the Sort by Supplier button sorts the data by supplier starting from the first page of data.</span></span> <span data-ttu-id="aa314-255">Выбор сортировки запоминается как страницам данных.</span><span class="sxs-lookup"><span data-stu-id="aa314-255">The sort choice is remembered as the data is paged through.</span></span> <span data-ttu-id="aa314-256">Рис. 11 показана страница после сортировки по категориям, а затем перейдите к странице тринадцатый данных.</span><span class="sxs-lookup"><span data-stu-id="aa314-256">Figure 11 shows the page after sorting by category and then advancing to the thirteenth page of data.</span></span>


<span data-ttu-id="aa314-257">[![Продукты отсортированные по категориям](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-257">[![The Products are Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span></span>

<span data-ttu-id="aa314-258">**Рис. 10**: продукты отсортированные по категориям ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-258">**Figure 10**: The Products are Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png))</span></span>


<span data-ttu-id="aa314-259">[![Выражение сортировки — сохраненных при разбивка на страницы через Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-259">[![The Sort Expression is Remembered When Paging Through the Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span></span>

<span data-ttu-id="aa314-260">**Рис. 11**: выражение сортировки — сохраненных при разбивка на страницы через Data ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-260">**Figure 11**: The Sort Expression is Remembered When Paging Through the Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png))</span></span>


## <a name="step-6-custom-paging-through-records-in-a-repeater"></a><span data-ttu-id="aa314-261">Шаг 6: Пользовательское разбиение по страницам по записям повторитель</span><span class="sxs-lookup"><span data-stu-id="aa314-261">Step 6: Custom Paging Through Records in a Repeater</span></span>

<span data-ttu-id="aa314-262">В примере DataList проверяются в шаге 5 страниц по данным способом подкачки неэффективным по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="aa314-262">The DataList example examined in step 5 pages through its data using the inefficient default paging technique.</span></span> <span data-ttu-id="aa314-263">При разбиении на страницы с большими объемами данных, важно использовать пользовательское разбиение по страницам.</span><span class="sxs-lookup"><span data-stu-id="aa314-263">When paging through sufficiently large amounts of data, it is imperative that custom paging be used.</span></span> <span data-ttu-id="aa314-264">В [эффективно подкачки через большие объемы данных](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md) и [сортировки пользовательских данных, разбитых на страницы](../paging-and-sorting/sorting-custom-paged-data-cs.md) учебники, мы рассмотрели различия между по умолчанию и пользовательское разбиение по страницам и созданные методы в МЕТОДА для Использование пользовательских разбиение по страницам и сортировка пользовательских разбитых на страницы данных.</span><span class="sxs-lookup"><span data-stu-id="aa314-264">Back in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md) and [Sorting Custom Paged Data](../paging-and-sorting/sorting-custom-paged-data-cs.md) tutorials, we examined the differences between default and custom paging and created methods in the BLL for utilizing custom paging and sorting custom paged data.</span></span> <span data-ttu-id="aa314-265">В частности, в этих двух предыдущих учебниках мы добавили следующие три метода `ProductsBLL` класса:</span><span class="sxs-lookup"><span data-stu-id="aa314-265">In particular, in these two previous tutorials we added the following three methods to the `ProductsBLL` class:</span></span>

- <span data-ttu-id="aa314-266">`GetProductsPaged(startRowIndex, maximumRows)`Возвращает подмножество записей, начиная с *startRowIndex* и не превышая *maximumRows*.</span><span class="sxs-lookup"><span data-stu-id="aa314-266">`GetProductsPaged(startRowIndex, maximumRows)` returns a particular subset of records starting at *startRowIndex* and not exceeding *maximumRows*.</span></span>
- <span data-ttu-id="aa314-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)`Возвращает подмножество записей, отсортированных по указанным *sortExpression* входного параметра.</span><span class="sxs-lookup"><span data-stu-id="aa314-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` returns a particular subset of records sorted by the specified *sortExpression* input parameter.</span></span>
- <span data-ttu-id="aa314-268">`TotalNumberOfProducts()`предоставляет общее число записей в `Products` таблицы базы данных.</span><span class="sxs-lookup"><span data-stu-id="aa314-268">`TotalNumberOfProducts()` provides the total number of records in the `Products` database table.</span></span>

<span data-ttu-id="aa314-269">Эти методы можно использовать для эффективного страницы и сортировки данных с помощью элемента управления DataList или повторителя.</span><span class="sxs-lookup"><span data-stu-id="aa314-269">These methods can be used to efficiently page and sort through data using a DataList or Repeater control.</span></span> <span data-ttu-id="aa314-270">Чтобы проиллюстрировать это, позволяют s начните с создания управления повторителем с настраиваемую поддержку разбиения на страницы; Затем мы добавим возможности сортировки.</span><span class="sxs-lookup"><span data-stu-id="aa314-270">To illustrate this, let s start by creating a Repeater control with custom paging support; we'll then add sorting capabilities.</span></span>

<span data-ttu-id="aa314-271">Откройте `SortingWithCustomPaging.aspx` страницы в `PagingSortingDataListRepeater` папки и добавьте повторитель страницу, установив его `ID` свойства `Products`.</span><span class="sxs-lookup"><span data-stu-id="aa314-271">Open the `SortingWithCustomPaging.aspx` page in the `PagingSortingDataListRepeater` folder and add a Repeater to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="aa314-272">Смарт-тег повторителя s, создайте новый элемент управления ObjectDataSource с именем `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="aa314-272">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="aa314-273">Настройте его для выбора данных из `ProductsBLL` класса s `GetProductsPaged` метод.</span><span class="sxs-lookup"><span data-stu-id="aa314-273">Configure it to select its data from the `ProductsBLL` class s `GetProductsPaged` method.</span></span>


<span data-ttu-id="aa314-274">[![Настройка ObjectDataSource можно использовать метод GetProductsPaged класса ProductsBLL s](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-274">[![Configure the ObjectDataSource to Use the ProductsBLL Class s GetProductsPaged Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span></span>

<span data-ttu-id="aa314-275">**Рис. 12**: Настройка ObjectDataSource для использования `ProductsBLL` класса s `GetProductsPaged` метод ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-275">**Figure 12**: Configure the ObjectDataSource to Use the `ProductsBLL` Class s `GetProductsPaged` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png))</span></span>


<span data-ttu-id="aa314-276">Задать раскрывающихся списков в UPDATE, INSERT и удаление вкладок (нет) и нажмите кнопку "Далее".</span><span class="sxs-lookup"><span data-stu-id="aa314-276">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and then click the Next button.</span></span> <span data-ttu-id="aa314-277">Мастер настройки источника данных, а теперь запрашивает источники `GetProductsPaged` метод s *startRowIndex* и *maximumRows* входных параметров.</span><span class="sxs-lookup"><span data-stu-id="aa314-277">The Configure Data Source wizard now prompts for the sources of the `GetProductsPaged` method s *startRowIndex* and *maximumRows* input parameters.</span></span> <span data-ttu-id="aa314-278">На самом деле эти параметры игнорируются.</span><span class="sxs-lookup"><span data-stu-id="aa314-278">In actuality, these input parameters are ignored.</span></span> <span data-ttu-id="aa314-279">Вместо этого *startRowIndex* и *maximumRows* значения будут передаваться в `Arguments` свойства в элемент управления ObjectDataSource s `Selecting` обработчика событий, как и как мы указали *sortExpression* в этой демонстрации первого учебника s.</span><span class="sxs-lookup"><span data-stu-id="aa314-279">Instead, the *startRowIndex* and *maximumRows* values will be passed in through the `Arguments` property in the ObjectDataSource s `Selecting` event handler, just like how we specified the *sortExpression* in this tutorial s first demo.</span></span> <span data-ttu-id="aa314-280">Таким образом оставьте параметр источника раскрывающихся списков в мастере на None.</span><span class="sxs-lookup"><span data-stu-id="aa314-280">Therefore, leave the parameter source drop-down lists in the wizard set at None .</span></span>


<span data-ttu-id="aa314-281">[![Оставьте параметр набор источников None](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-281">[![Leave the Parameter Sources Set to None](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span></span>

<span data-ttu-id="aa314-282">**Рис. 13**: оставьте параметр источников, значение None ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-282">**Figure 13**: Leave the Parameter Sources Set to None ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png))</span></span>


> [!NOTE]
> <span data-ttu-id="aa314-283">Сделать *не* набор ObjectDataSource s `EnablePaging` свойства `true`.</span><span class="sxs-lookup"><span data-stu-id="aa314-283">Do *not* set the ObjectDataSource s `EnablePaging` property to `true`.</span></span> <span data-ttu-id="aa314-284">Это приведет к ObjectDataSource автоматически включать свой собственный *startRowIndex* и *maximumRows* параметры `SelectMethod` s существующий список параметров.</span><span class="sxs-lookup"><span data-stu-id="aa314-284">This will cause the ObjectDataSource to automatically include its own *startRowIndex* and *maximumRows* parameters to the `SelectMethod` s existing parameter list.</span></span> <span data-ttu-id="aa314-285">`EnablePaging` Свойство полезно, когда пользовательские привязки постраничных данных к элементу управления GridView, DetailsView и FormView, поскольку эти элементы управления ожидает определенное поведение из ObjectDataSource s только при `EnablePaging` свойство `true`.</span><span class="sxs-lookup"><span data-stu-id="aa314-285">The `EnablePaging` property is useful when binding custom paged data to a GridView, DetailsView, or FormView control because these controls expect certain behavior from the ObjectDataSource that s only available when `EnablePaging` property is `true`.</span></span> <span data-ttu-id="aa314-286">Поскольку мы имеем вручную добавить поддержку разбиения на страницы DataList и повторителя, оставьте это свойство установлено в `false` (по умолчанию), как мы будем встраивает в необходимую функциональность непосредственно в нашу страницу ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="aa314-286">Since we have to manually add the paging support for the DataList and Repeater, leave this property set to `false` (the default), as we'll bake in the needed functionality directly within our ASP.NET page.</span></span>


<span data-ttu-id="aa314-287">Наконец, определите повторителя s `ItemTemplate` , чтобы название продукта s, категории и поставщик отображаются.</span><span class="sxs-lookup"><span data-stu-id="aa314-287">Finally, define the Repeater s `ItemTemplate` so that the product s name, category, and supplier are shown.</span></span> <span data-ttu-id="aa314-288">После внесения этих изменений повторителя и ObjectDataSource s должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="aa314-288">After these changes, the Repeater and ObjectDataSource s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample10.aspx)]

<span data-ttu-id="aa314-289">Теперь пора перейти на страницу с помощью браузера и обратите внимание, что записи не возвращаются.</span><span class="sxs-lookup"><span data-stu-id="aa314-289">Take a moment to visit the page through a browser and note that no records are returned.</span></span> <span data-ttu-id="aa314-290">Это, поскольку мы хранять еще для указания *startRowIndex* и *maximumRows* значения параметров; таким образом, значения 0 передаются в обоих.</span><span class="sxs-lookup"><span data-stu-id="aa314-290">This is because we ve yet to specify the *startRowIndex* and *maximumRows* parameter values; therefore, values of 0 are being passed in for both.</span></span> <span data-ttu-id="aa314-291">Чтобы задать эти значения, создайте обработчик событий для ObjectDataSource s `Selecting` событий и установите эти параметры программным образом значений жестко запрограммированные значения от 0 до 5, соответственно:</span><span class="sxs-lookup"><span data-stu-id="aa314-291">To specify these values, create an event handler for the ObjectDataSource s `Selecting` event and set these parameters values programmatically to hard-coded values of 0 and 5, respectively:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample11.cs)]

<span data-ttu-id="aa314-292">Благодаря этому изменению странице при просмотре через браузер, показаны первые пять продукты.</span><span class="sxs-lookup"><span data-stu-id="aa314-292">With this change, the page, when viewed through a browser, shows the first five products.</span></span>


<span data-ttu-id="aa314-293">[![Отображаются первых пяти записей](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-293">[![The First Five Records are Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span></span>

<span data-ttu-id="aa314-294">**Рис. 14**: отображаются первых пяти записей ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-294">**Figure 14**: The First Five Records are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png))</span></span>


> [!NOTE]
> <span data-ttu-id="aa314-295">Продукты, содержащиеся на рис. 14 произойти должны быть отсортированы по названию продукта, так как `GetProductsPaged` хранимую процедуру, которая выполняет эффективного пользовательского запроса подкачки упорядочивает результаты по `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="aa314-295">The products listed in Figure 14 happen to be sorted by product name because the `GetProductsPaged` stored procedure that performs the efficient custom paging query orders the results by `ProductName`.</span></span>


<span data-ttu-id="aa314-296">Чтобы разрешить пользователям перемещаться по страницам, нам нужно отслеживать индекс начальной строки и максимальное число строк и запомнить эти значения во время обратной передачи.</span><span class="sxs-lookup"><span data-stu-id="aa314-296">In order to allow the user to step through the pages, we need to keep track of the start row index and maximum rows and remember these values across postbacks.</span></span> <span data-ttu-id="aa314-297">В примере разбиения на страницы по умолчанию использовался полей строки запроса для сохранения этих значений; для этой демонстрации позволяют сохранить эту информацию в состояние просмотра страницы s s.</span><span class="sxs-lookup"><span data-stu-id="aa314-297">In the default paging example we used querystring fields to persist these values; for this demo, let s persist this information in the page s view state.</span></span> <span data-ttu-id="aa314-298">Создайте следующие два свойства:</span><span class="sxs-lookup"><span data-stu-id="aa314-298">Create the following two properties:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample12.cs)]

<span data-ttu-id="aa314-299">Затем обновите код в обработчик событий при выборе, чтобы он использовал `StartRowIndex` и `MaximumRows` свойства вместо жестко закодированные значения от 0 до 5:</span><span class="sxs-lookup"><span data-stu-id="aa314-299">Next, update the code in the Selecting event handler so that it uses the `StartRowIndex` and `MaximumRows` properties instead of the hard-coded values of 0 and 5:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample13.cs)]

<span data-ttu-id="aa314-300">На этом этапе нашу страницу по-прежнему показывает только первые пять записей.</span><span class="sxs-lookup"><span data-stu-id="aa314-300">At this point our page still shows just the first five records.</span></span> <span data-ttu-id="aa314-301">Однако с этими свойствами на месте, мы готов для создания нашей интерфейса постраничного просмотра.</span><span class="sxs-lookup"><span data-stu-id="aa314-301">However, with these properties in place, we re ready to create our paging interface.</span></span>

## <a name="adding-the-paging-interface"></a><span data-ttu-id="aa314-302">Добавление интерфейса постраничного просмотра</span><span class="sxs-lookup"><span data-stu-id="aa314-302">Adding the Paging Interface</span></span>

<span data-ttu-id="aa314-303">Let s используйте интерфейс же во-первых, назад, далее, после последнего разбиение по страницам используется в примере разбиения на страницы по умолчанию, включая Интернет метки просматривается элемент управления, отображающий какие страницы данных и существует общее количество страниц.</span><span class="sxs-lookup"><span data-stu-id="aa314-303">Let s use the same First, Previous, Next, Last paging interface used in the default paging example, including the Label Web control that displays what page of data is being viewed and how many total pages exist.</span></span> <span data-ttu-id="aa314-304">Добавьте четыре кнопки веб-элементов управления и подпись под повторителя.</span><span class="sxs-lookup"><span data-stu-id="aa314-304">Add the four Button Web controls and Label below the Repeater.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample14.aspx)]

<span data-ttu-id="aa314-305">Создайте `Click` обработчики событий для четырех кнопок.</span><span class="sxs-lookup"><span data-stu-id="aa314-305">Next, create `Click` event handlers for the four Buttons.</span></span> <span data-ttu-id="aa314-306">После нажатия одной из этих кнопок, нам нужно обновить `StartRowIndex` и привяжите данные к повторителя.</span><span class="sxs-lookup"><span data-stu-id="aa314-306">When one of these Buttons is clicked, we need to update the `StartRowIndex` and rebind the data to the Repeater.</span></span> <span data-ttu-id="aa314-307">Код для кнопки первой, предыдущую и следующую довольно проста, но для кнопки последней как мы определяем индекс начальной строки для последней странице данных?</span><span class="sxs-lookup"><span data-stu-id="aa314-307">The code for the First, Previous, and Next buttons is simple enough, but for the Last button how do we determine the start row index for the last page of data?</span></span> <span data-ttu-id="aa314-308">Для вычисления этого индекса, а также возможность определить Включение кнопок Далее и Дата последнего нам требуется узнать, сколько записей всего страниц.</span><span class="sxs-lookup"><span data-stu-id="aa314-308">To compute this index as well as being able to determine whether the Next and Last buttons should be enabled we need to know how many records in total are being paged through.</span></span> <span data-ttu-id="aa314-309">Это можно определить, вызвав `ProductsBLL` класса s `TotalNumberOfProducts()` метод.</span><span class="sxs-lookup"><span data-stu-id="aa314-309">We can determine this by calling the `ProductsBLL` class s `TotalNumberOfProducts()` method.</span></span> <span data-ttu-id="aa314-310">S позволяют создать свойство только для чтения, уровне страниц с именем `TotalRowCount` , возвращает результаты `TotalNumberOfProducts()` метод:</span><span class="sxs-lookup"><span data-stu-id="aa314-310">Let s create a read-only, page-level property named `TotalRowCount` that returns the results of the `TotalNumberOfProducts()` method:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample15.cs)]

<span data-ttu-id="aa314-311">Это свойство можно теперь определить индекс последней страницы s начальной строки.</span><span class="sxs-lookup"><span data-stu-id="aa314-311">With this property we can now determine the last page s start row index.</span></span> <span data-ttu-id="aa314-312">В частности, он s целочисленный результат из `TotalRowCount` минус 1, деленное на `MaximumRows`и умноженному `MaximumRows`.</span><span class="sxs-lookup"><span data-stu-id="aa314-312">Specifically, it s the integer result of the `TotalRowCount` minus 1 divided by `MaximumRows`, multiplied by `MaximumRows`.</span></span> <span data-ttu-id="aa314-313">Теперь можно написать `Click` обработчики событий для четырех кнопок интерфейс разбиения на страницы:</span><span class="sxs-lookup"><span data-stu-id="aa314-313">We can now write the `Click` event handlers for the four paging interface buttons:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample16.cs)]

<span data-ttu-id="aa314-314">Наконец необходимо отключить кнопки первой» и «назад в интерфейсе постраничного просмотра, при просмотре первой страницы данных и кнопок Далее и Дата последнего при просмотре на последней странице.</span><span class="sxs-lookup"><span data-stu-id="aa314-314">Finally, we need to disable the First and Previous buttons in the paging interface when viewing the first page of data and the Next and Last buttons when viewing the last page.</span></span> <span data-ttu-id="aa314-315">Для этого добавьте следующий код в элемент управления ObjectDataSource s `Selecting` обработчик событий:</span><span class="sxs-lookup"><span data-stu-id="aa314-315">To accomplish this, add the following code to the ObjectDataSource s `Selecting` event handler:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample17.cs)]

<span data-ttu-id="aa314-316">После добавления этих `Click` обработчики событий и код, чтобы включить или отключить элементы интерфейса постраничного просмотра, основанные на текущий индекс начальной строки проверять страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="aa314-316">After adding these `Click` event handlers and the code to enable or disable the paging interface elements based on the current start row index, test the page in a browser.</span></span> <span data-ttu-id="aa314-317">Как показано на рис. 15, при первом посещении страницы первого и кнопок будут отключены.</span><span class="sxs-lookup"><span data-stu-id="aa314-317">As Figure 15 illustrates, when first visiting the page the First and Previous buttons will are disabled.</span></span> <span data-ttu-id="aa314-318">Кнопки Далее показаны на второй странице данных, щелкнув последнего отображает последней страницы (см. рисунки 16 и 17).</span><span class="sxs-lookup"><span data-stu-id="aa314-318">Clicking Next shows the second page of data, while clicking Last displays the final page (see Figures 16 and 17).</span></span> <span data-ttu-id="aa314-319">При просмотре на последней странице данных кнопок "Далее" и "Дата последнего отключены.</span><span class="sxs-lookup"><span data-stu-id="aa314-319">When viewing the last page of data both the Next and Last buttons are disabled.</span></span>


<span data-ttu-id="aa314-320">[![Назад и последней кнопки отключены при просмотре первой страницы продуктов](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-320">[![The Previous and Last Buttons are Disabled When Viewing the First Page of Products](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span></span>

<span data-ttu-id="aa314-321">**Рис. 15**: Previous и последней кнопки отключены при просмотре первой страницы продуктов ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-321">**Figure 15**: The Previous and Last Buttons are Disabled When Viewing the First Page of Products ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png))</span></span>


<span data-ttu-id="aa314-322">[![Вторая страница продуктов, которые вывод](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-322">[![The Second Page of Products are Dispalyed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span></span>

<span data-ttu-id="aa314-323">**На рисунке 16**: второй страницы продукты, вывод ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-323">**Figure 16**: The Second Page of Products are Dispalyed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png))</span></span>


<span data-ttu-id="aa314-324">[![Нажав кнопку последней отображаются на последней странице данных](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-324">[![Clicking Last Displays the Final Page of Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span></span>

<span data-ttu-id="aa314-325">**Рисунок 17**: при щелчке последнего отображаются данные из последней страницы ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-325">**Figure 17**: Clicking Last Displays the Final Page of Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png))</span></span>


## <a name="step-7-including-sorting-support-with-the-custom-paged-repeater"></a><span data-ttu-id="aa314-326">Шаг 7., Включая поддержки со специальной сортировки разбитых на страницы повторителя</span><span class="sxs-lookup"><span data-stu-id="aa314-326">Step 7: Including Sorting Support with the Custom Paged Repeater</span></span>

<span data-ttu-id="aa314-327">Теперь, когда используется пользовательское разбиение по страницам, повторно все готово для включения сортировки поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="aa314-327">Now that custom paging has been implemented, we re ready to include sorting support.</span></span> <span data-ttu-id="aa314-328">`ProductsBLL` Класса s `GetProductsPagedAndSorted` метод имеет те же *startRowIndex* и *maximumRows* входных параметров, как `GetProductsPaged`, но позволяет использовать дополнительный  *sortExpression* входного параметра.</span><span class="sxs-lookup"><span data-stu-id="aa314-328">The `ProductsBLL` class s `GetProductsPagedAndSorted` method has the same *startRowIndex* and *maximumRows* input parameters as `GetProductsPaged`, but permits an additional *sortExpression* input parameter.</span></span> <span data-ttu-id="aa314-329">Для использования `GetProductsPagedAndSorted` метод `SortingWithCustomPaging.aspx`, необходимо выполнить следующие действия:</span><span class="sxs-lookup"><span data-stu-id="aa314-329">To use the `GetProductsPagedAndSorted` method from `SortingWithCustomPaging.aspx`, we need to perform the following steps:</span></span>

1. <span data-ttu-id="aa314-330">Изменить ObjectDataSource s `SelectMethod` свойство из `GetProductsPaged` для `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="aa314-330">Change the ObjectDataSource s `SelectMethod` property from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span>
2. <span data-ttu-id="aa314-331">Добавить *sortExpression* `Parameter` объекта ObjectDataSource s `SelectParameters` коллекции.</span><span class="sxs-lookup"><span data-stu-id="aa314-331">Add a *sortExpression* `Parameter` object to the ObjectDataSource s `SelectParameters` collection.</span></span>
3. <span data-ttu-id="aa314-332">Создать закрытый, уровне страниц `SortExpression` свойство, которое сохраняет его значение во время обратной передачи через состояния просмотра страницы s.</span><span class="sxs-lookup"><span data-stu-id="aa314-332">Create a private, page-level `SortExpression` property that persists its value across postbacks through the page s view state.</span></span>
4. <span data-ttu-id="aa314-333">Обновить ObjectDataSource s `Selecting` обработчик событий, чтобы назначить ObjectDataSource s *sortExpression* параметр значение уровня страницы `SortExpression` свойство.</span><span class="sxs-lookup"><span data-stu-id="aa314-333">Update the ObjectDataSource s `Selecting` event handler to assign the ObjectDataSource s *sortExpression* parameter the value of the page-level `SortExpression` property.</span></span>
5. <span data-ttu-id="aa314-334">Создайте интерфейс сортировки.</span><span class="sxs-lookup"><span data-stu-id="aa314-334">Create the sorting interface.</span></span>

<span data-ttu-id="aa314-335">Начните с обновления ObjectDataSource s `SelectMethod` свойств и добавления *sortExpression* `Parameter`.</span><span class="sxs-lookup"><span data-stu-id="aa314-335">Start by updating the ObjectDataSource s `SelectMethod` property and adding a *sortExpression* `Parameter`.</span></span> <span data-ttu-id="aa314-336">Убедитесь, что *sortExpression* `Parameter` s `Type` свойству `String`.</span><span class="sxs-lookup"><span data-stu-id="aa314-336">Make sure that the *sortExpression* `Parameter` s `Type` property is set to `String`.</span></span> <span data-ttu-id="aa314-337">После выполнения этих задач первых двух декларативная разметка ObjectDataSource s должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="aa314-337">After completing these first two tasks, the ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample18.aspx)]

<span data-ttu-id="aa314-338">Теперь нам нужны уровне страницы `SortExpression` свойства, значение которого сериализуется в состоянии представления.</span><span class="sxs-lookup"><span data-stu-id="aa314-338">Next, we need a page-level `SortExpression` property whose value is serialized to view state.</span></span> <span data-ttu-id="aa314-339">Если значение выражения не сортировки используйте ProductName по умолчанию:</span><span class="sxs-lookup"><span data-stu-id="aa314-339">If no sort expression value has been set, use ProductName as the default:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample19.cs)]

<span data-ttu-id="aa314-340">Перед вызывает элемент управления ObjectDataSource `GetProductsPagedAndSorted` нам нужно указать метод *sortExpression* `Parameter` значение `SortExpression` свойства.</span><span class="sxs-lookup"><span data-stu-id="aa314-340">Before the ObjectDataSource invokes the `GetProductsPagedAndSorted` method we need to set the *sortExpression* `Parameter` to the value of the `SortExpression` property.</span></span> <span data-ttu-id="aa314-341">В `Selecting` обработчика событий, добавьте следующую строку кода:</span><span class="sxs-lookup"><span data-stu-id="aa314-341">In the `Selecting` event handler, add the following line of code:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample20.cs)]

<span data-ttu-id="aa314-342">Осталось реализовать интерфейс сортировки.</span><span class="sxs-lookup"><span data-stu-id="aa314-342">All that remains is to implement the sorting interface.</span></span> <span data-ttu-id="aa314-343">Как это делалось в последнем примере позволяют s имеют сортировки интерфейс, реализованный с помощью три кнопки веб-элементы управления позволяют пользователю для сортировки результатов название продукта, категории или поставщика.</span><span class="sxs-lookup"><span data-stu-id="aa314-343">As we did in the last example, let s have the sorting interface implemented using three Button Web controls that allow the user to sort the results by product name, category, or supplier.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample21.aspx)]

<span data-ttu-id="aa314-344">Создание `Click` обработчики событий для эти три элемента управления Button.</span><span class="sxs-lookup"><span data-stu-id="aa314-344">Create `Click` event handlers for these three Button controls.</span></span> <span data-ttu-id="aa314-345">В случае сброса обработчик, `StartRowIndex` задано значение 0, `SortExpression` соответствующее значение и повторную привязку данных к повторителя:</span><span class="sxs-lookup"><span data-stu-id="aa314-345">In the event handler, reset the `StartRowIndex` to 0, set the `SortExpression` to the appropriate value, and rebind the data to the Repeater:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample22.cs)]

<span data-ttu-id="aa314-346">Все, что s — его!</span><span class="sxs-lookup"><span data-stu-id="aa314-346">That s all there is to it!</span></span> <span data-ttu-id="aa314-347">Несмотря на наличие ряд действий, чтобы получить пользовательское разбиение по страницам и сортировка реализован, действия были очень похоже на те, которые необходимы для разбиения на страницы по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="aa314-347">While there were a number of steps to get custom paging and sorting implemented, the steps were very similar to those needed for default paging.</span></span> <span data-ttu-id="aa314-348">На рисунке 18 показаны продукты, при просмотре на последней странице данных при сортировке по категориям.</span><span class="sxs-lookup"><span data-stu-id="aa314-348">Figure 18 shows the products when viewing the last page of data when sorted by category.</span></span>


<span data-ttu-id="aa314-349">[![Отображаются последние данные страницы, Sorted по категориям,](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="aa314-349">[![The Last Page of Data, Sorted by Category, is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span></span>

<span data-ttu-id="aa314-350">**На рисунке 18**: последней страницы данных, Sorted по категориям, отображается ([Просмотр полноразмерное изображение](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="aa314-350">**Figure 18**: The Last Page of Data, Sorted by Category, is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png))</span></span>


> [!NOTE]
> <span data-ttu-id="aa314-351">В предыдущих примерах, при сортировке по поставщикам, которые «название» был использован в качестве выражения сортировки.</span><span class="sxs-lookup"><span data-stu-id="aa314-351">In previous examples, when sorting by the supplier SupplierName was used as the sort expression.</span></span> <span data-ttu-id="aa314-352">Однако для реализации пользовательского разбиения на страницы, необходимо использовать CompanyName.</span><span class="sxs-lookup"><span data-stu-id="aa314-352">However, for the custom paging implementation, we need to use CompanyName.</span></span> <span data-ttu-id="aa314-353">Это, поскольку хранимая процедура отвечает за реализацию пользовательское разбиение по страницам `GetProductsPagedAndSorted` передает выражение сортировки в `ROW_NUMBER()` ключевое слово, `ROW_NUMBER()` ключевое слово требуется действительное имя столбца, а не псевдоним.</span><span class="sxs-lookup"><span data-stu-id="aa314-353">This is because the stored procedure responsible for implementing custom paging `GetProductsPagedAndSorted` passes the sort expression into the `ROW_NUMBER()` keyword, The `ROW_NUMBER()` keyword requires the actual column name rather than an alias.</span></span> <span data-ttu-id="aa314-354">Таким образом, мы используем `CompanyName` (имя столбца в `Suppliers` таблицы) вместо псевдоним, используемый в `SELECT` запроса (`SupplierName`) для выражения сортировки.</span><span class="sxs-lookup"><span data-stu-id="aa314-354">Therefore, we must use `CompanyName` (the name of the column in the `Suppliers` table) rather than the alias used in the `SELECT` query (`SupplierName`) for the sort expression.</span></span>


## <a name="summary"></a><span data-ttu-id="aa314-355">Сводка</span><span class="sxs-lookup"><span data-stu-id="aa314-355">Summary</span></span>

<span data-ttu-id="aa314-356">Ни DataList ни повторителя предоставляют встроенную поддержку сортировки, но с помощью небольшой код и пользовательский интерфейс сортировки, можно добавить такие функциональные возможности.</span><span class="sxs-lookup"><span data-stu-id="aa314-356">Neither the DataList nor Repeater offer built-in sorting support, but with a bit of code and a custom sorting interface, such functionality can be added.</span></span> <span data-ttu-id="aa314-357">При реализации сортировки, но не разбиение по страницам, выражение сортировки можно указать с помощью `DataSourceSelectArguments` , переданное в ObjectDataSource s `Select` метод.</span><span class="sxs-lookup"><span data-stu-id="aa314-357">When implementing sorting, but not paging, the sort expression can be specified through the `DataSourceSelectArguments` object passed into the ObjectDataSource s `Select` method.</span></span> <span data-ttu-id="aa314-358">Это `DataSourceSelectArguments` объект s `SortExpression` можно назначить свойства в элемент управления ObjectDataSource s `Selecting` обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="aa314-358">This `DataSourceSelectArguments` object s `SortExpression` property can be assigned in the ObjectDataSource s `Selecting` event handler.</span></span>

<span data-ttu-id="aa314-359">Чтобы добавить возможности сортировки в DataList или повторителя, который уже обеспечивает поддержку разбиения на страницы, простой подход — это настройка уровня бизнес-логики, чтобы включить метод, который принимает выражение сортировки.</span><span class="sxs-lookup"><span data-stu-id="aa314-359">To add sorting capabilities to a DataList or Repeater that already provides paging support, the easiest approach is to customize the Business Logic Layer to include a method that accepts a sort expression.</span></span> <span data-ttu-id="aa314-360">Эти данные затем можно передать в через параметр в ObjectDataSource s `SelectParameters`.</span><span class="sxs-lookup"><span data-stu-id="aa314-360">This information can then be passed in through a parameter in the ObjectDataSource s `SelectParameters`.</span></span>

<span data-ttu-id="aa314-361">Этот учебник завершает изучение разбиение по страницам и сортировка с помощью элементов управления DataList и повторителя.</span><span class="sxs-lookup"><span data-stu-id="aa314-361">This tutorial completes our examination of paging and sorting with the DataList and Repeater controls.</span></span> <span data-ttu-id="aa314-362">В этом руководстве Далее и последней проверит как добавить кнопку веб-элементов управления в DataList и повторителя s шаблоны для обеспечения функций некоторые пользовательские, инициированной пользователем отдельно для каждого элемента.</span><span class="sxs-lookup"><span data-stu-id="aa314-362">Our next and final tutorial will examine how to add Button Web controls to the DataList and Repeater s templates in order to provide some custom, user-initiated functionality on a per-item basis.</span></span>

<span data-ttu-id="aa314-363">Программирование довольны!</span><span class="sxs-lookup"><span data-stu-id="aa314-363">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="aa314-364">Об авторе</span><span class="sxs-lookup"><span data-stu-id="aa314-364">About the Author</span></span>

<span data-ttu-id="aa314-365">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи ASP/ASP.NET и основателя из [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Майкрософт с 1998 года.</span><span class="sxs-lookup"><span data-stu-id="aa314-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="aa314-366">Скотт — независимый консультант, trainer и записи.</span><span class="sxs-lookup"><span data-stu-id="aa314-366">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="aa314-367">Его последняя книга — [ *диспетчерами учат самостоятельно ASP.NET 2.0 в течение 24 часов*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="aa314-367">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="aa314-368">Он может быть достигнута по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) или через его блог, который можно найти в [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="aa314-368">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="aa314-369">Благодарности</span><span class="sxs-lookup"><span data-stu-id="aa314-369">Special Thanks To</span></span>

<span data-ttu-id="aa314-370">Этот учебник ряд прошел проверку многие полезные рецензентов.</span><span class="sxs-lookup"><span data-stu-id="aa314-370">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="aa314-371">Основной рецензент этого учебника было David Suru.</span><span class="sxs-lookup"><span data-stu-id="aa314-371">Lead reviewer for this tutorial was David Suru.</span></span> <span data-ttu-id="aa314-372">Объясняются моих последующих статей для MSDN?</span><span class="sxs-lookup"><span data-stu-id="aa314-372">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="aa314-373">Если Да, напишите мне по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="aa314-373">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="aa314-374">[Назад](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
[Вперед](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="aa314-374">[Previous](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
[Next](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span></span>
