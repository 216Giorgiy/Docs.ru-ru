---
uid: web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-with-a-dropdownlist-datalist-cs
title: "Фильтрация с помощью DropDownList (C#) иерархического | Документы Microsoft"
author: rick-anderson
description: "В этом учебнике показано, как отображать отчеты главного и подчиненного представлений одной веб-странице с помощью элементами управления DropDownList для вывода записей «master» и DataList displ..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/18/2007
ms.topic: article
ms.assetid: 07fa47ae-e491-4a2f-b265-d342b9ddef46
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-with-a-dropdownlist-datalist-cs
msc.type: authoredcontent
ms.openlocfilehash: c2199f0957f4cbe1d35dd971744087da9af1abce
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="masterdetail-filtering-with-a-dropdownlist-c"></a><span data-ttu-id="25ab9-103">Иерархического Фильтрация с помощью DropDownList (C#)</span><span class="sxs-lookup"><span data-stu-id="25ab9-103">Master/Detail Filtering With a DropDownList (C#)</span></span>
====================
<span data-ttu-id="25ab9-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="25ab9-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="25ab9-105">[Загрузить пример приложения](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_33_CS.exe) или [скачать PDF](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/datatutorial33cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="25ab9-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_33_CS.exe) or [Download PDF](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/datatutorial33cs1.pdf)</span></span>

> <span data-ttu-id="25ab9-106">В этом учебнике показано, как отображать отчеты главного и подчиненного представлений одной веб-странице с помощью элементами управления DropDownList для отображения записей «главный» и DataList для отображения «подробности».</span><span class="sxs-lookup"><span data-stu-id="25ab9-106">In this tutorial we see how to display master/detail reports in a single web page using DropDownLists to display the "master" records and a DataList to display the "details".</span></span>


## <a name="introduction"></a><span data-ttu-id="25ab9-107">Вступление</span><span class="sxs-lookup"><span data-stu-id="25ab9-107">Introduction</span></span>

<span data-ttu-id="25ab9-108">Главная и подчиненная отчет, в котором сначала создан с помощью элемента управления GridView в предыдущем [иерархического фильтрации с DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) учебник, начинается с определенного набора записей «главный».</span><span class="sxs-lookup"><span data-stu-id="25ab9-108">The master/detail report, which we first created using a GridView in the earlier [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) tutorial, begins by showing some set of "master" records.</span></span> <span data-ttu-id="25ab9-109">Пользователь может детализировать в одну главную строку тем самым просмотр этой главной записи «подробности».</span><span class="sxs-lookup"><span data-stu-id="25ab9-109">The user can then drill down into one of the master records, thereby viewing that master record's "details."</span></span> <span data-ttu-id="25ab9-110">Главная и подчиненная отчеты являются идеальным выбором для визуализации отношений один ко многим и для отображения подробных сведений из особенно «расширенный» таблиц (таблиц с большим числом столбцов).</span><span class="sxs-lookup"><span data-stu-id="25ab9-110">Master/detail reports are an ideal choice for visualizing one-to-many relationships and for displaying detailed information from particularly "wide" tables (ones that have a lot of columns).</span></span> <span data-ttu-id="25ab9-111">Мы изучили, как реализовать главного и подчиненного представлений отчетов с помощью элементов управления GridView и DetailsView в предыдущих учебниках.</span><span class="sxs-lookup"><span data-stu-id="25ab9-111">We've explored how to implement master/detail reports using the GridView and DetailsView controls in previous tutorials.</span></span> <span data-ttu-id="25ab9-112">В этом учебнике и двух следующих мы будем повторную проверку этих концепций, но фокус на использование DataList и вместо управляет повторителя.</span><span class="sxs-lookup"><span data-stu-id="25ab9-112">In this tutorial and the next two, we'll reexamine these concepts, but focus on using DataList and Repeater controls instead.</span></span>

<span data-ttu-id="25ab9-113">В этом учебнике мы рассмотрим использование DropDownList для содержат «главный» записи, с «сведения» записей, отображаемых в элементе управления DataList.</span><span class="sxs-lookup"><span data-stu-id="25ab9-113">In this tutorial, we'll look at using a DropDownList to contain the "master" records, with the "details" records displayed in a DataList.</span></span>

## <a name="step-1-adding-the-masterdetail-tutorial-web-pages"></a><span data-ttu-id="25ab9-114">Шаг 1: Добавление веб-страницы учебника главного и подчиненного представлений</span><span class="sxs-lookup"><span data-stu-id="25ab9-114">Step 1: Adding the Master/Detail Tutorial Web Pages</span></span>

<span data-ttu-id="25ab9-115">Прежде чем начать этого учебника, сначала давайте немного добавить папки и страниц ASP.NET, которые потребуются для этого учебника и работе с главного и подчиненного представлений отчетов, с помощью элементов управления DataList и повторителя двух следующих.</span><span class="sxs-lookup"><span data-stu-id="25ab9-115">Before we start this tutorial, let's first take a moment to add the folder and ASP.NET pages we'll need for this tutorial and the next two dealing with master/detail reports using the DataList and Repeater controls.</span></span> <span data-ttu-id="25ab9-116">Начните с создания новой папки в проект с именем `DataListRepeaterFiltering`.</span><span class="sxs-lookup"><span data-stu-id="25ab9-116">Start by creating a new folder in the project named `DataListRepeaterFiltering`.</span></span> <span data-ttu-id="25ab9-117">Добавьте пять страниц ASP.NET в этой папке, в которых настроен на использование главной страницы `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="25ab9-117">Next, add the following five ASP.NET pages to this folder, having all of them configured to use the master page `Site.master`:</span></span>

- `Default.aspx`
- `FilterByDropDownList.aspx`
- `CategoryListMaster.aspx`
- `ProductsForCategoryDetails.aspx`
- `CategoriesAndProducts.aspx`


![Создание папки DataListRepeaterFiltering и добавление страницы учебника по ASP.NET](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image1.png)

<span data-ttu-id="25ab9-119">**Рис. 1**: создание `DataListRepeaterFiltering` папки и добавления страниц учебника по ASP.NET</span><span class="sxs-lookup"><span data-stu-id="25ab9-119">**Figure 1**: Create a `DataListRepeaterFiltering` Folder and Add the Tutorial ASP.NET Pages</span></span>


<span data-ttu-id="25ab9-120">Затем откройте `Default.aspx` страницы и перетащите `SectionLevelTutorialListing.ascx` пользовательского элемента управления с `UserControls` папку в область конструктора.</span><span class="sxs-lookup"><span data-stu-id="25ab9-120">Next, open the `Default.aspx` page and drag the `SectionLevelTutorialListing.ascx` User Control from the `UserControls` folder onto the Design surface.</span></span> <span data-ttu-id="25ab9-121">Этот пользовательский элемент управления, который мы создали [главные страницы и переходов](../introduction/master-pages-and-site-navigation-cs.md) учебник, просматривает карту узла и отображает учебники из текущего раздела в виде маркированного списка.</span><span class="sxs-lookup"><span data-stu-id="25ab9-121">This User Control, which we created in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-cs.md) tutorial, enumerates the site map and displays the tutorials from the current section in a bulleted list.</span></span>


<span data-ttu-id="25ab9-122">[![Добавление Default.aspx SectionLevelTutorialListing.ascx пользовательского элемента управления](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image3.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="25ab9-122">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image3.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image2.png)</span></span>

<span data-ttu-id="25ab9-123">**На рисунке 2**: добавление `SectionLevelTutorialListing.ascx` пользовательского элемента управления на `Default.aspx` ([Просмотр полноразмерное изображение](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="25ab9-123">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image4.png))</span></span>


<span data-ttu-id="25ab9-124">Для отображения маркированного списка иерархического учебники, которые будут созданы, необходимо добавить их в карту узла.</span><span class="sxs-lookup"><span data-stu-id="25ab9-124">In order to have the bulleted list display the master/detail tutorials we'll be creating, we need to add them to the site map.</span></span> <span data-ttu-id="25ab9-125">Откройте `Web.sitemap` файл и добавьте следующую разметку после разметку узел карты узла «Отображение данных с DataList и повторителя»:</span><span class="sxs-lookup"><span data-stu-id="25ab9-125">Open the `Web.sitemap` file and add the following markup after the "Displaying Data with the DataList and Repeater" site map node markup:</span></span>

[!code-xml[Main](master-detail-filtering-with-a-dropdownlist-datalist-cs/samples/sample1.xml)]


![Обновление карты сайта для включения новых страниц ASP.NET](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image5.png)

<span data-ttu-id="25ab9-127">**Рис. 3**: обновление карты сайта для включения новых страниц ASP.NET</span><span class="sxs-lookup"><span data-stu-id="25ab9-127">**Figure 3**: Update the Site Map to Include the New ASP.NET Pages</span></span>


## <a name="step-2-displaying-the-categories-in-a-dropdownlist"></a><span data-ttu-id="25ab9-128">Шаг 2: Отображение категорий в DropDownList</span><span class="sxs-lookup"><span data-stu-id="25ab9-128">Step 2: Displaying the Categories in a DropDownList</span></span>

<span data-ttu-id="25ab9-129">Нашего главного и подчиненного представлений отчета будут отображаться категории в элементе управления DropDownList с продуктами выбранного элемента списка отображаются ниже на странице в DataList.</span><span class="sxs-lookup"><span data-stu-id="25ab9-129">Our master/detail report will list the categories in a DropDownList, with the selected list item's products displayed further down in the page in a DataList.</span></span> <span data-ttu-id="25ab9-130">Первой задачей, затем является отображение в элементе управления DropDownList категорий.</span><span class="sxs-lookup"><span data-stu-id="25ab9-130">The first task ahead of us, then, is to have the categories displayed in a DropDownList.</span></span> <span data-ttu-id="25ab9-131">Сначала откройте `FilterByDropDownList.aspx` страницы в `DataListRepeaterFiltering` папки и перетащите DropDownList из области элементов в конструктор страницы.</span><span class="sxs-lookup"><span data-stu-id="25ab9-131">Start by opening the `FilterByDropDownList.aspx` page in the `DataListRepeaterFiltering` folder and drag a DropDownList from the Toolbox onto the page's designer.</span></span> <span data-ttu-id="25ab9-132">Затем задайте DropDownList `ID` свойства `Categories`.</span><span class="sxs-lookup"><span data-stu-id="25ab9-132">Next, set the DropDownList's `ID` property to `Categories`.</span></span> <span data-ttu-id="25ab9-133">Щелкните ссылку в смарт-теге DropDownList Выбор источника данных и создать новый элемент управления ObjectDataSource с именем `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="25ab9-133">Click on the Choose Data Source link from the DropDownList's smart tag and create a new ObjectDataSource named `CategoriesDataSource`.</span></span>


<span data-ttu-id="25ab9-134">[![Добавить новый элемент управления ObjectDataSource CategoriesDataSource с именем](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image7.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="25ab9-134">[![Add a New ObjectDataSource Named CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image7.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image6.png)</span></span>

<span data-ttu-id="25ab9-135">**Рис. 4**: добавить новый элемент управления ObjectDataSource с именем `CategoriesDataSource` ([Просмотр полноразмерное изображение](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="25ab9-135">**Figure 4**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image8.png))</span></span>


<span data-ttu-id="25ab9-136">Настройка нового ObjectDataSource таким образом, что он вызывает `CategoriesBLL` класса `GetCategories()` метод.</span><span class="sxs-lookup"><span data-stu-id="25ab9-136">Configure the new ObjectDataSource such that it invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span> <span data-ttu-id="25ab9-137">После настройки ObjectDataSource мы по-прежнему необходимо указать поле источника данных, которые должны отображаться в раскрывающемся списке и которого должно быть связано как значение для каждого элемента списка.</span><span class="sxs-lookup"><span data-stu-id="25ab9-137">After configuring the ObjectDataSource we still need to specify what data source field should be displayed in the DropDownList and which one should be associated as the value for each list item.</span></span> <span data-ttu-id="25ab9-138">У `CategoryName` как отображение и `CategoryID` как значение для каждого элемента списка.</span><span class="sxs-lookup"><span data-stu-id="25ab9-138">Have the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>


<span data-ttu-id="25ab9-139">[![Иметь DropDownList отображения поля «Категория» и используйте CategoryID значение](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image10.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="25ab9-139">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image10.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image9.png)</span></span>

<span data-ttu-id="25ab9-140">**Рис. 5**: У отображения DropDownList `CategoryName` и использует `CategoryID` как значение ([Просмотр полноразмерное изображение](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="25ab9-140">**Figure 5**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image11.png))</span></span>


<span data-ttu-id="25ab9-141">На этом этапе у нас есть элемент управления DropDownList, заполненный записями из `Categories` таблицы (все действия выполняются за шесть секунд).</span><span class="sxs-lookup"><span data-stu-id="25ab9-141">At this point we have a DropDownList control that's populated with the records from the `Categories` table (all accomplished in about six seconds).</span></span> <span data-ttu-id="25ab9-142">Рис. 6 показан ход работы сих при просмотре через браузер.</span><span class="sxs-lookup"><span data-stu-id="25ab9-142">Figure 6 shows our progress thus far when viewed through a browser.</span></span>


<span data-ttu-id="25ab9-143">[![Раскрывающийся список с текущими категориями](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image13.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="25ab9-143">[![A Drop-Down Lists the Current Categories](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image13.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image12.png)</span></span>

<span data-ttu-id="25ab9-144">**Рис. 6**: раскрывающиеся списки текущие категории ([Просмотр полноразмерное изображение](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="25ab9-144">**Figure 6**: A Drop-Down Lists the Current Categories ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image14.png))</span></span>


## <a name="step-2-adding-the-products-datalist"></a><span data-ttu-id="25ab9-145">Шаг 2: Добавление DataList продуктов</span><span class="sxs-lookup"><span data-stu-id="25ab9-145">Step 2: Adding the Products DataList</span></span>

<span data-ttu-id="25ab9-146">В нашем отчете главного и подчиненного представлений остается перечислены продукты, связанные с выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="25ab9-146">The last step in our master/detail report is to list the products associated with the selected category.</span></span> <span data-ttu-id="25ab9-147">Для этого добавьте DataList страницы и создать новый элемент управления ObjectDataSource с именем `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="25ab9-147">To accomplish this, add a DataList to the page and create a new ObjectDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="25ab9-148">У `ProductsByCategoryDataSource` управления извлечения данных из `ProductsBLL` класса `GetProductsByCategoryID(categoryID)` метод.</span><span class="sxs-lookup"><span data-stu-id="25ab9-148">Have the `ProductsByCategoryDataSource` control retrieve its data from the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="25ab9-149">Поскольку в этом отчете главного и подчиненного представлений доступно только для чтения, выберите вариант (нет) на вкладках INSERT, UPDATE и DELETE.</span><span class="sxs-lookup"><span data-stu-id="25ab9-149">Since this master/detail report is read-only, choose the (None) option in the INSERT, UPDATE, and DELETE tabs.</span></span>


<span data-ttu-id="25ab9-150">[![Выберите метод GetProductsByCategoryID(categoryID)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image16.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="25ab9-150">[![Select the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image16.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image15.png)</span></span>

<span data-ttu-id="25ab9-151">**Рис. 7**: выберите `GetProductsByCategoryID(categoryID)` метод ([Просмотр полноразмерное изображение](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="25ab9-151">**Figure 7**: Select the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image17.png))</span></span>


<span data-ttu-id="25ab9-152">После нажатия кнопки Далее, мастер ObjectDataSource запрашивает источник значения для `GetProductsByCategoryID(categoryID)` метода  *`categoryID`*  параметра.</span><span class="sxs-lookup"><span data-stu-id="25ab9-152">After clicking Next, the ObjectDataSource wizard prompts us for the source of the value for the `GetProductsByCategoryID(categoryID)` method's *`categoryID`* parameter.</span></span> <span data-ttu-id="25ab9-153">Чтобы использовать значение выбранного `categories` источника параметра установите элемент DropDownList для элемента управления и ControlID в `Categories`.</span><span class="sxs-lookup"><span data-stu-id="25ab9-153">To use the value of the selected `categories` DropDownList item set the Parameter source to Control and the ControlID to `Categories`.</span></span>


<span data-ttu-id="25ab9-154">[![Присвоено значение из категории DropDownList categoryID параметра](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image19.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="25ab9-154">[![Set the categoryID Parameter to the Value of the Categories DropDownList](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image19.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image18.png)</span></span>

<span data-ttu-id="25ab9-155">**Рис. 8**: задать  *`categoryID`*  параметр в значение `Categories` DropDownList ([Просмотр полноразмерное изображение](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="25ab9-155">**Figure 8**: Set the *`categoryID`* Parameter to the Value of the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image20.png))</span></span>


<span data-ttu-id="25ab9-156">После завершения работы мастера настройки источника данных, Visual Studio автоматически создаст `ItemTemplate` для DataList, в котором отображаются имя и значение каждого поля данных.</span><span class="sxs-lookup"><span data-stu-id="25ab9-156">Upon completing the Configure Data Source wizard, Visual Studio will automatically generate an `ItemTemplate` for the DataList that displays the name and value of each data field.</span></span> <span data-ttu-id="25ab9-157">Давайте улучшения DataList вместо этого использовать `ItemTemplate` , отображается только название продукта, категория, поставщик, количество на единицу и цены вместе с `SeparatorTemplate` , внедряет `<hr>` элемент между каждым элементом.</span><span class="sxs-lookup"><span data-stu-id="25ab9-157">Let's enhance the DataList to instead use an `ItemTemplate` that displays just the product's name, category, supplier, quantity per unit, and price along with a `SeparatorTemplate` that injects an `<hr>` element between each item.</span></span> <span data-ttu-id="25ab9-158">Я буду использовать `ItemTemplate` из примера на [отображение данных с помощью DataList и элементы управления повторителем](../displaying-data-with-the-datalist-and-repeater/displaying-data-with-the-datalist-and-repeater-controls-cs.md) учебника, но можно использовать любой шаблон разметки можно найти наиболее привлекательный.</span><span class="sxs-lookup"><span data-stu-id="25ab9-158">I'm going to use the `ItemTemplate` from an example in the [Displaying Data with the DataList and Repeater Controls](../displaying-data-with-the-datalist-and-repeater/displaying-data-with-the-datalist-and-repeater-controls-cs.md) tutorial, but feel free to use whatever template markup you find most visually appealing.</span></span>

<span data-ttu-id="25ab9-159">После внесения этих изменений, DataList и его ObjectDataSource разметки должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="25ab9-159">After making these changes, your DataList and its ObjectDataSource's markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-datalist-cs/samples/sample2.aspx)]

<span data-ttu-id="25ab9-160">Теперь пора просмотрите ход работы в браузере.</span><span class="sxs-lookup"><span data-stu-id="25ab9-160">Take a moment to check out our progress in a browser.</span></span> <span data-ttu-id="25ab9-161">При первом посещении страницы, эти продукты, принадлежащие к выбранной категории (Напитки) отображаются (как показано на рис. 9), но изменение DropDownList данные не обновляются.</span><span class="sxs-lookup"><span data-stu-id="25ab9-161">When first visiting the page, those products belonging to the selected category (Beverages) are displayed (as shown in Figure 9), but changing the DropDownList doesn't update the data.</span></span> <span data-ttu-id="25ab9-162">Это так, как для DataList для обновления требуется выполнить обратную передачу.</span><span class="sxs-lookup"><span data-stu-id="25ab9-162">This is because a postback must occur for the DataList to update.</span></span> <span data-ttu-id="25ab9-163">Для этого мы можем либо задать DropDownList `AutoPostBack` свойства `true` или добавить кнопку веб-элемент управления на страницу.</span><span class="sxs-lookup"><span data-stu-id="25ab9-163">To accomplish this we can either set the DropDownList's `AutoPostBack` property to `true` or add a Button Web control to the page.</span></span> <span data-ttu-id="25ab9-164">В этом учебнике мы удалили задать DropDownList `AutoPostBack` свойства `true`.</span><span class="sxs-lookup"><span data-stu-id="25ab9-164">For this tutorial, I've opted to set the DropDownList's `AutoPostBack` property to `true`.</span></span>

<span data-ttu-id="25ab9-165">Рис иллюстрируют главного и подчиненного представлений отчета в действии.</span><span class="sxs-lookup"><span data-stu-id="25ab9-165">Figures 9 and 10 illustrate the master/detail report in action.</span></span>


<span data-ttu-id="25ab9-166">[![При первом посещении страницы, отображаются продукты напитков](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image22.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="25ab9-166">[![When First Visiting the Page, the Beverage Products are Displayed](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image22.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image21.png)</span></span>

<span data-ttu-id="25ab9-167">**Рис. 9**: при первом просмотре страницы, отображаются продукты напитки ([Просмотр полноразмерное изображение](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="25ab9-167">**Figure 9**: When First Visiting the Page, the Beverage Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image23.png))</span></span>


<span data-ttu-id="25ab9-168">[![Выбор нового продукта (продукты) автоматически вызывает обратную передачу, обновление DataList](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image25.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="25ab9-168">[![Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the DataList](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image25.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image24.png)</span></span>

<span data-ttu-id="25ab9-169">**Рис. 10**: Выбор нового продукта (продукты) автоматически вызывает обратную передачу, обновление DataList ([Просмотр полноразмерное изображение](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="25ab9-169">**Figure 10**: Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the DataList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image26.png))</span></span>


## <a name="adding-a----choose-a-category----list-item"></a><span data-ttu-id="25ab9-170">Добавление элемента списка «--выберите категорию--»</span><span class="sxs-lookup"><span data-stu-id="25ab9-170">Adding a "-- Choose a Category --" List Item</span></span>

<span data-ttu-id="25ab9-171">При первом просмотре `FilterByDropDownList.aspx` страницы категорий, по умолчанию, показывающая продукты Напитки в DataList выбран первый элемент списка DropDownList (Напитки).</span><span class="sxs-lookup"><span data-stu-id="25ab9-171">When first visiting the `FilterByDropDownList.aspx` page the categories DropDownList's first list item (Beverages) is selected by default, showing the beverage products in the DataList.</span></span> <span data-ttu-id="25ab9-172">В *иерархического фильтрации с DropDownList* учебника мы добавили это вариант «--выберите категорию--» в DropDownList, по умолчанию и, если флажок установлен, отображаются *все* из продукты в базе данных.</span><span class="sxs-lookup"><span data-stu-id="25ab9-172">In the *Master/Detail Filtering With a DropDownList* tutorial we added a "-- Choose a Category --" option to the DropDownList that was selected by default and, when selected, displayed *all* of the products in the database.</span></span> <span data-ttu-id="25ab9-173">Такой подход был управляемость при отображении списка продуктов в GridView, как каждая строка продукта заняло небольшого объема площадь экрана.</span><span class="sxs-lookup"><span data-stu-id="25ab9-173">Such an approach was manageable when listing the products in a GridView, as each product row took up a small amount of screen real estate.</span></span> <span data-ttu-id="25ab9-174">Тем не менее, с DataList, сведения о каждом продукте используется гораздо большего размера фрагмента экрана.</span><span class="sxs-lookup"><span data-stu-id="25ab9-174">With the DataList, however, each product's information consumes a much larger chunk of the screen.</span></span> <span data-ttu-id="25ab9-175">Давайте по-прежнему добавьте пункт «--выберите категорию--» и он выбран по умолчанию, но вместо отображения всех продуктов при выборе настроим ее, чтобы отобразить его ни одного продукта.</span><span class="sxs-lookup"><span data-stu-id="25ab9-175">Let's still add a "-- Choose a Category --" option and have it selected by default, but instead of having it show all products when selected, let's configure it so that it shows no products.</span></span>

<span data-ttu-id="25ab9-176">Чтобы добавить новый элемент списка DropDownList, перейдите в окне «Свойства» и щелкните на многоточие в `Items` свойство.</span><span class="sxs-lookup"><span data-stu-id="25ab9-176">To add a new list item to the DropDownList, go to the Properties window and click on the ellipses in the `Items` property.</span></span> <span data-ttu-id="25ab9-177">Добавление элемента списка с `Text` «--выберите категорию--» и `Value` `0`.</span><span class="sxs-lookup"><span data-stu-id="25ab9-177">Add a new list item with the `Text` "-- Choose a Category --" and the `Value` `0`.</span></span>


![Добавить](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image27.png)

<span data-ttu-id="25ab9-179">**Рис. 11**: Добавление элемента списка «--выберите категорию--»</span><span class="sxs-lookup"><span data-stu-id="25ab9-179">**Figure 11**: Add a "-- Choose a Category --" List Item</span></span>


<span data-ttu-id="25ab9-180">Кроме того можно добавить элемент списка, добавив следующую разметку DropDownList:</span><span class="sxs-lookup"><span data-stu-id="25ab9-180">Alternatively, you can add the list item by adding the following markup to the DropDownList:</span></span>

[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-datalist-cs/samples/sample3.aspx)]

<span data-ttu-id="25ab9-181">Кроме того, необходимо установить элемент управления DropDownList `AppendDataBoundItems` для `true` поскольку если задано значение `false` (по умолчанию), категории привязаны к DropDownList из ObjectDataSource они заменят любые добавленные вручную списка элементы.</span><span class="sxs-lookup"><span data-stu-id="25ab9-181">Additionally, we need to set the DropDownList control's `AppendDataBoundItems` to `true` because if it's set to `false` (the default), when the categories are bound to the DropDownList from the ObjectDataSource they'll overwrite any manually-added list items.</span></span>


![Свойство AppendDataBoundItems имеет значение True](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image28.png)

<span data-ttu-id="25ab9-183">**Рис. 12**: задать `AppendDataBoundItems` значение True</span><span class="sxs-lookup"><span data-stu-id="25ab9-183">**Figure 12**: Set the `AppendDataBoundItems` Property to True</span></span>


<span data-ttu-id="25ab9-184">По причине мы выбрали значение `0` для списка «--выберите категорию--» элемента не так, как отображаются без категорий в системе со значением `0`, таким образом записи продукта не будет возвращаться при выборе элемента списка «--выберите категорию--».</span><span class="sxs-lookup"><span data-stu-id="25ab9-184">The reason we chose the value `0` for the "-- Choose a Category --" list item is because there are no categories in the system with a value of `0`, hence no product records will be returned when the "-- Choose a Category --" list item is selected.</span></span> <span data-ttu-id="25ab9-185">Чтобы проверить это, занять некоторое время, чтобы перейти на страницу с помощью браузера.</span><span class="sxs-lookup"><span data-stu-id="25ab9-185">To confirm this, take a moment to visit the page through a browser.</span></span> <span data-ttu-id="25ab9-186">Как показано на рисунке 13, при первоначальной Просмотр страницы выбран элемент списка «--выберите категорию--» и продукты не отображаются.</span><span class="sxs-lookup"><span data-stu-id="25ab9-186">As Figure 13 shows, when initially viewing the page the "-- Choose a Category --" list item is selected and no products are displayed.</span></span>


<span data-ttu-id="25ab9-187">[![Когда](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image30.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="25ab9-187">[![When the](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image30.png)](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image29.png)</span></span>

<span data-ttu-id="25ab9-188">**Рис. 13**: при выборе элемента списка «--выберите категорию--» продукты не отображаются ([Просмотр полноразмерное изображение](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="25ab9-188">**Figure 13**: When the "-- Choose a Category --" List Item is Selected, No Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-cs/_static/image31.png))</span></span>


<span data-ttu-id="25ab9-189">Если вместо этого будет отображать *все* продуктов, при выборе параметра «– выберите категорию –», используйте значение `-1` вместо него.</span><span class="sxs-lookup"><span data-stu-id="25ab9-189">If you'd rather display *all* of the products when the "-- Choose a Category --" option is selected, use a value of `-1` instead.</span></span> <span data-ttu-id="25ab9-190">Проницательный читатель будет помните, что назад в *иерархического фильтрации с DropDownList* учебника мы обновили `ProductsBLL` класса `GetProductsByCategoryID(categoryID)` метод, чтобы если  *`categoryID`*  значение `-1` был передан в всех продуктов, возвращенных записей.</span><span class="sxs-lookup"><span data-stu-id="25ab9-190">The astute reader will recall that back in the *Master/Detail Filtering With a DropDownList* tutorial we updated the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method so that if a *`categoryID`* value of `-1` was passed in, all product records were returned.</span></span>

## <a name="summary"></a><span data-ttu-id="25ab9-191">Сводка</span><span class="sxs-lookup"><span data-stu-id="25ab9-191">Summary</span></span>

<span data-ttu-id="25ab9-192">При отображении иерархически связанных данных часто полезно для представления данных с помощью главного и подчиненного представлений отчетов, из которых пользователь может начать изучение данных в верхней части иерархии и перейти к подробным сведениям.</span><span class="sxs-lookup"><span data-stu-id="25ab9-192">When displaying hierarchically-related data, it often helps to present the data using master/detail reports, from which the user can start perusing the data from the top of the hierarchy and drill down into details.</span></span> <span data-ttu-id="25ab9-193">В этом учебнике было рассмотрено создание простого иерархического отчет, показывающий выбранной категории продуктов.</span><span class="sxs-lookup"><span data-stu-id="25ab9-193">In this tutorial we examined building a simple master/detail report showing a selected category's products.</span></span> <span data-ttu-id="25ab9-194">Это осуществлялось с помощью элемента управления DropDownList для списка категорий и DataList для продуктов, принадлежащих выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="25ab9-194">This was accomplished by using a DropDownList for the list of categories and a DataList for the products belonging to the selected category.</span></span>

<span data-ttu-id="25ab9-195">В следующем уроке мы рассмотрим разделение записей master и подробные сведения на двух страницах.</span><span class="sxs-lookup"><span data-stu-id="25ab9-195">In the next tutorial we'll look at separating the master and details records across two pages.</span></span> <span data-ttu-id="25ab9-196">На первой странице список записей «главный» будет отображаться с ссылку, чтобы просмотреть подробные сведения.</span><span class="sxs-lookup"><span data-stu-id="25ab9-196">In the first page, a list of "master" records will be displayed, with a link to view the details.</span></span> <span data-ttu-id="25ab9-197">Если щелкнуть ссылку будет whisk пользователя на второй странице отображаются сведения для выбранной записи master.</span><span class="sxs-lookup"><span data-stu-id="25ab9-197">Clicking on the link will whisk the user to the second page, which will display the details for the selected master record.</span></span>

<span data-ttu-id="25ab9-198">Программирование довольны!</span><span class="sxs-lookup"><span data-stu-id="25ab9-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="25ab9-199">Об авторе</span><span class="sxs-lookup"><span data-stu-id="25ab9-199">About the Author</span></span>

<span data-ttu-id="25ab9-200">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи ASP/ASP.NET и основателя из [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Майкрософт с 1998 года.</span><span class="sxs-lookup"><span data-stu-id="25ab9-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="25ab9-201">Скотт — независимый консультант, trainer и записи.</span><span class="sxs-lookup"><span data-stu-id="25ab9-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="25ab9-202">Его последняя книга — [ *диспетчерами учат самостоятельно ASP.NET 2.0 в течение 24 часов*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="25ab9-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="25ab9-203">Он может быть достигнута по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) или через его блог, который можно найти в [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="25ab9-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="25ab9-204">Особая благодарность</span><span class="sxs-lookup"><span data-stu-id="25ab9-204">Special Thanks To…</span></span>

<span data-ttu-id="25ab9-205">Этот учебник ряд прошел проверку многие полезные рецензентов.</span><span class="sxs-lookup"><span data-stu-id="25ab9-205">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="25ab9-206">Основной рецензент этого учебника было Рэнди Шмидт.</span><span class="sxs-lookup"><span data-stu-id="25ab9-206">Lead reviewer for this tutorial was Randy Schmidt.</span></span> <span data-ttu-id="25ab9-207">Объясняются моих последующих статей для MSDN?</span><span class="sxs-lookup"><span data-stu-id="25ab9-207">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="25ab9-208">Если Да, напишите мне по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="25ab9-208">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="25ab9-209">Вперед</span><span class="sxs-lookup"><span data-stu-id="25ab9-209">Next</span></span>](master-detail-filtering-acess-two-pages-datalist-cs.md)
