---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-vb
title: "Обзор изменения и удаления данных в DataList (VB) | Документы Microsoft"
author: rick-anderson
description: "Когда элемент управления DataList нет встроенной редактирование и удаление возможностей, в этом учебнике будет показано, как создать DataList, который поддерживает изменение и удаление o..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/30/2006
ms.topic: article
ms.assetid: 9410a23c-9697-4f07-bd71-e62b0ceac655
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-vb
msc.type: authoredcontent
ms.openlocfilehash: e08b55f763677a40a03503e54a23dc77a10a34f5
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2018
---
<a name="an-overview-of-editing-and-deleting-data-in-the-datalist-vb"></a><span data-ttu-id="69a66-103">Обзор изменения и удаления данных в DataList (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="69a66-103">An Overview of Editing and Deleting Data in the DataList (VB)</span></span>
====================
<span data-ttu-id="69a66-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="69a66-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="69a66-105">[Загрузить пример приложения](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_36_VB.exe) или [скачать PDF](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/datatutorial36vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="69a66-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_36_VB.exe) or [Download PDF](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/datatutorial36vb1.pdf)</span></span>

> <span data-ttu-id="69a66-106">Когда элемент управления DataList нет встроенной редактирование и удаление возможностей, в этом учебнике будет показано, как создать DataList, который поддерживает изменение и удаление из его базовых данных.</span><span class="sxs-lookup"><span data-stu-id="69a66-106">While the DataList lacks built-in editing and deleting capabilities, in this tutorial we'll see how to create a DataList that supports editing and deleting of its underlying data.</span></span>


## <a name="introduction"></a><span data-ttu-id="69a66-107">Вступление</span><span class="sxs-lookup"><span data-stu-id="69a66-107">Introduction</span></span>

<span data-ttu-id="69a66-108">В [Обзор Вставка, обновление и удаление данных](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) учебника мы рассмотрели вставки, обновления и удаления данных с помощью архитектуры приложения, ObjectDataSource GridView, DetailsView и FormView элементы управления.</span><span class="sxs-lookup"><span data-stu-id="69a66-108">In the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial we looked at how to insert, update, and delete data using the application architecture, an ObjectDataSource, and the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="69a66-109">ObjectDataSource и эти три данных веб-элементы управления реализация интерфейсов модификации данных простого было просто и участвуют просто отсчет флажок из смарт-тега.</span><span class="sxs-lookup"><span data-stu-id="69a66-109">With the ObjectDataSource and these three data Web controls, implementing simple data modification interfaces was a snap and involved merely ticking a checkbox from a smart tag.</span></span> <span data-ttu-id="69a66-110">Без кода, необходимого для записи.</span><span class="sxs-lookup"><span data-stu-id="69a66-110">No code needed to be written.</span></span>

<span data-ttu-id="69a66-111">К сожалению DataList не имеет встроенной, редактирование и удаление возможности, обеспечиваемые в элементе управления GridView.</span><span class="sxs-lookup"><span data-stu-id="69a66-111">Unfortunately, the DataList lacks the built-in editing and deleting capabilities inherent in the GridView control.</span></span> <span data-ttu-id="69a66-112">Эта функция отсутствует из-за частично тот факт, что DataList relic из предыдущей версии ASP.NET, если декларативный источников данных и страниц данных кода без изменения были недоступны.</span><span class="sxs-lookup"><span data-stu-id="69a66-112">This missing functionality is due in part to the fact that the DataList is a relic from the previous version of ASP.NET, when declarative data source controls and code-free data modification pages were unavailable.</span></span> <span data-ttu-id="69a66-113">Пока DataList в ASP.NET 2.0 предлагает таким же, без дополнительной настройки возможности модификации данных как GridView, мы используем ASP.NET 1.x методы для включения такой функции.</span><span class="sxs-lookup"><span data-stu-id="69a66-113">While the DataList in ASP.NET 2.0 does not offer the same out of the box data modification capabilities as the GridView, we can use ASP.NET 1.x techniques to include such functionality.</span></span> <span data-ttu-id="69a66-114">Этот подход требует большой объем кода, но, как будет показано в этом учебнике, DataList имеет некоторые события и свойства на месте для упрощения этого процесса.</span><span class="sxs-lookup"><span data-stu-id="69a66-114">This approach requires a bit of code but, as we'll see in this tutorial, the DataList has some events and properties in place to aid in this process.</span></span>

<span data-ttu-id="69a66-115">В этом учебнике мы рассмотрим создание DataList, который поддерживает изменение и удаление из его базовых данных.</span><span class="sxs-lookup"><span data-stu-id="69a66-115">In this tutorial we'll see how to create a DataList that supports editing and deleting of its underlying data.</span></span> <span data-ttu-id="69a66-116">Будущих учебниках проверит расширенного редактирования и удаление сценариев, включая поля ввода проверки, правильно обработки исключений, созданных из доступа к данным или уровни бизнес-логики и т. д.</span><span class="sxs-lookup"><span data-stu-id="69a66-116">Future tutorials will examine more advanced editing and deleting scenarios, including input field validation, gracefully handling exceptions raised from the Data Access or Business Logic Layers, and so on.</span></span>

> [!NOTE]
> <span data-ttu-id="69a66-117">Как элемент управления DataList элементе управления повторителем не имеет внешней функции поле для вставки, обновления или удаления.</span><span class="sxs-lookup"><span data-stu-id="69a66-117">Like the DataList, the Repeater control lacks the out of the box functionality for inserting, updating, or deleting.</span></span> <span data-ttu-id="69a66-118">Хотя можно добавить такие функциональные возможности, DataList включает свойства и события, не найден в Повторителе, которые упрощают добавление таких возможностей.</span><span class="sxs-lookup"><span data-stu-id="69a66-118">While such functionality can be added, the DataList includes properties and events not found in the Repeater that simplify adding such capabilities.</span></span> <span data-ttu-id="69a66-119">Таким образом этот учебник и последующие, которые отслеживают изменения и удаления будет уделяться строго DataList.</span><span class="sxs-lookup"><span data-stu-id="69a66-119">Therefore, this tutorial and future ones that look at editing and deleting will focus strictly on the DataList.</span></span>


## <a name="step-1-creating-the-editing-and-deleting-tutorials-web-pages"></a><span data-ttu-id="69a66-120">Шаг 1: Создание, редактирование и удаление учебники веб-страниц</span><span class="sxs-lookup"><span data-stu-id="69a66-120">Step 1: Creating the Editing and Deleting Tutorials Web Pages</span></span>

<span data-ttu-id="69a66-121">Прежде чем начать изучение как обновление и удаление данных из DataList, позволяют s сначала занять некоторое время для создания страниц ASP.NET в данном проекте веб-сайта, он понадобится для этого учебника и далее несколько из них.</span><span class="sxs-lookup"><span data-stu-id="69a66-121">Before we start exploring how to update and delete data from a DataList, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next several ones.</span></span> <span data-ttu-id="69a66-122">Начните с добавления в новую папку с именем `EditDeleteDataList`.</span><span class="sxs-lookup"><span data-stu-id="69a66-122">Start by adding a new folder named `EditDeleteDataList`.</span></span> <span data-ttu-id="69a66-123">Добавьте следующие страницы ASP.NET в этой папке, убедитесь, что связать каждую страницу с `Site.master` главной страницы:</span><span class="sxs-lookup"><span data-stu-id="69a66-123">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Basics.aspx`
- `BatchUpdate.aspx`
- `ErrorHandling.aspx`
- `UIValidation.aspx`
- `CustomizedUI.aspx`
- `OptimisticConcurrency.aspx`
- `ConfirmationOnDelete.aspx`
- `UserLevelAccess.aspx`


![Добавление страницы ASP.NET учебников](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image1.png)

<span data-ttu-id="69a66-125">**Рис. 1**: Добавление страницы ASP.NET учебников</span><span class="sxs-lookup"><span data-stu-id="69a66-125">**Figure 1**: Add the ASP.NET Pages for the Tutorials</span></span>


<span data-ttu-id="69a66-126">Как и в других папках, `Default.aspx` в `EditDeleteDataList` папки перечислены учебники в своем разделе.</span><span class="sxs-lookup"><span data-stu-id="69a66-126">Like in the other folders, `Default.aspx` in the `EditDeleteDataList` folder lists the tutorials in its section.</span></span> <span data-ttu-id="69a66-127">Помните, что `SectionLevelTutorialListing.ascx` пользовательский элемент управления предоставляет следующие функциональные возможности.</span><span class="sxs-lookup"><span data-stu-id="69a66-127">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="69a66-128">Таким образом, добавьте этот пользовательский элемент управления для `Default.aspx` , перетащив его из обозревателя решений на странице s представление конструктора.</span><span class="sxs-lookup"><span data-stu-id="69a66-128">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="69a66-129">[![Добавление Default.aspx SectionLevelTutorialListing.ascx пользовательского элемента управления](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image3.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="69a66-129">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image3.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image2.png)</span></span>

<span data-ttu-id="69a66-130">**На рисунке 2**: добавление `SectionLevelTutorialListing.ascx` пользовательского элемента управления на `Default.aspx` ([Просмотр полноразмерное изображение](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="69a66-130">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image4.png))</span></span>


<span data-ttu-id="69a66-131">Наконец, добавления страниц, как операции для `Web.sitemap` файла.</span><span class="sxs-lookup"><span data-stu-id="69a66-131">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="69a66-132">В частности, добавьте следующую разметку после главного и подчиненного представлений отчетов с DataList и повторителя `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="69a66-132">Specifically, add the following markup after the Master/Detail Reports with the DataList and Repeater `<siteMapNode>`:</span></span>


[!code-xml[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample1.xml)]

<span data-ttu-id="69a66-133">После обновления `Web.sitemap`, занять некоторое время для просмотра учебников веб-сайт с помощью браузера.</span><span class="sxs-lookup"><span data-stu-id="69a66-133">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="69a66-134">В левом меню теперь включает элементы для DataList, редактирование и удаление учебники.</span><span class="sxs-lookup"><span data-stu-id="69a66-134">The menu on the left now includes items for the DataList editing and deleting tutorials.</span></span>


![Карта сайта теперь содержит записи для DataList, редактирование и удаление учебники](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image5.png)

<span data-ttu-id="69a66-136">**Рис. 3**: карта сайта теперь содержит записи для DataList, редактирование и удаление учебники</span><span class="sxs-lookup"><span data-stu-id="69a66-136">**Figure 3**: The Site Map Now Includes Entries for the DataList Editing and Deleting Tutorials</span></span>


## <a name="step-2-examining-techniques-for-updating-and-deleting-data"></a><span data-ttu-id="69a66-137">Шаг 2: Проверка методы для обновление и удаление данных</span><span class="sxs-lookup"><span data-stu-id="69a66-137">Step 2: Examining Techniques for Updating and Deleting Data</span></span>

<span data-ttu-id="69a66-138">Изменение и удаление данных в GridView так просто, так как в системе, GridView и ObjectDataSource работы в сочетании.</span><span class="sxs-lookup"><span data-stu-id="69a66-138">Editing and deleting data with the GridView is so easy because, underneath the covers, the GridView and ObjectDataSource work in concert.</span></span> <span data-ttu-id="69a66-139">Как было сказано в [проверки события, связанные с вставки, обновления и удаления](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) учебника при нажатии кнопки обновления строки s GridView автоматически назначает ее полей, которые двухсторонней привязкой данных к `UpdateParameters` коллекцию методы, а затем вызывает ObjectDataSource s `Update()` метод.</span><span class="sxs-lookup"><span data-stu-id="69a66-139">As discussed in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial, when a row s Update button is clicked, the GridView automatically assigns its fields that used two-way databinding to the `UpdateParameters` collection of its ObjectDataSource and then invokes that ObjectDataSource s `Update()` method.</span></span>

<span data-ttu-id="69a66-140">К сожалению DataList не поддерживает любой из этих встроенных функциональных возможностей.</span><span class="sxs-lookup"><span data-stu-id="69a66-140">Sadly, the DataList does not provide any of this built-in functionality.</span></span> <span data-ttu-id="69a66-141">Наша ответственность, чтобы убедиться, что пользователь s значения присваиваются параметры s ObjectDataSource и его `Update()` вызывается метод.</span><span class="sxs-lookup"><span data-stu-id="69a66-141">It is our responsibility to ensure that the user s values are assigned to the ObjectDataSource s parameters and that its `Update()` method is called.</span></span> <span data-ttu-id="69a66-142">Чтобы помочь нам в эту задачу, DataList предоставляет следующие свойства и события.</span><span class="sxs-lookup"><span data-stu-id="69a66-142">To aid us in this endeavor, the DataList provides the following properties and events:</span></span>

- <span data-ttu-id="69a66-143">**[ `DataKeyField` Свойство](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeyfield.aspx)**  при обновлении или удалении, мы должны быть способны уникально идентифицировать каждого элемента в DataList.</span><span class="sxs-lookup"><span data-stu-id="69a66-143">**The [`DataKeyField` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeyfield.aspx)** when updating or deleting, we need to be able to uniquely identify each item in the DataList.</span></span> <span data-ttu-id="69a66-144">Присвойте этому свойству значение поля первичного ключа отображаемых данных.</span><span class="sxs-lookup"><span data-stu-id="69a66-144">Set this property to the primary key field of the displayed data.</span></span> <span data-ttu-id="69a66-145">Таким образом будет заполнять DataList s [ `DataKeys` коллекции](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeys.aspx) с указанным `DataKeyField` значение для каждого элемента DataList.</span><span class="sxs-lookup"><span data-stu-id="69a66-145">Doing so will populate the DataList s [`DataKeys` collection](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basedatalist.datakeys.aspx) with the specified `DataKeyField` value for each DataList item.</span></span>
- <span data-ttu-id="69a66-146">**[ `EditCommand` Событий](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.editcommand.aspx)**  возникает, когда кнопку, LinkButton или ImageButton которого `CommandName` свойству нажатии редактирования.</span><span class="sxs-lookup"><span data-stu-id="69a66-146">**The [`EditCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.editcommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Edit is clicked.</span></span>
- <span data-ttu-id="69a66-147">**[ `CancelCommand` Событий](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.cancelcommand.aspx)**  возникает, когда кнопку, LinkButton или ImageButton которого `CommandName` свойству нажатии кнопки отмены.</span><span class="sxs-lookup"><span data-stu-id="69a66-147">**The [`CancelCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.cancelcommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Cancel is clicked.</span></span>
- <span data-ttu-id="69a66-148">**[ `UpdateCommand` Событий](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.updatecommand.aspx)**  возникает, когда кнопку, LinkButton или ImageButton которого `CommandName` свойству щелчке обновления.</span><span class="sxs-lookup"><span data-stu-id="69a66-148">**The [`UpdateCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.updatecommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Update is clicked.</span></span>
- <span data-ttu-id="69a66-149">**[ `DeleteCommand` Событий](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.deletecommand.aspx)**  возникает, когда кнопку, LinkButton или ImageButton которого `CommandName` свойству нажатии Delete.</span><span class="sxs-lookup"><span data-stu-id="69a66-149">**The [`DeleteCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.deletecommand.aspx)** fires when a Button, LinkButton, or ImageButton whose `CommandName` property is set to Delete is clicked.</span></span>

<span data-ttu-id="69a66-150">С помощью этих свойств и событий, существует четыре подхода, который можно использовать для обновления и удаления данных из DataList.</span><span class="sxs-lookup"><span data-stu-id="69a66-150">Using these properties and events, there are four approaches we can use to update and delete data from the DataList:</span></span>

1. <span data-ttu-id="69a66-151">**С помощью методов ASP.NET 1.x** DataList существовали до ASP.NET 2.0 и ObjectDataSources и был в состоянии обновления и удаления данных полностью с помощью программных средств.</span><span class="sxs-lookup"><span data-stu-id="69a66-151">**Using ASP.NET 1.x Techniques** the DataList existed prior to ASP.NET 2.0 and ObjectDataSources and was able to update and delete data entirely through programmatic means.</span></span> <span data-ttu-id="69a66-152">Такой подход полностью ditches ObjectDataSource и требует, что привязка данных к уже DataList непосредственно из уровня бизнес-логики, и при получении данных для отображения и при обновлении или удалении записи.</span><span class="sxs-lookup"><span data-stu-id="69a66-152">This technique ditches the ObjectDataSource altogether and requires that we bind the data to the DataList directly from the Business Logic Layer, both in retrieving the data to display and when updating or deleting a record.</span></span>
2. <span data-ttu-id="69a66-153">**С помощью одного элемента управления ObjectDataSource на странице для выбор, обновления и удаления** когда DataList нет встроенного редактирования GridView s и удаление возможностей, отсутствует s нет необходимости, мы можем t добавьте их в сами.</span><span class="sxs-lookup"><span data-stu-id="69a66-153">**Using a Single ObjectDataSource Control on the Page for Selecting, Updating, and Deleting** while the DataList lacks the GridView s inherent editing and deleting capabilities, there s no reason we can t add them in ourselves.</span></span> <span data-ttu-id="69a66-154">В этом случае мы так же, как использовать элемент управления ObjectDataSource в примерах GridView, но необходимо создать обработчик событий для DataList s `UpdateCommand` событий, где задается параметры s ObjectDataSource и вызовите его `Update()` метод.</span><span class="sxs-lookup"><span data-stu-id="69a66-154">With this approach, we use an ObjectDataSource just like in the GridView examples, but must create an event handler for the DataList s `UpdateCommand` event where we set the ObjectDataSource s parameters and call its `Update()` method.</span></span>
3. <span data-ttu-id="69a66-155">**С помощью элемента управления ObjectDataSource выбор, но обновление и удаление непосредственно от МЕТОДА** при использовании параметра 2, нам нужно написать небольшой кода в `UpdateCommand` событий, присвоение значения параметров и т. д.</span><span class="sxs-lookup"><span data-stu-id="69a66-155">**Using an ObjectDataSource Control for Selecting, but Updating and Deleting Directly Against the BLL** when using option 2, we need to write a bit of code in the `UpdateCommand` event, assigning parameter values and so on.</span></span> <span data-ttu-id="69a66-156">Вместо этого мы можно использовать элемент управления ObjectDataSource для выбора, но необходимо обновление и удаление вызовы непосредственно для МЕТОДА (например, с параметром 1).</span><span class="sxs-lookup"><span data-stu-id="69a66-156">Instead, we can stick with using the ObjectDataSource for selecting, but make the updating and deleting calls directly against the BLL (like with option 1).</span></span> <span data-ttu-id="69a66-157">На мой взгляд, обновление данных, работая с МЕТОДА приводит к код более читаемым, чем назначение ObjectDataSource s `UpdateParameters` и вызов его `Update()` метод.</span><span class="sxs-lookup"><span data-stu-id="69a66-157">In my opinion, updating data by interfacing directly with the BLL leads to more readable code than assigning the ObjectDataSource s `UpdateParameters` and calling its `Update()` method.</span></span>
4. <span data-ttu-id="69a66-158">**С помощью декларативным образом через несколько ObjectDataSources** предыдущих все три подхода требуется большой объем кода.</span><span class="sxs-lookup"><span data-stu-id="69a66-158">**Using Declarative Means through Multiple ObjectDataSources** the previous three approaches all require a bit of code.</span></span> <span data-ttu-id="69a66-159">Если d вместо сохранять используется как гораздо декларативного синтаксиса, насколько это возможно, последний параметр является включение нескольких ObjectDataSources на странице.</span><span class="sxs-lookup"><span data-stu-id="69a66-159">If you d rather keep using as much declarative syntax as possible, a final option is to include multiple ObjectDataSources on the page.</span></span> <span data-ttu-id="69a66-160">Первый элемент управления ObjectDataSource получает данные из МЕТОДА и привязывает его к элементу управления DataList.</span><span class="sxs-lookup"><span data-stu-id="69a66-160">The first ObjectDataSource retrieves the data from the BLL and binds it to the DataList.</span></span> <span data-ttu-id="69a66-161">Для обновления, другой элемент управления ObjectDataSource добавлен, но добавить непосредственно в DataList s `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="69a66-161">For updating, another ObjectDataSource is added, but added directly within the DataList s `EditItemTemplate`.</span></span> <span data-ttu-id="69a66-162">Чтобы включить удаление поддержки, еще другой ObjectDataSource будут требоваться в `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="69a66-162">To include deleting support, yet another ObjectDataSource would be needed in the `ItemTemplate`.</span></span> <span data-ttu-id="69a66-163">При таком подходе эти внедренные использует ObjectDataSource `ControlParameters` для декларативной привязки параметров s ObjectDataSource для пользовательских элементов управления ввода (вместо того, чтобы задать их программным способом в DataList s `UpdateCommand` обработчика событий).</span><span class="sxs-lookup"><span data-stu-id="69a66-163">With this approach, these embedded ObjectDataSource s use `ControlParameters` to declaratively bind the ObjectDataSource s parameters to the user input controls (rather than having to specify them programmatically in the DataList s `UpdateCommand` event handler).</span></span> <span data-ttu-id="69a66-164">Такой подход по-прежнему требуется большой объем кода, нам потребуется вызвать внедренный элемент управления ObjectDataSource s `Update()` или `Delete()` команды, но требует гораздо меньше, чем с другими три подходы.</span><span class="sxs-lookup"><span data-stu-id="69a66-164">This approach still requires a bit of code we need to call the embedded ObjectDataSource s `Update()` or `Delete()` command but requires far less than with the other three approaches.</span></span> <span data-ttu-id="69a66-165">Недостатком здесь является то, что несколько ObjectDataSources загромождать странице отвлекать от общую читаемость.</span><span class="sxs-lookup"><span data-stu-id="69a66-165">The downside here is that the multiple ObjectDataSources do clutter up the page, detracting from the overall readability.</span></span>

<span data-ttu-id="69a66-166">Если принудительно использовать только один из следующих подходов, я d выберите параметр 1, так как он обеспечивает наибольшую гибкость, а DataList первоначально предназначалась для размещения этого шаблона.</span><span class="sxs-lookup"><span data-stu-id="69a66-166">If forced to only ever use one of these approaches, I d choose option 1 because it provides the most flexibility and because the DataList was originally designed to accommodate this pattern.</span></span> <span data-ttu-id="69a66-167">Хотя DataList была расширена для работы с элементами управления источника данных ASP.NET 2.0, он не имеет всех точек расширения или функции официальный веб-элементов управления (GridView, DetailsView и FormView) данных ASP.NET 2.0.</span><span class="sxs-lookup"><span data-stu-id="69a66-167">While the DataList was extended to work with the ASP.NET 2.0 data source controls, it does not have all of the extensibility points or features of the official ASP.NET 2.0 data Web controls (the GridView, DetailsView, and FormView).</span></span> <span data-ttu-id="69a66-168">Параметры 2 по 4, без эффективность, хотя.</span><span class="sxs-lookup"><span data-stu-id="69a66-168">Options 2 through 4 are not without merit, though.</span></span>

<span data-ttu-id="69a66-169">Это будущих редактирование и удаление учебники будет использовать ObjectDataSource для получения данных для отображения и направить вызовы МЕТОДА обновления и удаления данных (вариант 3).</span><span class="sxs-lookup"><span data-stu-id="69a66-169">This and the future editing and deleting tutorials will use an ObjectDataSource for retrieving the data to display and direct calls to the BLL to update and delete data (option 3).</span></span>

## <a name="step-3-adding-the-datalist-and-configuring-its-objectdatasource"></a><span data-ttu-id="69a66-170">Шаг 3: Добавление DataList и настройка его ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="69a66-170">Step 3: Adding the DataList and Configuring its ObjectDataSource</span></span>

<span data-ttu-id="69a66-171">В этом учебнике мы создадим DataList, который содержит сведения о продукте и для каждого продукта предоставляет пользователю возможность изменить имя и цену и полностью удалить продукт.</span><span class="sxs-lookup"><span data-stu-id="69a66-171">In this tutorial we will create a DataList that lists product information and, for each product, provides the user the ability to edit the name and price and to delete the product altogether.</span></span> <span data-ttu-id="69a66-172">В частности мы получить записи для отображения с помощью ObjectDataSource, но выполнить обновление и удаление действий, работая с МЕТОДА.</span><span class="sxs-lookup"><span data-stu-id="69a66-172">In particular, we will retrieve the records to display using an ObjectDataSource, but perform the update and delete actions by interfacing directly with the BLL.</span></span> <span data-ttu-id="69a66-173">Прежде чем мы беспокоиться о реализации возможности редактирования и удаления в DataList, позволяют s сначала перейти на страницу для отображения продуктов в интерфейсе только для чтения.</span><span class="sxs-lookup"><span data-stu-id="69a66-173">Before we worry about implementing the editing and deleting capabilities to the DataList, let s first get the page to display the products in a read-only interface.</span></span> <span data-ttu-id="69a66-174">Поскольку мы хранять проверяются следующие действия в предыдущих учебниках я будет выполняться через них быстро.</span><span class="sxs-lookup"><span data-stu-id="69a66-174">Since we ve examined these steps in previous tutorials, I'll proceed through them quickly.</span></span>

<span data-ttu-id="69a66-175">Сначала откройте `Basics.aspx` страницы в `EditDeleteDataList` папку и добавьте DataList на страницу в режиме конструктора.</span><span class="sxs-lookup"><span data-stu-id="69a66-175">Start by opening the `Basics.aspx` page in the `EditDeleteDataList` folder and, from the Design view, add a DataList to the page.</span></span> <span data-ttu-id="69a66-176">В смарт-теге DataList s, создайте новый элемент управления ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="69a66-176">Next, from the DataList s smart tag, create a new ObjectDataSource.</span></span> <span data-ttu-id="69a66-177">Поскольку мы работаем с данными о продуктах, настройте его для использования `ProductsBLL` класса.</span><span class="sxs-lookup"><span data-stu-id="69a66-177">Since we are working with product data, configure it to use the `ProductsBLL` class.</span></span> <span data-ttu-id="69a66-178">Для получения *все* выберите продукты, `GetProducts()` метод на вкладке "SELECT".</span><span class="sxs-lookup"><span data-stu-id="69a66-178">To retrieve *all* products, choose the `GetProducts()` method in the SELECT tab.</span></span>


<span data-ttu-id="69a66-179">[![Настройка ObjectDataSource с помощью класса ProductsBLL](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image7.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="69a66-179">[![Configure the ObjectDataSource to Use the ProductsBLL Class](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image7.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image6.png)</span></span>

<span data-ttu-id="69a66-180">**Рис. 4**: Настройка ObjectDataSource для использования `ProductsBLL` класса ([Просмотр полноразмерное изображение](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="69a66-180">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image8.png))</span></span>


<span data-ttu-id="69a66-181">[![Возвращает сведения о продукте, с помощью метода GetProducts()](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image10.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="69a66-181">[![Return the Product Information Using the GetProducts() Method](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image10.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image9.png)</span></span>

<span data-ttu-id="69a66-182">**Рис. 5**: возвращать сведения о продукта с помощью `GetProducts()` метод ([Просмотр полноразмерное изображение](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="69a66-182">**Figure 5**: Return the Product Information Using the `GetProducts()` Method ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image11.png))</span></span>


<span data-ttu-id="69a66-183">Элемент управления DataList, такие как GridView, не предназначена для вставки новых данных; Таким образом, выберите вариант (нет) из раскрывающегося списка на вкладке «Вставка». Также выберите (нет) для вкладок UPDATE и DELETE с момента обновления и удаления будут выполняться программным способом с помощью МЕТОДА.</span><span class="sxs-lookup"><span data-stu-id="69a66-183">The DataList, like the GridView, is not designed for inserting new data; therefore, select the (None) option from the drop-down list in the INSERT tab. Also choose (None) for the UPDATE and DELETE tabs since the updates and deletes will be performed programmatically through the BLL.</span></span>


<span data-ttu-id="69a66-184">[![Убедиться, что значение раскрывающихся списков в ObjectDataSource s вставки, обновления и удаления вкладок (нет)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image13.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="69a66-184">[![Confirm that the Drop-Down Lists in the ObjectDataSource s INSERT, UPDATE, and DELETE Tabs are Set to (None)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image13.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image12.png)</span></span>

<span data-ttu-id="69a66-185">**Рис. 6**: Убедитесь, что раскрывающемся списке указаны в ObjectDataSource s INSERT, UPDATE и удаление вкладок заданы (нет) ([Просмотр полноразмерное изображение](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="69a66-185">**Figure 6**: Confirm that the Drop-Down Lists in the ObjectDataSource s INSERT, UPDATE, and DELETE Tabs are Set to (None) ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image14.png))</span></span>


<span data-ttu-id="69a66-186">После настройки ObjectDataSource, нажмите кнопку Готово, возвращая в конструктор.</span><span class="sxs-lookup"><span data-stu-id="69a66-186">After configuring the ObjectDataSource, click Finish, returning to the Designer.</span></span> <span data-ttu-id="69a66-187">Как мы хранять показано в предыдущих примерах, после завершения настройки ObjectDataSource, Visual Studio автоматически создает `ItemTemplate` DropDownList отображение каждого из полей данных.</span><span class="sxs-lookup"><span data-stu-id="69a66-187">As we ve seen in past examples, when completing the ObjectDataSource configuration, Visual Studio automatically creates an `ItemTemplate` for the DropDownList, displaying each of the data fields.</span></span> <span data-ttu-id="69a66-188">Введите здесь `ItemTemplate` на тот, который отображает название продукта s и цену.</span><span class="sxs-lookup"><span data-stu-id="69a66-188">Replace this `ItemTemplate` with one that displays only the product s name and price.</span></span> <span data-ttu-id="69a66-189">Кроме того, задать `RepeatColumns` равным 2.</span><span class="sxs-lookup"><span data-stu-id="69a66-189">Also, set the `RepeatColumns` property to 2.</span></span>

> [!NOTE]
> <span data-ttu-id="69a66-190">Как было сказано в *Обзор Вставка, обновление и удаление данных* учебник, при изменении данных с помощью наших архитектура требует мы удаляем ObjectDataSource `OldValuesParameterFormatString` свойство из ObjectDataSource s декларативная разметка (или сбросить его значение по умолчанию `{0}`).</span><span class="sxs-lookup"><span data-stu-id="69a66-190">As discussed in the *Overview of Inserting, Updating, and Deleting Data* tutorial, when modifying data using the ObjectDataSource our architecture requires that we remove the `OldValuesParameterFormatString` property from the ObjectDataSource s declarative markup (or reset it to its default value, `{0}`).</span></span> <span data-ttu-id="69a66-191">В этом учебнике тем не менее, мы используем ObjectDataSource только для извлечения данных.</span><span class="sxs-lookup"><span data-stu-id="69a66-191">In this tutorial, however, we are using the ObjectDataSource only for retrieving data.</span></span> <span data-ttu-id="69a66-192">Таким образом, нам не нужно изменять ObjectDataSource s `OldValuesParameterFormatString` значение свойства (хотя он повредить для этого).</span><span class="sxs-lookup"><span data-stu-id="69a66-192">Therefore, we do not need to modify the ObjectDataSource s `OldValuesParameterFormatString` property value (although it doesn t hurt to do so).</span></span>


<span data-ttu-id="69a66-193">После замены по умолчанию DataList `ItemTemplate` на настроенный, на странице должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="69a66-193">After replacing the default DataList `ItemTemplate` with a customized one, the declarative markup on your page should look similar to the following:</span></span>


[!code-aspx[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample2.aspx)]

<span data-ttu-id="69a66-194">Теперь пора просмотрите ход работы через браузер.</span><span class="sxs-lookup"><span data-stu-id="69a66-194">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="69a66-195">Как показано на рис. 7, элемент управления DataList отображает продукта название и цену за единицу для каждого продукта в двух столбцах.</span><span class="sxs-lookup"><span data-stu-id="69a66-195">As Figure 7 shows, the DataList displays the product name and unit price for each product in two columns.</span></span>


<span data-ttu-id="69a66-196">[![Названия продуктов и цены отображаются в DataList два столбца](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image16.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="69a66-196">[![The Products Names and Prices are Displayed in a Two-Column DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image16.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image15.png)</span></span>

<span data-ttu-id="69a66-197">**Рис. 7**: имена продуктов и цен, отображаются в DataList двух столбцов ([Просмотр полноразмерное изображение](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="69a66-197">**Figure 7**: The Products Names and Prices are Displayed in a Two-Column DataList ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image17.png))</span></span>


> [!NOTE]
> <span data-ttu-id="69a66-198">DataList обладает рядом свойств, которые требуются для процесса обновления и удаления, и эти значения сохраняются в состоянии представления.</span><span class="sxs-lookup"><span data-stu-id="69a66-198">The DataList has a number of properties that are required for the updating and deleting process, and these values are stored in view state.</span></span> <span data-ttu-id="69a66-199">Таким образом при создании DataList, который поддерживает изменение или удаление данных, важно включить состояние просмотра s DataList.</span><span class="sxs-lookup"><span data-stu-id="69a66-199">Therefore, when building a DataList that supports editing or deleting data, it is essential that the DataList s view state be enabled.</span></span>  
>   
>  <span data-ttu-id="69a66-200">Проницательный читатель вспомнить, что мы смогли отключить состояние просмотра, при создании редактируемой GridViews DetailsViews и FormViews.</span><span class="sxs-lookup"><span data-stu-id="69a66-200">The astute reader may recall that we were able to disable view state when creating editable GridViews, DetailsViews, and FormViews.</span></span> <span data-ttu-id="69a66-201">Это так, как элементы управления ASP.NET 2.0 Web могут содержать *управления состоянием*, который сохраняется во время обратной передачи, например состояние представления, но если принято решение основные состояния.</span><span class="sxs-lookup"><span data-stu-id="69a66-201">This is because ASP.NET 2.0 Web controls can include *control state*, which is state persisted across postbacks like view state, but deemed essential.</span></span>


<span data-ttu-id="69a66-202">Отключение просмотра состояния в GridView, просто пропускает сведения о состоянии тривиальный, но сохраняет состояние элемента управления (который включает состояние, необходимое для изменения и удаления).</span><span class="sxs-lookup"><span data-stu-id="69a66-202">Disabling view state in the GridView merely omits trivial state information, but maintains the control state (which includes the state necessary for editing and deleting).</span></span> <span data-ttu-id="69a66-203">DataList, созданный на период времени 1.x ASP.NET не использует состояние элемента управления и поэтому должно быть включено состояние представления.</span><span class="sxs-lookup"><span data-stu-id="69a66-203">The DataList, having been created in the ASP.NET 1.x timeframe, does not utilize control state and therefore must have view state enabled.</span></span> <span data-ttu-id="69a66-204">В разделе [vs состояние элемента управления. Состояние представления](https://msdn.microsoft.com/library/1whwt1k7.aspx) Дополнительные сведения о назначении состояние элемента управления и его отличий от состояния просмотра.</span><span class="sxs-lookup"><span data-stu-id="69a66-204">See [Control State vs. View State](https://msdn.microsoft.com/library/1whwt1k7.aspx) for more information on the purpose of control state and how it differs from view state.</span></span>

## <a name="step-4-adding-an-editing-user-interface"></a><span data-ttu-id="69a66-205">Шаг 4: Добавление пользовательский интерфейс редактирования</span><span class="sxs-lookup"><span data-stu-id="69a66-205">Step 4: Adding an Editing User Interface</span></span>

<span data-ttu-id="69a66-206">Элемент управления GridView, состоящие из коллекции полей (стояли, CheckBoxFields, TemplateFields и т. д.).</span><span class="sxs-lookup"><span data-stu-id="69a66-206">The GridView control is composed of a collection of fields (BoundFields, CheckBoxFields, TemplateFields, and so on).</span></span> <span data-ttu-id="69a66-207">Эти поля можно настроить их отображения разметки в зависимости от их режима.</span><span class="sxs-lookup"><span data-stu-id="69a66-207">These fields can adjust their rendered markup depending on their mode.</span></span> <span data-ttu-id="69a66-208">Например в режиме только для чтения поле BoundField отображает его значение поля как текст; в режиме редактирования, но отображает Web текстовое свойство `Text` присваивается значение поля данных.</span><span class="sxs-lookup"><span data-stu-id="69a66-208">For example, when in read-only mode, a BoundField displays its data field value as text; when in edit mode, it renders a TextBox Web control whose `Text` property is assigned the data field value.</span></span>

<span data-ttu-id="69a66-209">Элемент управления DataList с другой стороны, отображает его элементы, с помощью шаблонов.</span><span class="sxs-lookup"><span data-stu-id="69a66-209">The DataList, on the other hand, renders its items using templates.</span></span> <span data-ttu-id="69a66-210">Элементы, предназначенные только для чтения, отображаются с использованием `ItemTemplate` в то время как элементы в режиме редактирования подготавливаются к просмотру через `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="69a66-210">Read-only items are rendered using the `ItemTemplate` whereas items in edit mode are rendered via the `EditItemTemplate`.</span></span> <span data-ttu-id="69a66-211">На этом этапе нашей DataList имеет только `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="69a66-211">At this point, our DataList has only an `ItemTemplate`.</span></span> <span data-ttu-id="69a66-212">Для поддержки функциональных возможностей редактирования уровня элемента, необходимо добавить `EditItemTemplate` , содержащая разметку, отображаемую для изменения элемент.</span><span class="sxs-lookup"><span data-stu-id="69a66-212">To support item-level editing functionality we need to add an `EditItemTemplate` that contains the markup to be displayed for the editable item.</span></span> <span data-ttu-id="69a66-213">В этом учебнике мы будем использовать текстовое поле веб-элементы управления для редактирования продукта s название и цену за единицу.</span><span class="sxs-lookup"><span data-stu-id="69a66-213">For this tutorial, we'll use TextBox Web controls for editing the product s name and unit price.</span></span>

<span data-ttu-id="69a66-214">`EditItemTemplate` Можно создать декларативно или с помощью конструктора (путем выбора параметра редактирование шаблонов смарт-теге DataList s).</span><span class="sxs-lookup"><span data-stu-id="69a66-214">The `EditItemTemplate` can be created either declaratively or through the Designer (by selecting the Edit Templates option from the DataList s smart tag).</span></span> <span data-ttu-id="69a66-215">Чтобы использовать параметр редактирование шаблонов, сначала щелкните ссылку Изменить шаблоны смарт-тега, а затем выберите `EditItemTemplate` элемент из раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="69a66-215">To use the Edit Templates option, first click the Edit Templates link in the smart tag and then select the `EditItemTemplate` item from the drop-down list.</span></span>


<span data-ttu-id="69a66-216">[![Необязательно для работы с DataList s EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image19.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="69a66-216">[![Opt to Work with the DataList s EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image19.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image18.png)</span></span>

<span data-ttu-id="69a66-217">**Рис. 8**: необязательно для работы с DataList s `EditItemTemplate` ([Просмотр полноразмерное изображение](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="69a66-217">**Figure 8**: Opt to Work with the DataList s `EditItemTemplate` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image20.png))</span></span>


<span data-ttu-id="69a66-218">После этого введите название продукта: и Price: и перетащите два элемента управления TextBox из области элементов в `EditItemTemplate` интерфейс в конструкторе.</span><span class="sxs-lookup"><span data-stu-id="69a66-218">Next, type in Product name: and Price: and then drag two TextBox controls from the Toolbox into the `EditItemTemplate` interface on the Designer.</span></span> <span data-ttu-id="69a66-219">Набор текстовых полей `ID` свойства `ProductName` и `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="69a66-219">Set the TextBoxes `ID` properties to `ProductName` and `UnitPrice`.</span></span>


<span data-ttu-id="69a66-220">[![Текстовое поле для имени продукта s и цены](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image22.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="69a66-220">[![Add a TextBox for the Product s Name and Price](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image22.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image21.png)</span></span>

<span data-ttu-id="69a66-221">**Рис. 9**: Добавьте текстовое поле имя продукта и Price ([Просмотр полноразмерное изображение](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="69a66-221">**Figure 9**: Add a TextBox for the Product s Name and Price ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image23.png))</span></span>


<span data-ttu-id="69a66-222">Нам нужно привязать соответствующими значениями полей данных продукта для `Text` свойства двух текстовых полей.</span><span class="sxs-lookup"><span data-stu-id="69a66-222">We need to bind the corresponding product data field values to the `Text` properties of the two TextBoxes.</span></span> <span data-ttu-id="69a66-223">Смарт-тегами текстовые поля, щелкните ссылку изменить привязки данных и затем связать поле с соответствующими данными `Text` свойства, как показано на рис. 10.</span><span class="sxs-lookup"><span data-stu-id="69a66-223">From the TextBoxes smart tags, click on the Edit DataBindings link and then associate the appropriate data field with the `Text` property, as shown in Figure 10.</span></span>

> [!NOTE]
> <span data-ttu-id="69a66-224">При привязке `UnitPrice` поля данных цену TextBox s `Text` поля, вы может отформатировать их в виде значения валюты (`{0:C}`), число с общим форматом (`{0:N}`), или оставить неформатированный.</span><span class="sxs-lookup"><span data-stu-id="69a66-224">When binding the `UnitPrice` data field to the price TextBox s `Text` field, you may format it as a currency value (`{0:C}`), a general number (`{0:N}`), or leave it unformatted.</span></span>


![Связать ProductName и полей данных UnitPrice свойства Text текстовых полей](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image24.png)

<span data-ttu-id="69a66-226">**Рис. 10**: привязка `ProductName` и `UnitPrice` поля данных для `Text` свойств текстовых полей</span><span class="sxs-lookup"><span data-stu-id="69a66-226">**Figure 10**: Bind the `ProductName` and `UnitPrice` Data Fields to the `Text` Properties of the TextBoxes</span></span>


<span data-ttu-id="69a66-227">Обратите внимание на то, как работает окно изменить привязки данных на рис. 10 *не* включают флажок двусторонняя привязка к данным, представленным при редактировании TemplateField в GridView или DetailsView или шаблона в FormView.</span><span class="sxs-lookup"><span data-stu-id="69a66-227">Notice how the Edit DataBindings dialog box in Figure 10 does *not* include the Two-way databinding checkbox that is present when editing a TemplateField in the GridView or DetailsView, or a template in the FormView.</span></span> <span data-ttu-id="69a66-228">Функция двухсторонней привязкой данных допустимое значение, введенное в элемент управления Web автоматически назначен соответствующий s ObjectDataSource `InsertParameters` или `UpdateParameters` при вставке или обновлении данных.</span><span class="sxs-lookup"><span data-stu-id="69a66-228">The two-way databinding feature allowed the value entered into the input Web control to be automatically assigned to the corresponding ObjectDataSource s `InsertParameters` or `UpdateParameters` when inserting or updating data.</span></span> <span data-ttu-id="69a66-229">DataList не поддерживает двусторонняя привязка к данным, как будет показано позднее в этом учебнике после пользователь вносит ей изменения и готов к обновлению данных, вам потребуется получить программный доступ к эти текстовые поля `Text` свойства и передайте их значения для соответствующие `UpdateProduct` метод `ProductsBLL` класса.</span><span class="sxs-lookup"><span data-stu-id="69a66-229">The DataList does not support two-way databinding as we'll see later on in this tutorial, after the user makes her changes and is ready to update the data, we will need to programmatically access these TextBoxes `Text` properties and pass in their values to the appropriate `UpdateProduct` method in the `ProductsBLL` class.</span></span>

<span data-ttu-id="69a66-230">Наконец, нужно добавить обновления и «Отмена», чтобы `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="69a66-230">Finally, we need to add Update and Cancel buttons to the `EditItemTemplate`.</span></span> <span data-ttu-id="69a66-231">Как мы видели в [главный/Detail, с помощью маркированного списка из главного записей с DataList сведения](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) учебник, когда кнопка, LinkButton или ImageButton которого `CommandName` свойство имеет значение выбирается из внутри повторителя или DataList, S повторителя или DataList `ItemCommand` события.</span><span class="sxs-lookup"><span data-stu-id="69a66-231">As we saw in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial, when a Button, LinkButton, or ImageButton whose `CommandName` property is set is clicked from within a Repeater or DataList, the Repeater or DataList s `ItemCommand` event is raised.</span></span> <span data-ttu-id="69a66-232">Для DataList Если `CommandName` имеет значение определенного значения, а также могут возникать дополнительные события.</span><span class="sxs-lookup"><span data-stu-id="69a66-232">For the DataList, if the `CommandName` property is set to a certain value, an additional event may be raised as well.</span></span> <span data-ttu-id="69a66-233">Специальные `CommandName` значений свойств: в частности:</span><span class="sxs-lookup"><span data-stu-id="69a66-233">The special `CommandName` property values include, among others:</span></span>

- <span data-ttu-id="69a66-234">Отмена вызывает `CancelCommand` событий</span><span class="sxs-lookup"><span data-stu-id="69a66-234">Cancel raises the `CancelCommand` event</span></span>
- <span data-ttu-id="69a66-235">Изменить вызывает `EditCommand` событий</span><span class="sxs-lookup"><span data-stu-id="69a66-235">Edit raises the `EditCommand` event</span></span>
- <span data-ttu-id="69a66-236">Обновить вызывает `UpdateCommand` событий</span><span class="sxs-lookup"><span data-stu-id="69a66-236">Update raises the `UpdateCommand` event</span></span>

<span data-ttu-id="69a66-237">Следует помнить, что эти события вызываются *в дополнение к* `ItemCommand` событий.</span><span class="sxs-lookup"><span data-stu-id="69a66-237">Keep in mind that these events are raised *in addition to* the `ItemCommand` event.</span></span>

<span data-ttu-id="69a66-238">Добавление `EditItemTemplate` две кнопки веб-элементов управления, из которого `CommandName` обновления и другие устройства, задайте значение "Отмена".</span><span class="sxs-lookup"><span data-stu-id="69a66-238">Add to the `EditItemTemplate` two Button Web controls, one whose `CommandName` is set to Update and the other s set to Cancel.</span></span> <span data-ttu-id="69a66-239">После добавления этих двух элементов управления Web кнопку Конструктор должен выглядеть примерно следующее:</span><span class="sxs-lookup"><span data-stu-id="69a66-239">After adding these two Button Web controls the Designer should look similar to the following:</span></span>


<span data-ttu-id="69a66-240">[![Добавление, обновление и Отмена кнопок EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image26.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="69a66-240">[![Add Update and Cancel Buttons to the EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image26.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image25.png)</span></span>

<span data-ttu-id="69a66-241">**Рис. 11**: Добавление обновления и кнопки "Отмена" для `EditItemTemplate` ([Просмотр полноразмерное изображение](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="69a66-241">**Figure 11**: Add Update and Cancel Buttons to the `EditItemTemplate` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image27.png))</span></span>


<span data-ttu-id="69a66-242">С `EditItemTemplate` завершения вашей DataList s должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="69a66-242">With the `EditItemTemplate` complete your DataList s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample3.aspx)]

## <a name="step-5-adding-the-plumbing-to-enter-edit-mode"></a><span data-ttu-id="69a66-243">Шаг 5: Добавление устройства в режим редактирования</span><span class="sxs-lookup"><span data-stu-id="69a66-243">Step 5: Adding the Plumbing to Enter Edit Mode</span></span>

<span data-ttu-id="69a66-244">На этом этапе нашей DataList имеет определенное через интерфейс редактирования ее `EditItemTemplate`, однако здесь s в настоящее время невозможно для пользователя, посетите нашу страницу для указания того, он хочет изменить сведения о продукте s.</span><span class="sxs-lookup"><span data-stu-id="69a66-244">At this point our DataList has an editing interface defined via its `EditItemTemplate`; however, there s currently no way for a user visiting our page to indicate that he wants to edit a product s information.</span></span> <span data-ttu-id="69a66-245">Нам нужно добавить кнопку "Изменить" для каждого продукта, что, при щелчке модули подготовки, DataList элементов в режиме редактирования.</span><span class="sxs-lookup"><span data-stu-id="69a66-245">We need to add an Edit button to each product that, when clicked, renders that DataList item in edit mode.</span></span> <span data-ttu-id="69a66-246">Начните с добавления кнопку "Изменить", чтобы `ItemTemplate`, с помощью конструктора или декларативно.</span><span class="sxs-lookup"><span data-stu-id="69a66-246">Start by adding an Edit button to the `ItemTemplate`, either through the Designer or declaratively.</span></span> <span data-ttu-id="69a66-247">Не забудьте задать s кнопка "Изменить" `CommandName` свойств для редактирования.</span><span class="sxs-lookup"><span data-stu-id="69a66-247">Be certain to set the Edit button s `CommandName` property to Edit .</span></span>

<span data-ttu-id="69a66-248">После добавления этой кнопки редактирования занять некоторое время для просмотра страницы через браузер.</span><span class="sxs-lookup"><span data-stu-id="69a66-248">After you have added this Edit button, take a moment to view the page through a browser.</span></span> <span data-ttu-id="69a66-249">В результате этого добавления каждого продукта списке должны содержаться кнопку "Изменить".</span><span class="sxs-lookup"><span data-stu-id="69a66-249">With this addition, each product listing should include an Edit button.</span></span>


<span data-ttu-id="69a66-250">[![Добавление, обновление и Отмена кнопок EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image29.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="69a66-250">[![Add Update and Cancel Buttons to the EditItemTemplate](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image29.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image28.png)</span></span>

<span data-ttu-id="69a66-251">**Рис. 12**: Добавление обновления и кнопки "Отмена" для `EditItemTemplate` ([Просмотр полноразмерное изображение](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="69a66-251">**Figure 12**: Add Update and Cancel Buttons to the `EditItemTemplate` ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image30.png))</span></span>


<span data-ttu-id="69a66-252">Нажав кнопку вызывает обратную передачу, но *не* перевести в режим редактирования списка продукции.</span><span class="sxs-lookup"><span data-stu-id="69a66-252">Clicking the button causes a postback, but does *not* bring the product listing into edit mode.</span></span> <span data-ttu-id="69a66-253">Чтобы сделать доступным для редактирования продукт, необходимо:</span><span class="sxs-lookup"><span data-stu-id="69a66-253">To make the product editable, we need to:</span></span>

1. <span data-ttu-id="69a66-254">Задать DataList s [ `EditItemIndex` свойство](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) индексу `DataListItem` выполнен щелчок, кнопка "Изменить".</span><span class="sxs-lookup"><span data-stu-id="69a66-254">Set the DataList s [`EditItemIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) to the index of the `DataListItem` whose Edit button was just clicked.</span></span>
2. <span data-ttu-id="69a66-255">Привяжите данные к элементу управления DataList.</span><span class="sxs-lookup"><span data-stu-id="69a66-255">Rebind the data to the DataList.</span></span> <span data-ttu-id="69a66-256">Когда в DataList повторно подготовленных к просмотру `DataListItem` которого `ItemIndex` соответствует DataList s `EditItemIndex` будет отображаться с помощью его `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="69a66-256">When the DataList is re-rendered, the `DataListItem` whose `ItemIndex` corresponds with the DataList s `EditItemIndex` will render using its `EditItemTemplate`.</span></span>

<span data-ttu-id="69a66-257">Так как элемент управления DataList s `EditCommand` событие вызывается, когда нажата кнопка "Изменить", создайте `EditCommand` обработчик событий следующим кодом:</span><span class="sxs-lookup"><span data-stu-id="69a66-257">Since the DataList s `EditCommand` event is fired when the Edit button is clicked, create an `EditCommand` event handler with the following code:</span></span>


[!code-vb[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample4.vb)]

<span data-ttu-id="69a66-258">`EditCommand` Обработчик событий передается в объект типа `DataListCommandEventArgs` вторым параметром ввода, которая содержит ссылку на `DataListItem` была нажата, кнопка "Изменить" (`e.Item`).</span><span class="sxs-lookup"><span data-stu-id="69a66-258">The `EditCommand` event handler is passed in an object of type `DataListCommandEventArgs` as its second input parameter, which includes a reference to the `DataListItem` whose Edit button was clicked (`e.Item`).</span></span> <span data-ttu-id="69a66-259">Обработчик события сначала задает DataList s `EditItemIndex` для `ItemIndex` из редактируемого `DataListItem` и затем выполняет повторную привязку данных к элементу управления DataList путем вызова DataList s `DataBind()` метод.</span><span class="sxs-lookup"><span data-stu-id="69a66-259">The event handler first sets the DataList s `EditItemIndex` to the `ItemIndex` of the editable `DataListItem` and then rebinds the data to the DataList by calling the DataList s `DataBind()` method.</span></span>

<span data-ttu-id="69a66-260">После добавления этого обработчика событий, вернитесь на страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="69a66-260">After adding this event handler, revisit the page in a browser.</span></span> <span data-ttu-id="69a66-261">Щелкнув ссылку "Изменить" позволяет выборе продукта для редактирования (см. рис. 13).</span><span class="sxs-lookup"><span data-stu-id="69a66-261">Clicking the Edit button now makes the clicked product editable (see Figure 13).</span></span>


<span data-ttu-id="69a66-262">[![Щелкнув делает кнопку Правка продукта для редактирования](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image32.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="69a66-262">[![Clicking the Edit Button Makes the Product Editable](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image32.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image31.png)</span></span>

<span data-ttu-id="69a66-263">**Рис. 13**: нажмите кнопку «Изменить» делает редактируемый продукта ([Просмотр полноразмерное изображение](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="69a66-263">**Figure 13**: Clicking the Edit Button Makes the Product Editable ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image33.png))</span></span>


## <a name="step-6-saving-the-user-s-changes"></a><span data-ttu-id="69a66-264">Шаг 6: Сохранение изменений s пользователя</span><span class="sxs-lookup"><span data-stu-id="69a66-264">Step 6: Saving the User s Changes</span></span>

<span data-ttu-id="69a66-265">На этом этапе; нажатию кнопки "Отмена" или s продукта обновления не выполняет никаких действий Чтобы добавить эту функцию, необходимо ли создавать обработчики событий для DataList s `UpdateCommand` и `CancelCommand` события.</span><span class="sxs-lookup"><span data-stu-id="69a66-265">Clicking the edited product s Update or Cancel buttons does nothing at this point; to add this functionality we need to create event handlers for the DataList s `UpdateCommand` and `CancelCommand` events.</span></span> <span data-ttu-id="69a66-266">Начните с создания `CancelCommand` обработчик событий, который будет выполняться при нажатии кнопки "Отмена" s продукта и его задачу с возвратом DataList состояние до редактирования.</span><span class="sxs-lookup"><span data-stu-id="69a66-266">Start by creating the `CancelCommand` event handler, which will execute when the edited product s Cancel button is clicked and it tasked with returning the DataList to its pre-editing state.</span></span>

<span data-ttu-id="69a66-267">Чтобы отобразить все элементы в режиме только для чтения DataList, необходимо:</span><span class="sxs-lookup"><span data-stu-id="69a66-267">To have the DataList render all of its items in the read-only mode, we need to:</span></span>

1. <span data-ttu-id="69a66-268">Задать DataList s [ `EditItemIndex` свойство](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) в индекс несуществующей `DataListItem` индекса.</span><span class="sxs-lookup"><span data-stu-id="69a66-268">Set the DataList s [`EditItemIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) to the index of a non-existent `DataListItem` index.</span></span> <span data-ttu-id="69a66-269">`-1`является безопасным, поскольку `DataListItem` индексы начинаются с `0`.</span><span class="sxs-lookup"><span data-stu-id="69a66-269">`-1` is a safe choice, since the `DataListItem` indexes start at `0`.</span></span>
2. <span data-ttu-id="69a66-270">Привяжите данные к элементу управления DataList.</span><span class="sxs-lookup"><span data-stu-id="69a66-270">Rebind the data to the DataList.</span></span> <span data-ttu-id="69a66-271">Так как нет `DataListItem` `ItemIndex` es соответствуют DataList s `EditItemIndex`, весь DataList будут отображены в режиме только для чтения.</span><span class="sxs-lookup"><span data-stu-id="69a66-271">Since no `DataListItem` `ItemIndex` es correspond to the DataList s `EditItemIndex`, the entire DataList will be rendered in a read-only mode.</span></span>

<span data-ttu-id="69a66-272">Эти действия могут быть выполнены с помощью следующего кода обработчика событий:</span><span class="sxs-lookup"><span data-stu-id="69a66-272">These steps can be accomplished with the following event handler code:</span></span>


[!code-vb[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample5.vb)]

<span data-ttu-id="69a66-273">В результате этого добавления щелкнув возвращает кнопку "Отмена" DataList в состояние до редактирования.</span><span class="sxs-lookup"><span data-stu-id="69a66-273">With this addition, clicking the Cancel button returns the DataList to its pre-editing state.</span></span>

<span data-ttu-id="69a66-274">Последний обработчик событий, необходимо завершить — `UpdateCommand` обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="69a66-274">The last event handler we need to complete is the `UpdateCommand` event handler.</span></span> <span data-ttu-id="69a66-275">Этот обработчик событий должен:</span><span class="sxs-lookup"><span data-stu-id="69a66-275">This event handler needs to:</span></span>

1. <span data-ttu-id="69a66-276">Программный доступ к имени продукта, введенные пользователем и цена, а также продукта s `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="69a66-276">Programmatically access the user-entered product name and price as well as the edited product s `ProductID`.</span></span>
2. <span data-ttu-id="69a66-277">Запуск процесса обновления путем вызова соответствующего `UpdateProduct` перегрузки в `ProductsBLL` класса.</span><span class="sxs-lookup"><span data-stu-id="69a66-277">Initiate the update process by calling the appropriate `UpdateProduct` overload in the `ProductsBLL` class.</span></span>
3. <span data-ttu-id="69a66-278">Задать DataList s [ `EditItemIndex` свойство](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) в индекс несуществующей `DataListItem` индекса.</span><span class="sxs-lookup"><span data-stu-id="69a66-278">Set the DataList s [`EditItemIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.edititemindex.aspx) to the index of a non-existent `DataListItem` index.</span></span> <span data-ttu-id="69a66-279">`-1`является безопасным, поскольку `DataListItem` индексы начинаются с `0`.</span><span class="sxs-lookup"><span data-stu-id="69a66-279">`-1` is a safe choice, since the `DataListItem` indexes start at `0`.</span></span>
4. <span data-ttu-id="69a66-280">Привяжите данные к элементу управления DataList.</span><span class="sxs-lookup"><span data-stu-id="69a66-280">Rebind the data to the DataList.</span></span> <span data-ttu-id="69a66-281">Так как нет `DataListItem` `ItemIndex` es соответствуют DataList s `EditItemIndex`, весь DataList будут отображены в режиме только для чтения.</span><span class="sxs-lookup"><span data-stu-id="69a66-281">Since no `DataListItem` `ItemIndex` es correspond to the DataList s `EditItemIndex`, the entire DataList will be rendered in a read-only mode.</span></span>

<span data-ttu-id="69a66-282">Шаги 1 и 2 несут ответственность за сохранение пользователь s изменений; После изменения были сохранены и идентичны шагов, выполненных в шагах 3 и 4 возвращать DataList состояние до редактирования `CancelCommand` обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="69a66-282">Steps 1 and 2 are responsible for saving the user s changes; steps 3 and 4 return the DataList to its pre-editing state after the changes have been saved and are identical to the steps performed in the `CancelCommand` event handler.</span></span>

<span data-ttu-id="69a66-283">Чтобы получить имя обновленного продукта и цену, необходимо использовать `FindControl` метод программно ссылка, элементы управления в Интернете в текстовом поле в `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="69a66-283">To get the updated product name and price, we need to use the `FindControl` method to programmatically reference the TextBox Web controls within the `EditItemTemplate`.</span></span> <span data-ttu-id="69a66-284">Нам также нужно получить продукта s `ProductID` значение.</span><span class="sxs-lookup"><span data-stu-id="69a66-284">We also need to get the edited product s `ProductID` value.</span></span> <span data-ttu-id="69a66-285">Когда мы изначально привязан элемент управления ObjectDataSource DataList, Visual Studio назначенный DataList s `DataKeyField` свойства на значение первичного ключа из источника данных (`ProductID`).</span><span class="sxs-lookup"><span data-stu-id="69a66-285">When we initially bound the ObjectDataSource to the DataList, Visual Studio assigned the DataList s `DataKeyField` property to the primary key value from the data source (`ProductID`).</span></span> <span data-ttu-id="69a66-286">Это значение может быть извлечен из DataList s `DataKeys` коллекции.</span><span class="sxs-lookup"><span data-stu-id="69a66-286">This value can then be retrieved from the DataList s `DataKeys` collection.</span></span> <span data-ttu-id="69a66-287">Теперь пора убедитесь, что `DataKeyField` на самом деле свойству `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="69a66-287">Take a moment to ensure that the `DataKeyField` property is indeed set to `ProductID`.</span></span>

<span data-ttu-id="69a66-288">Следующий код реализует четыре шага:</span><span class="sxs-lookup"><span data-stu-id="69a66-288">The following code implements the four steps:</span></span>


[!code-vb[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample6.vb)]

<span data-ttu-id="69a66-289">Обработчик события запускается посредством считывания продукта s `ProductID` из `DataKeys` коллекции.</span><span class="sxs-lookup"><span data-stu-id="69a66-289">The event handler starts by reading in the edited product s `ProductID` from the `DataKeys` collection.</span></span> <span data-ttu-id="69a66-290">Далее, два текстовых поля в `EditItemTemplate` указываются и их `Text` свойства, которые хранятся в локальных переменных `productNameValue` и `unitPriceValue`.</span><span class="sxs-lookup"><span data-stu-id="69a66-290">Next, the two TextBoxes in the `EditItemTemplate` are referenced and their `Text` properties stored in local variables, `productNameValue` and `unitPriceValue`.</span></span> <span data-ttu-id="69a66-291">Мы используем `Decimal.Parse()` метод для чтения значения из `UnitPrice` текстовое поле, поэтому, если значение, введенное указан символ валюты, его можно по-прежнему правильно преобразовываться в `Decimal` значение.</span><span class="sxs-lookup"><span data-stu-id="69a66-291">We use the `Decimal.Parse()` method to read the value from the `UnitPrice` TextBox so that if the value entered has a currency symbol, it can still be correctly converted into a `Decimal` value.</span></span>

> [!NOTE]
> <span data-ttu-id="69a66-292">Значения из `ProductName` и `UnitPrice` текстовые поля только если будут использоваться для переменных productNameValue и unitPriceValue свойства текстового поля указано значение.</span><span class="sxs-lookup"><span data-stu-id="69a66-292">The values from the `ProductName` and `UnitPrice` TextBoxes are only assigned to the productNameValue and unitPriceValue variables if the TextBoxes Text properties have a value specified.</span></span> <span data-ttu-id="69a66-293">В противном случае — значение `Nothing` используется для переменных, который действует как обновление данных с базой данных `NULL` значение.</span><span class="sxs-lookup"><span data-stu-id="69a66-293">Otherwise, a value of `Nothing` is used for the variables, which has the effect of updating the data with a database `NULL` value.</span></span> <span data-ttu-id="69a66-294">То есть наш код обрабатывает преобразует пустые строки в базу данных `NULL` значения, которые по умолчанию редактирования интерфейса в элементах управления GridView, DetailsView и FormView.</span><span class="sxs-lookup"><span data-stu-id="69a66-294">That is, our code treats converts empty strings to database `NULL` values, which is the default behavior of the editing interface in the GridView, DetailsView, and FormView controls.</span></span>


<span data-ttu-id="69a66-295">После считывания значений `ProductsBLL` класса s `UpdateProduct` вызывается метод, передав имя продукта s, цена и `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="69a66-295">After reading the values, the `ProductsBLL` class s `UpdateProduct` method is called, passing in the product s name, price, and `ProductID`.</span></span> <span data-ttu-id="69a66-296">Обработчик события завершения, возвращая DataList состояние до редактирования с помощью точное средств, как и в `CancelCommand` обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="69a66-296">The event handler completes by returning the DataList to its pre-editing state using the exact same logic as in the `CancelCommand` event handler.</span></span>

<span data-ttu-id="69a66-297">С `EditCommand`, `CancelCommand`, и `UpdateCommand` завершить обработчики событий, посетитель можно изменить имя и цену продукта.</span><span class="sxs-lookup"><span data-stu-id="69a66-297">With the `EditCommand`, `CancelCommand`, and `UpdateCommand` event handlers complete, a visitor can edit the name and price of a product.</span></span> <span data-ttu-id="69a66-298">Данные 14-16 Показать редактирования рабочего процесса в действии.</span><span class="sxs-lookup"><span data-stu-id="69a66-298">Figures 14-16 show this editing workflow in action.</span></span>


<span data-ttu-id="69a66-299">[![При первом посещении страницы, все продукты находятся в режиме только для чтения](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image35.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="69a66-299">[![When First Visiting the Page, All Products are in Read-Only Mode](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image35.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image34.png)</span></span>

<span data-ttu-id="69a66-300">**Рис. 14**: при первом просмотре страницы, все продукты находятся в режиме только для чтения ([Просмотр полноразмерное изображение](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="69a66-300">**Figure 14**: When First Visiting the Page, All Products are in Read-Only Mode ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image36.png))</span></span>


<span data-ttu-id="69a66-301">[![Чтобы обновить имя или цену продукта, нажмите кнопку редактирования](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image38.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="69a66-301">[![To Update a Product s Name or Price, Click the Edit Button](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image38.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image37.png)</span></span>

<span data-ttu-id="69a66-302">**Рис. 15**: чтобы обновить имя продукта или цену, нажмите кнопку Изменить ([Просмотр полноразмерное изображение](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="69a66-302">**Figure 15**: To Update a Product s Name or Price, Click the Edit Button ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image39.png))</span></span>


<span data-ttu-id="69a66-303">[![После изменения значения, щелкните обновление, чтобы вернуться в режим только для чтения](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image41.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="69a66-303">[![After Changing the Value, Click Update to Return to the Read-Only Mode](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image41.png)](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image40.png)</span></span>

<span data-ttu-id="69a66-304">**На рисунке 16**: после изменения значения, нажмите кнопку обновления, чтобы вернуться в режим только для чтения ([Просмотр полноразмерное изображение](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="69a66-304">**Figure 16**: After Changing the Value, Click Update to Return to the Read-Only Mode ([Click to view full-size image](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/_static/image42.png))</span></span>


## <a name="step-7-adding-delete-capabilities"></a><span data-ttu-id="69a66-305">Шаг 7: Добавление возможности удаления</span><span class="sxs-lookup"><span data-stu-id="69a66-305">Step 7: Adding Delete Capabilities</span></span>

<span data-ttu-id="69a66-306">Инструкции по добавлению возможности удаления DataList аналогичны для добавления возможностей редактирования.</span><span class="sxs-lookup"><span data-stu-id="69a66-306">The steps for adding delete capabilities to a DataList are similar to those for adding editing capabilities.</span></span> <span data-ttu-id="69a66-307">Иными словами, необходимо добавить кнопку «Удалить» для `ItemTemplate` , при щелчке:</span><span class="sxs-lookup"><span data-stu-id="69a66-307">In short, we need to add a Delete button to the `ItemTemplate` that, when clicked:</span></span>

1. <span data-ttu-id="69a66-308">Считывает данные из соответствующего продукта s `ProductID` через `DataKeys` коллекции.</span><span class="sxs-lookup"><span data-stu-id="69a66-308">Reads in the corresponding product s `ProductID` via the `DataKeys` collection.</span></span>
2. <span data-ttu-id="69a66-309">Выполняет удаление с помощью вызова `ProductsBLL` класса s `DeleteProduct` метод.</span><span class="sxs-lookup"><span data-stu-id="69a66-309">Performs the delete by calling the `ProductsBLL` class s `DeleteProduct` method.</span></span>
3. <span data-ttu-id="69a66-310">Выполняет повторную привязку данных к элементу управления DataList.</span><span class="sxs-lookup"><span data-stu-id="69a66-310">Rebinds the data to the DataList.</span></span>

<span data-ttu-id="69a66-311">S начните с добавления кнопку «Удалить», чтобы позволить `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="69a66-311">Let s start by adding a Delete button to the `ItemTemplate`.</span></span>

<span data-ttu-id="69a66-312">При нажатии кнопки которого `CommandName` -Edit, обновление, или "Отмена" вызывает DataList s `ItemCommand` событий, а также дополнительное событие (например, в том случае, когда с помощью редактирования `EditCommand` событие также).</span><span class="sxs-lookup"><span data-stu-id="69a66-312">When clicked, a Button whose `CommandName` is Edit, Update, or Cancel raises the DataList s `ItemCommand` event along with an additional event (for example, when using Edit the `EditCommand` event is raised as well).</span></span> <span data-ttu-id="69a66-313">Аналогичным образом все кнопки, LinkButton или ImageButton в DataList которого `CommandName` свойству удалить причины `DeleteCommand` срабатывание события (вместе с `ItemCommand`).</span><span class="sxs-lookup"><span data-stu-id="69a66-313">Similarly, any Button, LinkButton, or ImageButton in the DataList whose `CommandName` property is set to Delete causes the `DeleteCommand` event to fire (along with `ItemCommand`).</span></span>

<span data-ttu-id="69a66-314">Добавьте кнопку «Удалить» рядом с «изменить» в `ItemTemplate`, параметр его `CommandName` свойство для удаления.</span><span class="sxs-lookup"><span data-stu-id="69a66-314">Add a Delete button next to the Edit button in the `ItemTemplate`, setting its `CommandName` property to Delete.</span></span> <span data-ttu-id="69a66-315">После добавления этой кнопки управления DataList s `ItemTemplate` декларативный синтаксис должен выглядеть так:</span><span class="sxs-lookup"><span data-stu-id="69a66-315">After adding this Button control your DataList s `ItemTemplate` declarative syntax should look like:</span></span>


[!code-aspx[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample7.aspx)]

<span data-ttu-id="69a66-316">Создайте обработчик событий для DataList s `DeleteCommand` событие, используя следующий код:</span><span class="sxs-lookup"><span data-stu-id="69a66-316">Next, create an event handler for the DataList s `DeleteCommand` event, using the following code:</span></span>


[!code-vb[Main](an-overview-of-editing-and-deleting-data-in-the-datalist-vb/samples/sample8.vb)]

<span data-ttu-id="69a66-317">Нажав кнопку «Удалить» вызывает обратную передачу и срабатывает в DataList s `DeleteCommand` событий.</span><span class="sxs-lookup"><span data-stu-id="69a66-317">Clicking the Delete button causes a postback and fires the DataList s `DeleteCommand` event.</span></span> <span data-ttu-id="69a66-318">В обработчике событий, пользователь щелкнул продукт s `ProductID` значение осуществляется из `DataKeys` коллекции.</span><span class="sxs-lookup"><span data-stu-id="69a66-318">In the event handler, the clicked product s `ProductID` value is accessed from the `DataKeys` collection.</span></span> <span data-ttu-id="69a66-319">После этого продукта удаляется вызовом `ProductsBLL` класса s `DeleteProduct` метод.</span><span class="sxs-lookup"><span data-stu-id="69a66-319">Next, the product is deleted by calling the `ProductsBLL` class s `DeleteProduct` method.</span></span>

<span data-ttu-id="69a66-320">После удаления продукта, его важно, что мы привяжите данные к элементу управления DataList s (`DataList1.DataBind()`), в противном случае элемент управления DataList будут отображать продукта, которая была удалена.</span><span class="sxs-lookup"><span data-stu-id="69a66-320">After deleting the product, it s important that we rebind the data to the DataList (`DataList1.DataBind()`), otherwise the DataList will continue to show the product that was just deleted.</span></span>

## <a name="summary"></a><span data-ttu-id="69a66-321">Сводка</span><span class="sxs-lookup"><span data-stu-id="69a66-321">Summary</span></span>

<span data-ttu-id="69a66-322">DataList не имеет точки, и нажмите кнопку редактирования и удаления поддержки, которыми пользуются GridView, с помощью коротких большой объем кода его можно улучшить эти возможности.</span><span class="sxs-lookup"><span data-stu-id="69a66-322">While the DataList lacks the point and click editing and deleting support enjoyed by the GridView, with a short bit of code it can be enhanced to include these features.</span></span> <span data-ttu-id="69a66-323">В этом учебнике мы узнали, как для создания двух столбцов списка продуктов, может быть удален, и может редактироваться, название и цену.</span><span class="sxs-lookup"><span data-stu-id="69a66-323">In this tutorial we saw how to create a two-column listing of products that could be deleted and whose name and price could be edited.</span></span> <span data-ttu-id="69a66-324">Добавление, изменение и удаление поддержки заключается в том числе соответствующий веб-элементов управления в `ItemTemplate` и `EditItemTemplate`, создание соответствующих обработчиков событий, чтение значения пользователь ввел и первичных ключей и взаимодействие с бизнес Логики.</span><span class="sxs-lookup"><span data-stu-id="69a66-324">Adding editing and deleting support is a matter of including the appropriate Web controls in the `ItemTemplate` and `EditItemTemplate`, creating the corresponding event handlers, reading the user-entered and primary key values, and interfacing with the Business Logic Layer.</span></span>

<span data-ttu-id="69a66-325">Хотя мы добавили основные изменения и удаления возможности DataList, он не имеет дополнительных функций.</span><span class="sxs-lookup"><span data-stu-id="69a66-325">While we have added basic editing and deleting capabilities to the DataList, it lacks more advanced features.</span></span> <span data-ttu-id="69a66-326">Например, отсутствует поле ввода проверка -, если пользователь введет ценой слишком много ресурсов, будет создано исключение `Decimal.Parse` при попытке преобразования слишком дорого в `Decimal`.</span><span class="sxs-lookup"><span data-stu-id="69a66-326">For example, there is no input field validation - if a user enters a price of Too expensive, an exception will be thrown by `Decimal.Parse` when attempting to convert Too expensive into a `Decimal`.</span></span> <span data-ttu-id="69a66-327">Аналогичным образом Если имеется проблема при обновлении данных на бизнес-логики или уровней доступа к данным пользователя откроется экран Стандартная ошибка.</span><span class="sxs-lookup"><span data-stu-id="69a66-327">Similarly, if there is a problem in updating the data at the Business Logic or Data Access Layers the user will be presented with the standard error screen.</span></span> <span data-ttu-id="69a66-328">Без каких-либо подтверждения на кнопке удаления случайное удаление продукта слишком наверняка.</span><span class="sxs-lookup"><span data-stu-id="69a66-328">Without any sort of confirmation on the Delete button, accidentally deleting a product is all too likely.</span></span>

<span data-ttu-id="69a66-329">В будущем мы рассмотрим, как улучшить редактирования пользователем учебники снизиться.</span><span class="sxs-lookup"><span data-stu-id="69a66-329">In future tutorials we'll see how to improve the editing user experience.</span></span>

<span data-ttu-id="69a66-330">Программирование довольны!</span><span class="sxs-lookup"><span data-stu-id="69a66-330">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="69a66-331">Об авторе</span><span class="sxs-lookup"><span data-stu-id="69a66-331">About the Author</span></span>

<span data-ttu-id="69a66-332">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи ASP/ASP.NET и основателя из [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Майкрософт с 1998 года.</span><span class="sxs-lookup"><span data-stu-id="69a66-332">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="69a66-333">Скотт — независимый консультант, trainer и записи.</span><span class="sxs-lookup"><span data-stu-id="69a66-333">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="69a66-334">Его последняя книга — [ *диспетчерами учат самостоятельно ASP.NET 2.0 в течение 24 часов*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="69a66-334">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="69a66-335">Он может быть достигнута по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) или через его блог, который можно найти в [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="69a66-335">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="69a66-336">Благодарности</span><span class="sxs-lookup"><span data-stu-id="69a66-336">Special Thanks To</span></span>

<span data-ttu-id="69a66-337">Этот учебник ряд прошел проверку многие полезные рецензентов.</span><span class="sxs-lookup"><span data-stu-id="69a66-337">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="69a66-338">Основными редакторами этого учебника были Зак Джонс, Алексей Pespisa и Рэнди Шмидт.</span><span class="sxs-lookup"><span data-stu-id="69a66-338">Lead reviewers for this tutorial were Zack Jones, Ken Pespisa, and Randy Schmidt.</span></span> <span data-ttu-id="69a66-339">Объясняются моих последующих статей для MSDN?</span><span class="sxs-lookup"><span data-stu-id="69a66-339">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="69a66-340">Если Да, напишите мне по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="69a66-340">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="69a66-341">[Назад](customizing-the-datalist-s-editing-interface-cs.md)
[Вперед](performing-batch-updates-vb.md)</span><span class="sxs-lookup"><span data-stu-id="69a66-341">[Previous](customizing-the-datalist-s-editing-interface-cs.md)
[Next](performing-batch-updates-vb.md)</span></span>
