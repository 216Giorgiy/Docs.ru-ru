---
uid: web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb
title: Форматирование DataList и повторителя на основе данных (Visual Basic) | Документы Microsoft
author: rick-anderson
description: В этом учебнике предстоит пошаговый примеры как мы изменить внешний вид элементов управления DataList и повторителя, либо с помощью функции форматирования с...
ms.author: aspnetcontent
manager: wpickett
ms.date: 09/13/2006
ms.topic: article
ms.assetid: e2f401ae-37bb-4b19-aa97-d6b385d40f88
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb
msc.type: authoredcontent
ms.openlocfilehash: 174a68cf0785b33c85139d57ede9717ce7e135e0
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="formatting-the-datalist-and-repeater-based-upon-data-vb"></a><span data-ttu-id="253da-103">Форматирование DataList и повторителя на основе данных (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="253da-103">Formatting the DataList and Repeater Based Upon Data (VB)</span></span>
====================
<span data-ttu-id="253da-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="253da-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="253da-105">[Загрузить пример приложения](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_VB.exe) или [скачать PDF](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/datatutorial30vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="253da-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_VB.exe) or [Download PDF](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/datatutorial30vb1.pdf)</span></span>

> <span data-ttu-id="253da-106">В этом учебнике предстоит пошагово примеры как мы изменить внешний вид элементов управления DataList и повторителя, либо с помощью функции форматирования в шаблонах, либо путем обработки события с привязкой к данным.</span><span class="sxs-lookup"><span data-stu-id="253da-106">In this tutorial we'll step through examples of how we format the appearance of the DataList and Repeater controls, either by using formatting functions within templates or by handling the DataBound event.</span></span>


## <a name="introduction"></a><span data-ttu-id="253da-107">Вступление</span><span class="sxs-lookup"><span data-stu-id="253da-107">Introduction</span></span>

<span data-ttu-id="253da-108">Как упоминалось в предыдущем учебнике DataList предлагает ряд свойств, относящихся к стилю, определяющие его внешний вид.</span><span class="sxs-lookup"><span data-stu-id="253da-108">As we saw in the preceding tutorial, the DataList offers a number of style-related properties that affect its appearance.</span></span> <span data-ttu-id="253da-109">В частности, мы узнали, как назначить по умолчанию классы CSS к элементу управления DataList s `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`, и `SelectedItemStyle` свойства.</span><span class="sxs-lookup"><span data-stu-id="253da-109">In particular, we saw how to assign default CSS classes to the DataList s `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`, and `SelectedItemStyle` properties.</span></span> <span data-ttu-id="253da-110">В дополнение к эти четыре свойства DataList включает ряд других относящихся к стилю свойств, таких как `Font`, `ForeColor`, `BackColor`, и `BorderWidth`, Вот некоторые из них.</span><span class="sxs-lookup"><span data-stu-id="253da-110">In addition to these four properties, the DataList includes a number of other style-related properties, such as `Font`, `ForeColor`, `BackColor`, and `BorderWidth`, to name a few.</span></span> <span data-ttu-id="253da-111">Элементе управления повторителем не содержит все свойства, связанные со стилем.</span><span class="sxs-lookup"><span data-stu-id="253da-111">The Repeater control does not contain any style-related properties.</span></span> <span data-ttu-id="253da-112">Значения этих параметров стиля должно выполняться непосредственно в разметку в шаблонах s повторителя.</span><span class="sxs-lookup"><span data-stu-id="253da-112">Any such style settings must be made directly within the markup in the Repeater s templates.</span></span>

<span data-ttu-id="253da-113">Часто, способ форматирования данных зависит от самих данных.</span><span class="sxs-lookup"><span data-stu-id="253da-113">Often, though, how data should be formatted depends on the data itself.</span></span> <span data-ttu-id="253da-114">Например, при отображении списка продуктов мы может потребоваться отобразить сведения о продукте в светло-серый цвет, если он больше не поддерживается, или нужно выделить `UnitsInStock` значение, если это значение равно нулю.</span><span class="sxs-lookup"><span data-stu-id="253da-114">For example, when listing products we might want to display the product information in a light gray font color if it is discontinued, or we may want to highlight the `UnitsInStock` value if it is zero.</span></span> <span data-ttu-id="253da-115">Как было показано в предыдущих учебниках, GridView, DetailsView и FormView имеют два различных способа форматирования их внешний вид на основе своих данных.</span><span class="sxs-lookup"><span data-stu-id="253da-115">As we saw in previous tutorials, the GridView, DetailsView, and FormView offer two distinct ways to format their appearance based on their data:</span></span>

- <span data-ttu-id="253da-116">**`DataBound` Событий** создайте обработчик событий для соответствующей `DataBound` событие, которое возникает после привязки данных для каждого элемента (для GridView, она была `RowDataBound` события; для DataList и повторителя это `ItemDataBound`событий).</span><span class="sxs-lookup"><span data-stu-id="253da-116">**The `DataBound` event** create an event handler for the appropriate `DataBound` event, which fires after the data has been bound to each item (for the GridView it was the `RowDataBound` event; for the DataList and Repeater it is the `ItemDataBound` event).</span></span> <span data-ttu-id="253da-117">В этом случае можно проверить обработчик только данные, привязанные и принятие решений о форматировании его.</span><span class="sxs-lookup"><span data-stu-id="253da-117">In that event handler, the data just bound can be examined and formatting decisions made.</span></span> <span data-ttu-id="253da-118">Мы рассмотрели этот прием в [форматирование на основе по данным](../custom-formatting/custom-formatting-based-upon-data-vb.md) учебника.</span><span class="sxs-lookup"><span data-stu-id="253da-118">We examined this technique in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial.</span></span>
- <span data-ttu-id="253da-119">**Функций в шаблонах форматирования** при использовании TemplateFields в элементы управления DetailsView или GridView или шаблона в элементе управления FormView, можно добавить в класс фонового кода ASP.NET страницы s, уровень бизнес-логики или любые функции форматирования другие библиотеки классов, доступного из веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="253da-119">**Formatting Functions in Templates** when using TemplateFields in the DetailsView or GridView controls, or a template in the FormView control, we can add a formatting function to the ASP.NET page s code-behind class, the Business Logic Layer, or any other class library that is accessible from the web application.</span></span> <span data-ttu-id="253da-120">Эта функция форматирования может принимать произвольное число входных параметров, но должны возвращать в HTML в шаблоне.</span><span class="sxs-lookup"><span data-stu-id="253da-120">This formatting function can accept an arbitrary number of input parameters, but must return the HTML to render in the template.</span></span> <span data-ttu-id="253da-121">Функции форматирования сначала были проверены в [с помощью TemplateFields в элементе управления GridView](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) учебника.</span><span class="sxs-lookup"><span data-stu-id="253da-121">Formatting functions were first examined in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial.</span></span>

<span data-ttu-id="253da-122">Эти методы форматирования доступны с помощью элементов управления DataList и повторителя.</span><span class="sxs-lookup"><span data-stu-id="253da-122">Both of these formatting techniques are available with the DataList and Repeater controls.</span></span> <span data-ttu-id="253da-123">В этом учебнике предстоит пошагово примеры использования обоих методов для обоих элементов управления.</span><span class="sxs-lookup"><span data-stu-id="253da-123">In this tutorial we'll step through examples using both techniques for both controls.</span></span>

## <a name="using-theitemdataboundevent-handler"></a><span data-ttu-id="253da-124">С помощью`ItemDataBound`обработчика событий</span><span class="sxs-lookup"><span data-stu-id="253da-124">Using the`ItemDataBound`Event Handler</span></span>

<span data-ttu-id="253da-125">При привязке данных к DataList, из элемента управления источником данных, либо путем программного связывания данных к элементу управления s `DataSource` и вызова его `DataBind()` метод DataList s `DataBinding` инициирует событие, перечисления, источник данных и каждая запись данных привязан к элементу управления DataList.</span><span class="sxs-lookup"><span data-stu-id="253da-125">When data is bound to a DataList, either from a data source control or through programmatically assigning data to the control s `DataSource` property and calling its `DataBind()` method, the DataList s `DataBinding` event fires, the data source enumerated, and each data record is bound to the DataList.</span></span> <span data-ttu-id="253da-126">Для каждой записи в источнике данных, создает DataList [ `DataListItem` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx) объект, то связан с текущей записью.</span><span class="sxs-lookup"><span data-stu-id="253da-126">For each record in the data source, the DataList creates a [`DataListItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx) object that is then bound to the current record.</span></span> <span data-ttu-id="253da-127">Во время этого процесса DataList вызывает два события:</span><span class="sxs-lookup"><span data-stu-id="253da-127">During this process, the DataList raises two events:</span></span>

- <span data-ttu-id="253da-128">**`ItemCreated`** срабатывает после `DataListItem` был создан</span><span class="sxs-lookup"><span data-stu-id="253da-128">**`ItemCreated`** fires after the `DataListItem` has been created</span></span>
- <span data-ttu-id="253da-129">**`ItemDataBound`** вызывается после привязано к текущей записи `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="253da-129">**`ItemDataBound`** fires after the current record has been bound to the `DataListItem`</span></span>

<span data-ttu-id="253da-130">Ниже описан процесс привязки данных для элемента управления DataList.</span><span class="sxs-lookup"><span data-stu-id="253da-130">The following steps outline the data binding process for the DataList control.</span></span>

1. <span data-ttu-id="253da-131">Элемент управления DataList s [ `DataBinding` событие](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx) активируется</span><span class="sxs-lookup"><span data-stu-id="253da-131">The DataList s [`DataBinding` event](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx) fires</span></span>
2. <span data-ttu-id="253da-132">Данные, привязанные к элементу управления DataList</span><span class="sxs-lookup"><span data-stu-id="253da-132">The data is bound to the DataList</span></span>  
  
   <span data-ttu-id="253da-133">Для каждой записи в источнике данных</span><span class="sxs-lookup"><span data-stu-id="253da-133">For each record in the data source</span></span> 

    1. <span data-ttu-id="253da-134">Создание `DataListItem` объекта</span><span class="sxs-lookup"><span data-stu-id="253da-134">Create a `DataListItem` object</span></span>
    2. <span data-ttu-id="253da-135">Пожара [ `ItemCreated` событий](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span><span class="sxs-lookup"><span data-stu-id="253da-135">Fire the [`ItemCreated` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span></span>
    3. <span data-ttu-id="253da-136">Запись привязывается к `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="253da-136">Bind the record to the `DataListItem`</span></span>
    4. <span data-ttu-id="253da-137">Пожара [ `ItemDataBound` событий](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span><span class="sxs-lookup"><span data-stu-id="253da-137">Fire the [`ItemDataBound` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span></span>
    5. <span data-ttu-id="253da-138">Добавить `DataListItem` для `Items` коллекции</span><span class="sxs-lookup"><span data-stu-id="253da-138">Add the `DataListItem` to the `Items` collection</span></span>

<span data-ttu-id="253da-139">Привязка данных к элементу управления повторителем, продвижения через ту же последовательность шагов.</span><span class="sxs-lookup"><span data-stu-id="253da-139">When binding data to the Repeater control, it progresses through the exact same sequence of steps.</span></span> <span data-ttu-id="253da-140">Единственным различием является вместо `DataListItem` использует повторителя создания экземпляров, [ `RepeaterItem` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s.</span><span class="sxs-lookup"><span data-stu-id="253da-140">The only difference is that instead of `DataListItem` instances being created, the Repeater uses [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s.</span></span>

> [!NOTE]
> <span data-ttu-id="253da-141">Проницательный читатель заметить небольшие аномалий между последовательность шагов, которые происходят при DataList и повторителя привязанных к данным и при привязке к данным GridView упорядочении.</span><span class="sxs-lookup"><span data-stu-id="253da-141">The astute reader may have noticed a slight anomaly between the sequence of steps that transpire when the DataList and Repeater are bound to data versus when the GridView is bound to data.</span></span> <span data-ttu-id="253da-142">В конце заключительного процесса привязки данных вызывает GridView `DataBound` события; тем не менее, элемент управления DataList ни повторителя имеет такого события.</span><span class="sxs-lookup"><span data-stu-id="253da-142">At the tail end of the data binding process, the GridView raises the `DataBound` event; however, neither the DataList nor Repeater control have such an event.</span></span> <span data-ttu-id="253da-143">Это так, как элементы управления DataList и повторителя созданных обратно в ASP.NET 1.x временные рамки, до шаблон обработчик событий до и после уровня становится популярным.</span><span class="sxs-lookup"><span data-stu-id="253da-143">This is because the DataList and Repeater controls were created back in the ASP.NET 1.x timeframe, before the pre- and post-level event handler pattern had become common.</span></span>


<span data-ttu-id="253da-144">Как и с GridView, один из вариантов форматирования на основе данных для создания обработчика событий для `ItemDataBound` события.</span><span class="sxs-lookup"><span data-stu-id="253da-144">Like with the GridView, one option for formatting based on the data is to create an event handler for the `ItemDataBound` event.</span></span> <span data-ttu-id="253da-145">Этот обработчик событий должен проверить данные, которые только что привязанного к `DataListItem` или `RepeaterItem` и влияет на форматирование элемента управления при необходимости.</span><span class="sxs-lookup"><span data-stu-id="253da-145">This event handler would inspect the data that had just been bound to the `DataListItem` or `RepeaterItem` and affect the formatting of the control as needed.</span></span>

<span data-ttu-id="253da-146">Для элемента управления DataList изменения форматирования для всего элемента может осуществляться с помощью `DataListItem` s относящихся к стилю свойств, включающих стандартный `Font`, `ForeColor`, `BackColor`, `CssClass`, и т. д.</span><span class="sxs-lookup"><span data-stu-id="253da-146">For the DataList control, formatting changes for the entire item can be implemented using the `DataListItem` s style-related properties, which include the standard `Font`, `ForeColor`, `BackColor`, `CssClass`, and so on.</span></span> <span data-ttu-id="253da-147">Чтобы влияют на форматирование определенного веб-элементов управления в шаблоне DataList s, нужно получить программный доступ и изменение стиля этих веб-элементов управления.</span><span class="sxs-lookup"><span data-stu-id="253da-147">To affect the formatting of particular Web controls within the DataList s template, we need to programmatically access and modify the style of those Web controls.</span></span> <span data-ttu-id="253da-148">Мы узнали, как выполнять его обратно в *форматирование на основе по данным* учебника.</span><span class="sxs-lookup"><span data-stu-id="253da-148">We saw how to accomplish this back in the *Custom Formatting Based Upon Data* tutorial.</span></span> <span data-ttu-id="253da-149">Аналогичен элементу управления повторителем `RepeaterItem` класс имеет свойства, не относящихся к стилю; таким образом, все связанные со стилем изменения в `RepeaterItem` в `ItemDataBound` обработчик событий должен выполнять программным путем доступа и обновления веб-элементов управления в шаблон.</span><span class="sxs-lookup"><span data-stu-id="253da-149">Like the Repeater control, the `RepeaterItem` class has no style-related properties; therefore, all style-related changes made to a `RepeaterItem` in the `ItemDataBound` event handler must be done by programmatically accessing and updating Web controls within the template.</span></span>

<span data-ttu-id="253da-150">Поскольку `ItemDataBound` форматирование прием для DataList и повторителя практически идентичны, нашем примере мы сосредоточимся на использовании DataList.</span><span class="sxs-lookup"><span data-stu-id="253da-150">Since the `ItemDataBound` formatting technique for the DataList and Repeater are virtually identical, our example will focus on using the DataList.</span></span>

## <a name="step-1-displaying-product-information-in-the-datalist"></a><span data-ttu-id="253da-151">Шаг 1: Отображение сведений о продукте в DataList</span><span class="sxs-lookup"><span data-stu-id="253da-151">Step 1: Displaying Product Information in the DataList</span></span>

<span data-ttu-id="253da-152">Прежде чем мы беспокоиться о форматировании, позволяют s сначала создать страницы, использующей DataList для отображения сведений о продукте.</span><span class="sxs-lookup"><span data-stu-id="253da-152">Before we worry about the formatting, let s first create a page that uses a DataList to display product information.</span></span> <span data-ttu-id="253da-153">В [с предыдущим учебником](displaying-data-with-the-datalist-and-repeater-controls-vb.md) мы создали DataList которого `ItemTemplate` отображается каждого s название продукта, категория, поставщик, количество за единицу и цены.</span><span class="sxs-lookup"><span data-stu-id="253da-153">In the [previous tutorial](displaying-data-with-the-datalist-and-repeater-controls-vb.md) we created a DataList whose `ItemTemplate` displayed each product s name, category, supplier, quantity per unit, and price.</span></span> <span data-ttu-id="253da-154">Разрешить s Повторите этих функциональных возможностей в этом учебнике.</span><span class="sxs-lookup"><span data-stu-id="253da-154">Let s repeat this functionality here in this tutorial.</span></span> <span data-ttu-id="253da-155">Для этого можно воссоздать DataList и его ObjectDataSource с нуля или скопировать в эти элементы управления на странице, созданной в предыдущем учебнике (`Basics.aspx`) и вставьте их в страницы в этом учебнике (`Formatting.aspx`).</span><span class="sxs-lookup"><span data-stu-id="253da-155">To accomplish this, you can either recreate the DataList and its ObjectDataSource from scratch, or you can copy over those controls from the page created in the previous tutorial (`Basics.aspx`) and paste them into the page for this tutorial (`Formatting.aspx`).</span></span>

<span data-ttu-id="253da-156">После репликации DataList и ObjectDataSource функции `Basics.aspx` в `Formatting.aspx`, занять некоторое время для изменения DataList s `ID` свойство из `DataList1` на более описательное `ItemDataBoundFormattingExample`.</span><span class="sxs-lookup"><span data-stu-id="253da-156">Once you have replicated the DataList and ObjectDataSource functionality from `Basics.aspx` into `Formatting.aspx`, take a moment to change the DataList s `ID` property from `DataList1` to a more descriptive `ItemDataBoundFormattingExample`.</span></span> <span data-ttu-id="253da-157">После этого просмотра DataList в браузере.</span><span class="sxs-lookup"><span data-stu-id="253da-157">Next, view the DataList in a browser.</span></span> <span data-ttu-id="253da-158">Как показано на рис. 1, форматирования между каждого продукта отличается только что переключается цвет фона.</span><span class="sxs-lookup"><span data-stu-id="253da-158">As Figure 1 shows, the only formatting difference between each product is that the background color alternates.</span></span>


<span data-ttu-id="253da-159">[![Продукты отображаются в элементе управления DataList](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="253da-159">[![The Products are Listed in the DataList Control](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image1.png)</span></span>

<span data-ttu-id="253da-160">**Рис. 1**: продукты отображаются в элементе управления DataList ([Просмотр полноразмерное изображение](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="253da-160">**Figure 1**: The Products are Listed in the DataList Control ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image3.png))</span></span>


<span data-ttu-id="253da-161">В этом учебнике позволяют s форматирования DataList таким образом, что все продукты с ценой менее $20,00 будет иметь оба его имя и цену единицы выделен желтым цветом.</span><span class="sxs-lookup"><span data-stu-id="253da-161">For this tutorial, let s format the DataList such that any products with a price less than $20.00 will have both its name and unit price highlighted yellow.</span></span>

## <a name="step-2-programmatically-determining-the-value-of-the-data-in-the-itemdatabound-event-handler"></a><span data-ttu-id="253da-162">Шаг 2: Программное определение значений данных в обработчике событий ItemDataBound</span><span class="sxs-lookup"><span data-stu-id="253da-162">Step 2: Programmatically Determining the Value of the Data in the ItemDataBound Event Handler</span></span>

<span data-ttu-id="253da-163">Поскольку только те продукты, цена в $20,00 будет применен пользовательский формат, должен быть могут определять каждую s цену продукта.</span><span class="sxs-lookup"><span data-stu-id="253da-163">Since only those products with a price under $20.00 will have the custom formatting applied, we must be able to determine each product s price.</span></span> <span data-ttu-id="253da-164">При привязке данных к DataList, DataList перечисляет записей в источник данных и для каждой записи создается `DataListItem` экземпляра, запись в источнике данных для привязки `DataListItem`.</span><span class="sxs-lookup"><span data-stu-id="253da-164">When binding data to a DataList, the DataList enumerates the records in its data source and, for each record, creates a `DataListItem` instance, binding the data source record to the `DataListItem`.</span></span> <span data-ttu-id="253da-165">После конкретной записи s привязки данных к текущему `DataListItem` объекта DataList s `ItemDataBound` событие.</span><span class="sxs-lookup"><span data-stu-id="253da-165">After the particular record s data has been bound to the current `DataListItem` object, the DataList s `ItemDataBound` event is fired.</span></span> <span data-ttu-id="253da-166">Можно создать обработчик событий для этого события, чтобы проверить значения данных для текущего `DataListItem` и, основываясь на эти значения, внесите необходимые изменения форматирования.</span><span class="sxs-lookup"><span data-stu-id="253da-166">We can create an event handler for this event to inspect the data values for the current `DataListItem` and, based upon those values, make any formatting changes necessary.</span></span>

<span data-ttu-id="253da-167">Создание `ItemDataBound` событий для DataList и добавьте следующий код:</span><span class="sxs-lookup"><span data-stu-id="253da-167">Create an `ItemDataBound` event for the DataList and add the following code:</span></span>


[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample1.vb)]

<span data-ttu-id="253da-168">Во время концепции и семантикой DataList s `ItemDataBound` обработчик событий совпадают с используемыми GridView s `RowDataBound` обработчик событий в *форматирование на основе по данным* учебнике ее синтаксис отличается немного.</span><span class="sxs-lookup"><span data-stu-id="253da-168">While the concept and semantics behind the DataList s `ItemDataBound` event handler are the same as those used by the GridView s `RowDataBound` event handler in the *Custom Formatting Based Upon Data* tutorial, the syntax differs slightly.</span></span> <span data-ttu-id="253da-169">При `ItemDataBound` события `DataListItem` только с привязкой к данным, передается в соответствующий обработчик событий через `e.Item` (вместо `e.Row`, как и в случае с GridView s `RowDataBound` обработчика событий).</span><span class="sxs-lookup"><span data-stu-id="253da-169">When the `ItemDataBound` event fires, the `DataListItem` just bound to data is passed into corresponding event handler via `e.Item` (instead of `e.Row`, as with the GridView s `RowDataBound` event handler).</span></span> <span data-ttu-id="253da-170">Элемент управления DataList s `ItemDataBound` запускает обработчик событий для *каждого* строки, добавляемой в DataList, включая строки верхнего колонтитула, нижнего колонтитула и разделитель строк.</span><span class="sxs-lookup"><span data-stu-id="253da-170">The DataList s `ItemDataBound` event handler fires for *each* row added to the DataList, including header rows, footer rows, and separator rows.</span></span> <span data-ttu-id="253da-171">Тем не менее сведения о продукте ограничена только на строки данных.</span><span class="sxs-lookup"><span data-stu-id="253da-171">However, the product information is only bound to the data rows.</span></span> <span data-ttu-id="253da-172">Таким образом при использовании `ItemDataBound` события, чтобы проверить данные привязаны к DataList, нам нужно убедиться, что мы re работа с элементом данных.</span><span class="sxs-lookup"><span data-stu-id="253da-172">Therefore, when using the `ItemDataBound` event to inspect the data bound to the DataList, we need to first ensure that we re working with a data item.</span></span> <span data-ttu-id="253da-173">Это можно сделать, проверив `DataListItem` s [ `ItemType` свойство](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx), который может иметь одно из [следующих восьми значений](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx):</span><span class="sxs-lookup"><span data-stu-id="253da-173">This can be accomplished by checking the `DataListItem` s [`ItemType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx), which can have one of [the following eight values](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx):</span></span>

- `AlternatingItem`
- `EditItem`
- `Footer`
- `Header`
- `Item`
- `Pager`
- `SelectedItem`
- `Separator`

<span data-ttu-id="253da-174">Оба `Item` и `AlternatingItem``DataListItem` элементов данных s состава DataList s.</span><span class="sxs-lookup"><span data-stu-id="253da-174">Both `Item` and `AlternatingItem``DataListItem` s makeup the DataList s data items.</span></span> <span data-ttu-id="253da-175">При условии, что мы re работа с `Item` или `AlternatingItem`, мы доступа к самим `ProductsRow` экземпляр, который был связан с текущим `DataListItem`.</span><span class="sxs-lookup"><span data-stu-id="253da-175">Assuming we re working with an `Item` or `AlternatingItem`, we access the actual `ProductsRow` instance that was bound to the current `DataListItem`.</span></span> <span data-ttu-id="253da-176">`DataListItem` s [ `DataItem` свойство](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx) содержит ссылку на `DataRowView` объекта, в которых `Row` свойство предоставляет ссылку на фактический `ProductsRow` объекта.</span><span class="sxs-lookup"><span data-stu-id="253da-176">The `DataListItem` s [`DataItem` property](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx) contains a reference to the `DataRowView` object, whose `Row` property provides a reference to the actual `ProductsRow` object.</span></span>

<span data-ttu-id="253da-177">Далее мы проверяем, `ProductsRow` экземпляра s `UnitPrice` свойство.</span><span class="sxs-lookup"><span data-stu-id="253da-177">Next, we check the `ProductsRow` instance s `UnitPrice` property.</span></span> <span data-ttu-id="253da-178">Поскольку для таблицы Products s `UnitPrice` поле позволяет `NULL` значения, прежде чем пытаться получить доступ к `UnitPrice` свойство нам необходимо проверить, имеет ли `NULL` с использованием `IsUnitPriceNull()` метод.</span><span class="sxs-lookup"><span data-stu-id="253da-178">Since the Products table s `UnitPrice` field allows `NULL` values, before attempting to access the `UnitPrice` property we should first check to see if it has a `NULL` value using the `IsUnitPriceNull()` method.</span></span> <span data-ttu-id="253da-179">Если `UnitPrice` значение не `NULL`, затем проверьте ли его s меньше $20,00.</span><span class="sxs-lookup"><span data-stu-id="253da-179">If the `UnitPrice` value is not `NULL`, we then check to see if it s less than $20.00.</span></span> <span data-ttu-id="253da-180">Если это действительно в разделе 20,00 долларов, нам потребуется применения пользовательских форматов.</span><span class="sxs-lookup"><span data-stu-id="253da-180">If it is indeed under $20.00, we then need to apply the custom formatting.</span></span>

## <a name="step-3-highlighting-the-product-s-name-and-price"></a><span data-ttu-id="253da-181">Шаг 3: Выделение s имя продукта и цену</span><span class="sxs-lookup"><span data-stu-id="253da-181">Step 3: Highlighting the Product s Name and Price</span></span>

<span data-ttu-id="253da-182">Когда мы знаем, что цена продукта s — меньше $20,00, остается выделите ее название и цену.</span><span class="sxs-lookup"><span data-stu-id="253da-182">Once we know that a product s price is less than $20.00, all that remains is to highlight its name and price.</span></span> <span data-ttu-id="253da-183">Чтобы сделать это, мы сначала необходимо программно добавить ссылку меток в `ItemTemplate` , отобразить имя продукта s и цену.</span><span class="sxs-lookup"><span data-stu-id="253da-183">To accomplish this, we must first programmatically reference the Label controls in the `ItemTemplate` that display the product s name and price.</span></span> <span data-ttu-id="253da-184">Теперь нам нужны отображение желтым фоном.</span><span class="sxs-lookup"><span data-stu-id="253da-184">Next, we need to have them display a yellow background.</span></span> <span data-ttu-id="253da-185">Эти сведения о форматировании могут применяться изменения непосредственно в метках `BackColor` свойства (`LabelID.BackColor = Color.Yellow`); в идеальном случае менее, все аспекты использования отображение связанных должна быть выражена через каскадные таблицы стилей.</span><span class="sxs-lookup"><span data-stu-id="253da-185">This formatting information can be applied by directly modifying the Labels `BackColor` properties (`LabelID.BackColor = Color.Yellow`); ideally, though, all display-related matters should be expressed through cascading stylesheets.</span></span> <span data-ttu-id="253da-186">На самом деле у нас уже есть таблицы стилей, предоставляет нужный формат, определенный в `Styles.css`  -  `AffordablePriceEmphasis`, которой был создан и обсуждается в *форматирование на основе по данным* учебника.</span><span class="sxs-lookup"><span data-stu-id="253da-186">In fact, we already have a stylesheet that provides the desired formatting defined in `Styles.css` - `AffordablePriceEmphasis`, which was created and discussed in the *Custom Formatting Based Upon Data* tutorial.</span></span>

<span data-ttu-id="253da-187">Чтобы применить форматирование, просто установите два элемента управления Label Web `CssClass` свойства `AffordablePriceEmphasis`, как показано в следующем коде:</span><span class="sxs-lookup"><span data-stu-id="253da-187">To apply the formatting, simply set the two Label Web controls `CssClass` properties to `AffordablePriceEmphasis`, as shown in the following code:</span></span>


[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample2.vb)]

<span data-ttu-id="253da-188">С `ItemDataBound` завершения обработчика событий, повторное использование `Formatting.aspx` страницы в браузере.</span><span class="sxs-lookup"><span data-stu-id="253da-188">With the `ItemDataBound` event handler completed, revisit the `Formatting.aspx` page in a browser.</span></span> <span data-ttu-id="253da-189">Как показано на рисунке 2, эти продукты с ценой под $20,00 иметь их имени и цена выделяются.</span><span class="sxs-lookup"><span data-stu-id="253da-189">As Figure 2 illustrates, those products with a price under $20.00 have both their name and price highlighted.</span></span>


<span data-ttu-id="253da-190">[![Эти продукты меньше $20,00 выделяются](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="253da-190">[![Those Products Less than $20.00 are Highlighted](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image4.png)</span></span>

<span data-ttu-id="253da-191">**На рисунке 2**: тех продуктов меньше $20,00 выделяются ([Просмотр полноразмерное изображение](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="253da-191">**Figure 2**: Those Products Less than $20.00 are Highlighted ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image6.png))</span></span>


> [!NOTE]
> <span data-ttu-id="253da-192">Поскольку элемент управления DataList подготавливается к просмотру как HTML `<table>`, ее `DataListItem` экземпляры имеют относящихся к стилю свойств, которые могут быть установлены для применения определенных стилей для всего элемента.</span><span class="sxs-lookup"><span data-stu-id="253da-192">Since the DataList is rendered as an HTML `<table>`, its `DataListItem` instances have style-related properties that can be set to apply a specific style to the entire item.</span></span> <span data-ttu-id="253da-193">Например, если требуется выделить *всей* yellow элемента при его стоимость была меньше $20,00, нам удалось заменили код, ссылки на метки и задайте их `CssClass` свойства с помощью следующей строки кода: `e.Item.CssClass = "AffordablePriceEmphasis"` (см. рис. 3).</span><span class="sxs-lookup"><span data-stu-id="253da-193">For example, if we wanted to highlight the *entire* item yellow when its price was less than $20.00, we could have replaced the code that referenced the Labels and set their `CssClass` properties with the following line of code: `e.Item.CssClass = "AffordablePriceEmphasis"` (see Figure 3).</span></span>


<span data-ttu-id="253da-194">`RepeaterItem` , Составляющих элементе управления повторителем, однако t больше не предоставляют такие свойства стиля уровня.</span><span class="sxs-lookup"><span data-stu-id="253da-194">The `RepeaterItem` s that make up the Repeater control, however, don t offer such style-level properties.</span></span> <span data-ttu-id="253da-195">Таким образом Применение пользовательского форматирования для повторителя требуется применение свойства стиля для веб-элементов управления в шаблонах повторителя s, так же, как мы делали на рис. 2.</span><span class="sxs-lookup"><span data-stu-id="253da-195">Therefore, applying custom formatting to the Repeater requires the application of style properties to the Web controls within the Repeater s templates, just like we did in Figure 2.</span></span>


<span data-ttu-id="253da-196">[![Для продуктов в списке $20,00 выделяется весь элемент продукта](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="253da-196">[![The Entire Product Item is Highlighted for Products Under $20.00](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image7.png)</span></span>

<span data-ttu-id="253da-197">**Рис. 3**: для продуктов в списке $20,00 выделяется весь элемент продукта ([Просмотр полноразмерное изображение](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="253da-197">**Figure 3**: The Entire Product Item is Highlighted for Products Under $20.00 ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image9.png))</span></span>


## <a name="using-formatting-functions-from-within-the-template"></a><span data-ttu-id="253da-198">С помощью функции форматирования из шаблона</span><span class="sxs-lookup"><span data-stu-id="253da-198">Using Formatting Functions from Within the Template</span></span>

<span data-ttu-id="253da-199">В *с помощью TemplateFields в элементе управления GridView* учебника мы узнали, как использовать функции форматирования в GridView TemplateField для применения пользовательских форматов на основе данных, привязанным с строкам s GridView.</span><span class="sxs-lookup"><span data-stu-id="253da-199">In the *Using TemplateFields in the GridView Control* tutorial we saw how to use a formatting function within a GridView TemplateField to apply custom formatting based upon the data bound to the GridView s rows.</span></span> <span data-ttu-id="253da-200">Функции форматирования — метод, который может вызываться из шаблона и возвращает HTML-код может быть выпущен в его место.</span><span class="sxs-lookup"><span data-stu-id="253da-200">A formatting function is a method that can be invoked from a template and returns the HTML to be emitted in its place.</span></span> <span data-ttu-id="253da-201">Функции форматирования может находиться в классе фонового кода ASP.NET страницы s или будет сосредоточено в файлах классов в `App_Code` папке или в отдельном проекте библиотеки классов.</span><span class="sxs-lookup"><span data-stu-id="253da-201">Formatting functions can reside in the ASP.NET page s code-behind class or can be centralized into class files in the `App_Code` folder or in a separate Class Library project.</span></span> <span data-ttu-id="253da-202">Перемещение функции форматирования из класс кода программной s страницы ASP.NET, лучше, если вы планируете использовать одну и ту же функцию форматирования на нескольких страницах ASP.NET, или в других веб-приложений ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="253da-202">Moving the formatting function out of the ASP.NET page s code-behind class is ideal if you plan on using the same formatting function in multiple ASP.NET pages or in other ASP.NET web applications.</span></span>

<span data-ttu-id="253da-203">Для демонстрации функции форматирования, s позволяют иметь сведения о продукте, которая включает текст [DISCONTINUED] рядом с именем product s, при его s более не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="253da-203">To demonstrate formatting functions, let s have the product information include the text [DISCONTINUED] next to the product s name if it s discontinued.</span></span> <span data-ttu-id="253da-204">Также позволяют s имеют выделенный желтый Если цена его s меньше $20,00 (как это делалось `ItemDataBound` пример обработчика событий); Если цена таких товаров не $20,00 или выше, позволяют s Отображает фактические цены, но вместо этого текст, выполните вызов цены.</span><span class="sxs-lookup"><span data-stu-id="253da-204">Also, let s have the price highlighted yellow if it s less than $20.00 (as we did in the `ItemDataBound` event handler example); if the price is $20.00 or higher, let s not display the actual price, but instead the text, Please call for a price quote.</span></span> <span data-ttu-id="253da-205">На рисунке 4 показаны снимок экрана список с правилами форматирования применяется продуктов.</span><span class="sxs-lookup"><span data-stu-id="253da-205">Figure 4 shows a screen shot of the products listing with these formatting rules applied.</span></span>


<span data-ttu-id="253da-206">[![Дорогих товаров цена заменяется текст, вызовите цены](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="253da-206">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image10.png)</span></span>

<span data-ttu-id="253da-207">**Рис. 4**: дорогих товаров, цена заменяется текст, вызовите цены ([Просмотр полноразмерное изображение](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="253da-207">**Figure 4**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image12.png))</span></span>


## <a name="step-1-create-the-formatting-functions"></a><span data-ttu-id="253da-208">Шаг 1: Создание функции форматирования</span><span class="sxs-lookup"><span data-stu-id="253da-208">Step 1: Create the Formatting Functions</span></span>

<span data-ttu-id="253da-209">В этом примере мы должны две функции форматирования, один, отображающий название продукта вместе с текстом [DISCONTINUED], при необходимости, а другой, выделенная цены, если он меньше, чем $20,00 или текст, вызовите для предложения цены в противном случае.</span><span class="sxs-lookup"><span data-stu-id="253da-209">For this example we need two formatting functions, one that displays the product name along with the text [DISCONTINUED], if needed, and another that displays either a highlighted price if it s less than $20.00, or the text, Please call for a price quote otherwise.</span></span> <span data-ttu-id="253da-210">Разрешить s создания этих функций в классе фонового кода ASP.NET страницы s и назовите их `DisplayProductNameAndDiscontinuedStatus` и `DisplayPrice`.</span><span class="sxs-lookup"><span data-stu-id="253da-210">Let s create these functions in the ASP.NET page s code-behind class and name them `DisplayProductNameAndDiscontinuedStatus` and `DisplayPrice`.</span></span> <span data-ttu-id="253da-211">Оба метода должны возвращать HTML для подготовки к просмотру в виде строки и должны быть помечены `Protected` (или `Public`) для вызова из области декларативный синтаксис страницы s в ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="253da-211">Both methods need to return the HTML to render as a string and both need to be marked `Protected` (or `Public`) in order to be invoked from the ASP.NET page s declarative syntax portion.</span></span> <span data-ttu-id="253da-212">Код для этих двух методов выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="253da-212">The code for these two methods follows:</span></span>


[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample3.vb)]

<span data-ttu-id="253da-213">Обратите внимание, что `DisplayProductNameAndDiscontinuedStatus` метод принимает значения `productName` и `discontinued` как скалярные значения поля данных, тогда как `DisplayPrice` метод принимает `ProductsRow` экземпляра (а не `unitPrice` скалярное значение).</span><span class="sxs-lookup"><span data-stu-id="253da-213">Note that the `DisplayProductNameAndDiscontinuedStatus` method accepts the values of the `productName` and `discontinued` data fields as scalar values, whereas the `DisplayPrice` method accepts a `ProductsRow` instance (rather than a `unitPrice` scalar value).</span></span> <span data-ttu-id="253da-214">Оба подхода могут использоваться; Тем не менее работает ли функции форматирования со скалярными значениями, которые могут содержать базы данных `NULL` значения (такие как `UnitPrice`; ни один из `ProductName` ни `Discontinued` Разрешить `NULL` значения), необходимо уделить особое при обработке этих скалярные входных данных.</span><span class="sxs-lookup"><span data-stu-id="253da-214">Either approach will work; however, if the formatting function is working with scalar values that can contain database `NULL` values (such as `UnitPrice`; neither `ProductName` nor `Discontinued` allow `NULL` values), special care must be taken in handling these scalar inputs.</span></span>

<span data-ttu-id="253da-215">В частности, входной параметр должен иметь тип `Object` поскольку входящее значение может быть `DBNull` экземпляром, а не в ожидаемый тип данных.</span><span class="sxs-lookup"><span data-stu-id="253da-215">In particular, the input parameter must be of type `Object` since the incoming value might be a `DBNull` instance instead of the expected data type.</span></span> <span data-ttu-id="253da-216">Кроме того, чтобы определить, является ли входное значение базы данных необходимо сделать проверку `NULL` значение.</span><span class="sxs-lookup"><span data-stu-id="253da-216">Additionally, a check must be made to determine whether or not the incoming value is a database `NULL` value.</span></span> <span data-ttu-id="253da-217">То есть если бы мы хотели `DisplayPrice` метод, принимающий цена в виде скалярного значения, d, мы должны использовать следующий код:</span><span class="sxs-lookup"><span data-stu-id="253da-217">That is, if we wanted the `DisplayPrice` method to accept the price as a scalar value, we d have to use the following code:</span></span>


[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample4.vb)]

<span data-ttu-id="253da-218">Обратите внимание, что `unitPrice` входной параметр имеет тип `Object` и, чтобы выяснить, если был изменен условного оператора `unitPrice` — `DBNull` или нет.</span><span class="sxs-lookup"><span data-stu-id="253da-218">Note that the `unitPrice` input parameter is of type `Object` and that the conditional statement has been modified to ascertain if `unitPrice` is `DBNull` or not.</span></span> <span data-ttu-id="253da-219">Кроме того, с момента `unitPrice` входного параметра передается в качестве `Object`, он должен быть приведен в десятичное значение.</span><span class="sxs-lookup"><span data-stu-id="253da-219">Furthermore, since the `unitPrice` input parameter is passed in as an `Object`, it must be cast to a decimal value.</span></span>

## <a name="step-2-calling-the-formatting-function-from-the-datalist-s-itemtemplate"></a><span data-ttu-id="253da-220">Шаг 2: Вызов функции форматирования из DataList s ItemTemplate</span><span class="sxs-lookup"><span data-stu-id="253da-220">Step 2: Calling the Formatting Function from the DataList s ItemTemplate</span></span>

<span data-ttu-id="253da-221">С помощью форматирования функции, добавленные в нашем ASP.NET s кода класса страницы, остается только для вызова этих функций из DataList s форматирования `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="253da-221">With the formatting functions added to our ASP.NET page s code-behind class, all that remains is to invoke these formatting functions from the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="253da-222">Для вызова функции форматирования на основе шаблона, поместите вызов функции в синтаксис привязки данных:</span><span class="sxs-lookup"><span data-stu-id="253da-222">To call a formatting function from a template, place the function call within the databinding syntax:</span></span>


[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample5.aspx)]

<span data-ttu-id="253da-223">В DataList s `ItemTemplate` `ProductNameLabel` веб-управления Label в данный момент отображаются имя продукта s, назначив его `Text` свойство результат из `<%# Eval("ProductName") %>`.</span><span class="sxs-lookup"><span data-stu-id="253da-223">In the DataList s `ItemTemplate` the `ProductNameLabel` Label Web control currently displays the product s name by assigning its `Text` property the result of `<%# Eval("ProductName") %>`.</span></span> <span data-ttu-id="253da-224">Чтобы отобразить имя и текст [DISCONTINUED], при необходимости, обновите декларативный синтаксис так, чтобы вместо назначает `Text` свойства значение из `DisplayProductNameAndDiscontinuedStatus` метод.</span><span class="sxs-lookup"><span data-stu-id="253da-224">In order to have it display the name plus the text [DISCONTINUED], if needed, update the declarative syntax so that it instead assigns the `Text` property the value of the `DisplayProductNameAndDiscontinuedStatus` method.</span></span> <span data-ttu-id="253da-225">При этом необходимо передать в название продукта s и неподдерживаемые значения, с использованием `Eval("columnName")` синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="253da-225">When doing so, we must pass in the product s name and discontinued values using the `Eval("columnName")` syntax.</span></span> <span data-ttu-id="253da-226">`Eval` Возвращает значение типа `Object`, но `DisplayProductNameAndDiscontinuedStatus` метод ожидает входные параметры типа `String` и `Boolean`; таким образом, мы должны приведены значения, возвращаемые методом `Eval` метод типам ожидаемый входной параметр следующим образом:</span><span class="sxs-lookup"><span data-stu-id="253da-226">`Eval` returns a value of type `Object`, but the `DisplayProductNameAndDiscontinuedStatus` method expects input parameters of type `String` and `Boolean`; therefore, we must cast the values returned by the `Eval` method to the expected input parameter types, like so:</span></span>


[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample6.aspx)]

<span data-ttu-id="253da-227">Чтобы отобразить цены, мы просто задать `UnitPriceLabel` метки s `Text` свойство в значение, возвращаемое `DisplayPrice` метод так же, как мы для отображения имени продукта s, а [НЕПОДДЕРЖИВАЕМЫЕ] текста.</span><span class="sxs-lookup"><span data-stu-id="253da-227">To display the price, we can simply set the `UnitPriceLabel` Label s `Text` property to the value returned by the `DisplayPrice` method, just like we did for displaying the product s name and [DISCONTINUED] text.</span></span> <span data-ttu-id="253da-228">Однако вместо передачи в `UnitPrice` как скалярный входной параметр, вместо этого передается во всем `ProductsRow` экземпляр:</span><span class="sxs-lookup"><span data-stu-id="253da-228">However, instead of passing in the `UnitPrice` as a scalar input parameter, we instead pass in the entire `ProductsRow` instance:</span></span>


[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample7.aspx)]

<span data-ttu-id="253da-229">С вызовами функций форматирования в месте мгновение просмотрите ход работы в браузере.</span><span class="sxs-lookup"><span data-stu-id="253da-229">With the calls to the formatting functions in place, take a moment to view our progress in a browser.</span></span> <span data-ttu-id="253da-230">Экран должен выглядеть аналогично рис. 5 с неподдерживаемые продукты, включая текст [DISCONTINUED] и продукты стоимостью более $20,00 необходимости их цена заменяются текст выполните вызов цены.</span><span class="sxs-lookup"><span data-stu-id="253da-230">Your screen should look similar to Figure 5, with the discontinued products including the text [DISCONTINUED] and those products costing more than $20.00 having their price replaced with the text Please call for a price quote .</span></span>


<span data-ttu-id="253da-231">[![Дорогих товаров цена заменяется текст, вызовите цены](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="253da-231">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image13.png)</span></span>

<span data-ttu-id="253da-232">**Рис. 5**: дорогих товаров, цена заменяется текст, вызовите цены ([Просмотр полноразмерное изображение](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="253da-232">**Figure 5**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image15.png))</span></span>


## <a name="summary"></a><span data-ttu-id="253da-233">Сводка</span><span class="sxs-lookup"><span data-stu-id="253da-233">Summary</span></span>

<span data-ttu-id="253da-234">Форматирование содержимого элемента управления DataList и повторителя на основе данных может выполняться с помощью двух методов.</span><span class="sxs-lookup"><span data-stu-id="253da-234">Formatting the contents of a DataList or Repeater control based upon the data can be accomplished using two techniques.</span></span> <span data-ttu-id="253da-235">Первый способ состоит в том, чтобы создать обработчик событий для `ItemDataBound` событие, которое вызывается при каждой записи в источнике данных, привязанного к новый `DataListItem` или `RepeaterItem`.</span><span class="sxs-lookup"><span data-stu-id="253da-235">The first technique is to create an event handler for the `ItemDataBound` event, which fires as each record in the data source is bound to a new `DataListItem` or `RepeaterItem`.</span></span> <span data-ttu-id="253da-236">В `ItemDataBound` обработчик событий, можно проверить текущие данные элемент s и затем форматирование может применяться к содержимое шаблона, или для `DataListItem` s для всего самого элемента.</span><span class="sxs-lookup"><span data-stu-id="253da-236">In the `ItemDataBound` event handler, the current item s data can be examined and then formatting can be applied to the contents of the template or, for `DataListItem` s, to the entire item itself.</span></span>

<span data-ttu-id="253da-237">Кроме того пользовательский формат можно реализовать через функций форматирования.</span><span class="sxs-lookup"><span data-stu-id="253da-237">Alternatively, custom formatting can be realized through formatting functions.</span></span> <span data-ttu-id="253da-238">Функции форматирования — метод, который может быть вызвана из DataList или повторителя s шаблоны, которые возвращает HTML-код для создания на его месте.</span><span class="sxs-lookup"><span data-stu-id="253da-238">A formatting function is a method that can be invoked from the DataList or Repeater s templates that returns the HTML to emit in its place.</span></span> <span data-ttu-id="253da-239">Часто возвращаемые функцией форматирования HTML определяется значениями, которая привязывается к текущему элементу.</span><span class="sxs-lookup"><span data-stu-id="253da-239">Often, the HTML returned by a formatting function is determined by the values being bound to the current item.</span></span> <span data-ttu-id="253da-240">Эти значения можно передать в функцию форматирования как скалярные значения или путем передачи всего объекта, которая привязывается к элементу (такие как `ProductsRow` экземпляра).</span><span class="sxs-lookup"><span data-stu-id="253da-240">These values can be passed into the formatting function, either as scalar values or by passing in the entire object being bound to the item (such as the `ProductsRow` instance).</span></span>

<span data-ttu-id="253da-241">Программирование довольны!</span><span class="sxs-lookup"><span data-stu-id="253da-241">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="253da-242">Об авторе</span><span class="sxs-lookup"><span data-stu-id="253da-242">About the Author</span></span>

<span data-ttu-id="253da-243">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи ASP/ASP.NET и основателя из [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Майкрософт с 1998 года.</span><span class="sxs-lookup"><span data-stu-id="253da-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="253da-244">Скотт — независимый консультант, trainer и записи.</span><span class="sxs-lookup"><span data-stu-id="253da-244">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="253da-245">Его последняя книга — [ *диспетчерами учат самостоятельно ASP.NET 2.0 в течение 24 часов*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="253da-245">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="253da-246">Он может быть достигнута по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) или через его блог, который можно найти в [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="253da-246">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="253da-247">Благодарности</span><span class="sxs-lookup"><span data-stu-id="253da-247">Special Thanks To</span></span>

<span data-ttu-id="253da-248">Этот учебник ряд прошел проверку многие полезные рецензентов.</span><span class="sxs-lookup"><span data-stu-id="253da-248">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="253da-249">Основными редакторами этого учебника были Yaakov Эллис (Ellis) и Рэнди Шмидт, (Liz Shulok).</span><span class="sxs-lookup"><span data-stu-id="253da-249">Lead reviewers for this tutorial were Yaakov Ellis, Randy Schmidt, and Liz Shulok.</span></span> <span data-ttu-id="253da-250">Объясняются моих последующих статей для MSDN?</span><span class="sxs-lookup"><span data-stu-id="253da-250">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="253da-251">Если Да, напишите мне по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="253da-251">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="253da-252">[Назад](displaying-data-with-the-datalist-and-repeater-controls-vb.md)
> [Вперед](showing-multiple-records-per-row-with-the-datalist-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="253da-252">[Previous](displaying-data-with-the-datalist-and-repeater-controls-vb.md)
[Next](showing-multiple-records-per-row-with-the-datalist-control-vb.md)</span></span>
