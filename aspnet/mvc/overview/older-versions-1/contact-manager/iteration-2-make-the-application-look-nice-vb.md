---
uid: mvc/overview/older-versions-1/contact-manager/iteration-2-make-the-application-look-nice-vb
title: 'Итерации #2 — сделать приложение поиска работы с низким приоритетом (VB) | Документы Microsoft'
author: microsoft
description: В этой итерации нам улучшить внешний вид приложения, изменив значение по умолчанию главной страницы представления ASP.NET MVC и каскадные таблицы стилей.
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2009
ms.topic: article
ms.assetid: f65cb436-e493-46fd-9608-384b27385aa1
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-2-make-the-application-look-nice-vb
msc.type: authoredcontent
ms.openlocfilehash: 8545351b099e52533789b372903cd493f533f834
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="iteration-2--make-the-application-look-nice-vb"></a>Итерации #2 — сделать приложение поиска работы с низким приоритетом (Visual Basic)
====================
по [Microsoft](https://github.com/microsoft)

[Загрузить исходный код](iteration-2-make-the-application-look-nice-vb/_static/contactmanager_2_vb1.zip)

> В этой итерации нам улучшить внешний вид приложения, изменив значение по умолчанию главной страницы представления ASP.NET MVC и каскадные таблицы стилей.


## <a name="building-a-contact-management-aspnet-mvc-application-vb"></a>Создание приложения ASP.NET MVC управления контактами (Visual Basic)
  

В этой серии учебники мы создаем всего приложения управления контактами от начала и завершения. Приложение диспетчера контактов позволяет хранить контактные данные — имена, телефонных номеров и адресах электронной почты — список людей.

Мы постройте приложение в нескольких итерациях. С каждой итерацией постепенно мы улучшить приложение. Это несколько итераций предназначена для того, чтобы позволяют понять причину для каждого изменения.

- Итерация #1 – Создание приложения. В первой итерации мы создадим диспетчера контактов простейшим способом невозможно. Добавлена поддержка для основных операций базы данных: создание, чтение, обновление и удаление (CRUD).

- Итерации #2 — сделать приложение поиска работы с низким приоритетом. В этой итерации нам улучшить внешний вид приложения, изменив значение по умолчанию главной страницы представления ASP.NET MVC и каскадные таблицы стилей.

- Итерация #3 – добавить проверку формы. В третьем проходе добавим проверки базовой формы. Мы запретить отправки формы, не завершая обязательные поля. Мы также для проверки адреса электронной почты и номера телефонов.

- Итерации #4 — сделать приложение слабо. В этой третьей итерации мы воспользоваться преимуществами нескольких шаблонов разработки программного обеспечения, чтобы упростить обслуживание и изменить приложение диспетчера контактов. Например мы выполнили рефакторинг наше приложение, чтобы использовать шаблон репозитория и шаблон внедрения зависимостей.

- Итерация #5 – Создание модульных тестов. В пятой итерации сделан нашего приложения проще в обслуживании и изменить, добавив модульных тестов. Мы макета наших классов модели данных и создания модульных тестов для наших контроллеров и логику проверки.

- Итерация 6 # — с помощью управляемой тестами разработки. В итерации этого шестой мы добавим новые функциональные возможности наше приложение, сначала написание модульных тестов и писать код для модульных тестов. В этой итерации добавим групп контактов.

- Итерация #7 — Ajax добавить функциональные возможности. В седьмой итерации мы повысить скорость реагирования и производительности приложения, добавляя поддержку Ajax.

## <a name="this-iteration"></a>Этой итерации

Эту итерацию предназначена для того, чтобы улучшить внешний вид приложение диспетчера контактов. В настоящее время Диспетчер контактов использует по умолчанию ASP.NET MVC представления главной страницы и таблицы каскадных стилей (см. рис. 1). Эти Дон t выглядеть неправильный, но нигде t выполнялись диспетчера контактов для поиска так же, как каждый других ASP.NET MVC веб-сайта. Я хочу заменить эти файлы пользовательские файлы.


[![Диалоговое окно нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image1.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image1.png)

**На рисунке 01**: внешний вид приложения ASP.NET MVC по умолчанию ([Просмотр полноразмерное изображение](iteration-2-make-the-application-look-nice-vb/_static/image2.png))


В этой итерации обсуждаются два подхода к улучшению визуальной разработки приложения. Во-первых я показано, как использовать преимущества ASP.NET MVC макетов для загрузки свободного шаблон разработки ASP.NET MVC. Макетов ASP.NET MVC позволяет создавать профессиональные веб-приложения без выполнения действий.

Я решил не использовать шаблон из библиотеки макетов MVC ASP.NET для приложения диспетчера контактов. Вместо этого у меня возникли созданные фирмы профессиональное пользовательской системы. Во второй части этого учебника я объясню, как работает с профессиональное компании, чтобы создать итоговый проект ASP.NET MVC.

## <a name="the-aspnet-mvc-design-gallery"></a>ASP.NET MVC макетов

ASP.NET MVC макетов является бесплатным ресурсом, предоставляемых корпорацией Майкрософт. В ASP.NET MVC коллекции можно найти по следующему адресу:

[https://www.asp.net/mvc/gallery](https://www.asp.net/mvc/gallery)

ASP.NET MVC макетов размещает коллекции схем бесплатные веб-сайта, которые были созданы специально для использования в проекте ASP.NET MVC. Схемы загружаются участниками сообщества. Посетителям коллекции смогут проголосовать за свои избранные модели (см. рис. 2).


[![Диалоговое окно нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image2.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image3.png)

**На рисунке 02**: ASP.NET MVC макетов ([Просмотр полноразмерное изображение](iteration-2-make-the-application-look-nice-vb/_static/image4.png))


Написания этого учебника, наиболее популярных конструктора в коллекции — это Дизайн, названный Дэвид Hauser октября. Такой подход можно использовать для проекта ASP.NET MVC, выполнив следующие действия:

1. Нажмите кнопку **загрузки** кнопку, чтобы загрузить файл October.zip на компьютер.
2. Щелкните правой кнопкой мыши загруженный файл October.zip и нажмите кнопку **Unblock** кнопку (см. рис. 3).
3. Распакуйте файл в папку с именем октября.
4. Выберите все файлы из папки DesignTemplate, содержащиеся в папке октября, правой кнопкой мыши и выберите пункт меню в **копирования**.
5. Щелкните правой кнопкой мыши узел проекта ContactManager в окне обозревателя решений Visual Studio и выберите пункт меню в **вставить** (см. рис. 4).
6. Выберите пункт меню в Visual Studio **редактирования, поиск и замена "," Быстрая замена** и замените *[MyProjectName]* с *ContactManager* (см. рис. 5).


[![Диалоговое окно нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image3.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image5.png)

**На рисунке 03**: разблокирования файла, загруженного из Интернета ([Просмотр полноразмерное изображение](iteration-2-make-the-application-look-nice-vb/_static/image6.png))


[![Диалоговое окно нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image4.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image7.png)

**На рисунке 04**: перезапись файлов в обозревателе решений ([Просмотр полноразмерное изображение](iteration-2-make-the-application-look-nice-vb/_static/image8.png))


[![Диалоговое окно нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image5.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image9.png)

**На рисунке 05**: замена ContactManager [имя_проекта] ([Просмотр полноразмерное изображение](iteration-2-make-the-application-look-nice-vb/_static/image10.png))


После выполнения этих шагов веб-приложения будет использовать новый макет. Страницы на рис. 6 показан внешний вид приложение диспетчера контактов с октября конструктора.


[![Диалоговое окно нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image6.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image11.png)

**На рисунке 06**: ContactManager шаблоном октября ([Просмотр полноразмерное изображение](iteration-2-make-the-application-look-nice-vb/_static/image12.png))


## <a name="creating-a-custom-aspnet-mvc-design"></a>Создание проекта пользовательского ASP.NET MVC

ASP.NET MVC макетов имеет хороший выбор стилей другую структуру. Коллекции позволяет быстро настроить способ настройки внешнего вида приложений ASP.NET MVC. И Конечно, галереи имеет значительное преимущество, совершенно бесплатно.

Тем не менее необходимо создать проект уникальна для веб-сайта. В этом случае имеет смысл для работы с веб-сайта компании по проектированию. Я решил применить такой подход для создания проекта для приложения диспетчера контактов.

Я ZIP-настройки диспетчера контактов из итерации 1 и отправляется компании по проектированию проекта. Они не владел Visual Studio (стыдно их!), но это t является проблемой. Они смогли для бесплатной загрузки из Microsoft Visual Web Developer [ https://www.asp.net ](https://www.asp.net) веб-сайта и откройте приложение диспетчера контактов в Visual Web Developer. За несколько дней они созданы разработки на рис. 7.


[![Диалоговое окно нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image7.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image13.png)

**На рисунке 07**: конструирования диспетчера контактов ASP.NET MVC ([Просмотр полноразмерное изображение](iteration-2-make-the-application-look-nice-vb/_static/image14.png))


Новый дизайн состоял из двух основных файлов: новый файл каскадные таблицы стилей и новый файл главной страницы представления. Главная страница представления содержит макет и общего содержимого для представления в приложении ASP.NET MVC. Например главной страницы представления включает в себя заголовок, вкладки навигации и нижний колонтитулы, которые отображаются на рис. 7. Я перезаписывают существующие Site.Master представления главной страницы в одну папку с файл Site.Master из компании по проектированию

Компании по проектированию, также создается новый таблицы каскадных стилей и набор изображений. Я разместить эти новые файлы в папке, содержимого и заменено существующий файл Site.css. Все статическое содержимое следует поместить в папку содержимого.

Обратите внимание, что новых методов разработки для диспетчера контактов содержит изображения для редактирования и удаления контактов. Рядом с каждого идентификатора контактного лица в HTML-таблицы контактов появится изображение Edit и Delete.

Первоначально эти ссылки, которые были к просмотру с HTML. Вспомогательные ActionLink() следующим образом:

[!code-aspx[Main](iteration-2-make-the-application-look-nice-vb/samples/sample1.aspx)]

Метод Html.ActionLink() не поддерживает изображения (метод HTML кодирует текст ссылки по соображениям безопасности). Поэтому я заменены вызовы Html.ActionLink() вызовы Url.Action() следующим образом:

[!code-aspx[Main](iteration-2-make-the-application-look-nice-vb/samples/sample2.aspx)]

Метод Html.ActionLink() отображает всю гиперссылку HTML. Метод Url.Action(), с другой стороны, отображает только URL-адрес без &lt;&gt; тег.

Кроме того, обратите внимание, что новых методов разработки включает выбранном и невыбранном вкладки. Например, на рис. 8 **создать новый контакт** вкладка и **контактов** не установлен.


[![Диалоговое окно нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image8.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image15.png)

**На рисунке 08**: выбран и не выбрано вкладок ([Просмотр полноразмерное изображение](iteration-2-make-the-application-look-nice-vb/_static/image16.png))


Для поддержки визуализации выбранном и невыбранном вкладок, я создал пользовательские вспомогательный метод HTML, с именем MenuItemHelper. Этот вспомогательный метод отображает либо &lt;li&gt; тег или &lt;li класса = «выбранных»&gt; тег в зависимости от того, соответствует ли текущий контроллер и действие к имени контроллера и действия, передаваемый вспомогательное приложение. Код для MenuItemHelper содержится в листинге 1.

**Перечисление Helpers\MenuItemHelper.vb. 1.**

[!code-vb[Main](iteration-2-make-the-application-look-nice-vb/samples/sample3.vb)]

MenuItemHelper использует класс TagBuilder внутренне для построения &lt;li&gt; HTML-тега. Класс TagBuilder является полезным служебный класс, который можно использовать, когда необходимо создавать новый тег HTML. Он включает методы для добавления атрибутов, добавление классов CSS, создания ID и изменение тегов s внутренний HTML-код.

## <a name="summary"></a>Сводка

В этой итерации нам улучшить визуальной разработки приложения ASP.NET MVC. Во-первых вы ознакомились с ASP.NET MVC макетов. Вы узнали, как загрузить шаблоны свободной разработки с ASP.NET MVC макетов, можно использовать в приложениях ASP.NET MVC.

Далее мы рассмотрели, как можно создать пользовательский конструктор путем изменения по умолчанию CSS-файла и файл подкачки главного представления. Для поддержки новых методов разработки, необходимо было создать некоторые незначительные изменения в приложение диспетчера контактов. Например мы добавили новый вспомогательный метод HTML, с именем MenuItemHelper, в которой отображаются выбранные и невыбранные вкладки.

В следующей итерации мы разберем очень важно субъект проверки. Мы добавим код проверки нашего приложения, чтобы пользователь не может создать новый контакт без указания необходимые значения, такие как человека s сначала и фамилии.

> [!div class="step-by-step"]
> [Назад](iteration-1-create-the-application-vb.md)
> [Вперед](iteration-3-add-form-validation-vb.md)
