---
uid: mvc/overview/older-versions-1/contact-manager/iteration-3-add-form-validation-vb
title: 'Итерации #3 – добавить проверку формы (Visual Basic) | Документы Microsoft'
author: microsoft
description: В третьем проходе добавим проверки базовой формы. Мы запретить отправки формы, не завершая обязательные поля. Кроме того, мы проверяем электронной почт...
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2009
ms.topic: article
ms.assetid: 4805e75a-7911-46e3-b11b-229a6eed245e
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-3-add-form-validation-vb
msc.type: authoredcontent
ms.openlocfilehash: 8e30e247bd31dfb800eea517d195025f9e881cd3
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30870444"
---
<a name="iteration-3--add-form-validation-vb"></a>Итерации #3 – добавить проверку формы (Visual Basic)
====================
по [Microsoft](https://github.com/microsoft)

[Загрузить исходный код](iteration-3-add-form-validation-vb/_static/contactmanager_3_vb1.zip)

> В третьем проходе добавим проверки базовой формы. Мы запретить отправки формы, не завершая обязательные поля. Мы также для проверки адреса электронной почты и номера телефонов.


## <a name="building-a-contact-management-aspnet-mvc-application-vb"></a>Создание приложения ASP.NET MVC управления контактами (Visual Basic)
  

В этой серии учебники мы создаем всего приложения управления контактами от начала и завершения. Приложение диспетчера контактов позволяет хранить контактные данные - имена, номера телефонов и адресов электронной почты — список людей.

Мы постройте приложение в нескольких итерациях. С каждой итерацией постепенно мы улучшить приложение. Это несколько итераций предназначена для того, чтобы позволяют понять причину для каждого изменения.

- Итерации #1 - создать приложение. В первой итерации мы создадим диспетчера контактов простейшим способом невозможно. Добавлена поддержка для основных операций базы данных: создание, чтение, обновление и удаление (CRUD).

- Итерации #2 — сделать приложение поиска работы с низким приоритетом. В этой итерации нам улучшить внешний вид приложения, изменив значение по умолчанию главной страницы представления ASP.NET MVC и каскадные таблицы стилей.

- Итерации #3 - Добавление проверки формы. В третьем проходе добавим проверки базовой формы. Мы запретить отправки формы, не завершая обязательные поля. Мы также для проверки адреса электронной почты и номера телефонов.

- Итерации #4 - сделать приложение слабо. В этой третьей итерации мы воспользоваться преимуществами нескольких шаблонов разработки программного обеспечения, чтобы упростить обслуживание и изменить приложение диспетчера контактов. Например мы выполнили рефакторинг наше приложение, чтобы использовать шаблон репозитория и шаблон внедрения зависимостей.

- Итерации #5 - Создание модульных тестов. В пятой итерации сделан нашего приложения проще в обслуживании и изменить, добавив модульных тестов. Мы макета наших классов модели данных и создания модульных тестов для наших контроллеров и логику проверки.

- Итерация 6 # — с помощью управляемой тестами разработки. В итерации этого шестой мы добавим новые функциональные возможности наше приложение, сначала написание модульных тестов и писать код для модульных тестов. В этой итерации добавим групп контактов.

- Итерации #7. Добавление функциональности Ajax. В седьмой итерации мы повысить скорость реагирования и производительности приложения, добавляя поддержку Ajax.


## <a name="this-iteration"></a>Этой итерации

Второй итерации приложение диспетчера контактов добавим проверки базовой формы. Мы отключать пользователей от передачи контакт без ввода значений для обязательных полей формы. Мы также проверить телефонные номера и адреса электронной почты (см. рис. 1).


[![Диалоговое окно нового проекта](iteration-3-add-form-validation-vb/_static/image1.jpg)](iteration-3-add-form-validation-vb/_static/image1.png)

**На рисунке 01**: формы проверки подлинности ([Просмотр полноразмерное изображение](iteration-3-add-form-validation-vb/_static/image2.png))


В этой итерации мы добавим логику проверки непосредственно действия контроллера. Как правило это не рекомендуется добавить проверку в приложении ASP.NET MVC. Рекомендуется размещать логику проверки s приложение в отдельном [уровень службы](http://martinfowler.com/eaaCatalog/serviceLayer.html). В следующей итерации мы выполнили рефакторинг приложение диспетчера контактов, чтобы сделать приложение более простого в сопровождении.

В этой итерации чтобы не усложнять, мы писать весь код проверки вручную. Вместо написания кода проверки сами, мы может воспользоваться преимуществами структуры проверки. Например Microsoft Enterprise библиотеки проверки приложения блока (VAB) можно использовать для реализации логики проверки для приложения ASP.NET MVC. Дополнительные сведения о блокировке приложения проверки см. в разделе:

[*http://msdn.microsoft.com/library/dd203099.aspx*](https://msdn.microsoft.com/library/dd203099.aspx)

## <a name="adding-validation-to-the-create-view"></a>Добавление проверки для представления создания

Позволяет начать с добавления логики проверки представления создания s. К счастью так как мы создали Create view с Visual Studio, создать представление уже содержит все логики интерфейса пользователя, необходимые для отображения сообщений проверки. Создать представление содержится в листинге 1.

**Листинг 1 - \Views\Contact\Create.aspx**

[!code-aspx[Main](iteration-3-add-form-validation-vb/samples/sample1.aspx)]

Ошибка при проверке поля класса, используемого для стиля выходных данных, подготовленных вспомогательный Html.ValidationMessage(). Класс ошибки для проверки входных данных, используемого для стиля текстового поля (input) к просмотру Html.TextBox() вспомогательный метод. Сводка ошибок класса, используемого для стиля неупорядоченный список, к просмотру Html.ValidationSummary() вспомогательный метод.

> [!NOTE] 
> 
> Вы можете изменить классы таблицы стилей, описанные в этом разделе, чтобы настроить внешний вид сообщений об ошибках проверки.


## <a name="adding-validation-logic-to-the-create-action"></a>Добавление логики проверки, чтобы создать действие

В данный момент, представления создания никогда не отображает сообщения об ошибках проверки, поскольку мы не записаны логику для создания сообщения. Для отображения сообщений об ошибках проверки, необходимо добавить эти сообщения об ошибках для ModelState.

> [!NOTE] 
> 
> Метод UpdateModel() добавляет сообщения об ошибках ModelState автоматически при наличии ошибка присваивания значения поля формы к свойству. Например при попытке назначить BirthDate свойства, которое принимает значения даты-времени строка «apple», затем метод UpdateModel() добавляет ошибку ModelState.


Измененный метод Create() в списке 2 содержит новый раздел, который проверяет свойства класса, обратитесь в службу, перед вставкой нового контакта в базе данных.

**Листинг 2 - Controllers\ContactController.vb (создать проверки)**

[!code-vb[Main](iteration-3-add-form-validation-vb/samples/sample2.vb)]

В разделе проверки обеспечивает четыре различных условий:

- Свойство «имя» должен иметь длину не больше нуля (и он не может состоять только из пробелов)
- Свойство LastName должен иметь длину не больше нуля (и он не может состоять только из пробелов)
- Если свойство Phone имеет значение (имеет длину больше 0), а затем свойство Phone должно соответствовать регулярному выражению.
- Если значение свойства электронной почты (имеет длину больше 0), а затем свойства электронной почты должно соответствовать регулярному выражению.

При нарушении правила проверки, сообщение об ошибке добавляется с помощью метода AddModelError() ModelState. При добавлении сообщение ModelState, укажите имя свойства и текст сообщений об ошибках проверки. Это сообщение об ошибке отображается в представлении с Html.ValidationSummary() и Html.ValidationMessage() вспомогательных методов.

После выполнения правила проверки проверяется свойство IsValid ModelState. Свойство IsValid возвращает значение false, ModelState будут добавлены все сообщения об ошибках проверки. Если проверка завершается неудачно, создание формы отобразится в сообщения об ошибках.

> [!NOTE] 
> 
> Получено регулярные выражения для проверки адреса электронной почты и номера телефона из репозитория регулярных выражений в [*http://regexlib.com*](http://regexlib.com)


## <a name="adding-validation-logic-to-the-edit-action"></a>Добавление логики проверки в действие изменения

Действие Edit() обновляет контакта. Edit() действие необходимо выполнить одинаковые проверки, как действие Create(). Вместо повторения один и тот же код проверки, мы должны рефакторинг контроллера контактов таким образом, Create() и Edit() действия вызывать один и тот же метод проверки.

В списке 3 содержится измененный класс контроллера контакта. Этот класс содержит новый метод ValidateContact(), который вызывается в пределах Create() и Edit() действия.

**Листинг 3 - Controllers\ContactController.vb**

[!code-vb[Main](iteration-3-add-form-validation-vb/samples/sample3.vb)]

## <a name="summary"></a>Сводка

В этой итерации мы добавили в наше приложение диспетчера контактов проверки базовой формы. Логику проверки запрещает пользователям Отправка нового контакта или изменении существующего контакта без указания значения для свойств, FirstName и LastName. Кроме того пользователи должны предоставлять допустимым телефонных номеров и адресах электронной почты.

В этой итерации мы добавили логику проверки в наше приложение диспетчера контактов простым способом. Тем не менее смешивание логику проверки в логику контроллера создаст проблемы в долгосрочной перспективе. Наше приложение будет сложнее в обслуживании и изменении со временем.

В следующей итерации мы рефакторинга нашей логики проверки и логики доступа к базе данных наших контроллерами. Мы будем воспользоваться преимуществами нескольких принципы разработки программного обеспечения, чтобы можно было создать приложение более слабосвязанной и более простого в сопровождении.

> [!div class="step-by-step"]
> [Назад](iteration-2-make-the-application-look-nice-vb.md)
> [Вперед](iteration-4-make-the-application-loosely-coupled-vb.md)
