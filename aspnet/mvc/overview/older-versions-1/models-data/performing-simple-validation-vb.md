---
uid: mvc/overview/older-versions-1/models-data/performing-simple-validation-vb
title: Выполняет простую проверку (VB) | Документы Microsoft
author: StephenWalther
description: Узнайте, как выполнять проверку в приложении ASP.NET MVC. В этом учебнике Стивен Вальтер вводит вы состояние модели и вспомогательный класс проверки HTML...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/02/2009
ms.topic: article
ms.assetid: df6cf4b7-0bb3-4c4e-b17a-bd78a759a6bc
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/models-data/performing-simple-validation-vb
msc.type: authoredcontent
ms.openlocfilehash: efb98d87106e332fffb158e5f382d57fea778957
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30869755"
---
<a name="performing-simple-validation-vb"></a>Выполняет простую проверку (Visual Basic)
====================
по [Стивен Вальтер](https://github.com/StephenWalther)

> Узнайте, как выполнять проверку в приложении ASP.NET MVC. В этом учебнике Стивен Вальтер вводит для состояния модели и вспомогательные методы проверки HTML.


Целью данного учебника является объясняется, как можно выполнить проверку в приложении ASP.NET MVC. Например вы научитесь допустить Отправка формы, который не содержит значение для обязательного поля. Вы узнаете, как использовать состояние модели и вспомогательных методов HTML проверки.

## <a name="understanding-model-state"></a>Общие сведения о состоянии модели

Используйте состояние модели - или более точно в словарь состояния модели — для представления ошибки проверки. Например действие Create() в список 1 проверяет свойства класса Product перед добавлением класс продукта в базе данных.


Я не рекомендую добавить логику проверки или базы данных, к контроллеру. Контроллер должен содержать только процедуры, относящиеся к управления потоком приложения. Мы воспользуемся ярлык для простоты.


**Листинг 1 - Controllers\ProductController.vb**

[!code-vb[Main](performing-simple-validation-vb/samples/sample1.vb)]

В список 1 проверяются имя, описание и UnitsInStock свойства класса продукта. Если эти свойства не проходят проверку коллекцию ошибок добавляется в словарь состояния модели (представленные свойством ModelState класса контроллера).

Если имеются ошибки в состояние модели ModelState.IsValid свойство возвращает значение false. В этом случае отобразится форма HTML для создания нового продукта. В противном случае — в случае ошибки проверки не нового продукта добавляется в базу данных.

## <a name="using-the-validation-helpers"></a>Использование вспомогательных методов проверки

Платформа ASP.NET MVC включает две вспомогательные методы проверки: Html.ValidationMessage() поддержки и вспомогательные Html.ValidationSummary(). Используйте эти две вспомогательные функции в представлении для отображения сообщений об ошибках проверки.

Создание и изменение представления, которые автоматически формируются формирование шаблонов ASP.NET MVC используются вспомогательные методы Html.ValidationMessage() и Html.ValidationSummary(). Выполните следующие действия для создания представления создания.

1. Щелкните правой кнопкой мыши действие Create() в контроллере продукта и выбрать пункт меню **добавить представление** (см. рис. 1).
2. В **добавить представление** диалогового окна, установите флажок "с меткой" **создать строго типизированное представление** (см. рис. 2).
3. Из **просматривать данные класс** раскрывающегося списка выберите класс продукта.
4. Из **просматривать содержимое** раскрывающийся список, выберите создать.
5. Нажмите кнопку **Добавить**.


Убедитесь, что сборка приложения перед добавлением представления. В противном случае не будет отображаться в список классов **просматривать данные класс** раскрывающегося списка.


[![Диалоговое окно нового проекта](performing-simple-validation-vb/_static/image1.jpg)](performing-simple-validation-vb/_static/image1.png)

**На рисунке 01**: Добавление представления ([Просмотр полноразмерное изображение](performing-simple-validation-vb/_static/image2.png))


[![Диалоговое окно нового проекта](performing-simple-validation-vb/_static/image2.jpg)](performing-simple-validation-vb/_static/image3.png)

**На рисунке 02**: создание строго типизированное представление ([Просмотр полноразмерное изображение](performing-simple-validation-vb/_static/image4.png))


После выполнения этих действий вы получаете создать представление в списке 2.

**Листинг 2 - Views\Product\Create.aspx**

[!code-aspx[Main](performing-simple-validation-vb/samples/sample2.aspx)]

В списке 2 вспомогательный Html.ValidationSummary() вызывается немедленно выше HTML-формы. Этого вспомогательного объекта используется для отображения списка сообщений об ошибках проверки. Вспомогательный объект Html.ValidationSummary() отображает ошибки в виде маркированного списка.

Вспомогательный объект Html.ValidationMessage() называется радом с каждым из полей формы HTML. Этого вспомогательного объекта используется для отображения сообщения об ошибке, рядом с полем формы. В случае листинг 2 вспомогательный Html.ValidationMessage() отображается звездочка, при наличии ошибки.

Страницы на рисунке 3 показано сообщения об ошибках, отрисовываемый помощников проверки при отправке формы с отсутствующих полей и недопустимые значения.


[![Диалоговое окно нового проекта](performing-simple-validation-vb/_static/image3.jpg)](performing-simple-validation-vb/_static/image5.png)

**На рисунке 03**: Create view, отправленные с проблемами ([Просмотр полноразмерное изображение](performing-simple-validation-vb/_static/image6.png))


Обратите внимание на внешний вид HTML введенных поля также изменяются при ошибке проверки. Отображает вспомогательные Html.TextBox() *класс = «ошибка ввода проверки»* атрибут при ошибке проверки, связанное со свойством к просмотру Html.TextBox() вспомогательный метод.

Имеется три класса каскадные таблицы стиля, используется для управления внешним видом ошибки проверки:

- входные данные — проверка ошибка — применить к &lt;ввода&gt; тег, представляемый Html.TextBox() вспомогательный метод.
- поле ошибке проверки - применены к &lt;span&gt; тег, представляемый Html.ValidationMessage() вспомогательный метод.
- Сводка ошибки проверки - применены к &lt;ul&gt; тег, представляемый Html.ValidationSumamry() вспомогательный метод.

Можно изменить эти каскадные таблицы классы стилей и таким образом изменить внешний вид ошибки проверки, изменив файл Site.css, расположенный в папке содержимого.

> [!NOTE] 
> 
> Класс HtmlHelper включает только для чтения статических свойств CSS, получение имен проверки связанных классов. Эти статические свойства называются ValidationInputCssClassName, ValidationFieldCssClassName и ValidationSummaryCssClassName.


## <a name="prebinding-validation-and-postbinding-validation"></a>Prebinding проверки и проверки Postbinding

Если введено недопустимое значение в поле «Цена» и значение для поля UnitsInStock отправки формы HTML для создания продукта, вы сможете получить проверки сообщений, отображаемых на рис. 4. Откуда берутся эти сообщения об ошибках проверки?


[![Диалоговое окно нового проекта](performing-simple-validation-vb/_static/image4.jpg)](performing-simple-validation-vb/_static/image7.png)

**На рисунке 04**: ошибок проверки Prebinding ([Просмотр полноразмерное изображение](performing-simple-validation-vb/_static/image8.png))


Существует фактически два типа сообщений об ошибках проверки - созданные перед поля формы HTML привязаны к классу и те, созданных после поля формы привязаны к классу. Другими словами, имеются ошибки проверки prebinding и postbinding ошибки проверки.

Create() действию, предоставляемым контроллером продукта в листинге 1 принимает экземпляр класса Product. Сигнатура метода создания выглядит следующим образом:

[!code-vb[Main](performing-simple-validation-vb/samples/sample3.vb)]

Значения поля формы HTML в форме создания привязаны к productToCreate класса, называемое связыватель модели. Связыватель модели по умолчанию добавляет сообщение об ошибке состояния модели автоматически при его невозможно привязать поле формы со свойством формы.

Связыватель модели по умолчанию не удается привязать свойство цена продукта класса строку «apple». Строка не может назначить свойства десятичного типа. Таким образом связывателя модели добавляет ошибку в состояние модели.

Связыватель модели по умолчанию также не удается присвоить значение Nothing свойство, которое не принимает значение Nothing. В частности связывателя модели нельзя назначить значение Nothing UnitsInStock свойство. Опять же связывателя модели отдает и добавляет сообщение об ошибке состояния модели.

Если вы хотите настроить внешний вид этих prebinding сообщения об ошибках, необходимо создать ресурс строки для этих сообщений.

## <a name="summary"></a>Сводка

Целью данного учебника было описаны основные принципы работы проверки в ASP.NET MVC. Вы узнали, как использовать состояние модели и вспомогательных методов HTML проверки. Также мы рассмотрели различие между prebinding и postbinding проверки. В других учебниках мы обсудим различные стратегии перемещения код проверки из контроллеров в классами модели.

> [!div class="step-by-step"]
> [Назад](displaying-a-table-of-database-data-vb.md)
> [Вперед](validating-with-the-idataerrorinfo-interface-vb.md)
