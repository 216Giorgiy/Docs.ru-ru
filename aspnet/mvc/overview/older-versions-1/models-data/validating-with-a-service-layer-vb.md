---
uid: mvc/overview/older-versions-1/models-data/validating-with-a-service-layer-vb
title: Проверка с помощью на уровне службы (Visual Basic) | Документы Microsoft
author: StephenWalther
description: Узнайте, как переместить логику проверки из действия контроллера и в слой отдельной службе. В этом учебнике объясняется Стивен Вальтер как вы...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/02/2009
ms.topic: article
ms.assetid: 344bb38e-4965-4c47-bda1-f6d29ae5b83a
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/models-data/validating-with-a-service-layer-vb
msc.type: authoredcontent
ms.openlocfilehash: bb1191b663f863bf881def620efab4f2f03edc56
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30868247"
---
<a name="validating-with-a-service-layer-vb"></a>Проверка с помощью на уровне службы (Visual Basic)
====================
по [Стивен Вальтер](https://github.com/StephenWalther)

> Узнайте, как переместить логику проверки из действия контроллера и в слой отдельной службе. В этом учебнике Стивен Вальтер объясняется, как обеспечить острым Разделение областей ответственности изоляция на уровне службы из вашего уровня контроллера.


Целью данного учебника является описание один из способов проверки в приложении ASP.NET MVC. В этом учебнике вы узнаете, как переместить логику проверки из контроллеров и отправляются на уровне отдельных службы.

## <a name="separating-concerns"></a>Отделение проблемы

При создании приложения ASP.NET MVC, логику базы данных не следует помещать внутри действия контроллера. Смешивание логику базы данных и контроллера усложняет приложение для поддержания со временем. Рекомендуется поместить все логики базы данных на уровне отдельных репозитория.

Например список 1 содержит простой репозиторий с именем ProductRepository. Репозиторий продукта содержит все код доступа к данным для приложения. Список также включает интерфейс IProductRepository, который реализует хранилище продукта.

**Листинг 1 - Models\ProductRepository.vb**

[!code-vb[Main](validating-with-a-service-layer-vb/samples/sample1.vb)]

Контроллер в списке 2 использует уровня репозитория Index() и Create() действий. Обратите внимание, что данный контроллер не содержит логику базы данных. Создание уровня хранилища позволяет поддерживать четкое разделение областей ответственности. Контроллеры отвечают за логику управления потоком приложения и репозитория отвечает за логики доступа к данным.

**Листинг 2 - Controllers\ProductController.vb**

[!code-vb[Main](validating-with-a-service-layer-vb/samples/sample2.vb)]

## <a name="creating-a-service-layer"></a>Создание уровня службы

Таким образом приложения потока управления располагается в контроллере и принадлежит логики доступа к данным в репозитории. В этом случае, где размещен свою логику проверки? Первый вариант — разместить логику проверки в *уровень службы*.

На уровне службы представляет собой дополнительный уровень в приложении ASP.NET MVC, который является посредником связи между контроллером и уровня репозитория. Уровень службы содержит бизнес-логики. В частности он содержит логику проверки.

Например уровень службы продукта в списке 3 имеет метод CreateProduct(). Метод CreateProduct() вызывает метод ValidateProduct(), чтобы проверить новый продукт перед передачей продукта в репозитории продукта.

**Листинг 3 - Models\ProductService.vb**

[!code-vb[Main](validating-with-a-service-layer-vb/samples/sample3.vb)]

Контроллер продукта был обновлен в листинге 4 для использования вместо уровня репозитория уровня службы. Обсуждения слоя контроллера до уровня службы. Уровень служб обращается к уровня репозитория. Каждый уровень имеет отдельный ответственности.

**Листинг 4 - Controllers\ProductController.vb**

[!code-vb[Main](validating-with-a-service-layer-vb/samples/sample4.vb)]

Обратите внимание, что службы продукта создается в конструктор контроллера продукта. При создании службы продукта в словарь состояния модели передается в службу. Обновления продукта состояние модели используется для передачи сообщений об ошибках проверки на контроллер.

## <a name="decoupling-the-service-layer"></a>Отделение уровень службы

Изолировать контроллера и слои службы в одном — произошел сбой. Контроллер и слои службы взаимодействуют через состояние модели. Другими словами уровень службы имеет зависимость от определенной функции платформы ASP.NET MVC.

Мы хотим изолировать уровень службы из наших максимально уровня контроллера. В теории мы должны иметь возможность использовать уровень службы с любым типом приложения, а не только приложение ASP.NET MVC. Например в дальнейшем может потребоваться для построения переднего плана для нашего приложения WPF. Мы должны найти состояние модели способ удалить зависимость от ASP.NET MVC из наших уровня службы.

В листинге 5 уровня службы, была обновлена, чтобы он больше не использует состояние модели. Вместо этого он использует любой класс, реализующий интерфейс IValidationDictionary.

**Список 5 - Models\ProductService.vb (связано)**

[!code-vb[Main](validating-with-a-service-layer-vb/samples/sample5.vb)]

Интерфейс IValidationDictionary определен в 6 со списком. Этот простой интерфейс имеет один метод и одного свойства.

**Перечисление 6 - Models\IValidationDictionary.cs**

[!code-vb[Main](validating-with-a-service-layer-vb/samples/sample6.vb)]

Класс в список 7, с именем класса ModelStateWrapper, реализующий интерфейс IValidationDictionary. Можно создать экземпляр класса ModelStateWrapper, передав конструктору словарь состояния модели.

**Листинг 7 - Models\ModelStateWrapper.vb**

[!code-vb[Main](validating-with-a-service-layer-vb/samples/sample7.vb)]

Наконец обновленный контроллер в листинг 8 использует ModelStateWrapper при создании уровня службы в конструкторе.

**8 - Controllers\ProductController.vb со списком**

[!code-vb[Main](validating-with-a-service-layer-vb/samples/sample8.vb)]

С помощью IValidationDictionary интерфейс и класс ModelStateWrapper позволяет полностью изолировать уровень нашей службы из наших уровня контроллера. Уровень службы больше не зависит от состояния модели. Можно передать любой класс, реализующий интерфейс IValidationDictionary до уровня службы. Например приложение WPF может реализовывать интерфейс IValidationDictionary с класс простой коллекции.

## <a name="summary"></a>Сводка

Целью данного учебника было обсудить один из подходов к проверке в приложении ASP.NET MVC. В этом учебнике вы узнали, как перемещение всех логики проверки из контроллеров и отправляются на уровне отдельных службы. Вы также узнали, как изоляция на уровне службы из вашего уровня контроллера, создав класс ModelStateWrapper.

> [!div class="step-by-step"]
> [Назад](validating-with-the-idataerrorinfo-interface-vb.md)
> [Вперед](validation-with-the-data-annotation-validators-vb.md)
