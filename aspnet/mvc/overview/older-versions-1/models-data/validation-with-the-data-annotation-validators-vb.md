---
uid: mvc/overview/older-versions-1/models-data/validation-with-the-data-annotation-validators-vb
title: Проверка с помощью заметки данных проверяющие элементы управления (Visual Basic) | Документы Microsoft
author: microsoft
description: Воспользуйтесь преимуществами связывателя модели данных заметок для выполнения проверки в приложении ASP.NET MVC. Сведения об использовании различных типов проверяющий элемент управления...
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/29/2009
ms.topic: article
ms.assetid: 0d23ff2b-f2ec-434a-be3b-1180beeccba3
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/models-data/validation-with-the-data-annotation-validators-vb
msc.type: authoredcontent
ms.openlocfilehash: d1987182a44a0ad3f91f455342dc934d1dd50267
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="validation-with-the-data-annotation-validators-vb"></a>Проверка с помощью заметки данных проверяющие элементы управления (Visual Basic)
====================
по [Microsoft](https://github.com/microsoft)

> Воспользуйтесь преимуществами связывателя модели данных заметок для выполнения проверки в приложении ASP.NET MVC. Узнайте, как использовать различные типы атрибутов, проверяющий элемент управления и работы с ними в Entity Framework корпорации Майкрософт.


В этом учебнике вы узнаете, как использовать заметки к данным проверяющие элементы управления для выполнения проверки в приложении ASP.NET MVC. Преимуществом использования проверяющие элементы управления заметки данных является, что они позволяют выполнять проверку, просто добавив один или несколько атрибутов — например, необходимая или атрибут StringLength — свойства класса.

Прежде чем использовать заметки к данным проверяющие элементы управления, необходимо загрузить связывателя модели данных заметок. Примером связывателя модели данных заметок можно загрузить с веб-сайта CodePlex, щелкнув [здесь](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471).


Важно понимать, что связывателя модели данных заметок не официальной частью платформы Microsoft ASP.NET MVC. Несмотря на то, что связывателя модели данных заметок создан командой Microsoft ASP.NET MVC, Майкрософт не осуществляет Официальная поддержка для связывателя модели данных заметок описанные и используемые в этом учебнике.


## <a name="using-the-data-annotation-model-binder"></a>С помощью связывателя модели данных заметок

Чтобы использовать связывателя модели данных заметок в MVC-приложениях ASP.NET, необходимо сначала добавить ссылку на сборку Microsoft.Web.Mvc.DataAnnotations.dll и сборки библиотеку System.ComponentModel.DataAnnotations.dll. Выберите пункт меню в **проект, добавить ссылку**. Далее щелкните **Обзор** вкладку и перейдите к расположению, в которую был загружен (и распаковываются) в образце связыватель модели данных заметок (в разделе **рис. 1**).

[![](validation-with-the-data-annotation-validators-vb/_static/image2.png)](validation-with-the-data-annotation-validators-vb/_static/image1.png)

**Рис. 1**: добавить ссылку на связыватель модели данных заметок ([Просмотр полноразмерное изображение](validation-with-the-data-annotation-validators-vb/_static/image3.png))

Выберите сборку Microsoft.Web.Mvc.DataAnnotations.dll и библиотеку System.ComponentModel.DataAnnotations.dll сборку и нажмите кнопку **ОК** кнопки.


Нельзя использовать библиотеку System.ComponentModel.DataAnnotations.dll сборки, входящий в состав .NET Framework с пакетом обновления 1 связывателя модели данных заметок. Необходимо использовать версию сборки библиотеку System.ComponentModel.DataAnnotations.dll, входящий в состав загрузки образца связывателя модели данных заметок.


Наконец необходимо зарегистрировать DataAnnotations связыватель модели в файле Global.asax. Добавьте следующую строку кода в приложение\_Start() обработчик событий, чтобы приложение\_метод Start() выглядит следующим образом:

[!code-vb[Main](validation-with-the-data-annotation-validators-vb/samples/sample1.vb)]

Эта строка кода регистрирует DataAnnotationsModelBinder как связыватель модели по умолчанию для всего приложения ASP.NET MVC.

## <a name="using-the-data-annotation-validator-attributes"></a>С помощью атрибуты данных заметок проверяющий элемент управления

При использовании связывателя модели данных заметок, можно использовать атрибуты проверяющий элемент управления для выполнения проверки. Пространство имен System.ComponentModel.DataAnnotations включает следующие атрибуты оператора проверки:

- Диапазон — позволяет проверить, является ли значение свойства находится в указанном диапазоне значений.
- ReqularExpression — позволяет проверить, соответствует ли значение свойства заданного шаблона регулярного выражения.
- Требуется — позволяет помечать свойство как обязательное.
- StringLength — позволяет указать максимальную длину для свойства строки.
- Проверка — базовый класс для всех атрибутов проверки.

> [!NOTE] 
> 
> Если вашим требованиям проверки не выполняются на любой из стандартных проверяющие элементы управления затем всегда имеется возможность создания атрибута настраиваемый проверяющий элемент управления путем наследования от базового атрибута проверки нового атрибута проверяющего элемента управления.


Класс продукта в **список 1** показано, как использовать эти атрибуты проверяющий элемент управления. Имя, описание и UnitPrice свойства, которые отмечены как требуется. Свойство Name должно иметь строку, длина которой составляет менее 10 символов. Наконец свойство UnitPrice должно соответствовать регулярному выражению, которая представляет денежную сумму.

[!code-vb[Main](validation-with-the-data-annotation-validators-vb/samples/sample2.vb)]

**Листинг 1**: Models\Product.vb

Класс продукта показано, как использовать один дополнительный атрибут: атрибут DisplayName. Атрибут DisplayName позволяет изменять имя свойства, если свойство отображается в сообщении об ошибке. Вместо отображения сообщение об ошибке «поле «Цена» требуется» можно отобразить сообщение об ошибке «поле «Цена» является обязательным».

> [!NOTE] 
> 
> Если вы хотите полностью настроить сообщение об ошибке, проверяющий элемент управления можно назначить пользовательское сообщение об ошибке в свойство ErrorMessage проверяющего элемента управления следующим образом: `<Required(ErrorMessage:="This field needs a value!")>`


Можно использовать класс продукта в **список 1** с Create() действия контроллера в **листинг 2**. Это действие контроллера повторно отображает представление создания при состояния модели содержит все ошибки.

[!code-vb[Main](validation-with-the-data-annotation-validators-vb/samples/sample3.vb)]

**Листинг 2**: Controllers\ProductController.vb

Наконец, можно создать представление в **листинге 3** , щелкнув правой кнопкой мыши действие Create() и выбрав пункт меню **добавить представление**. Создайте строго типизированное представление с продукта класс как класс модели. Выберите **создать** из представления содержимого раскрывающегося списка (см. **рис. 2**).

[![](validation-with-the-data-annotation-validators-vb/_static/image5.png)](validation-with-the-data-annotation-validators-vb/_static/image4.png)

**На рисунке 2**: Добавление представления создания

[!code-aspx[Main](validation-with-the-data-annotation-validators-vb/samples/sample4.aspx)]

**Листинг 3**: Views\Product\Create.aspx

> [!NOTE] 
> 
> Удалить поле из Создание формы, созданные **добавить представление** пункт меню. Так как поле «идентификатор» соответствует столбец идентификаторов, вы не хотите разрешить пользователям вводить значение для этого поля.


Если отправки формы для создания продукта и не вводите значения для обязательных полей, а затем выдает сообщение об ошибке проверки **рис. 3** отображаются.

[![](validation-with-the-data-annotation-validators-vb/_static/image7.png)](validation-with-the-data-annotation-validators-vb/_static/image6.png)

**Рис. 3**: отсутствуют обязательные поля

Если ввести недопустимые валюты суммы, то сообщение об ошибке в **рис. 4** отображается.

[![](validation-with-the-data-annotation-validators-vb/_static/image9.png)](validation-with-the-data-annotation-validators-vb/_static/image8.png)

**Рис. 4**: Недопустимая валюта сумма

## <a name="using-data-annotation-validators-with-the-entity-framework"></a>С помощью данных заметки проверяющие элементы управления с платформой Entity Framework

Если вы используете для создания классов модели данных Microsoft Entity Framework не удается применить атрибуты оператора проверки к классам. Поскольку Entity Framework Designer создает классы модели, все изменения, внесенные в классы модели будет перезаписана при очередном вы внесли изменения в конструкторе.

Если вы хотите использовать проверяющие элементы управления с классами, созданные платформой Entity Framework, необходимо создать классы данных метаданных. Класс метаданных данных вместо применения проверяющие элементы управления на фактический класс применяются проверяющие элементы управления.

Например, предположим, что вы создали класс фильма платформы Entity Framework (см. **рис. 5**). Представьте себе, кроме того, вы хотите сделать название фильма и директора необходимые свойства для свойства. В этом случае можно создать разделяемый класс и класс данных метаданных в **листинг 4**.

[![](validation-with-the-data-annotation-validators-vb/_static/image11.png)](validation-with-the-data-annotation-validators-vb/_static/image10.png)

**Рис. 5**: класс фильм, созданный платформой Entity Framework

[!code-vb[Main](validation-with-the-data-annotation-validators-vb/samples/sample5.vb)]

**Листинг 4**: Models\Movie.vb

Файл в **листинг 4** содержит два класса с именем фильма и MovieMetaData. Класс фильма является частичным классом. Он соответствует разделяемый класс, созданный платформой Entity Framework, которая содержится в файле DataModel.Designer.vb.

В настоящее время платформа .NET framework не поддерживает частичное свойства. Таким образом, нет возможности применение атрибутов проверяющий элемент управления к свойствам класса фильм, определенные в файле DataModel.Designer.vb путем применения атрибутов проверяющий элемент управления к свойствам класса фильма, определенные в файле в **листинг 4**.

Обратите внимание, что разделяемый класс фильма помечено атрибутом MetadataType, указывающий на класс MovieMetaData. Класс MovieMetaData содержит свойства прокси-сервера для свойства класса фильма.

Атрибуты оператора проверки применяются к свойствам класса MovieMetaData. Свойства Title, директор и DateReleased помечаются как обязательные свойства. Свойство директора необходимо назначить строку, содержащую не более 5 символов. Наконец атрибут DisplayName DateReleased свойства для отображения сообщения об ошибке, как «поле даты выпуска является обязательным.» вместо ошибки «DateReleased поле является обязательным.»

> [!NOTE] 
> 
> Обратите внимание, что свойства в классе MovieMetaData прокси-сервера не должны представлять совпадает с типом свойства соответствующего класса фильма. Например свойство директор является строковое свойство в классе фильма и свойства объекта в классе MovieMetaData.


Страницы в **рис. 6** иллюстрирует сообщения об ошибках, если ввести недопустимые значения для свойств фильма.

[![](validation-with-the-data-annotation-validators-vb/_static/image13.png)](validation-with-the-data-annotation-validators-vb/_static/image12.png)

**Рис. 6**: с помощью проверяющие элементы управления с платформой Entity Framework ([Просмотр полноразмерное изображение](validation-with-the-data-annotation-validators-vb/_static/image14.png))

## <a name="summary"></a>Сводка

В этом учебнике вы узнали, как пользоваться преимуществами связывателя модели данных заметок для выполнения проверки в приложении ASP.NET MVC. Вы узнали, как использовать различные типы атрибутов проверяющий элемент управления, таких как обязательный и StringLength атрибутов. Вы также узнали, как использовать эти атрибуты при работе с платформой Entity Framework корпорации Майкрософт.

> [!div class="step-by-step"]
> [Назад](validating-with-a-service-layer-vb.md)
