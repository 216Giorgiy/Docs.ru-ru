---
uid: mvc/overview/older-versions-1/controllers-and-routing/creating-custom-routes-vb
title: Создание настраиваемых маршрутов (VB) | Документы Microsoft
author: microsoft
description: Дополнительные сведения о добавлении настраиваемых маршрутов для приложения ASP.NET MVC. В этом учебнике вы научитесь изменять таблицы маршрутов по умолчанию в файле Global.asax.
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/16/2009
ms.topic: article
ms.assetid: 6ac5758b-6199-42af-adcb-21954b864951
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/controllers-and-routing/creating-custom-routes-vb
msc.type: authoredcontent
ms.openlocfilehash: e827725ab7ce54c86ae9f4193d0a8a7ef4af8512
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="creating-custom-routes-vb"></a>Создание настраиваемых маршрутов (Visual Basic)
====================
по [Microsoft](https://github.com/microsoft)

> Дополнительные сведения о добавлении настраиваемых маршрутов для приложения ASP.NET MVC. В этом учебнике вы научитесь изменять таблицы маршрутов по умолчанию в файле Global.asax.


В этом учебнике вы узнаете, как добавить настраиваемый маршрут в приложении ASP.NET MVC. Вы узнаете, как изменение таблицы маршрутов по умолчанию в файле Global.asax с настраиваемый маршрут.

В приложениях ASP.NET MVC таблицы маршрутов по умолчанию будет работать нормально. Тем не менее можно обнаружить специализированные маршрутизации потребностей. В этом случае можно создать настраиваемый маршрут.

Допустим, что вы создаете приложение блога. Может потребоваться для обработки входящих запросов, которые выглядят следующим образом:

/Archive/12-25-2009

Когда пользователь вводит этот запрос, можно вернуться в записи блога, соответствующий дате 12/25/2009. Чтобы обработать этот тип запроса, необходимо создать настраиваемый маршрут.

Файл Global.asax в листинге 1 содержит новый настраиваемый маршрут с именем блоге, какие запросы маркеров, которые выглядят как /Archive/*Дата записи*.

**Листинг 1 — Global.asax (с настраиваемый маршрут)**

[!code-vb[Main](creating-custom-routes-vb/samples/sample1.vb)]

Важен порядок маршрутов, добавьте к таблице маршрутов. Наш новый настраиваемый маршрут блога добавляется перед существующего маршрута по умолчанию. Если отменить заказ, то маршрут по умолчанию всегда будет вызван вместо настраиваемый маршрут.

Настраиваемый маршрут блог соответствует любому запросу, который начинается с/архив /. Таким образом он удовлетворяет всем следующим URL-адресам:

- /Archive/12-25-2009

- /Archive/10-6-2004

- /Archive/apple

Настраиваемый маршрут сопоставляется контроллер с именем архива входящего запроса и вызывает действие Entry(). При вызове метода Entry() Дата операции передается как параметр с именем entryDate.

Можно использовать настраиваемый маршрут блогов с контроллером в списке 2.

**Листинг 2 - ArchiveController.vb**

[!code-vb[Main](creating-custom-routes-vb/samples/sample2.vb)]

Обратите внимание, что метод Entry() в списке 2 принимает параметр типа DateTime. Платформа MVC способен преобразовать дату записи из URL-адрес в значение даты и времени автоматически. Если параметр даты входа из URL-адреса невозможно преобразовать к типу DateTime, возникает ошибка (см. рис. 1).

**Рис. 1. Ошибка преобразования параметра**


[![Диалоговое окно нового проекта](creating-custom-routes-vb/_static/image1.jpg)](creating-custom-routes-vb/_static/image1.png)

**Рисунок 01**: ошибка из преобразование параметра ([Просмотр полноразмерное изображение](creating-custom-routes-vb/_static/image2.png))


## <a name="summary"></a>Сводка

Целью данного учебника было показано, как создать настраиваемый маршрут. Вы узнали, как добавить настраиваемый маршрут к таблице маршрутов в файле Global.asax, представляющий записи в блогах. Мы рассмотрели, как сопоставить запросы для записи в блогах с именем ArchiveController контроллера и действия контроллера, с именем Entry().

> [!div class="step-by-step"]
> [Назад](asp-net-mvc-controller-overview-vb.md)
> [Вперед](creating-a-route-constraint-vb.md)
