---
uid: mvc/overview/older-versions-1/controllers-and-routing/understanding-action-filters-cs
title: "Основные сведения о фильтрах действий (C#) | Документы Microsoft"
author: microsoft
description: "Целью данного учебника является объяснить фильтров действий. Фильтр действий является атрибутом, который можно применить к действия контроллера--или контроллер всего..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/16/2008
ms.topic: article
ms.assetid: a94e4e81-40c1-47b7-8613-126a1a6cc93d
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/controllers-and-routing/understanding-action-filters-cs
msc.type: authoredcontent
ms.openlocfilehash: 86d5d429d9900d4c04391804598626705e6c88b4
ms.sourcegitcommit: b83a5f731a9c02bdb1cc1e3f9a8bf273eb5b33e0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/11/2018
---
<a name="understanding-action-filters-c"></a>Основные сведения о фильтрах действий (C#)
====================
по [Microsoft](https://github.com/microsoft)

[Скачать PDF](http://download.microsoft.com/download/e/f/3/ef3f2ff6-7424-48f7-bdaa-180ef64c3490/ASPNET_MVC_Tutorial_14_CS.pdf)

> Целью данного учебника является объяснить фильтров действий. Фильтр действий является атрибутом, который можно применять действия контроллера--или всей контроллеру--, изменяет способ, в котором выполняется действие.


## <a name="understanding-action-filters"></a>Основные сведения о фильтрах действий

Целью данного учебника является объяснить фильтров действий. Фильтр действий является атрибутом, который можно применять действия контроллера--или всей контроллеру--, изменяет способ, в котором выполняется действие. Платформа ASP.NET MVC включает несколько фильтров действий:

- OutputCache — это фильтр действий кэширует выходные данные действия контроллера для заданного количества времени.
- HandleError — это действие фильтр обрабатывает ошибки, возникшие при выполнении действия контроллера.
- Авторизация — это фильтр действий позволяет ограничить доступ к определенному пользователю или роли.

Можно также создавать свои собственные настраиваемых фильтров действий. Например может потребоваться создание пользовательского фильтра действий, чтобы реализовать пользовательскую систему аутентификации. Или может потребоваться создание фильтра действий, изменяющих представление данных, возвращаемых функцией действия контроллера.

В этом учебнике вы узнаете, как для построения фильтра действий с нуля. Мы Создание фильтра действий журнала, который записывает различные этапы обработки действия в окне вывода Visual Studio.

### <a name="using-an-action-filter"></a>С помощью фильтра действий

Фильтр действий является атрибутом. Большинство фильтров действий можно применить действие отдельного контроллера или всей контроллера.

Например, контроллер данных в список 1 предоставляет действие с именем `Index()` , возвращает текущее время. Это действие снабжен `OutputCache` фильтра действий. Этот фильтр в результате значение, возвращаемое действие на кэширование в течение 10 секунд.

**Листинг 1.`Controllers\DataController.cs`**

[!code-csharp[Main](understanding-action-filters-cs/samples/sample1.cs)]

Если несколько раз вызвать `Index()` действие, введя URL-адрес или данных или индекса в адресную строку браузера и попадание обновления кнопку несколько раз, то же время вы увидите на 10 секунд. Выходные данные `Index()` действие кэшируется на 10 секунд (см. рис. 1).


[![Время кэширования](understanding-action-filters-cs/_static/image2.png)](understanding-action-filters-cs/_static/image1.png)

**На рисунке 01**: время ([Просмотр полноразмерное изображение](understanding-action-filters-cs/_static/image3.png))


В список 1 фильтр одно действие — `OutputCache` фильтр действий — применяется к `Index()` метод. Если требуется, можно применить несколько фильтров действий для одного действия. Например, может потребоваться применить оба `OutputCache` и `HandleError` фильтры действий для одного действия.

В список 1 `OutputCache` фильтр действий применяется к `Index()` действие. Можно также применить этот атрибут к `DataController` сам класс. В этом случае результат, возвращаемый какие-либо действия, предоставляемые контроллером будет кэшироваться на 10 секунд.

### <a name="the-different-types-of-filters"></a>Различные типы фильтров

Платформа ASP.NET MVC поддерживает четыре типа фильтров:

1. Фильтры авторизации — реализует `IAuthorizationFilter` атрибута.
2. Фильтры действий — реализует `IActionFilter` атрибута.
3. Фильтры — реализует привести `IResultFilter` атрибута.
4. Фильтры исключений — реализует `IExceptionFilter` атрибута.

Фильтры выполняются в указанном выше порядке. Например фильтры авторизации всегда выполняются перед фильтрами действий и фильтры исключений, всегда выполняются после каждого типа фильтра.

Фильтры авторизации используются для реализации проверки подлинности и авторизации для действий контроллера. Например фильтр Authorize является примером фильтра авторизации.

Фильтры действий содержат логику, которая выполняется до и после выполнения действия контроллера. Фильтр действий можно использовать для экземпляра, для изменения представления данных, возвращающий действия контроллера.

Фильтры результатов содержат логику, которая выполняется до и после выполнения результата представления. Например, может возникнуть необходимость изменить результат представления правой перед визуализации представления в браузере.

Фильтры исключений — это последний тип фильтра для выполнения. Фильтр исключений можно использовать для обработки ошибок, вызванных результаты действий контроллера или действия контроллера. Также можно использовать фильтры исключений ошибок в журнал.

У каждого типа фильтра выполняется в определенном порядке. Если вы хотите управлять порядком, в котором выполняются фильтры того же типа можно задать свойство порядок фильтра.

Базовый класс для всех фильтров действий — `System.Web.Mvc.FilterAttribute` класса. Если необходимо реализовать определенный тип фильтра, то необходимо создать класс, наследующий от базового класса фильтра и реализует один или несколько `IAuthorizationFilter`, `IActionFilter`, `IResultFilter`, или `IExceptionFilter` интерфейсов.

### <a name="the-base-actionfilterattribute-class"></a>Базовый класс ActionFilterAttribute

Для упрощения реализации пользовательского фильтра действий, платформа ASP.NET MVC включает базовый `ActionFilterAttribute` класса. Этот класс реализует интерфейс `IActionFilter` и `IResultFilter` интерфейсы и наследует от `Filter` класса.

Терминология здесь не полностью согласованной. С технической точки зрения класс, наследующий от класса ActionFilterAttribute — фильтра действий и фильтра результатов. Тем не менее в том смысле, сохранения, фильтр действий word позволяет ссылаться на любой тип фильтра в платформе ASP.NET MVC.

Базовый `ActionFilterAttribute` класс содержит следующие методы, которые можно переопределить:

- OnActionExecuting — этот метод вызывается перед выполнением действия контроллера.
- OnActionExecuted — этот метод вызывается после выполнения действий контроллера.
- OnResultExecuting — этот метод вызывается до выполнения результата действия контроллера.
- OnResultExecuted — этот метод вызывается после выполнения результата действия контроллера.

В следующем разделе мы рассмотрим, как можно реализовать каждый из этих различных методов.

### <a name="creating-a-log-action-filter"></a>Создание фильтра журнала действий

Чтобы продемонстрировать, как создать настраиваемого фильтра действий, мы создадим пользовательского фильтра действий, записывает в журнал этапы обработки действия контроллера, в окне вывода Visual Studio. Наш `LogActionFilter` содержится в списке 2.

**Листинг 2.`ActionFilters\LogActionFilter.cs`**

[!code-csharp[Main](understanding-action-filters-cs/samples/sample2.cs)]

В списке 2 `OnActionExecuting()`, `OnActionExecuted()`, `OnResultExecuting()`, и `OnResultExecuted()` все методы вызова `Log()` метод. Имя метода и текущие данные маршрута передается `Log()` метод. `Log()` Метод записывает сообщение в окне вывода Visual Studio (см. рис. 2).


[![Запись в окне вывода Visual Studio](understanding-action-filters-cs/_static/image5.png)](understanding-action-filters-cs/_static/image4.png)

**На рисунке 02**: запись в окне вывода Visual Studio ([Просмотр полноразмерное изображение](understanding-action-filters-cs/_static/image6.png))


Контроллер Home в списке 3 показано, как применять фильтр журнала действий в класс контроллера целиком. Каждый раз, когда любой из действия, представляемые контроллера Home вызываются — либо `Index()` метода или `About()` метод — этапы обработки действия регистрируются в окне вывода Visual Studio.

**Листинг 3.`Controllers\HomeController.cs`**

[!code-csharp[Main](understanding-action-filters-cs/samples/sample3.cs)]

### <a name="summary"></a>Сводка

В этом учебнике вы ознакомились с ASP.NET MVC фильтров действий. Вы узнали о четыре различных типа фильтров: фильтры авторизации, фильтры действий, фильтры результатов и фильтры исключений. Вы также узнали о базе `ActionFilterAttribute` класса.

Наконец вы узнали, как реализовать простой фильтр действий. Мы создали фильтр действий журнала, который записывает в журнал этапы обработки действия контроллера, в окне вывода Visual Studio.

>[!div class="step-by-step"]
[Назад](asp-net-mvc-routing-overview-cs.md)
[Вперед](improving-performance-with-output-caching-cs.md)
