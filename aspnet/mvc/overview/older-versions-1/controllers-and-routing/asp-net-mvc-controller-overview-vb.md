---
uid: mvc/overview/older-versions-1/controllers-and-routing/asp-net-mvc-controller-overview-vb
title: Общие сведения о ASP.NET MVC контроллера (VB) | Документы Microsoft
author: StephenWalther
description: В этом учебнике Стивен Вальтер представлены контроллеров ASP.NET MVC. Вы узнаете, как для создания новых контроллеров и возвращать различные типы действий res...
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/16/2008
ms.topic: article
ms.assetid: 94c3e5d9-a904-445e-a34e-d92fd1ca108a
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/controllers-and-routing/asp-net-mvc-controller-overview-vb
msc.type: authoredcontent
ms.openlocfilehash: 0a45630e8f2d5ae0548bb6b8496df08ca5877a40
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="aspnet-mvc-controller-overview-vb"></a>Общие сведения о ASP.NET MVC контроллера (Visual Basic)
====================
по [Стивен Вальтер](https://github.com/StephenWalther)

> В этом учебнике Стивен Вальтер представлены контроллеров ASP.NET MVC. Вы узнаете, как для создания новых контроллеров и возвращать различные типы результатов действий.


Этот учебник изучает темы ASP.NET MVC контроллеры действия контроллера и результаты действий. После завершения этого учебника вы сможете понять, как контроллеры используются для управления способом, когда посетитель взаимодействует с веб-сайта ASP.NET MVC.

## <a name="understanding-controllers"></a>Общее представление о контроллерах

Контроллеров MVC отвечают за отвечает на запросы, адресованные на веб-сайт ASP.NET MVC. Каждый запрос браузера сопоставляется конкретном контроллере. Например предположим, что введите следующий URL-адрес в адресную строку браузера:

`http://localhost/Product/Index/3`

В этом случае вызывается контроллер с именем ProductController. ProductController отвечает за создание ответа на запрос браузера. Например контроллер может вернуть конкретное представление браузера или контроллер может перенаправлять пользователя на другом контроллере.

Листинг 1 содержит простой контроллер с именем ProductController.

**Listing1 - Controllers\ProductController.vb**

[!code-vb[Main](asp-net-mvc-controller-overview-vb/samples/sample1.vb)]

Как видно из список 1 контроллера — это класс (класс Visual Basic .NET или C#). Контроллер — класс, производный от базового класса System.Web.Mvc.Controller. Поскольку контроллер наследует от этого базового класса, контроллер наследует несколько полезных методов для получения бесплатной (мы обсудим эти методы чуть позже).

## <a name="understanding-controller-actions"></a>Основные сведения о действиях контроллера

Контроллер предоставляет действия контроллера. Действие — это метод на контроллере, который вызывается при вводе определенный URL-адрес в адресную строку браузера. Например предположим, сделать запрос для следующего URL:

`http://localhost/Product/Index/3`

В этом случае метод Index() вызывается в классе ProductController. Метод Index() приведен пример действия контроллера.

Действие контроллера должен быть открытый метод класса контроллера. Visual Basic.NET методы, по умолчанию являются открытыми методами. Учтите, что любой открытый метод, который можно добавить в класс контроллера предоставляется как действия контроллера, автоматически (необходимо быть осторожным это так, как действие контроллера может вызываться кем-либо во вселенной просто введя правой URL-адрес в адресную строку браузера).

Существуют некоторые дополнительные требования, которые должны быть удовлетворены с помощью действия контроллера. Метод, который используется в качестве действия контроллера, не могут быть перегружены. Кроме того действия контроллера не может быть статическим методом. За исключением этого можно использовать практически любой метод, как действия контроллера.

## <a name="understanding-action-results"></a>Основные сведения о результатах действия

Возвращает действие контроллера называемое *результат действия*. Результат действия — возвращает в ответ на запрос браузера действия контроллера.

Платформа ASP.NET MVC поддерживает несколько типов результатов действий, в том числе:

1. ViewResult - представляет HTML и разметки.
2. EmptyResult - представляет никакого результата.
3. RedirectResult - представляет перенаправление на новый URL-адрес.
4. JsonResult - представляет результат нотации объектов JavaScript, который может использоваться в приложениях AJAX.
5. JavaScriptResult - представляет сценарий JavaScript.
6. ContentResult - представляет результат текста.
7. FileContentResult - представляет загружаемый файл (с двоичное содержимое).
8. FilePathResult - представляет загружаемый файл (с путем).
9. FileStreamResult - представляет загружаемый файл (с файлового потока).

Результаты этих действий наследуются от базового класса ActionResult.

В большинстве случаев действия контроллера возвращает ViewResult. Например действие контроллера индекса в списке 2 Возвращает ViewResult.

**Листинг 2 - Controllers\BookController.vb**

[!code-vb[Main](asp-net-mvc-controller-overview-vb/samples/sample2.vb)]

Если действие возвращает ViewResult, HTML возвращается в браузере. Метод Index() в списке 2 Возвращает представление с именем Index в браузере.

Обратите внимание, что Index() действие в списке 2 Возвращает ViewResult(). Вместо этого вызывается метод View() базового класса контроллера. Как правило вы не возвращают результат действия непосредственно. Вместо этого вызовите один из следующих методов базового класса контроллера.

1. Просмотр - возвращает результат действия ViewResult.
2. Перенаправить — возвращает результат действия RedirectResult.
3. RedirectToAction - возвращает результат действия RedirectToRouteResult.
4. RedirectToRoute - возвращает результат действия RedirectToRouteResult.
5. JSON - возвращает результат действия JsonResult.
6. JavaScriptResult - возвращает JavaScriptResult.
7. Содержания - возвращает результат действия ContentResult.
8. Файл - возвращает FileContentResult, FilePathResult или FileStreamResult в зависимости от параметров, переданного методу.

Таким образом Если требуется возвратить представление в браузере, вызовите метод View(). Если вы хотите перенаправить пользователя из одного контроллера действия к другому, можно вызвать метод RedirectToAction(). Например действие Details() в списке 3 отображает представление либо перенаправляет пользователя на Index() действие в зависимости от того, является ли параметр Id имеет значение.

**Листинг 3 - CustomerController.vb**

[!code-vb[Main](asp-net-mvc-controller-overview-vb/samples/sample3.vb)]

Результат действия ContentResult специальные. Результат действия ContentResult можно использовать для возвращения результата действия в виде обычного текста. Например метод Index() в листинге 4 возвращает сообщение, как обычный текст, а не как HTML.

**Листинг 4 - Controllers\StatusController.vb**

> StatusController
> 
> 
> System.Web.Mvc.Controller


[!code-vb[Main](asp-net-mvc-controller-overview-vb/samples/sample4.vb)]

При вызове действия StatusController.Index() представления не возвращается. Вместо этого необработанный текст «Hello World!» возвращается в браузере.

Если действие контроллера возвращает результат, не результат действия — например, даты или целое число — затем результат заключается в ContentResult автоматически. Например при вызове действия Index() WorkController в листинге 5 даты возвращается в виде ContentResult автоматически.

**Список 5 - WorkController.vb**

[!code-vb[Main](asp-net-mvc-controller-overview-vb/samples/sample5.vb)]

Действие Index() в листинге 5 возвращает объект DateTime. Платформа ASP.NET MVC преобразует объект DateTime в строку и создает оболочку значения даты и времени в ContentResult автоматически. Обозреватель получает дату и время в виде обычного текста.

## <a name="summary"></a>Сводка

Цель этого учебника было для ознакомления с основными понятиями контроллеров ASP.NET MVC, действия контроллера и результаты действий контроллера. В первом разделе вы узнали, как добавление новых контроллеров в проект ASP.NET MVC. Далее вы узнали, как открытые методы контроллера доступны вселенной действия контроллера. Наконец мы рассмотрели различные типы результатов действий, которые могут быть возвращены из действия контроллера. В частности мы рассмотрели, как получить ViewResult, RedirectToActionResult и ContentResult из действия контроллера.

> [!div class="step-by-step"]
> [Назад](creating-a-custom-route-constraint-cs.md)
> [Вперед](creating-custom-routes-vb.md)
