---
uid: mvc/overview/older-versions-1/security/preventing-javascript-injection-attacks-cs
title: Предотвращение атак путем внедрения кода JavaScript (C#) | Документы Microsoft
author: StephenWalther
description: Предотвратить атаки путем внедрения кода JavaScript и межсайтовых сценариев атаки для вас. В этом учебнике Стивен Вальтер объясняется, каким образом вы можете легко de...
ms.author: aspnetcontent
manager: wpickett
ms.date: 08/19/2008
ms.topic: article
ms.assetid: d0136da6-81a4-4815-b002-baa84744c09e
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/security/preventing-javascript-injection-attacks-cs
msc.type: authoredcontent
ms.openlocfilehash: fbec58c009640164d908db5a45557c9e50041173
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="preventing-javascript-injection-attacks-c"></a>Предотвращение атак путем внедрения кода JavaScript (C#)
====================
по [Стивен Вальтер](https://github.com/StephenWalther)

[Скачать PDF](http://download.microsoft.com/download/8/4/8/84843d8d-1575-426c-bcb5-9d0c42e51416/ASPNET_MVC_Tutorial_06_CS.pdf)

> Предотвратить атаки путем внедрения кода JavaScript и межсайтовых сценариев атаки для вас. В этом учебнике Стивен Вальтер объясняется, как можно легко обойти эти типы атак с HTML-кодирование содержимого.


Целью данного учебника является объясняется, каким образом можно предотвратить атаки путем внедрения кода JavaScript в приложениях ASP.NET MVC. Этот учебник описывает два подхода к Защита веб-сайта от атаки путем внедрения кода JavaScript. Вы узнаете, как для предотвращения атак путем внедрения кода JavaScript путем кодирования данных, которые можно просматривать. Вы также узнаете, как предотвратить атаки путем внедрения кода JavaScript при кодировании, вы принимаете данные.

## <a name="what-is-a-javascript-injection-attack"></a>Что такое атака путем внедрения кода JavaScript

Каждый раз, когда принимают пользовательский ввод и отобразите данные, введенные пользователем, можно открыть веб-сайт для атак путем внедрения кода JavaScript. Давайте рассмотрим конкретные приложения, которое атакам путем внедрения кода JavaScript.

Представьте, что вы создали веб-сайт клиента обратной связи (см. рис. 1). Клиентов можно посетить веб-сайт и ввести обратной связи со своими впечатлениями своей продукции. Когда клиент отправляет свои отзывы, отзывы и предложения отобразится на странице обратной связи.


[![Веб-сайт отзывов клиентов](preventing-javascript-injection-attacks-cs/_static/image2.png)](preventing-javascript-injection-attacks-cs/_static/image1.png)

**На рисунке 01**: веб-сайта клиента обратной связи ([Просмотр полноразмерное изображение](preventing-javascript-injection-attacks-cs/_static/image3.png))


Веб-сайт отзывов клиентов использует `controller` в листинге 1. Это `controller` содержит два действия с именем `Index()` и `Create()`.

**Листинг 1. `HomeController.cs`**

[!code-csharp[Main](preventing-javascript-injection-attacks-cs/samples/sample1.cs)]

`Index()` Метод выводит `Index` представления. Этот метод передает все предыдущие отзывы для `Index` представление, получая обратную связь из базы данных (с помощью LINQ to SQL-запроса).

`Create()` Метод создает новый элемент обратной связи и добавляет его в базу данных. Сообщение, которое клиент вводит в форме передается `Create()` метода в параметре сообщения. Элемент отзыв создается и сообщение назначается элемент отзыв `Message` свойство. Элемент отзыв отправляется в базу данных с `DataContext.SubmitChanges()` вызова метода. Наконец, пользователь перенаправляется обратно `Index` представление, где отображаются все отзывы и предложения.

`Index` Представление содержится в списке 2.

**Листинг 2. `Index.aspx`**

[!code-aspx[Main](preventing-javascript-injection-attacks-cs/samples/sample2.aspx)]

`Index` Представление состоит из двух разделов. Верхняя область содержит формы на отзыв клиента. В нижней части содержит цикл For... Каждый цикл, который просматривает все предыдущие элементы отзыв клиента и отображает свойства EntryDate и сообщение для каждого элемента отзыва.

Отзыв веб-сайта клиента является простой веб-сайт. К сожалению веб-сайт доступен для атак путем внедрения кода JavaScript.

Представьте, введите следующий текст в форме отзыв клиента:

[!code-html[Main](preventing-javascript-injection-attacks-cs/samples/sample3.html)]

Этот текст представляет сценарий JavaScript, который выводит окно оповещения. После кто-то отправляет этот скрипт в отзывы форме сообщения <em>Boo!</em> будет отображаться всякий раз, когда любой пользователь посещает веб-сайт отзывов клиентов в будущем (см. рис. 2).


[![Путем внедрения кода JavaScript](preventing-javascript-injection-attacks-cs/_static/image5.png)](preventing-javascript-injection-attacks-cs/_static/image4.png)

**На рисунке 02**: путем внедрения кода JavaScript ([Просмотр полноразмерное изображение](preventing-javascript-injection-attacks-cs/_static/image6.png))


Теперь ваш первого ответа для атак путем внедрения кода JavaScript может быть apathy. Может показаться, что атак путем внедрения кода JavaScript — это просто тип *вандализм* атаки. Разработчик может посчитать, что ни один можно делать все действительно злонамеренный путем фиксации атаке путем внедрения кода JavaScript.

К сожалению, злоумышленник может выполнения некоторых правота действительно злонамеренный вещей, внедряя JavaScript в веб-сайт. Атака путем внедрения кода JavaScript можно использовать для выполнения атаки межузловых сценариев (XSS). При атаке межсайтовых сценариев крадут конфиденциальные пользователя данные и отправляет данные другой веб-сайт.

Например злоумышленник можно использовать атаке путем внедрения кода JavaScript для кражи значения cookie браузера у других пользователей. Если конфиденциальные сведения — например, пароли, номера кредитных карт или номера социального страхования — хранится в файлах cookie браузера, злоумышленник воспользуйтесь атаке путем внедрения кода JavaScript для кражи эти сведения. Или, если пользователь вводит конфиденциальные сведения в поле формы, содержащихся на странице, который подвергался угрозе атаки JavaScript, то злоумышленник может использовать подставляемого JavaScript Чтобы захватить данные формы и отправлять их в другой веб-сайт.

*Будьте Испуганные*. Серьезно атак путем внедрения кода JavaScript и защитить конфиденциальные данные конечных пользователей. В следующих двух разделах мы рассмотрим два метода, которые можно использовать для защиты от атак путем внедрения кода JavaScript из приложений ASP.NET MVC.

## <a name="approach-1-html-encode-in-the-view"></a>Подход #1: Кодировка HTML в представлении

Один простой метод предотвращает атаки путем внедрения кода JavaScript в HTML кодировать данные, вводимые пользователем на веб-сайт, при отображении данных в представлении. Обновленный `Index` представление в списке 3 соответствует этот подход.

**Листинг 3 – `Index.aspx` (кодируется в HTML)**

[!code-aspx[Main](preventing-javascript-injection-attacks-cs/samples/sample4.aspx)]

Обратите внимание, что значение `feedback.Message` кодировку перед отображением значение с помощью следующего кода HTML:

[!code-aspx[Main](preventing-javascript-injection-attacks-cs/samples/sample5.aspx)]

Каковы среднее для HTML-кодирования строки? Когда вы HTML кодирования строки, опасные символы, такие как `<` и `>` заменяются ссылки на сущности HTML, такие как `&lt;` и `&gt;`. Поэтому если строка `<script>alert("Boo!")</script>` HTML-код в кодировке, он преобразуется в `&lt;script&gt;alert(&quot;Boo!&quot;)&lt;/script&gt;`. Закодированная строка больше не выполняется как сценарий JavaScript при интерпретации в браузере. Вместо этого можно получить опасное страницу на рис. 3.


[![Атака нарушается, JavaScript](preventing-javascript-injection-attacks-cs/_static/image8.png)](preventing-javascript-injection-attacks-cs/_static/image7.png)

**На рисунке 03**: нарушается атаки JavaScript ([Просмотр полноразмерное изображение](preventing-javascript-injection-attacks-cs/_static/image9.png))


Обратите внимание, что в `Index` просмотр только значения в списке 3 `feedback.Message` кодируется. Значение `feedback.EntryDate` не кодируется. Необходимо кодировать данные, введенные пользователем. Поскольку значение EntryDate было создано в контроллере, не требуется в формате HTML кодирования это значение.

## <a name="approach-2-html-encode-in-the-controller"></a>Подход #2: Кодировка HTML в контроллере

Вместо кодировки данных, при отображении данных в представлении HTML можно HTML кодировать данные только в том случае, прежде чем отправлять данные в базу данных. Этот второй подход применяется в случае использования `controller` в листинге 4.

**Листинг 4 – `HomeController.cs` (кодируется в HTML)**

[!code-csharp[Main](preventing-javascript-injection-attacks-cs/samples/sample6.cs)]

Обратите внимание, что значения сообщения перед отправкой в базу данных значение в кодировке HTML `Create()` действие. При сообщении отобразится в представлении, сообщение кодируется в HTML и любые JavaScript, введенного в сообщении не выполняется.

Как правило следует предпочитать первый подход, описанный в этом учебнике по такой подход. Проблема с такой подход заключается в том, что вы получаете кодируется в HTML-данных в базе данных. Другими словами данные из базы данных является измененных забавные внешнего вида символов.

Почему это неправильный? В дальнейшем для отображения данных базы данных в нечто, отличное от веб-страницы, будут иметь проблем. Например можно отобразить больше не легко данных в приложении Windows Forms.

## <a name="summary"></a>Сводка

Целью данного учебника было запугивает вас о потенциальных атак путем внедрения кода JavaScript. Этот учебник рассматриваются два подхода для защиты приложений ASP.NET MVC от атак путем внедрения кода JavaScript: вы можете либо HTML кодирования отправлен пользователем данных в представлении или вы можете HTML кодирования отправлен пользователем данных в контроллере.

> [!div class="step-by-step"]
> [Назад](authenticating-users-with-windows-authentication-cs.md)
> [Вперед](authenticating-users-with-forms-authentication-vb.md)
