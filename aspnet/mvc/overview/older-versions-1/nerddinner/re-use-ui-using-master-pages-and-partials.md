---
uid: mvc/overview/older-versions-1/nerddinner/re-use-ui-using-master-pages-and-partials
title: Повторно использовать пользовательский Интерфейс, с помощью главных страниц и частичными репликами | Документы Microsoft
author: microsoft
description: Шаг 7 рассматриваются способы ТОНЕРА принцип, можно применить в наших шаблонов представлений, чтобы исключить дублирование кода, с помощью шаблонов частичного представления и главные страницы.
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/27/2010
ms.topic: article
ms.assetid: d4243a4a-e91c-4116-9ae0-5c08e5285677
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/nerddinner/re-use-ui-using-master-pages-and-partials
msc.type: authoredcontent
ms.openlocfilehash: ade655f3a4a429360b678d02fb564ac9cf255d42
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30870015"
---
<a name="re-use-ui-using-master-pages-and-partials"></a>Повторно использовать пользовательский Интерфейс, с помощью главных страниц и частичными репликами
====================
по [Microsoft](https://github.com/microsoft)

[Скачать PDF](http://aspnetmvcbook.s3.amazonaws.com/aspnetmvc-nerdinner_v1.pdf)

> Это бесплатная шаге 7 [учебника «Обновление NerdDinner» приложения](introducing-the-nerddinner-tutorial.md) , обходов сквозной как построить небольшой, но завершается веб-приложения с помощью ASP.NET MVC 1.
> 
> Шаг 7 выглядит как «ТОНЕРА принцип», можно применить в наших шаблонов представлений, чтобы исключить дублирование кода, с помощью шаблонов частичного представления и главные страницы.
> 
> При использовании ASP.NET MVC 3, которому рекомендуется следовать [Приступая к работе с MVC 3](../../older-versions/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3.md) или [MVC Music Store](../../older-versions/mvc-music-store/mvc-music-store-part-1.md) учебники.


## <a name="nerddinner-step-7-partials-and-master-pages"></a>Обновление NerdDinner шаг 7: Частичными репликами и главных страниц

Один из принципов проектирования, которые охватывает ASP.NET MVC — «Выполнить не повторяться» принцип (часто называют «ПРОБНОГО»). ТОНЕРА разработки позволяет избежать дублирования кода и логику, которая в конечном счете делает приложения для построения быстрее и проще.

Мы уже видели ТОНЕРА принцип применяется в нескольких обновление NerdDinner сценариев. Некоторые примеры: Наша логика проверки реализуется в нашей модели уровня, который позволяет принудительно через оба изменения и создавать сценарии в нашем контроллера; Мы используем Просмотр шаблона «NotFound» повторно через методы действий редактирования, подробные сведения и Delete; шаблон именования соглашение - мы используем наш представление шаблонов, которые устраняет необходимость явно задавать имя при вызове вспомогательного метода View(); и мы снова используется класс DinnerFormViewModel для обоих изменения и создавать сценарии действие.

Теперь взглянем на способы «ТОНЕРА принцип», можно применить в рамках наших шаблонов представлений во избежание дублирования кода существует также.

### <a name="re-visiting-our-edit-and-create-view-templates"></a>Повторно обсудите наши изменения и создания шаблонов представлений

В настоящее время мы используем два шаблона другое представление — «Edit.aspx» и «Create.aspx» — для отображения нашей компании Dinner формы пользовательского интерфейса. Быстрое сравнение visual их подчеркивает они похожи. Ниже приведен выглядит как создать форму.

![](re-use-ui-using-master-pages-and-partials/_static/image1.png)

И вот как выглядит нашу форму «Изменить»:

![](re-use-ui-using-master-pages-and-partials/_static/image2.png)

Больших изменений не существует? Отличное от текста заголовка и заголовок элементы управления формы макет и входные данные являются идентичными.

При открытии «Edit.aspx» и «Create.aspx» шаблонов представлений, которые мы найти, они содержат идентичные формы макет и входные данные управления код. Это дублирование означает, что мы образоваться дважды каждый раз, когда мы ввести или изменить новое свойство Dinner - не вносить изменения.

### <a name="using-partial-view-templates"></a>С помощью шаблонов частичного представления

ASP.NET MVC поддерживает возможность определения «частичное представление» шаблоны, которые можно использовать для инкапсуляции логики отрисовки представления для вложенных часть страницы. «Частичными репликами» — это удобное средство для определения логики отрисовки представления один раз и затем использовать его повторно в нескольких местах внутри приложения.

Чтобы «ПРОБНОГО вверх» наш Edit.aspx и дублирование шаблона Create.aspx представления, можно создать шаблон частичного представления, с именем «DinnerForm.ascx», инкапсулирующий макет формы и общим для обоих входных элементов. Это нужно сделать, щелкнув правой кнопкой мыши на каталог ужинов/представления/и выбрав команду «Add -&gt;представление «команды меню:

![](re-use-ui-using-master-pages-and-partials/_static/image3.png)

Откроется диалоговое окно «Добавление представления». Мы назовем новое представление, мы хотите создавать «DinnerForm», установите флажок «Создание частичного представления» в диалоговом окне и указывают, что мы будет передавать класс DinnerFormViewModel:

![](re-use-ui-using-master-pages-and-partials/_static/image4.png)

При нажатии кнопки «Добавить», Visual Studio создаст новый шаблон представления «DinnerForm.ascx» для нас в каталоге «\Views\Dinners».

Мы можно затем скопировать и вставить в макет формы повторяющиеся / ввод управляющий код из наших шаблонов представлений Edit.aspx/ Create.aspx в наш новый шаблон частичного представления «DinnerForm.ascx»:

[!code-aspx[Main](re-use-ui-using-master-pages-and-partials/samples/sample1.aspx)]

Затем можно обновлять наши изменение и создание шаблонов представлений для вызова шаблона частичного DinnerForm и исключения дублирования формы. Это можно сделать путем вызова Html.RenderPartial("DinnerForm") в наших шаблонов представлений:

##### <a name="createaspx"></a>CREATE.aspx

[!code-aspx[Main](re-use-ui-using-master-pages-and-partials/samples/sample2.aspx)]

##### <a name="editaspx"></a>Edit.aspx

[!code-aspx[Main](re-use-ui-using-master-pages-and-partials/samples/sample3.aspx)]

Можно явно указать путь к шаблону частичного, при вызове Html.RenderPartial (например: ~ Views/Dinners/DinnerForm.ascx»). В коде выше, мы воспользуемся преимуществами соглашению шаблон именования в ASP.NET MVC и только указывает «DinnerForm» как имя частичного для подготовки к просмотру. Когда мы делаем это ASP.NET MVC будет искать сначала в каталоге представлений на основе соглашений (это было бы ужинов/представления/DinnersController). Если он не находит частичного шаблона существует он будет искать его в каталоге /Views/Shared.

При вызове Html.RenderPartial() только именем частичного представления ASP.NET MVC передает частичного представления одной модели и ViewData словарь объектов, используемых вызывающий шаблона представления. Кроме того существуют перегруженные версии Html.RenderPartial(), позволяющие передавать альтернативный объект модели и/или словарь ViewData для частичного представления, чтобы использовать. Это полезно в сценариях, где требуется только подмножество полной модели или ViewModel передачи.

| **Раздел стороны: Почему &lt;%%&gt; вместо &lt;% = %&gt;?** |
| --- |
| Одно из действий небольшие, вы могли заметить с приведенный выше код является мы используем &lt;%%&gt; блокировать вместо &lt;% = %&gt; блокировать при вызове Html.RenderPartial(). &lt;% = %&gt; блоки в ASP.NET указывают, разработчик хочет отрисовки указанное значение (например: &lt;% = «Hello» %&gt; будет отображен «Hello»). &lt;%%&gt; блоки вместо этого указать, что разработчику для выполнения кода, любой созданный выходные данные в них должны выполняться явно (например: &lt;% Response.Write("Hello") %&gt;. Причина, мы используем &lt;%%&gt; блока с нашей приведенный выше код Html.RenderPartial — поскольку Html.RenderPartial() метод не возвращает строки, а вместо этого выводит поток выходных данных содержимое непосредственно для вызова шаблона представления. Это делается в целях повышения эффективности производительности и, таким образом, он исключает необходимость создания объекта (потенциально очень большого объема) временной строки. Это позволяет сократить использование памяти и повышает пропускную способность для всего приложения. Распространенной ошибкой при использовании Html.RenderPartial(), забыли добавить точку с запятой в конце вызова, когда он находится в пределах &lt;%%&gt; блока. Например, этот код вызывает ошибку компилятора: &lt;% Html.RenderPartial("DinnerForm") %&gt; вместо этого необходимо написать: &lt;% Html.RenderPartial("DinnerForm"); %&gt; это из-за &lt;%%&gt; блоки — это автономная код инструкции и при использовании кода C#, операторы должны заканчиваться точкой с запятой. |

### <a name="using-partial-view-templates-to-clarify-code"></a>Использование шаблонов частичного представления для уточнения кода

Мы создали шаблон частичного представления «DinnerForm» во избежание дублирования логики визуализации представления в нескольких местах. Это наиболее распространенная причина для создания шаблонов частичного представления.

Иногда он по-прежнему имеет смысл для создания частичных представлений, даже в том случае, если они вызываются только в одном месте. Шаблоны очень сложным представления зачастую становится гораздо легче читать при их логики отрисовки представления извлекаются и секционирована в одну или более также с именем частичная шаблонов.

Например, рассмотрим ниже фрагмент кода в файл Site.master, в данном проекте (который мы заинтересованы в ближайшее время). Код является довольно прост для чтения — частично так, как связать логику для отображения имени входа и выхода в верхней правой части экрана, инкапсулируется в разделяемом «LogOnUserControl»:

[!code-aspx[Main](re-use-ui-using-master-pages-and-partials/samples/sample4.aspx)]

Каждый раз, когда вы обнаружите начало путать попытке понять разметка html кода в рамках шаблона представления, рассмотрите возможность ли она не будет работать лучше, если некоторые из его было извлечь и подвергнуты рефакторингу в хорошо именованные частичного представления.

### <a name="master-pages"></a>Главные страницы

Помимо поддержки частичных представлений, ASP.NET MVC также поддерживает возможность создания шаблонов «главной страницы», можно использовать для определения макета страницы и html верхнего уровня сайта. Заполнитель, которую затем можно добавить элементы управления на главную страницу для определения заменяемых областей, которые переопределены или «заполнено» с помощью представлений. Это обеспечивает очень эффективный (и ТОНЕРА) способ применения макета страницы приложения.

По умолчанию для новых проектов ASP.NET MVC имеют шаблон главной страницы, автоматически добавляется в их. Эта главная страница называется «Site.master» и находится в папке \Views\Shared\:

![](re-use-ui-using-master-pages-and-partials/_static/image5.png)

По умолчанию файл Site.master выглядит как ниже. Он определяет внешнее HTML-код сайта, а также меню навигации в верхней. Он содержит два элемента управления заменяемым заполнителя контента — один для заголовка, а другая — для которой следует заменить основного содержимого страницы:

[!code-aspx[Main](re-use-ui-using-master-pages-and-partials/samples/sample5.aspx)]

Все шаблоны представления, которые мы создали для нашего приложения обновление NerdDinner («Список», «Сведения», «Изменить», «Создание», «NotFound» и т. д) основанными на этот шаблон Site.master. Это указывает через атрибут «MasterPageFile», был добавлен по умолчанию в верхней части &lt;% @ Page %&gt; директива создания наши представления с помощью диалогового окна «Добавление представления»:

[!code-aspx[Main](re-use-ui-using-master-pages-and-partials/samples/sample6.aspx)]

Это означает, что мы можем изменить содержимое Site.master и иметь изменения автоматически применяться и используется, когда мы отрисовки любой из наших шаблонов представлений.

Давайте обновить раздел заголовка нашей Site.master таким образом, заголовок приложения «Обновление NerdDinner» вместо «Мое приложение MVC». Давайте также обновляет нашей меню навигации, первая вкладка — «Найти Dinner» (обрабатываться методом действия HomeController Index()) и добавим новую вкладку, которая называется «Узла Dinner» (обрабатываться методом действия DinnersController Create()).

[!code-aspx[Main](re-use-ui-using-master-pages-and-partials/samples/sample7.aspx)]

Если сохранить файл Site.master и обновить наш обозреватель, мы увидим заголовка изменения Показать до ко всем представлениям в приложении. Пример:

![](re-use-ui-using-master-pages-and-partials/_static/image6.png)

И с */Dinners/Edit / [id]* URL-адрес:

![](re-use-ui-using-master-pages-and-partials/_static/image7.png)

### <a name="next-step"></a>Следующий шаг

Частичными репликами и главные страницы предоставляют очень гибкие средства, позволяющие полностью упорядочения представления. Вы найдете они помогают избежать дублирования представления содержимого / кода и облегчить чтение и обслуживание вашей шаблонов представлений.

Теперь давайте повторное использование листинг сценария, который мы создали ранее и включить масштабируемую поддержку разбиения на страницы.

> [!div class="step-by-step"]
> [Назад](use-viewdata-and-implement-viewmodel-classes.md)
> [Вперед](implement-efficient-data-paging.md)
