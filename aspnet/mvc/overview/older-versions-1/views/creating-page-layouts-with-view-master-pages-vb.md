---
uid: mvc/overview/older-versions-1/views/creating-page-layouts-with-view-master-pages-vb
title: Создание макетов страниц с главными страницами представлений (VB) | Документы Microsoft
author: microsoft
description: В этом учебнике вы научитесь создавать общий макет страницы для нескольких страниц в приложении, используя преимущества представления главных страниц. Можно использовать...
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/16/2008
ms.topic: article
ms.assetid: d34f90a1-6de3-482a-a326-f87fdcbaaaff
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/views/creating-page-layouts-with-view-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 5208cedd8d24a290a0227bdcbaa84ae6210cd969
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="creating-page-layouts-with-view-master-pages-vb"></a>Создание макетов страниц с главными страницами представлений (Visual Basic)
====================
по [Microsoft](https://github.com/microsoft)

[Скачать PDF](http://download.microsoft.com/download/e/f/3/ef3f2ff6-7424-48f7-bdaa-180ef64c3490/ASPNET_MVC_Tutorial_12_VB.pdf)

> В этом учебнике вы научитесь создавать общий макет страницы для нескольких страниц в приложении, используя преимущества представления главных страниц. Например, главной страницы представления, можно использовать для определения макета страницы с двумя столбцами и двумя столбцами разметка используется для всех страниц веб-приложения.


## <a name="creating-page-layouts-with-view-master-pages"></a>Создание макетов страниц с главными страницами представлений

В этом учебнике вы научитесь создавать общий макет страницы для нескольких страниц в приложении, используя преимущества представления главных страниц. Например, главной страницы представления, можно использовать для определения макета страницы с двумя столбцами и двумя столбцами разметка используется для всех страниц веб-приложения.

Вы также сможете использовать представления главных страниц для совместного использования типичного содержимого на несколько страниц в приложении. Например можно поместить Эмблема веб-сайта, ссылки навигации и рекламных объявлений в главной страницы представления. В этом случае каждой страницы в приложении будут автоматически отображать это содержимое.

В этом учебнике вы узнаете, как для создания новой главной страницы представления и создать новую страницу содержимого представления, основанные на главной странице.

### <a name="creating-a-view-master-page"></a>Создание представления главной страницы

Давайте начнем с создания представления главной страницы, которая определяет макета с двумя столбцами. Добавлении новой главной страницы представления проекта MVC щелкните правой кнопкой мыши одну папку, выбрав пункт меню **добавить, новый элемент**и выбрав шаблон MVC представления главной страницы (см. рис. 1).


[![Добавление представления главной страницы](creating-page-layouts-with-view-master-pages-vb/_static/image2.png)](creating-page-layouts-with-view-master-pages-vb/_static/image1.png)

**На рисунке 01**: Добавление главной страницы представления ([Просмотр полноразмерное изображение](creating-page-layouts-with-view-master-pages-vb/_static/image3.png))


В приложении можно создать более одной главной страницы представления. Каждого представления главной страницы можно задать макет в другую страницу. Например может потребоваться определенные страницы иметь макета с двумя столбцами и других страниц, чтобы макет с тремя столбцами.

Главная страница представления внешне похожи стандартного представления ASP.NET MVC. Однако в отличие от обычных представления главной страницы представления содержит один или несколько `<asp:ContentPlaceHolder>` тегов. `<contentplaceholder>` Теги используются для пометки областей главной страницы, который может быть переопределен в отдельной страницы содержимого.

Например главной страницы представления в список 1 определяет макета с двумя столбцами. Он содержит два `<contentplaceholder>` тегов. Один `<ContentPlaceHolder>` для каждого столбца.

**Листинг 1. `Views\Shared\Site.master`**

[!code-aspx[Main](creating-page-layouts-with-view-master-pages-vb/samples/sample1.aspx)]

Текст представления главной страницы в список 1 содержит два `<div>` теги, которые соответствуют двух столбцов. Класс каскадной таблицы стилей столбца применяется к обоим `<div>` тегов. Этот класс определен в таблице стилей, объявленные в верхней части главной страницы. Можно просмотреть просмотру главной страницы представления с переключением в представление конструирования. Перейдите на вкладку конструктора в левой нижней части редактора исходного кода (см. рис. 2).


[![Предварительный просмотр главной страницы в конструкторе](creating-page-layouts-with-view-master-pages-vb/_static/image5.png)](creating-page-layouts-with-view-master-pages-vb/_static/image4.png)

**На рисунке 02**: предварительный просмотр главной страницы в конструкторе ([Просмотр полноразмерное изображение](creating-page-layouts-with-view-master-pages-vb/_static/image6.png))


### <a name="creating-a-view-content-page"></a>Создание представления содержимого страницы

После создания представления главной страницы, можете создать один или несколько представление страницы содержимого, на основе главной страницы представления. Например, можно создать индекс представления страницы содержимого для контроллера Home щелкните правой кнопкой мыши по папке Views\Home выбора **добавить, новый элемент**, выбрав **страница содержимого представления MVC** шаблон, введя имя Index.aspx и выберите команду Добавить кнопку (см. рис. 3).


[![Добавление представления содержимого страницы](creating-page-layouts-with-view-master-pages-vb/_static/image8.png)](creating-page-layouts-with-view-master-pages-vb/_static/image7.png)

**На рисунке 03**: Добавление страница содержимого представления ([Просмотр полноразмерное изображение](creating-page-layouts-with-view-master-pages-vb/_static/image9.png))


После нажатия кнопки "Добавить", новое диалоговое окно отображается, можно выбрать представления главной страницы для связи с страница содержимого представления (см. рис. 4). Можно перейти к главной страницы представление Site.master, созданную в предыдущем разделе.


[![Выбор главной страницы](creating-page-layouts-with-view-master-pages-vb/_static/image11.png)](creating-page-layouts-with-view-master-pages-vb/_static/image10.png)

**На рисунке 04**: Выбор главной страницы ([Просмотр полноразмерное изображение](creating-page-layouts-with-view-master-pages-vb/_static/image12.png))


После создания новой страницы содержимого представления, основанные на главной странице Site.master, вы получаете файл в списке 2.

**Листинг 2. `Views\Home\Index.aspx`**

[!code-aspx[Main](creating-page-layouts-with-view-master-pages-vb/samples/sample2.aspx)]

Обратите внимание, что это представление содержит `<asp:Content>` тег, соответствующий каждому `<asp:ContentPlaceHolder>` тегов в главной страницы представления. Каждый `<asp:Content>` тег содержит атрибут ContentPlaceHolderID, который указывает конкретный `<asp:ContentPlaceHolder>` , оно переопределяет.

Кроме того, обратите внимание, что страница содержимого представления в списке 2 не содержат обычные открывающие и закрывающие HTML теги. Например, он не содержит открывающим и закрывающим `<html>` или `<head>` тегов. Все обычные открывающие и закрывающие теги содержатся в главной страницы представления.

Любое содержимое, которое будет отображаться на странице содержимого представления должен быть помещен в `<asp:Content>` тег. Если поместить любой код HTML и другое содержимое, за пределами этих тегов будет формировать ошибку при попытке просмотра страницы.

Не требуется переопределять каждый `<asp:ContentPlaceHolder>` тег из главной страницы в представлении содержимого страницы. Необходимо переопределить `<asp:ContentPlaceHolder>` тег, если вы хотите заменить тег конкретного содержимого.

Например, представление изменения индекса в списке 3 содержит только две `<asp:Content>` тегов. Каждый из `<asp:Content>` тегов содержит некоторый текст.

**Листинг 3. `Views\Home\Index.aspx (modified)`**

[!code-aspx[Main](creating-page-layouts-with-view-master-pages-vb/samples/sample3.aspx)]

При запросе представления в списке 3 он отображает страницу на рис. 5. Обратите внимание, что представление отображает страницу с двумя столбцами. Кроме того, обратите внимание, что содержимое на странице содержимого объединяется с содержимым из главной страницы представления.


[![Страница содержимого представления индекса](creating-page-layouts-with-view-master-pages-vb/_static/image14.png)](creating-page-layouts-with-view-master-pages-vb/_static/image13.png)

**На рисунке 05**: индекс, представляющий страница содержимого представления ([Просмотр полноразмерное изображение](creating-page-layouts-with-view-master-pages-vb/_static/image15.png))


### <a name="modifying-view-master-page-content"></a>Изменение главного представления содержимого страницы

Одна проблема возникнет почти немедленно при работе с главными страницами представления заключается проблема, при запросе страницы содержимого в другое представление, изменить содержимое главной страницы представления. Например требуется каждой страницы в веб-приложение для уникальным заголовком. Тем не менее заголовка объявлен на главной странице представления, а не в странице содержимого. Таким образом как настроить заголовок страницы для каждой страницы содержимого представление?

Существует два способа, которые можно изменить заголовок, отображаемый элементом страница содержимого представления. Во-первых, можно назначить заголовок страницы для атрибута title `<%@ page %>` объявление директивы в верхней части страницы содержимого представления. Например если вы хотите назначить представление Index заголовка страницы «Отлично Super веб-сайт», могут включать следующую директиву в верхней части представления индекса.

[!code-aspx[Main](creating-page-layouts-with-view-master-pages-vb/samples/sample4.aspx)]

При представлении индекса подготавливается к просмотру в браузере требуемый заголовок отображается в заголовке окна браузера:


[![Строка заголовка браузера](creating-page-layouts-with-view-master-pages-vb/_static/image17.png)](creating-page-layouts-with-view-master-pages-vb/_static/image16.png)


Имеется одно важное требование, которому должна удовлетворять главной страницы представления в порядке для атрибута title, для работы. Главная страница представления должна содержать `<head runat="server">` тег вместо обычной `<head>` тег для его заголовок. Если `<head>` тег не поддерживает runat = «server» атрибута, то заголовок не будет отображаться. Представление по умолчанию, главной страницы содержит обязательные `<head runat="server">` тег.

Альтернативный подход к изменению содержимого главной страницы на странице содержимого отдельные представления — программы-оболочки для региона, в который требуется внести изменения в `<asp:ContentPlaceHolder>` тег. Например предположим, вы хотите изменить не только название, но мета-теги, подготовки к просмотру в главной страницы представления. Страница главного представления в листинге 4 содержит `<asp:ContentPlaceHolder>` тег в его `<head>` тег.

**Листинг 4. `Views\Shared\Site2.master`**

[!code-aspx[Main](creating-page-layouts-with-view-master-pages-vb/samples/sample5.aspx)]

Обратите внимание, что `<asp:ContentPlaceHolder>` тег в листинге 4 включает в себя содержимое по умолчанию: заголовок по умолчанию и мета-теги по умолчанию. Если не переопределить это `<asp:ContentPlaceHolder>` тег в отдельные представления страницы содержимого, то отображается содержимое по умолчанию.

Страница содержимого представления в листинге 5 переопределяет `<asp:ContentPlaceHolder>` тег, чтобы отобразить пользовательский заголовок и пользовательские мета-теги.

**Листинг 5. `Views\Home\Index2.aspx`**

[!code-aspx[Main](creating-page-layouts-with-view-master-pages-vb/samples/sample6.aspx)]

### <a name="summary"></a>Сводка

Этот учебник предоставлен основные сведения можно просмотреть главные страницы и страницы содержимого. Вы узнали, как создать новое представление, главные страницы и создавать представления страницы содержимого, на их основе. Также мы рассмотрели, как можно изменить содержимое из отдельного представления страницы содержимого главной страницы представления.

> [!div class="step-by-step"]
> [Назад](using-the-tagbuilder-class-to-build-html-helpers-vb.md)
> [Вперед](passing-data-to-view-master-pages-vb.md)
