---
uid: mvc/overview/older-versions-1/views/creating-custom-html-helpers-vb
title: "Создание настраиваемых вспомогательных методов HTML (VB) | Документы Microsoft"
author: microsoft
description: "Целью данного учебника является демонстрация способы создания пользовательских вспомогательных методов HTML, который можно использовать в пределах представлений MVC. Используя преимущества вспомогательный метод HTML..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/07/2008
ms.topic: article
ms.assetid: f96f4800-19ef-44c0-b457-55e777eb5de8
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/views/creating-custom-html-helpers-vb
msc.type: authoredcontent
ms.openlocfilehash: e389a03228995ce0a6926a53af38f26ad51372d5
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="creating-custom-html-helpers-vb"></a>Создание настраиваемых вспомогательных методов HTML (Visual Basic)
====================
по [Microsoft](https://github.com/microsoft)

[Скачать PDF](http://download.microsoft.com/download/1/1/f/11f721aa-d749-4ed7-bb89-a681b68894e6/ASPNET_MVC_Tutorial_9_VB.pdf)

> Целью данного учебника является демонстрация способы создания пользовательских вспомогательных методов HTML, который можно использовать в пределах представлений MVC. Используя преимущества вспомогательных методов HTML, можно уменьшить объем длительного ввода HTML-тегов, которые необходимо выполнить для создания стандартных HTML-страниц.


Целью данного учебника является демонстрация способы создания пользовательских вспомогательных методов HTML, который можно использовать в пределах представлений MVC. Используя преимущества вспомогательных методов HTML, можно уменьшить объем длительного ввода HTML-тегов, которые необходимо выполнить для создания стандартных HTML-страниц.

В первой части этого учебника я опишу некоторые из существующих вспомогательных методов HTML, входящий в состав платформы ASP.NET MVC. Далее описывается создание пользовательских вспомогательных методов HTML два метода: я описаны способы создания пользовательских вспомогательных методов HTML путем создания совместно используемого метода и путем создания метода расширения.

## <a name="understanding-html-helpers"></a>Основные сведения о вспомогательных методов HTML

Вспомогательный метод HTML — просто это метод, который возвращает строку. Строка может представлять любой тип содержимого, которое требуется. Например, можно использовать вспомогательные методы HTML для подготовки к просмотру стандартные теги HTML, например HTML `<input>` и `<img>` тегов. Также можно использовать вспомогательные методы HTML для отображения более сложного содержимого, например полосе вкладок или HTML-таблицы базы данных.

Платформа ASP.NET MVC включает следующий набор стандартных вспомогательные методы HTML (это не полный список):

- Html.ActionLink()
- Html.BeginForm()
- Html.CheckBox()
- Html.DropDownList()
- Html.EndForm()
- Html.Hidden()
- Html.ListBox()
- Html.Password()
- Html.RadioButton()
- Html.TextArea()
- Html.TextBox()

Например рассмотрим форму в листинге 1. Эта форма подготавливается к просмотру с помощью двух стандартных вспомогательные методы HTML (см. рис. 1). В этой форме используются `Html.BeginForm()` и `Html.TextBox()` вспомогательные методы.


[![Страницы к просмотру с помощью вспомогательных методов HTML](creating-custom-html-helpers-vb/_static/image2.png)](creating-custom-html-helpers-vb/_static/image1.png)

**На рисунке 01**: страницы к просмотру с помощью вспомогательных методов HTML ([Просмотр полноразмерное изображение](creating-custom-html-helpers-vb/_static/image3.png))


**Листинг 1.`Views\Home\Index.aspx`**

[!code-aspx[Main](creating-custom-html-helpers-vb/samples/sample1.aspx)]

`Html.BeginForm()` Вспомогательный метод используется для создания HTML-код, открывающий и закрывающий `<form>` тегов. Обратите внимание, что `Html.BeginForm()` метод вызывается с помощью инструкции. Использование инструкции гарантирует, что `<form>` тег закрывается по окончании использования блока.

Если вы предпочитаете, вместо создания с помощью блока, можно вызвать Html.EndForm() вспомогательный метод для закрытия `<form>` тег. Использовать любой способ создания Открытие и закрытие `<form>` тег, который наиболее интуитивно понятно пользователю.

`Html.TextBox()` Вспомогательные методы, используемые для отображения HTML в листинге 1 `<input>` тегов. Если выбрать Просмотр исходного кода в браузере появится в списке 2 источник HTML. Обратите внимание, что источник содержит стандартные теги HTML.

> [!IMPORTANT]
> Обратите внимание, что `Html.TextBox()`-HTML вспомогательный визуализируется с `<%= %>` теги вместо `<% %>` тегов. Если не включить знак равенства, ничего не возвращает выводятся в браузер.

Платформа ASP.NET MVC содержит небольшой набор вспомогательных методов. Скорее всего потребуется расширить платформу MVC с помощью пользовательских вспомогательных методов HTML. В оставшейся части этого учебника вы узнаете два метода создания пользовательских вспомогательных методов HTML.

**Листинг 2.`Index.aspx Source`**

[!code-aspx[Main](creating-custom-html-helpers-vb/samples/sample2.aspx)]

### <a name="creating-html-helpers-with-shared-methods"></a>Создание вспомогательных методов HTML с помощью общих методов

Самый простой способ создать новый вспомогательный метод HTML является создание общий метод, который возвращает строку. Представьте себе, например, вы решили создать новый вспомогательный метод HTML, который отображает HTML- `<label>` тег. Для подготовки к просмотру, можно использовать класс в списке 2 `<label>`.

**Листинг 2.`Helpers\LabelHelper.vb`**

[!code-vb[Main](creating-custom-html-helpers-vb/samples/sample3.vb)]

Нет ничего особенного класса в списке 2. `Label()` Метод просто возвращает строку.

Измененный представление индекса в списке 3 использует `LabelHelper` для отрисовки HTML- `<label>` тегов. Обратите внимание, что представление включает `<%@ imports %>` директиву, которая импортирует пространство имен Application1.Helpers.

**Листинг 2.`Views\Home\Index2.aspx`**

[!code-aspx[Main](creating-custom-html-helpers-vb/samples/sample4.aspx)]

### <a name="creating-html-helpers-with-extension-methods"></a>Создание вспомогательных методов HTML с помощью методов расширения

Если вы хотите создать вспомогательных методов HTML, которые работают так же как стандартные вспомогательных методов HTML, включены в платформе ASP.NET MVC, вам нужно создать методы расширения. Методы расширения позволяют добавлять новые методы в существующий класс. При создании метода вспомогательный метод HTML, можно добавить новые методы `HtmlHelper` класс, представленный свойством представление Html.

Модуль Visual Basic в списке 3 добавляет метод расширения с именем `Label()` для `HtmlHelper` класса. Существует несколько вещей, которые можно заметить об этом модуле. Во-первых, обратите внимание, дополненному модуль `<Extension()>` атрибута. Чтобы использовать этот атрибут, необходимо импортировать `System.Runtime.CompilerServices` пространства имен

Во-вторых, обратите внимание, что первый параметр `Label()` представляет метод `HtmlHelper` класса. Первый параметр метода расширения указывает класс, который расширяет метод расширения.

**Листинг 3.`Helpers\LabelExtensions.vb`**

[!code-vb[Main](creating-custom-html-helpers-vb/samples/sample5.vb)]

После создания метода расширения и построить приложение успешно, метод расширения отображается в Intellisense в Visual Studio как и всех других методов класса (см. рис. 2). Единственное отличие заключается в расширения методы отображаются с символом "специальный" рядом с ними (значок со стрелкой вниз).


[![С помощью метода расширения Html.Label()](creating-custom-html-helpers-vb/_static/image5.png)](creating-custom-html-helpers-vb/_static/image4.png)

**На рисунке 02**: с помощью метода расширения Html.Label() ([Просмотр полноразмерное изображение](creating-custom-html-helpers-vb/_static/image6.png))


Измененный представление Index в листинге 4 этого метод расширения Html.Label() используется для отображения всех его &lt;метка&gt; тегов.

**Листинг 4.`Views\Home\Index3.aspx`**

[!code-aspx[Main](creating-custom-html-helpers-vb/samples/sample6.aspx)]

## <a name="summary"></a>Сводка

В этом учебнике вы узнали два метода создания пользовательских вспомогательных методов HTML. Во-первых, вы узнали, как создать настраиваемый `Label()` вспомогательный метод HTML, путем создания совместно используемого метода, который возвращает строку. Далее вы узнали, как создать настраиваемый `Label()` метод вспомогательный метод HTML, создав метод расширения для `HtmlHelper` класса.

В этом учебнике уделено построение очень простой метод вспомогательный метод HTML. Имейте в виду, что вспомогательный метод HTML может быть не проще требуется. Можно построить вспомогательных методов HTML, отображения сложных элементов, таких как представления в виде дерева, меню и таблицы базы данных.

>[!div class="step-by-step"]
[Назад](asp-net-mvc-views-overview-vb.md)
[Вперед](using-the-tagbuilder-class-to-build-html-helpers-vb.md)
