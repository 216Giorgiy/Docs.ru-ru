---
uid: mvc/overview/advanced/custom-mvc-templates
title: "Шаблон MVC пользовательские | Документы Microsoft"
author: joeloff
description: "Создание шаблона, как расширение VSIX."
ms.author: aspnetcontent
manager: wpickett
ms.date: 12/10/2012
ms.topic: article
ms.assetid: b0a214c7-2f38-4dbc-b47f-bd7bd9df97bd
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/advanced/custom-mvc-templates
msc.type: authoredcontent
ms.openlocfilehash: c3ddd4e341511f520927e924b25d890088adb69e
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2018
---
<a name="custom-mvc-template"></a>Пользовательский шаблон
====================
по [— Жак Элоф](https://github.com/joeloff)

В выпуске обновления средств MVC 3 для Visual Studio 2010 появился в мастере отдельных проектов для проектов MVC. Изменение был определяется двумя факторами. Во-первых внедрение новых шаблонов в MVC 3 и поддержку дополнительного представления ядер, например Razor привести к overcrowding диалоговое окно нового проекта в Visual Studio. Во-вторых клиенты пользователя может возникнуть вопрос для точек расширения, и мастер создания проекта MVC будет увеличение нам возможность ответить на эти запросы.

Добавление настраиваемых шаблонов было достаточно сложный процесс, который полагается на отображение новых шаблонов в мастере проекта MVC путем изменения реестра. Автор шаблона было включите его в MSI-ФАЙЛ, убедитесь, что необходимые записи реестра будет создана во время установки. Вместо этого было сделать ZIP-файл, содержащий шаблон, доступный и позволить конечным пользователем вручную создать необходимые записи реестра.

Ни один из упомянутых выше подходов является идеальным, мы решили использовать некоторые из существующей инфраструктуры, предоставляемый [VSIX](https://msdn.microsoft.com/library/ff363239.aspx) расширения, чтобы упростить автора, распространения и установки пользовательских шаблонов MVC, начиная с MVC 4 для Visual Studio 2012. Ниже приведены некоторые преимущества этого подхода.

- Расширение VSIX может содержать несколько шаблонов, поддержки различных языков (C# и Visual Basic) и несколько обработчиков представлений (ASPX- и Razor).
- Расширение VSIX можно назначить несколько номеров SKU Visual Studio Express SKU включая.
- [Коллекции Visual Studio](https://visualstudiogallery.msdn.microsoft.com/) упрощает распространение расширения для широкой аудитории.
- Можно обновить расширения VSIX, облегчая создание исправлений и обновлений для настраиваемых шаблонов.

## <a name="prerequisites"></a>Предварительные требования

- Пользователи должны быть знакомы с разработки шаблонов проекта, включая разметку, необходимые для vstemplate-файлы и т. д.
- Пользователи должны будут иметь Visual Studio Professional и более позднее. Express SKU не поддерживают создание проекты VSIX.
- [Пакет SDK для Visual Studio 2012](https://www.microsoft.com/download/details.aspx?id=30668) установлен.

## <a name="example"></a>Пример

Первым шагом является создание нового проекта VSIX с помощью C# или Visual Basic. Выберите **файл > Новый проект**, нажмите кнопку **расширяемости** в левой области и выберите **проект VSIX**.

![Создание проекта](custom-mvc-templates/_static/image1.jpg)

После создания проекта будет открыт конструктор VSIX.

![Метаданные конструктора проектов](custom-mvc-templates/_static/image2.jpg)

Конструктор можно использовать для редактирования некоторые общие свойства расширения, которое будет отображаться для пользователей, когда они установить расширение или просмотреть установленные расширения в Visual Studio (**Сервис > расширения и обновления**). После завершения нажмите кнопку Общие сведения на **вкладка цели установки**.

![Целевые объекты установки конструктора проектов](custom-mvc-templates/_static/image3.jpg)

Эта вкладка используется для указания номера SKU и версиях Visual Studio, поддерживаемые расширения. Установите флажок для **этот VSIX-ФАЙЛ устанавливается для всех пользователей** для включения экземпляров на компьютере VSIX. Щелкните **New** кнопку справа, чтобы добавить дополнительные номера SKU такие как Web Developer Express (VWD).

![Добавить новую цель установки](custom-mvc-templates/_static/image4.jpg)

Если планируется поддержка все Professional и более поздних версиях номера SKU (Professional, Premium и Ultimate) необходимо только выбрать минимальный номер SKU семейства, **Microsoft.VisualStudio.Pro**. Не забудьте сохранить все изменения после завершения установки целевых объектов.

![Целевые объекты установки конструктора проектов](custom-mvc-templates/_static/image5.jpg)

**Активы** вкладка используется для добавления всех файлов содержимого в VSIX. Так как MVC требует пользовательские метаданные будут изменять исходные XML-файл манифеста VSIX вместо использования **активы** можно добавлять содержимое. Начните с добавления содержимого шаблона в проект VSIX. Очень важно, что структура папок и содержимого отражает проекта. В приведенном ниже примере содержит четыре шаблонов проектов, которые были получены на основе шаблона проекта Basic MVC. Убедитесь, что все файлы, составляющие шаблон проекта (все элементы, под папка Шаблоны_проекта) добавляются **содержимого** itemgroup в VSIX-ФАЙЛ проекта файл и что каждый элемент содержит  **CopyToOutputDirectory** и **IncludeInVsix** метаданные набора, как показано в следующем примере.

&lt;Content Include=&quot;ProjectTemplates\MyMvcWebApplicationProjectTemplate.csaspx\BasicWeb.config&quot;&gt;

&lt;CopyToOutputDirectory&gt;всегда&lt;/CopyToOutputDirectory&gt;

&lt;IncludeInVSIX&gt;true&lt;/IncludeInVSIX&gt;

&lt;/Content&gt;

В противном случае IDE попытается скомпилировать содержимое шаблона при создании VSIX и скорее всего появится сообщение об ошибке. Файлы кода в шаблонах часто содержат специальные [параметров шаблона](https://msdn.microsoft.com/library/eehb4faa(v=vs.110).aspx) используется в Visual Studio, когда шаблон проекта создается и поэтому не может быть скомпилирован в Интегрированной среде разработки.

![обозреватель решений](custom-mvc-templates/_static/image6.jpg)

Закройте конструктор VSIX, щелкните правой кнопкой мыши **: source.extension.manifest** файла в **обозревателе решений** и выберите **открыть с помощью** и выберите **XML () Редактор текста)** параметр.

![Открыть с помощью диалогового окна](custom-mvc-templates/_static/image7.jpg)

Создание  **&lt;активы&gt;**  элемент и добавьте  **&lt;активов&gt;**  для каждого файла, который необходимо включить в VSIX. **Тип** атрибут каждого  **&lt;активов&gt;**  элемента должно быть присвоено **Microsoft.VisualStudio.Mvc.Template**. Это пользовательского пространства имен, которое понимает только в мастере проекта MVC. Обратитесь к документации схемой VSIX 2.0 Дополнительные сведения о структуре и расположение файла манифеста.

Только добавление файлов VSIX недостаточно для регистрации шаблонов с помощью мастера MVC. Необходимо предоставить сведения, например имя шаблона, описание, обработчиков представлений, поддерживаемых и язык программирования, мастер MVC. Эта информация передается в настраиваемые атрибуты, связанные с  **&lt;активов&gt;**  для каждого элемента **vstemplate** файла.

&lt;Asset d:VsixSubPath=&quot;ProjectTemplates\MyMvcWebApplicationProjectTemplate.csaspx&quot;

Type=&quot;Microsoft.VisualStudio.Mvc.Template&quot;

d:Source=&quot;File&quot;

Path=&quot;ProjectTemplates\MyMvcWebApplicationProjectTemplate.csaspx\BasicMvcWebApplicationProjectTemplate.11.csaspx.vstemplate&quot;

ProjectType=&quot;MVC&quot;

Language=&quot;C#&quot;

ViewEngine=&quot;Aspx&quot;

Идентификатор шаблона =&quot;MyMvcApplication&quot;

Заголовок =&quot;настраиваемое основные веб-приложение&quot;

Описание =&quot;пользовательский шаблон, производным от веб-приложения MVC основные (Razor)&quot;

Версия =&quot;4.0&quot;/&gt;

Ниже приведено описание настраиваемых атрибутов, которые должны быть созданы.

- **ProjectType** должно быть присвоено MVC.
- **Язык** обозначает язык разработки, поддерживаемая шаблоном. Допустимые значения: C# или Visual Basic.
- **ViewEngine** определяет обработчик представлений, поддерживаемая шаблоном, например Aspx или Razor. Можно указать пользовательское значение для этого поля.
- **Идентификатор шаблона** используется для группирования шаблоны. Если значение совпадает с существующим Идентификатором шаблона, он будет переопределяйте ранее зарегистрированный с помощью мастера MVC шаблонов.
- **Заголовок** обозначает краткое описание, отображаемое в мастере под каждый шаблон проекта MVC.
- **Описание** задает более подробное описание шаблона.

После добавления все файлы манифеста и сохранить его, можно будет заметить, что **активы** в конструкторе будут отображаться все файлы, но не пользовательские атрибуты, добавленные в  **&lt;активов&gt;**  элементы для **vstemplate** файлов.

![Ресурсы конструктора проектов](custom-mvc-templates/_static/image8.jpg)

Теперь остается скомпилировать проект VSIX и установить его.

Убедитесь в том, что на компьютере, закрываются все экземпляры Visual Studio которых необходимо проверить расширение VSIX. Visual Studio проверяет наличие новых расширений во время запуска, поэтому если при установке VSIX открыт интегрированной среды разработки необходимо перезапустить Visual Studio. В проводнике дважды щелкните файл VSIX, чтобы запустить **установщик VSIX**, нажмите кнопку **установить** и последующем запуске Visual Studio.

![Установщик VSIX](custom-mvc-templates/_static/image9.jpg)

В меню выберите **Сервис > расширения и обновления** для подтверждения того, что расширение было установлено. Если установщик VSIX выдаются все ошибки во время установки расширения можно просмотреть журнал установщик VSIX для получения дополнительной информации. Обычно журнал создается в **% temp %** папки пользователя, которая установила расширение, например **C:\Users\Bob\AppData\Local\Temp**.

![Расширения и обновления](custom-mvc-templates/_static/image10.jpg)

После закрытия окна можно создать проект MVC 4 в разделе, отображаются ли новых шаблонов в мастере MVC.

![Новый проект ASP.NET MVC 4](custom-mvc-templates/_static/image11.jpg)

## <a name="limitations"></a>Ограничения

1. Мастер MVC не поддерживает локализованные пользовательские шаблоны.
2. Мастер не сообщит все ошибки, если не удается найти настраиваемые шаблоны. Если необходимые настраиваемые атрибуты отсутствуют, шаблон будет просто исключен из мастера.
