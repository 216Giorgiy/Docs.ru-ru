---
uid: mvc/overview/getting-started/database-first-development/enhancing-data-validation
title: "EF базы данных сначала с ASP.NET MVC: упрощает проверку данных | Документы Microsoft"
author: tfitzmac
description: "С помощью MVC, Entity Framework и формирование шаблонов ASP.NET, можно создать веб-приложения, который предоставляет интерфейс для существующей базы данных. Этот учебник seri..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 12/29/2014
ms.topic: article
ms.assetid: 0ed5e67a-34c0-4b57-84a6-802b0fb3cd00
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/getting-started/database-first-development/enhancing-data-validation
msc.type: authoredcontent
ms.openlocfilehash: 465be4b51ab280d0b3e2f4b33362fa771480d5e1
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="ef-database-first-with-aspnet-mvc-enhancing-data-validation"></a>EF базы данных сначала с ASP.NET MVC: упрощает проверку данных
====================
по [Tom FitzMacken](https://github.com/tfitzmac)

> С помощью MVC, Entity Framework и формирование шаблонов ASP.NET, можно создать веб-приложения, который предоставляет интерфейс для существующей базы данных. Этот ряд учебника показано, как автоматически создают код, который дает пользователям возможность отображения, изменения, создания и удаления данных, которые хранятся в таблице базы данных. Созданный код соответствует столбцам в таблице базы данных.
> 
> Эта часть ряда фокусируется на добавление заметок к данным в модели данных, чтобы указать требования к проверке и формат отображения. Она была улучшена на основе отзывов пользователей в разделе "Примечания".


## <a name="add-data-annotations"></a>Добавление заметок к данным

Как было показано ранее раздела, несколько правил проверки данных автоматически применяются на ввод данных пользователем. Например число может предоставить только для свойства уровень. Чтобы указать дополнительные правила проверки данных, можно добавить в класс модели заметок к данным. Эти заметки применяются по всему веб-приложения для указанного свойства. Также можно применить атрибуты форматирования, изменить способ отображения свойств; например изменение значение, используемое для подписи.

В этом учебнике вы добавите заметок к данным для ограничения длины значения, предоставленные для свойства FirstName, MiddleName и LastName. В базе данных эти значения являются более 50 символов; Тем не менее в веб-приложения, ограничение числа символов в настоящее время не применяется. Если пользователь вводит более 50 символов для одного из этих значений, страницы произойдет сбой при попытке сохранить значение в базе данных. Также будет ограничена уровнем значения от 0 до 4.

Откройте **Student.cs** файла в **моделей** папки. Добавьте следующий выделенный код в класс.

[!code-csharp[Main](enhancing-data-validation/samples/sample1.cs?highlight=5,15,17,20)]

В «Enrollment.cs» в качестве добавьте следующий выделенный код.

[!code-csharp[Main](enhancing-data-validation/samples/sample2.cs?highlight=5,10)]

Постройте решение.

Перейдите на страницу по изменению и созданию студент. Если вы пытаетесь ввести более 50 символов, отображается сообщение об ошибке.

![Показать сообщение об ошибке](enhancing-data-validation/_static/image1.png)

Перейти на страницу для редактирования регистраций и пытаться предоставить уровень выше 4.

![Ошибка диапазона уровень](enhancing-data-validation/_static/image2.png)

Полный список проверки заметок к данным можно применять к свойствам и классов см. в разделе [System.ComponentModel.DataAnnotations](https://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.aspx).

## <a name="add-metadata-classes"></a>Добавление классов метаданных

Добавление атрибутов проверки класс модели работает, если предполагается, что база данных для изменения; Тем не менее если изменения базы данных и вам нужно повторно создать класс модели, будут потеряны все атрибуты, которые были применены к классу модели. Этот подход может оказаться очень неэффективным и подвержен потери важных условий.

Чтобы избежать этой проблемы, можно добавить класс метаданных, содержащий атрибуты. При связывании класс модели в класс метаданных, эти атрибуты будут применены к модели. При таком подходе класс модели могут быть повторно созданы без потери всех атрибутов, которые были применены к класса метаданных.

В **моделей** папки, добавьте класс с именем **Metadata.cs**.

![Добавление класса метаданных](enhancing-data-validation/_static/image3.png)

Замените код в Metadata.cs следующим кодом.

[!code-csharp[Main](enhancing-data-validation/samples/sample3.cs)]

Эти классы метаданные содержат все атрибуты проверки, которые ранее был применен к классам модели. **Отображения** атрибута можно изменить значение, используемое для подписи.

Теперь классы модели необходимо связать с классов метаданных.

В **моделей** папки, добавьте класс с именем **PartialClasses.cs**.

Замените содержимое файла следующим кодом.

[!code-csharp[Main](enhancing-data-validation/samples/sample4.cs)]

Обратите внимание, что каждый класс помечен как `partial` класса и каждая совпадает с именем и пространством имен как класс, который создается автоматически. Применение атрибута метаданных в разделяемый класс, убедитесь, что атрибуты проверки данных будет применяться к классу автоматически создается. Эти атрибуты не будут потеряны при повторном классы модели, так как атрибут метаданных применяется в разделяемых классах, которые не восстанавливаются.

Для повторного создания автоматически созданных классов, откройте файл ContosoModel.edmx. Еще раз щелкните правой кнопкой мыши область конструктора и выберите **обновление модели из базы данных**. Несмотря на то, что базы данных не изменились, этот процесс приведет к повторному созданию классов. В **обновление** выберите **таблиц** и **Готово**.

![обновить таблицы](enhancing-data-validation/_static/image4.png)

Сохраните файл ContosoModel.edmx, чтобы применить изменения.

Откройте файл Student.cs или «Enrollment.cs» в качестве и обратите внимание, что ранее примененные атрибуты проверки данных больше не находятся в файле. Тем не менее запустите приложение и обратите внимание, что правила проверки по-прежнему применяются при вводе данных.

>[!div class="step-by-step"]
[Назад](customizing-a-view.md)
[Вперед](publish-to-azure.md)
