---
uid: mvc/overview/getting-started/getting-started-with-ef-using-mvc/advanced-entity-framework-scenarios-for-an-mvc-web-application
title: "Сложные сценарии, Entity Framework 6 5 веб-приложения MVC (12 12) | Документы Microsoft"
author: tdykstra
description: "Contoso университета примера веб-приложения показано, как создавать приложения ASP.NET MVC 5 с помощью Entity Framework 6 Code First и Visual Studio..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 12/08/2014
ms.topic: article
ms.assetid: f35a9b0c-49ef-4cde-b06d-19d1543feb0b
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/getting-started/getting-started-with-ef-using-mvc/advanced-entity-framework-scenarios-for-an-mvc-web-application
msc.type: authoredcontent
ms.openlocfilehash: 85276377671b96e65406639c8584d9ebf8d77ff7
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2018
---
<a name="advanced-entity-framework-6-scenarios-for-an-mvc-5-web-application-12-of-12"></a>Дополнительно Entity Framework 6 сценариев 5 веб-приложения MVC (12 12)
====================
По [Tom Dykstra](https://github.com/tdykstra)

[Загрузка завершенного проекта](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) или [скачать PDF](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)

> Contoso университета примера веб-приложения показано, как создавать приложения ASP.NET MVC 5 с помощью Entity Framework 6 Code First и Visual Studio 2013. Сведения о учебника серии см [в первом учебнике ряда](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).


В предыдущем учебнике реализован таблица на иерархию наследования. Этот учебник включает представлены несколько разделов, которые необходимо иметь в виду при переходе расширенные возможности разработки веб-приложений ASP.NET, использующие Entity Framework Code First. Пошаговые инструкции поможет в коде или с помощью Visual Studio в следующих разделах:

- [Выполняет необработанные запросы SQL](#rawsql)
- [Выполняя запросы отслеживания нет](#notracking)
- [Изучение SQL отправляемые в базу данных](#sql)

Учебник вводит несколько подразделов с вводную следуют ссылки на ресурсы для получения дополнительной информации:

- [Репозиторий и единицы шаблонов рабочих элементов](#repo)
- [Прокси-классы](#proxies)
- [Изменение автоматического обнаружения](#changedetection)
- [Автоматическая проверка](#validation)
- [EF средства для Visual Studio](#tools)
- [Entity Framework исходного кода](#source)

Он также содержит следующие разделы:

- [Сводка](#summary)
- [Подтверждения](#acknowledgments)
- [Примечание об VB](#vb)
- [Распространенные ошибки и решения или обходные пути для них](#errors)

Большинство этих разделов вы будете работать со страницами, которые уже созданы. Для использования необработанных SQL для проведения массовых обновлений вы создадите новую страницу, обновляет номер кредиты всех курсов в базе данных:

![Update_Course_Credits_initial_page](advanced-entity-framework-scenarios-for-an-mvc-web-application/_static/image1.png)

<a id="rawsql"></a>
## <a name="performing-raw-sql-queries"></a>Выполнение запросов Raw SQL

API первый Entity Framework кода включает методы, которые позволяют передавать команды SQL непосредственно к базе данных. Можно выбрать один из следующих параметров.

- Используйте [DbSet.SqlQuery](https://msdn.microsoft.com/library/system.data.entity.dbset.sqlquery.aspx) метод для запросов, возвращающих типы сущностей. Возвращаемые объекты должно относится к типу, ожидаемому `DbSet` объекта и они, автоматически отслеживаются контекстом контекст базы данных, если не отключить отслеживание. (См. в разделе [AsNoTracking](https://msdn.microsoft.com/library/system.data.entity.dbextensions.asnotracking.aspx) метод.)
- Используйте [Database.SqlQuery](https://msdn.microsoft.com/library/system.data.entity.database.sqlquery.aspx) метод для запросов, возвращающих типы, которые не являются сущностями. Возвращаемые данные не отслеживается контекст базы данных, даже при использовании этого метода на получение типов сущностей.
- Используйте [Database.ExecuteSqlCommand](https://msdn.microsoft.com/library/gg679456.aspx) для команды без запроса.

Одним из преимуществ использования платформы Entity Framework является позволяет избежать прерывания кода слишком близко к конкретного метода хранения данных. Это делается путем создания SQL-запросов и команд, который избавляет от необходимости записывать их. Но существует исключительных сценариев, при необходимости выполнения конкретных запросов SQL, созданных вручную, и эти методы позволяют обрабатывать такие исключения.

Как всегда имеет значение true при выполнении команды SQL для веб-приложения, необходимо принять меры предосторожности, чтобы защитить сайт от атак путем внедрения кода SQL. Один из способов сделать это является использование параметризованных запросов, чтобы убедиться в том, что строки, отправленных веб-страницы не может интерпретироваться как команды SQL. В этом учебнике будет использоваться параметризованные запросы при интеграции ввод данных пользователем в запросе.

### <a name="calling-a-query-that-returns-entities"></a>Вызов запроса, которая возвращает сущности

[DbSet&lt;TEntity&gt; ](https://msdn.microsoft.com/library/gg696460.aspx) класс предоставляет метод, который можно использовать для выполнения запроса, возвращающее сущность типа `TEntity`. Чтобы увидеть, как это работает, можно будет изменить код в `Details` метод `Department` контроллера.

В *DepartmentController.cs*в `Details` метод, замените `db.Departments.FindAsync` вызов метода с `db.Departments.SqlQuery` вызова метода, как показано в следующий выделенный код:

[!code-csharp[Main](advanced-entity-framework-scenarios-for-an-mvc-web-application/samples/sample1.cs?highlight=8-14)]

Чтобы убедиться, что новый код работает неправильно, выберите **отделы** tab и затем **сведения** для одного из отделов.

![Сведения об отделе](advanced-entity-framework-scenarios-for-an-mvc-web-application/_static/image2.png)

### <a name="calling-a-query-that-returns-other-types-of-objects"></a>Вызов запроса, которая возвращает другие типы объектов

Ранее вы создали сетку статистики студента страницу о программе показано число учеников для каждой даты регистрации. Код, который делает это в *HomeController.cs* использует LINQ:

[!code-csharp[Main](advanced-entity-framework-scenarios-for-an-mvc-web-application/samples/sample2.cs)]

Предположим, что необходимо написать код, который получает эти данные непосредственно в SQL, а не с помощью LINQ. Чтобы сделать, необходимо запустить запрос, который возвращает нечто, отличное от объектов сущностей, означающее, что необходимо использовать [Database.SqlQuery](https://msdn.microsoft.com/library/system.data.entity.database.sqlquery(v=VS.103).aspx) метод.

В *HomeController.cs*, замените оператор LINQ в `About` метод с инструкцией SQL, как показано в следующий выделенный код:

[!code-csharp[Main](advanced-entity-framework-scenarios-for-an-mvc-web-application/samples/sample3.cs?highlight=3-18)]

Запустите страницу About. Он отображает те же данные, которые раньше.

![About_page](advanced-entity-framework-scenarios-for-an-mvc-web-application/_static/image3.png)

### <a name="calling-an-update-query"></a>Вызов запроса Update

Предположим, что администраторы университета Contoso требуется возможность выполнения массовых изменений в базе данных, например изменение количества кредиты для каждого курса. Если университета имеет большое количество курсов, было бы неэффективно, извлекать их все как сущности и измените их по отдельности. В этом разделе будет реализован веб-страницы, которая позволяет пользователю указать коэффициент, используемый для изменения номера кредиты для всех курсов и вносятся изменения, выполнив SQL `UPDATE` инструкции. Веб-страница будет выглядеть как на следующем рисунке:

![Update_Course_Credits_initial_page](advanced-entity-framework-scenarios-for-an-mvc-web-application/_static/image4.png)

В *CourseContoller.cs*, добавьте `UpdateCourseCredits` методы для `HttpGet` и `HttpPost`:

[!code-csharp[Main](advanced-entity-framework-scenarios-for-an-mvc-web-application/samples/sample4.cs)]

Когда контроллер обрабатывает `HttpGet` запроса, ничего не возвращается в `ViewBag.RowsAffected` переменная и представлении отображаются пустые текстовые поля и кнопку Отправить, как показано на предыдущем рисунке.

Когда **обновление** по нажатию кнопки `HttpPost` вызывается метод, и `multiplier` имеет значение, введенное в текстовом поле. Затем выполняется код SQL, которая обновляет курсы и возвращает количество задействованных строк в представление `ViewBag.RowsAffected` переменной. Когда представление возвращает значение в том, что переменной, он отображает число строк, обновленных вместо текстового поля и отправить кнопки, как показано на следующем рисунке:

![Update_Course_Credits_rows_affected_page](advanced-entity-framework-scenarios-for-an-mvc-web-application/_static/image5.png)

В *CourseController.cs*, щелкните правой кнопкой мыши один из `UpdateCourseCredits` методы, а затем щелкните **добавить представление**.

![Add_View_dialog_box_for_Update_Course_Credits](advanced-entity-framework-scenarios-for-an-mvc-web-application/_static/image6.png)

В *Views\Course\UpdateCourseCredits.cshtml*, замените код шаблона в следующий код:

[!code-cshtml[Main](advanced-entity-framework-scenarios-for-an-mvc-web-application/samples/sample5.cshtml)]

Запустите `UpdateCourseCredits` метод, выбрав **курсы** вкладку, затем добавляется «/ UpdateCourseCredits» в конец URL-адрес в адресной строке браузера (например: `http://localhost:50205/Course/UpdateCourseCredits`). Введите число в текстовом поле:

![Update_Course_Credits_initial_page_with_2_entered](advanced-entity-framework-scenarios-for-an-mvc-web-application/_static/image7.png)

Нажмите кнопку **Обновить**. Количество строк, затронутых просмотреть:

![Update_Course_Credits_rows_affected_page](advanced-entity-framework-scenarios-for-an-mvc-web-application/_static/image8.png)

Нажмите кнопку **списка** для просмотра списка курсов с измененный номер кредиты.

![Courses_Index_page_showing_revised_credits](advanced-entity-framework-scenarios-for-an-mvc-web-application/_static/image9.png)

Дополнительные сведения о необработанных запросов SQL см. в разделе [необработанные запросы SQL](https://msdn.microsoft.com/data/jj592907) на сайте MSDN.

<a id="notracking"></a>
## <a name="no-tracking-queries"></a>Нет отслеживания запросов

Если контекст базы данных получает строки таблицы и создает объекты сущности, представляющие их, по умолчанию он хранит информацию о ли сущностей в памяти синхронизированы с папкой базы данных. Данные в памяти действует как кэш и используется, если вы обновили сущность. Это кэширование необязательно, часто в веб-приложение, так как контекста экземпляров обычно кратковременных (новый один создается и удаляется для каждого запроса), а в контексте, осуществляющий чтение сущности обычно удаляется, прежде чем снова используется этой сущности.

Отслеживание объектов сущностей в памяти можно отключить с помощью [AsNoTracking](https://msdn.microsoft.com/library/gg679352(v=vs.103).aspx) метод. Ниже приведены типичные сценарии, в которых может потребоваться сделать:

- Запрос получает таких больших объемов данных, отключение трассировка может заметно повысить производительность.
- Необходимо присоединить сущности, чтобы обновить его, но ранее полученные той же сущности для другой цели. Поскольку сущность уже отслеживается контекстом базы данных, не удается присоединить сущности, который требуется изменить. Один из способов обработки этой ситуации является использование `AsNoTracking` параметр с приведенный выше запрос.

Пример, демонстрирующий способ использования [AsNoTracking](https://msdn.microsoft.com/library/gg679352(v=vs.103).aspx) метода, в разделе [более ранней версии этого учебника](../../older-versions/getting-started-with-ef-5-using-mvc-4/advanced-entity-framework-scenarios-for-an-mvc-web-application.md). Данной версии учебника не задан флаг изменено на сущности, созданные связыватель модели, в метод Edit, для нее не требуется `AsNoTracking`.

<a id="sql"></a>
## <a name="examining-sql-sent-to-the-database"></a>Изучение SQL отправляемые в базу данных

Иногда бывает полезно иметь возможность просматривать фактические запросы SQL, которые отправляются в базу данных. В более ранних учебника показано, как это сделать в коде перехватчик; Теперь вы увидите несколько способов сделать это без написания кода перехватчик. Чтобы протестировать эту возможность, будет рассмотрим простой запрос и проверьте, что происходит на него при добавлении параметров таких eager загрузки, фильтрации и сортировки.

В *контроллеров или CourseController*, замените `Index` метод следующим кодом, чтобы временно остановить упреждающую:

[!code-csharp[Main](advanced-entity-framework-scenarios-for-an-mvc-web-application/samples/sample6.cs)]

Теперь задать точку останова на `return` инструкции (F9 с курсором, в этой строке). Нажмите клавишу F5 для запуска проекта в режиме отладки и выберите страницу индекса курса. Когда код достигает точки останова, изучите `sql` переменной. Появится запрос, отправленных на SQL Server. Это простой `Select` инструкции.

[!code-json[Main](advanced-entity-framework-scenarios-for-an-mvc-web-application/samples/sample7.json)]

Нажмите кнопку увеличивающимися класс, чтобы просмотреть запрос в **визуализации текста**.

![](advanced-entity-framework-scenarios-for-an-mvc-web-application/_static/image10.png)

Теперь добавим раскрывающегося списка на страницу индекса курсы, чтобы пользователи могут выполнять фильтрацию определенного отдела. Нужно отсортировать курсов по названию, и потребуется указать упреждающую для `Department` свойства навигации.

В *CourseController.cs*, замените `Index` метод следующим кодом:

[!code-csharp[Main](advanced-entity-framework-scenarios-for-an-mvc-web-application/samples/sample8.cs)]

Восстановление точки останова на `return` инструкции.

Метод получает выбранное значение из раскрывающегося списка в `SelectedDepartment` параметра. Если ничего не выделено, этот параметр будет иметь значение null.

Объект `SelectList` передается коллекция, содержащая все отделы в представление для раскрывающегося списка. Параметры, передаваемые `SelectList` конструктор указать значение имени поля, имя текстового поля и выбранного элемента.

Для `Get` метод `Course` репозитория, код задает критерий фильтра, порядок сортировки и загрузка для eager `Department` свойства навигации. Возвращает критерий фильтра всегда `true` Если ничего не выбрано в раскрывающемся списке (то есть `SelectedDepartment` имеет значение null).

В *Views\Course\Index.cshtml*, непосредственно перед открытием `table` , добавьте следующий код для создания раскрывающегося списка и кнопка отправки:

[!code-cshtml[Main](advanced-entity-framework-scenarios-for-an-mvc-web-application/samples/sample9.cshtml)]

Точки останова по-прежнему установить, запустить страницу индекса курса. Выполните первый раз, что код не достигнет точки останова, чтобы отобразить страницу в браузере. Выберите подразделение из раскрывающегося списка и нажмите кнопку **фильтра**:

![Course_Index_page_with_department_selected](advanced-entity-framework-scenarios-for-an-mvc-web-application/_static/image11.png)

Это время первой точки останова будет запроса отделов для раскрывающегося списка. Пропустить и просмотреть `query` переменной очередном код достигает точки останова, чтобы узнать, какие `Course` запроса теперь имеет следующий вид. Вы увидите примерно следующим образом:

[!code-sql[Main](advanced-entity-framework-scenarios-for-an-mvc-web-application/samples/sample10.sql)]

Вы увидите, что запрос теперь является `JOIN` запрос, который загружает `Department` вместе с данными `Course` данных и что он включает `WHERE` предложения.

Удалить `var sql = courses.ToString()` строки.

<a id="repo"></a>

## <a name="repository-and-unit-of-work-patterns"></a>Репозиторий и единицы шаблонов рабочих элементов

Многие разработчики написать код для реализации репозитория и единицы шаблонов рабочих элементов как оболочка для кода, который работает с платформой Entity Framework. Эти шаблоны предназначены для создания уровень абстракции между уровня доступа к данным и бизнес-логики приложения. Реализация этих шаблонов для изоляции приложения от изменений в хранилище данных и может упростить автоматических модульного тестирования или разработки через тестирование (TDD). Тем не менее написать дополнительный код для реализации этих шаблонов не всегда подходит для приложений, использующих EF, по следующим причинам:

- EF контекста класса изолирует кода из кода на конкретных хранилища данных.
- Класс EF контекста может выступать как единица работы класса для базы данных обновляет это сделать с помощью EF.
- Возможности, появившиеся в Entity Framework 6 было проще реализовать TDD без написания кода репозитория.

Дополнительные сведения о реализации репозитория и единицы шаблонов рабочих элементов см. в разделе [версию Entity Framework 5 этого учебника ряда](../../older-versions/getting-started-with-ef-5-using-mvc-4/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application.md). Сведения о способах реализации TDD в Entity Framework 6 см. следующие ресурсы:

- [Как EF6 позволяет Mocking DbSets проще](http://thedatafarm.com/data-access/how-ef6-enables-mocking-dbsets-more-easily/)
- [Тестирование с помощью платформа имитации](https://msdn.microsoft.com/data/dn314429)
- [Тестирование с помощью собственных тестовых дублей](https://msdn.microsoft.com/data/dn314431)

<a id="proxies"></a>
## <a name="proxy-classes"></a>Прокси-классы

Когда платформа Entity Framework создает экземпляры сущности (например, при выполнении запроса), они часто будут созданы как экземпляры динамически создаваемых производного типа, который действует как прокси для сущности. Например см. следующие два образа отладчика. На первом рисунке можно видеть, что `student` переменная является ожидаемым `Student` введите сразу после создания сущности. На втором рисунке после EF используется для чтения сущностей студента из базы данных, вы увидите прокси-класса.

![Перед прокси-класс](advanced-entity-framework-scenarios-for-an-mvc-web-application/_static/image12.png)

![После прокси-класс](advanced-entity-framework-scenarios-for-an-mvc-web-application/_static/image13.png)

Этот класс-посредник переопределяет некоторые виртуальные свойства сущности, которую необходимо вставить обработчики для выполнения действий, автоматически при доступе к этому свойству. Одна функция этот механизм используется для — отложенную загрузку.

В большинстве случаев не требуется учитывать такое использование учетных записей-посредников, однако существуют исключения:

- В некоторых сценариях может потребоваться запретить Entity Framework создавать экземпляры прокси-сервера. Например при сериализации сущностей обычно требуется классов POCO, не прокси-классы. Один из способов избежать проблем при сериализации является сериализовать объекты передачи данных (DTO) вместо объекта сущности, как показано в [с помощью веб-API с Entity Framework](../../../../web-api/overview/data/using-web-api-with-entity-framework/part-1.md) учебника. Другим способом является [отключить создание прокси-сервера](https://msdn.microsoft.com/data/jj592886.aspx).
- При создании экземпляра класса сущностей с помощью `new` оператора, можно не получить экземпляр прокси-сервера. Это означает, что вы не получаете функциональные возможности, например отложенную загрузку и автоматическое отслеживание изменений. Как правило, это хорошо; обычно не требуется отложенную загрузку, поскольку вы создаете новую сущность, которая не находится в базе данных и обычно не требуется отслеживания изменений, если явным образом пометить сущности как `Added`. Тем не менее, если вам нужен отложенную загрузку и требуется отслеживание изменений, можно создать экземпляры этой сущности с прокси-серверов с помощью [создать](https://msdn.microsoft.com/library/gg679504.aspx) метод `DbSet` класса.
- Можно получить фактический тип сущности из прокси-типа. Можно использовать [GetObjectType](https://msdn.microsoft.com/library/system.data.objects.objectcontext.getobjecttype.aspx) метод `ObjectContext` класса, чтобы получить фактический тип сущности экземпляра типа прокси-сервера.

Дополнительные сведения см. в разделе [работа с прокси-серверы](https://msdn.microsoft.com/data/JJ592886.aspx) на сайте MSDN.

<a id="changedetection"></a>
## <a name="automatic-change-detection"></a>Изменение автоматического обнаружения

Платформа Entity Framework определяет изменении сущности (и поэтому обновления, которые необходимо передать в базу данных), путем сравнения значений текущей сущности с исходными значениями. Исходные значения хранятся в том случае, когда сущность запрос или присоединенного. Ниже перечислены некоторые методы, которые вызывают изменение автоматического обнаружения.

- `DbSet.Find`
- `DbSet.Local`
- `DbSet.Remove`
- `DbSet.Add`
- `DbSet.Attach`
- `DbContext.SaveChanges`
- `DbContext.GetValidationErrors`
- `DbContext.Entry`
- `DbChangeTracker.Entries`

Если вы отслеживаете большого числа сущностей и вызовите один из этих методов много раз в цикле, может появиться значительное повышение производительности, временно отключив автоматическое изменение отслеживания с помощью [AutoDetectChangesEnabled](https://msdn.microsoft.com/library/system.data.entity.infrastructure.dbcontextconfiguration.autodetectchangesenabled.aspx) свойство. Дополнительные сведения см. в разделе [автоматическое обнаружение изменения](https://msdn.microsoft.com/data/jj556205) в библиотеке MSDN.

<a id="validation"></a>
## <a name="automatic-validation"></a>Автоматическая проверка

При вызове `SaveChanges` метода по умолчанию платформа Entity Framework проверяет данные в все свойства сущности все измененные перед обновлением базы данных. Если вы обновили большого числа сущностей и вы уже проверены данные, эта работа не требуется и может сделать процесс сохранения изменений требуется меньше времени, временно отключив проверки. Можно сделать при помощи этого [ValidateOnSaveEnabled](https://msdn.microsoft.com/library/system.data.entity.infrastructure.dbcontextconfiguration.validateonsaveenabled.aspx) свойство. Дополнительные сведения см. в разделе [проверки](https://msdn.microsoft.com/data/gg193959) на сайте MSDN.

<a id="tools"></a>
## <a name="entity-framework-power-tools"></a>Entity Framework Power Tools

[Entity Framework Power Tools](https://visualstudiogallery.msdn.microsoft.com/72a60b14-1581-4b9b-89f2-846072eff19d) надстройки Visual Studio, которая использовалась для создания диаграмм моделей данных отображается в этих учебниках. Средства также можно сделать другой функции, такие как создания классов сущностей на основе таблиц в существующую базу данных, чтобы базы данных можно использовать в режиме Code First. После установки этих средств в контекстных меню отображаются некоторые дополнительные параметры. Например, если щелкнуть правой кнопкой мыши класс контекста в **обозревателе решений**, вы получаете возможность создать схему. При использовании Code First нельзя изменить модель данных в схеме, но можно перемещать вещей для облегчения понимания.

![EF в контекстном меню](advanced-entity-framework-scenarios-for-an-mvc-web-application/_static/image14.png)

![Схема EF](advanced-entity-framework-scenarios-for-an-mvc-web-application/_static/image15.png)

<a id="source"></a>
## <a name="entity-framework-source-code"></a>Entity Framework исходного кода

Исходный код для платформы Entity Framework 6 доступен на [GitHub](https://github.com/aspnet/EntityFramework6). Можно регистрировать ошибки и могут способствовать собственные усовершенствования EF исходного кода.

Несмотря на то, что исходный код открыт, Entity Framework полностью поддерживается как продуктов корпорации Майкрософт. Команда Microsoft Entity Framework поддерживает элемент управления, по которому принимаются вклад и проверяет все изменения кода, чтобы обеспечить его качество каждого выпуска.

<a id="summary"></a>
## <a name="summary"></a>Сводка

На этом завершается, серию учебники по использованию платформы Entity Framework в приложении ASP.NET MVC. Дополнительные сведения о работе с данными с помощью платформы Entity Framework см. в разделе [EF страницы документации в библиотеке MSDN](https://msdn.microsoft.com/data/ee712907) и [доступа к данным ASP.NET - рекомендуется использовать ресурсы](../../../../whitepapers/aspnet-data-access-content-map.md).

Дополнительные сведения о развертывании веб-приложения после его построения см. в разделе [ASP.NET веб-развертывание - рекомендуется использовать ресурсы](../../../../whitepapers/aspnet-web-deployment-content-map.md) в библиотеке MSDN.

Сведения о других разделов, связанных с MVC, таких как проверка подлинности и авторизации, в разделе [ASP.NET MVC — рекомендуется использовать ресурсы](../recommended-resources-for-mvc.md).

<a id="acknowledgments"></a>
## <a name="acknowledgments"></a>Подтверждения

- Tom Dykstra написал исходной версии этого учебника, обновление EF 5, выпущенной и написал обновления EF 6. Том является старший программирования записи на веб-платформу Майкрософт и средств разработчиков содержимого.
- [Рик Андерсон](https://blogs.msdn.com/b/rickandy/) (twitter [ @RickAndMSFT ](http://twitter.com/RickAndMSFT)) не большую часть работы, обновление учебника для EF 5 и MVC 4 и обновлением EF 6, выпущенной. Рик имеет старший программный модуль записи для Microsoft Azure и MVC.
- [Роуэном Миллер](http://www.romiller.com) и другими членами команды Entity Framework вспомогательная с проверками кода и помогли многих проблемах отладки со миграций, возникших во время мы обновляли учебника для EF 5 и EF 6.

<a id="vb"></a>
## <a name="vb"></a>VB

Когда учебника была разработана EF 4.1, мы предоставляем версии C# и VB завершения загрузки проекта. Из-за ограничения времени и другие приоритеты мы еще не, для этой версии. При построении проекта Visual Basic, с помощью этих учебников и возможно, захотят данным совместного использования с другими пользователями, сообщите нам об этом.

<a id="errors"></a>
## <a name="common-errors-and-solutions-or-workarounds-for-them"></a>Распространенные ошибки и решения или обходные пути для них

### <a name="cannot-createshadow-copy"></a>Не удается создать теневую копию

Сообщение об ошибке:

> Не удается создать теневую копию "&lt;filename&gt;" Когда этот файл уже существует.


Решение

Подождите несколько секунд и обновите страницу.

### <a name="update-database-not-recognized"></a>Update-Database не распознан

Сообщение об ошибке (из `Update-Database` в PMC):

> Термин «Update-Database» не распознан как имя командлета, функции, файла скрипта или действующей программы. Проверьте правильность написания имени, а если включен путь, проверьте правильность пути и повторите попытку.


Решение

Выйдите из Visual Studio. Откройте проект и повторите попытку.

### <a name="validation-failed"></a>Сбой проверки

Сообщение об ошибке (из `Update-Database` в PMC):

> Не удалось проверить одну или несколько сущностей. См. Дополнительные сведения о свойстве «EntityValidationErrors».


Решение

Одной из причин этой ошибки является ошибки проверки при `Seed` метода. В разделе [заполнения и отладка Entity Framework (EF) БД](https://blogs.msdn.com/b/rickandy/archive/2013/02/12/seeding-and-debugging-entity-framework-ef-dbs.aspx) советы по отладке `Seed` метод.

### <a name="http-50019-error"></a>HTTP 500.19 ошибки

Сообщение об ошибке:

> Ошибка HTTP 500.19 — Внутренняя ошибка сервера  
> Запрашиваемая страница не доступна из-за неверной конфигурации данных для страницы.


Решение

Эта ошибка может возникнуть в том из с несколькими копиями решение, каждый из них используют тот же номер порта. Обычно эти проблемы можно устранить, выход из всех экземпляров Visual Studio, а затем перезагрузить проект, над которым вы работаете. Если это не поможет, попробуйте изменить номер порта. Щелкните правой кнопкой мыши файл проекта и выберите пункт Свойства. Выберите **Web** вкладку и измените номер порта в **URL-адрес проекта** текстовое поле.

### <a name="error-locating-sql-server-instance"></a>Ошибка поиску экземпляра SQL Server

Сообщение об ошибке:

> Связанные с сетью или с определенным экземпляром ошибка при установлении соединения с SQL Server. Сервер не найден или недоступен. Проверьте правильность имени экземпляра и настройку сервера SQL Server для удаленных подключений. (поставщик: сетевые интерфейсы SQL, ошибка: 26: ошибка поиске указанного сервера/экземпляра)


Решение

Проверьте строку подключения. Если удаленные базы данных вручную, измените имя базы данных в строке построения.

>[!div class="step-by-step"]
[Назад](implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application.md)
