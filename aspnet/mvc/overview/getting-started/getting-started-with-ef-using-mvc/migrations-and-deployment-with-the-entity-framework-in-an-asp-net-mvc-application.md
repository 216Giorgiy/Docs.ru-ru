---
uid: mvc/overview/getting-started/getting-started-with-ef-using-mvc/migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application
title: "Сначала код миграция и развертывание с платформой Entity Framework в приложении ASP.NET MVC | Документы Microsoft"
author: tdykstra
description: "Contoso университета примера веб-приложения показано, как создавать приложения ASP.NET MVC 5 с помощью Entity Framework 6 Code First и Visual Studio..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 11/07/2014
ms.topic: article
ms.assetid: d4dfc435-bda6-4621-9762-9ba270f8de4e
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/getting-started/getting-started-with-ef-using-mvc/migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application
msc.type: authoredcontent
ms.openlocfilehash: 2294f2aba3f765d7849d1f407e85f424dc8b2518
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="code-first-migrations-and-deployment-with-the-entity-framework-in-an-aspnet-mvc-application"></a><span data-ttu-id="ab876-103">Сначала код миграция и развертывание с платформой Entity Framework в приложении ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="ab876-103">Code First Migrations and Deployment with the Entity Framework in an ASP.NET MVC Application</span></span>
====================
<span data-ttu-id="ab876-104">По [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="ab876-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="ab876-105">[Загрузка завершенного проекта](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) или [скачать PDF](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span><span class="sxs-lookup"><span data-stu-id="ab876-105">[Download Completed Project](http://code.msdn.microsoft.com/ASPNET-MVC-Application-b01a9fe8) or [Download PDF](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20Entity%20Framework%206%20Code%20First%20using%20MVC%205.pdf)</span></span>

> <span data-ttu-id="ab876-106">Contoso университета примера веб-приложения показано, как создавать приложения ASP.NET MVC 5 с помощью Entity Framework 6 Code First и Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="ab876-106">The Contoso University sample web application demonstrates how to create ASP.NET MVC 5 applications using the Entity Framework 6 Code First and Visual Studio 2013.</span></span> <span data-ttu-id="ab876-107">Сведения о учебника серии см [в первом учебнике ряда](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span><span class="sxs-lookup"><span data-stu-id="ab876-107">For information about the tutorial series, see [the first tutorial in the series](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md).</span></span>

<span data-ttu-id="ab876-108">Пока приложение работает локально в IIS Express на компьютере разработчика.</span><span class="sxs-lookup"><span data-stu-id="ab876-108">So far the application has been running locally in IIS Express on your development computer.</span></span> <span data-ttu-id="ab876-109">Чтобы сделать доступными для других пользователей в Интернете в реальном приложении, необходимо развернуть его на веб-поставщик услуг размещения.</span><span class="sxs-lookup"><span data-stu-id="ab876-109">To make a real application available for other people to use over the Internet, you have to deploy it to a web hosting provider.</span></span> <span data-ttu-id="ab876-110">В этом учебнике вы развернете приложение Contoso университета в облаке в Azure.</span><span class="sxs-lookup"><span data-stu-id="ab876-110">In this tutorial, you'll deploy the Contoso University application to the cloud in Azure.</span></span>

<span data-ttu-id="ab876-111">Учебник содержит следующие разделы:</span><span class="sxs-lookup"><span data-stu-id="ab876-111">The tutorial contains the following sections:</span></span>

- <span data-ttu-id="ab876-112">Включите Code First Migrations.</span><span class="sxs-lookup"><span data-stu-id="ab876-112">Enable Code First Migrations.</span></span> <span data-ttu-id="ab876-113">Функция миграции позволяет изменить модель данных и развертывания изменений в рабочей среде путем обновления схемы базы данных без необходимости удаления и повторного создания базы данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-113">The Migrations feature enables you to change the data model and deploy your changes to production by updating the database schema without having to drop and re-create the database.</span></span>
- <span data-ttu-id="ab876-114">Развертывание в Azure.</span><span class="sxs-lookup"><span data-stu-id="ab876-114">Deploy to Azure.</span></span> <span data-ttu-id="ab876-115">Этот шаг является необязательным. оставшихся учебниках можно будет продолжить без развернут проект.</span><span class="sxs-lookup"><span data-stu-id="ab876-115">This step is optional; you can continue with the remaining tutorials without having deployed the project.</span></span>

<span data-ttu-id="ab876-116">Рекомендуется использовать процесс непрерывной интеграции с системой управления версиями для развертывания, что этот учебник не охватывает разделы.</span><span class="sxs-lookup"><span data-stu-id="ab876-116">We recommend that you use a continuous integration process with source control for deployment, but this tutorial does not cover those topics.</span></span> <span data-ttu-id="ab876-117">Дополнительные сведения см. в разделе [система управления версиями](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/source-control) и [непрерывной интеграции](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/continuous-integration-and-continuous-delivery) главах [Создание реальных облачных приложений с Azure](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/introduction) электронных книг.</span><span class="sxs-lookup"><span data-stu-id="ab876-117">For more information, see the [source control](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/source-control) and [continuous integration](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/continuous-integration-and-continuous-delivery) chapters of the [Building Real-World Cloud Apps with Azure](xref:aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/introduction) e-book.</span></span>

## <a name="enable-code-first-migrations"></a><span data-ttu-id="ab876-118">Включить Code First Migrations</span><span class="sxs-lookup"><span data-stu-id="ab876-118">Enable Code First Migrations</span></span>

<span data-ttu-id="ab876-119">При разработке нового приложения модель данных меняется часто и каждый раз изменения модели, она возвращает синхронизации с базой данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-119">When you develop a new application, your data model changes frequently, and each time the model changes, it gets out of sync with the database.</span></span> <span data-ttu-id="ab876-120">Вы настроили для автоматического удаления и повторного создания базы данных каждый раз при изменении модели данных Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="ab876-120">You have configured the Entity Framework to automatically drop and re-create the database each time you change the data model.</span></span> <span data-ttu-id="ab876-121">При добавлении, удалить, или изменить классы сущностей или изменить ваш `DbContext` класса, при очередном запуске приложения автоматически удаляет существующей базы данных, создает новый, который соответствует модели и заполняет его с тестовыми данными.</span><span class="sxs-lookup"><span data-stu-id="ab876-121">When you add, remove, or change entity classes or change your `DbContext` class, the next time you run the application it automatically deletes your existing database, creates a new one that matches the model, and seeds it with test data.</span></span>

<span data-ttu-id="ab876-122">Синхронизация базы данных с моделью данных, этот метод работает хорошо, пока развертывание приложения в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="ab876-122">This method of keeping the database in sync with the data model works well until you deploy the application to production.</span></span> <span data-ttu-id="ab876-123">Когда приложение выполняется в производственной среде, он обычно хранит данные, которые требуется сохранить, и вы не хотите потерять все, что каждый раз при внесении изменения, такие как добавление нового столбца.</span><span class="sxs-lookup"><span data-stu-id="ab876-123">When the application is running in production, it is usually storing data that you want to keep, and you don't want to lose everything each time you make a change such as adding a new column.</span></span> <span data-ttu-id="ab876-124">[Code First Migrations](https://msdn.microsoft.com/data/jj591621) функция решает эту проблему, позволяя Code First обновить схему базы данных вместо удаления и повторного создания базы данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-124">The [Code First Migrations](https://msdn.microsoft.com/data/jj591621) feature solves this problem by enabling Code First to update the database schema instead of dropping and re-creating the database.</span></span> <span data-ttu-id="ab876-125">В этом учебнике вы развернете приложение, и для подготовки, вы будете включить миграцию.</span><span class="sxs-lookup"><span data-stu-id="ab876-125">In this tutorial, you'll deploy the application, and to prepare for that you'll enable Migrations.</span></span>

1. <span data-ttu-id="ab876-126">Отключить инициализатор, настроенные ранее, скрыв или удалив `contexts` элемент, добавленный в файл Web.config приложения.</span><span class="sxs-lookup"><span data-stu-id="ab876-126">Disable the initializer that you set up earlier by commenting out or deleting the `contexts` element that you added to the application Web.config file.</span></span>

    [!code-xml[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample1.xml?highlight=2,6)]
2. <span data-ttu-id="ab876-127">Также в приложении *Web.config* файл, измените имя базы данных в строке соединения на ContosoUniversity2.</span><span class="sxs-lookup"><span data-stu-id="ab876-127">Also in the application *Web.config* file, change the name of the database in the connection string to ContosoUniversity2.</span></span>

    [!code-xml[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample2.xml?highlight=2)]

    <span data-ttu-id="ab876-128">Это изменение настраивает проект, чтобы первый миграции создает новую базу данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-128">This change sets up the project so that the first migration will create a new database.</span></span> <span data-ttu-id="ab876-129">Это необязательно, но вы увидите Далее почему он имеет смысл.</span><span class="sxs-lookup"><span data-stu-id="ab876-129">This isn't required but you'll see later why it's a good idea.</span></span>
3. <span data-ttu-id="ab876-130">Из **средства** меню, нажмите кнопку **диспетчер пакетов библиотеки** и затем **консоль диспетчера пакетов**.</span><span class="sxs-lookup"><span data-stu-id="ab876-130">From the **Tools** menu, click **Library Package Manager** and then **Package Manager Console**.</span></span>

    ![Selecting_Package_Manager_Console](https://asp.net/media/4336350/1pm.png)
4. <span data-ttu-id="ab876-132">В `PM>` строке введите следующие команды:</span><span class="sxs-lookup"><span data-stu-id="ab876-132">At the `PM>` prompt enter the following commands:</span></span>

    `enable-migrations`  
    `add-migration InitialCreate`

    ![команду Enable-migrations](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image1.png)

    <span data-ttu-id="ab876-134">`enable-migrations` Команда создает *миграций* папки в проект ContosoUniversity и помещает в этой папке *Configuration.cs* файл, который можно изменять для настройки миграции.</span><span class="sxs-lookup"><span data-stu-id="ab876-134">The `enable-migrations` command creates a *Migrations* folder in the ContosoUniversity project, and it puts in that folder a *Configuration.cs* file that you can edit to configure Migrations.</span></span>

    <span data-ttu-id="ab876-135">(Если вы пропустили в предыдущем шаге, направляющее можно изменить имя базы данных, миграция будет найти существующую базу данных и автоматически `add-migration` команды.</span><span class="sxs-lookup"><span data-stu-id="ab876-135">(If you missed the step above that directs you to change the database name, Migrations will find the existing database and automatically do the `add-migration` command.</span></span> <span data-ttu-id="ab876-136">Это нормально, он просто означает, что тестирования кода миграции не запускается перед развертыванием базы данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-136">That's OK, it just means you won't run a test of the migrations code before you deploy the database.</span></span> <span data-ttu-id="ab876-137">Позже при запуске `update-database` команды, ничего не произойдет, так как база данных уже будет существовать.)</span><span class="sxs-lookup"><span data-stu-id="ab876-137">Later when you run the `update-database` command nothing will happen because the database will already exist.)</span></span>

    ![Миграция папки](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image2.png)

    <span data-ttu-id="ab876-139">Инициализатор класса, который вы видели ранее, такие как `Configuration` класс включает `Seed` метод.</span><span class="sxs-lookup"><span data-stu-id="ab876-139">Like the initializer class that you saw earlier, the `Configuration` class includes a `Seed` method.</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample3.cs)]

    <span data-ttu-id="ab876-140">Назначение [начальное значение](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) проще позволяют вставлять или обновлять данные теста, после Code First создает или обновляет базу данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-140">The purpose of the [Seed](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) method is to enable you to insert or update test data after Code First creates or updates the database.</span></span> <span data-ttu-id="ab876-141">Метод вызывается при создании базы данных, и каждый раз при обновлении схемы базы данных после изменения модели данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-141">The method is called when the database is created and every time the database schema is updated after a data model change.</span></span>

### <a name="set-up-the-seed-method"></a><span data-ttu-id="ab876-142">Настройка Seed-метод</span><span class="sxs-lookup"><span data-stu-id="ab876-142">Set up the Seed Method</span></span>

<span data-ttu-id="ab876-143">При удалении и повторного создания базы данных при каждом изменении модели данных, используется класс инициализатора `Seed` для вставки проверочных данных, так как база данных уничтожается после каждого изменения модели и проверочных данных будут потеряны.</span><span class="sxs-lookup"><span data-stu-id="ab876-143">When you are dropping and re-creating the database for every data model change, you use the initializer class's `Seed` method to insert test data, because after every model change the database is dropped and all the test data is lost.</span></span> <span data-ttu-id="ab876-144">Code First Migrations, тестирования, данные сохраняются после изменения базы данных, поэтому включив тестовых данных в [начальное значение](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) метод обычно не требуется.</span><span class="sxs-lookup"><span data-stu-id="ab876-144">With Code First Migrations, test data is retained after database changes, so including test data in the [Seed](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) method is typically not necessary.</span></span> <span data-ttu-id="ab876-145">На самом деле вы не хотите `Seed` для вставки тестовых данных, если вы будете использовать миграции для развертывания базы данных в рабочей среде, так как `Seed` метод будет выполняться в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="ab876-145">In fact, you don't want the `Seed` method to insert test data if you'll be using Migrations to deploy the database to production, because the `Seed` method will run in production.</span></span> <span data-ttu-id="ab876-146">В этом случае требуется `Seed` для вставки в базу данных только те данные, необходимые в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="ab876-146">In that case you want the `Seed` method to insert into the database only the data that you need in production.</span></span> <span data-ttu-id="ab876-147">Например, может потребоваться базы данных, для включения отдел фактические имена в `Department` таблицы, когда приложение становится доступной в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="ab876-147">For example, you might want the database to include actual department names in the `Department` table when the application becomes available in production.</span></span>

<span data-ttu-id="ab876-148">В этом учебнике вы будете использовать миграции для развертывания, а `Seed` метод все равно вставит тестовых данных позволит лучше понять, как работает функциональных возможностей приложения без необходимости вставлять большой объем данных вручную.</span><span class="sxs-lookup"><span data-stu-id="ab876-148">For this tutorial, you'll be using Migrations for deployment, but your `Seed` method will insert test data anyway in order to make it easier to see how application functionality works without having to manually insert a lot of data.</span></span>

1. <span data-ttu-id="ab876-149">Замените содержимое *Configuration.cs* файл следующий код, который будет загружать данные теста в базе данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-149">Replace the contents of the *Configuration.cs* file with the following code, which will load test data into the new database.</span></span> 

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample4.cs)]

    <span data-ttu-id="ab876-150">[Начальное значение](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) метод принимает объекта контекста базы данных в качестве входного параметра и кода в методе использует этот объект для добавления новых сущностей в базу данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-150">The [Seed](https://msdn.microsoft.com/library/hh829453(v=vs.103).aspx) method takes the database context object as an input parameter, and the code in the method uses that object to add new entities to the database.</span></span> <span data-ttu-id="ab876-151">Для каждого типа сущности, код создает коллекцию новых сущностей, добавляет их в соответствующую [DbSet](https://msdn.microsoft.com/library/system.data.entity.dbset(v=vs.103).aspx) свойства, а затем сохраняет изменения в базе данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-151">For each entity type, the code creates a collection of new entities, adds them to the appropriate [DbSet](https://msdn.microsoft.com/library/system.data.entity.dbset(v=vs.103).aspx) property, and then saves the changes to the database.</span></span> <span data-ttu-id="ab876-152">Нет необходимости вызывать [SaveChanges](https://msdn.microsoft.com/library/system.data.entity.dbcontext.savechanges(v=VS.103).aspx) метод после каждой группы сущностей, как показано здесь, но это поможет найти источник проблемы, если исключение возникает, когда код производит запись в базу данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-152">It isn't necessary to call the [SaveChanges](https://msdn.microsoft.com/library/system.data.entity.dbcontext.savechanges(v=VS.103).aspx) method after each group of entities, as is done here, but doing that helps you locate the source of a problem if an exception occurs while the code is writing to the database.</span></span>

    <span data-ttu-id="ab876-153">Некоторые операторы, которые вставляют данные с помощью [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) метод для выполнения операции «вставки-обновления».</span><span class="sxs-lookup"><span data-stu-id="ab876-153">Some of the statements that insert data use the [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) method to perform an "upsert" operation.</span></span> <span data-ttu-id="ab876-154">Поскольку `Seed` метод выполняется каждый раз при выполнении `update-database` команды, обычно после каждой миграции нельзя просто вставить данные, так как вы пытаетесь добавить строки уже существует после первой миграции, который создает базу данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-154">Because the `Seed` method runs every time you execute the `update-database` command, typically after each migration, you can't just insert data, because the rows you are trying to add will already be there after the first migration that creates the database.</span></span> <span data-ttu-id="ab876-155">Операция «вставки-обновления» позволяет избежать ошибок, произойдет при попытке вставить строку, которая уже существует, но он ***переопределяет*** любые изменения данных, внесенные во время тестирования приложения.</span><span class="sxs-lookup"><span data-stu-id="ab876-155">The "upsert" operation prevents errors that would happen if you try to insert a row that already exists, but it ***overrides*** any changes to data that you may have made while testing the application.</span></span> <span data-ttu-id="ab876-156">С тестовыми данными в некоторых таблицах не имеет смысла, происходит: в некоторых случаях при изменении данных во время тестирования требуется изменения после обновления базы данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-156">With test data in some tables you might not want that to happen: in some cases when you change data while testing you want your changes to remain after database updates.</span></span> <span data-ttu-id="ab876-157">В этом случае необходимо выполнить операцию вставки условного: вставьте строку только в том случае, если он еще не существует.</span><span class="sxs-lookup"><span data-stu-id="ab876-157">In that case you want to do a conditional insert operation: insert a row only if it doesn't already exist.</span></span> <span data-ttu-id="ab876-158">Seed-метод использует оба подхода.</span><span class="sxs-lookup"><span data-stu-id="ab876-158">The Seed method uses both approaches.</span></span>

    <span data-ttu-id="ab876-159">Первый параметр, передаваемый [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) метод задает свойство, используемое для проверки, если строки уже существует.</span><span class="sxs-lookup"><span data-stu-id="ab876-159">The first parameter passed to the [AddOrUpdate](https://msdn.microsoft.com/library/system.data.entity.migrations.idbsetextensions.addorupdate(v=vs.103).aspx) method specifies the property to use to check if a row already exists.</span></span> <span data-ttu-id="ab876-160">Для тестовых данных студентов, которому предоставляется `LastName` свойство может использоваться для этой цели, так как каждый последнее имя в списке является уникальным:</span><span class="sxs-lookup"><span data-stu-id="ab876-160">For the test student data that you are providing, the `LastName` property can be used for this purpose since each last name in the list is unique:</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample5.cs)]

    <span data-ttu-id="ab876-161">Данный код предполагает, что последний имена являются уникальными.</span><span class="sxs-lookup"><span data-stu-id="ab876-161">This code assumes that last names are unique.</span></span> <span data-ttu-id="ab876-162">Если вручную добавить студента с повторяющимся именем последней, вы получите следующее исключение при последующем выполнении миграции.</span><span class="sxs-lookup"><span data-stu-id="ab876-162">If you manually add a student with a duplicate last name, you'll get the following exception the next time you perform a migration.</span></span>

    <span data-ttu-id="ab876-163">Последовательность содержит более одного элемента</span><span class="sxs-lookup"><span data-stu-id="ab876-163">Sequence contains more than one element</span></span>

    <span data-ttu-id="ab876-164">Сведения об обработке избыточных данных, например двух учащихся с именем «Александр Carson» см. в разделе [заполнения и отладка Entity Framework (EF) БД](https://blogs.msdn.com/b/rickandy/archive/2013/02/12/seeding-and-debugging-entity-framework-ef-dbs.aspx) в блоге Рика Андерсона.</span><span class="sxs-lookup"><span data-stu-id="ab876-164">For information about how to handle redundant data such as two students named "Alexander Carson", see [Seeding and Debugging Entity Framework (EF) DBs](https://blogs.msdn.com/b/rickandy/archive/2013/02/12/seeding-and-debugging-entity-framework-ef-dbs.aspx) on Rick Anderson's blog.</span></span> <span data-ttu-id="ab876-165">Дополнительные сведения о `AddOrUpdate` метода, в разделе [Будьте внимательны с EF 4.3 AddOrUpdate метод](http://thedatafarm.com/blog/data-access/take-care-with-ef-4-3-addorupdate-method/) в блоге Джули Лерман.</span><span class="sxs-lookup"><span data-stu-id="ab876-165">For more information about the `AddOrUpdate` method, see [Take care with EF 4.3 AddOrUpdate Method](http://thedatafarm.com/blog/data-access/take-care-with-ef-4-3-addorupdate-method/) on Julie Lerman's blog.</span></span>

    <span data-ttu-id="ab876-166">Код, который создает `Enrollment` сущностей предполагается, что имеется `ID` значение в сущностях в `students` коллекции, несмотря на то, что этого свойства не задана в коде, который создает коллекцию.</span><span class="sxs-lookup"><span data-stu-id="ab876-166">The code that creates `Enrollment` entities assumes you have the `ID` value in the entities in the `students` collection, although you didn't set that property in the code that creates the collection.</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample6.cs?highlight=2)]

    <span data-ttu-id="ab876-167">Можно использовать `ID` свойство здесь так как `ID` значение при вызове `SaveChanges` для `students` коллекции.</span><span class="sxs-lookup"><span data-stu-id="ab876-167">You can use the `ID` property here because the `ID` value is set when you call `SaveChanges` for the `students` collection.</span></span> <span data-ttu-id="ab876-168">EF автоматически получает значение первичного ключа, если он вставляет сущность в базе данных, и обновляет `ID` свойство сущности в памяти.</span><span class="sxs-lookup"><span data-stu-id="ab876-168">EF automatically gets the primary key value when it inserts an entity into the database, and it updates the `ID` property of the entity in memory.</span></span>

    <span data-ttu-id="ab876-169">Код, который добавляет каждый `Enrollment` сущность `Enrollments` набор сущностей не использует `AddOrUpdate` метод.</span><span class="sxs-lookup"><span data-stu-id="ab876-169">The code that adds each `Enrollment` entity to the `Enrollments` entity set doesn't use the `AddOrUpdate` method.</span></span> <span data-ttu-id="ab876-170">Проверяется, если сущность уже существует и вставляет сущность, если он не существует.</span><span class="sxs-lookup"><span data-stu-id="ab876-170">It checks if an entity already exists and inserts the entity if it doesn't exist.</span></span> <span data-ttu-id="ab876-171">Этот подход сохранит изменения, внесенные уровень регистрации с помощью пользовательского интерфейса приложения.</span><span class="sxs-lookup"><span data-stu-id="ab876-171">This approach will preserve changes you make to an enrollment grade by using the application UI.</span></span> <span data-ttu-id="ab876-172">Код выполняет цикл через каждый член `Enrollment` [список](https://msdn.microsoft.com/library/6sh2ey19.aspx) и если регистрации не найден в базе данных, он добавляет регистрацию в базу данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-172">The code loops through each member of the `Enrollment`[List](https://msdn.microsoft.com/library/6sh2ey19.aspx) and if the enrollment is not found in the database, it adds the enrollment to the database.</span></span> <span data-ttu-id="ab876-173">При первом обновлении базы данных, база данных будет пустым, он добавляет каждый регистрации.</span><span class="sxs-lookup"><span data-stu-id="ab876-173">The first time you update the database, the database will be empty, so it will add each enrollment.</span></span>

    [!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample7.cs)]
2. <span data-ttu-id="ab876-174">Выполните построение проекта.</span><span class="sxs-lookup"><span data-stu-id="ab876-174">Build the project.</span></span>

### <a name="execute-the-first-migration"></a><span data-ttu-id="ab876-175">Выполнение первой миграции</span><span class="sxs-lookup"><span data-stu-id="ab876-175">Execute the First Migration</span></span>

<span data-ttu-id="ab876-176">При выполнении `add-migration` команды миграции создается код, который может создать базу данных с нуля.</span><span class="sxs-lookup"><span data-stu-id="ab876-176">When you executed the `add-migration` command, Migrations generated the code that would create the database from scratch.</span></span> <span data-ttu-id="ab876-177">Этот код также можно найти в *миграций* папки в файл с именем  *&lt;timestamp&gt;\_InitialCreate.cs*.</span><span class="sxs-lookup"><span data-stu-id="ab876-177">This code is also in the *Migrations* folder, in the file named *&lt;timestamp&gt;\_InitialCreate.cs*.</span></span> <span data-ttu-id="ab876-178">`Up` Метод `InitialCreate` класс создает таблицы базы данных, которые соответствуют наборов сущностей модели данных, и `Down` метод удаляет их.</span><span class="sxs-lookup"><span data-stu-id="ab876-178">The `Up` method of the `InitialCreate` class creates the database tables that correspond to the data model entity sets, and the `Down` method deletes them.</span></span>

[!code-csharp[Main](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample8.cs)]

<span data-ttu-id="ab876-179">Миграция вызовы `Up` метод для реализации изменений модели данных для миграции.</span><span class="sxs-lookup"><span data-stu-id="ab876-179">Migrations calls the `Up` method to implement the data model changes for a migration.</span></span> <span data-ttu-id="ab876-180">При вводе команды для отката обновления, вызывает миграции `Down` метод.</span><span class="sxs-lookup"><span data-stu-id="ab876-180">When you enter a command to roll back the update, Migrations calls the `Down` method.</span></span>

<span data-ttu-id="ab876-181">Это первоначальной миграции, который был создан при вводе `add-migration InitialCreate` команды.</span><span class="sxs-lookup"><span data-stu-id="ab876-181">This is the initial migration that was created when you entered the `add-migration InitialCreate` command.</span></span> <span data-ttu-id="ab876-182">Параметр (`InitialCreate` в примере) используется для файла имя и может принимать любые необходимые; обычно выбрать слово или фразу, в которой говорится, что выполняется в процессе переноса.</span><span class="sxs-lookup"><span data-stu-id="ab876-182">The parameter (`InitialCreate` in the example) is used for the file name and can be whatever you want; you typically choose a word or phrase that summarizes what is being done in the migration.</span></span> <span data-ttu-id="ab876-183">Например, можно назвать последующей миграции &quot;AddDepartmentTable&quot;.</span><span class="sxs-lookup"><span data-stu-id="ab876-183">For example, you might name a later migration &quot;AddDepartmentTable&quot;.</span></span>

<span data-ttu-id="ab876-184">При создании первоначальной миграции базы данных уже существует, создается код создания базы данных, но он не должен выполняться, так как база данных, уже соответствует модели данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-184">If you created the initial migration when the database already exists, the database creation code is generated but it doesn't have to run because the database already matches the data model.</span></span> <span data-ttu-id="ab876-185">При развертывании приложения в другую среду, где базы данных не существует, однако, этот код будет выполняться Создание базы данных, поэтому рекомендуется сначала протестировать.</span><span class="sxs-lookup"><span data-stu-id="ab876-185">When you deploy the app to another environment where the database doesn't exist yet, this code will run to create your database, so it's a good idea to test it first.</span></span> <span data-ttu-id="ab876-186">Вот почему было изменено имя базы данных в более ранней версии — строку подключения, чтобы миграции можно создать новую с нуля.</span><span class="sxs-lookup"><span data-stu-id="ab876-186">That's why you changed the name of the database in the connection string earlier -- so that migrations can create a new one from scratch.</span></span>

1. <span data-ttu-id="ab876-187">В **консоль диспетчера пакетов** окно, введите следующую команду:</span><span class="sxs-lookup"><span data-stu-id="ab876-187">In the **Package Manager Console** window, enter the following command:</span></span>

    `update-database`

    ![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image3.png)

    <span data-ttu-id="ab876-188">`update-database` Выполняется команда `Up` метод для создания базы данных, а затем выполняется `Seed` метод для заполнения базы данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-188">The `update-database` command runs the `Up` method to create the database and then it runs the `Seed` method to populate the database.</span></span> <span data-ttu-id="ab876-189">Тот же процесс запускается автоматически в рабочей среде после развертывания приложения, как можно будет увидеть в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="ab876-189">The same process will run automatically in production after you deploy the application, as you'll see in the following section.</span></span>
- <span data-ttu-id="ab876-190">Используйте **обозревателя серверов** для проверки базы данных как в первом руководстве и запустите приложение, чтобы убедиться, что все данные по-прежнему работает так же, как и раньше.</span><span class="sxs-lookup"><span data-stu-id="ab876-190">Use **Server Explorer** to inspect the database as you did in the first tutorial, and run the application to verify that everything still works the same as before.</span></span>

## <a name="deploy-to-azure"></a><span data-ttu-id="ab876-191">Развертывание в Azure</span><span class="sxs-lookup"><span data-stu-id="ab876-191">Deploy to Azure</span></span>

<span data-ttu-id="ab876-192">Пока приложение работает локально в IIS Express на компьютере разработчика.</span><span class="sxs-lookup"><span data-stu-id="ab876-192">So far the application has been running locally in IIS Express on your development computer.</span></span> <span data-ttu-id="ab876-193">Чтобы сделать его доступным для других пользователей в Интернете, необходимо развернуть его на веб-поставщик услуг размещения.</span><span class="sxs-lookup"><span data-stu-id="ab876-193">To make it available for other people to use over the Internet, you have to deploy it to a web hosting provider.</span></span> <span data-ttu-id="ab876-194">В этом разделе учебника будет развернуть в Azure.</span><span class="sxs-lookup"><span data-stu-id="ab876-194">In this section of the tutorial you'll deploy it to Azure.</span></span> <span data-ttu-id="ab876-195">Этот раздел является необязательным. можно пропустить и продолжить в этом руководстве, или вы можете адаптировать инструкции в этом разделе для другого поставщика услуг размещения по своему усмотрению.</span><span class="sxs-lookup"><span data-stu-id="ab876-195">This section is optional; you can skip this and continue with the following tutorial, or you can adapt the instructions in this section for a different hosting provider of your choice.</span></span>

### <a name="using-code-first-migrations-to-deploy-the-database"></a><span data-ttu-id="ab876-196">С помощью Code First Migrations развертывание базы данных</span><span class="sxs-lookup"><span data-stu-id="ab876-196">Using Code First Migrations to Deploy the Database</span></span>

<span data-ttu-id="ab876-197">Для развертывания базы данных потребуется использовать Code First Migrations.</span><span class="sxs-lookup"><span data-stu-id="ab876-197">To deploy the database you'll use Code First Migrations.</span></span> <span data-ttu-id="ab876-198">При создании профиля публикации, который используется для настройки параметров для развертывания из Visual Studio будет предложено выбрать флажок **обновление базы данных**.</span><span class="sxs-lookup"><span data-stu-id="ab876-198">When you create the publish profile that you use to configure settings for deploying from Visual Studio, you'll select a check box labeled **Update Database**.</span></span> <span data-ttu-id="ab876-199">Этот параметр задан, то процесс развертывания, чтобы автоматически настроить приложение *Web.config* файлов на целевом сервере, чтобы Code First использует `MigrateDatabaseToLatestVersion` класс инициализатора.</span><span class="sxs-lookup"><span data-stu-id="ab876-199">This setting causes the deployment process to automatically configure the application *Web.config* file on the destination server so that Code First uses the `MigrateDatabaseToLatestVersion` initializer class.</span></span>

<span data-ttu-id="ab876-200">Visual Studio не выполняет никаких действий с базой данных во время развертывания, пока она копирует проекта на сервере назначения.</span><span class="sxs-lookup"><span data-stu-id="ab876-200">Visual Studio doesn't do anything with the database during the deployment process while it is copying your project to the destination server.</span></span> <span data-ttu-id="ab876-201">При запуске развернутого приложения и обращается к базе данных в первый раз после развертывания, Code First проверяет, если база данных, соответствует модели данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-201">When you run the deployed application and it accesses the database for the first time after deployment, Code First checks if the database matches the data model.</span></span> <span data-ttu-id="ab876-202">В случае несоответствия Code First автоматически создает базу данных (если он еще не существует) или обновляет схему базы данных до последней версии (если база данных существует, но не соответствует модели).</span><span class="sxs-lookup"><span data-stu-id="ab876-202">If there's a mismatch, Code First automatically creates the database (if it doesn't exist yet) or updates the database schema to the latest version (if a database exists but doesn't match the model).</span></span> <span data-ttu-id="ab876-203">Если приложение поддерживает миграцию `Seed` метода, метод выполняется, после создания базы данных или обновления схемы.</span><span class="sxs-lookup"><span data-stu-id="ab876-203">If the application implements a Migrations `Seed` method, the method runs after the database is created or the schema is updated.</span></span>

<span data-ttu-id="ab876-204">Миграции `Seed` метод вставляет данные теста.</span><span class="sxs-lookup"><span data-stu-id="ab876-204">Your Migrations `Seed` method inserts test data.</span></span> <span data-ttu-id="ab876-205">При развертывании в рабочей среде, необходимо изменить `Seed` метода, так что он вставляет только те данные, необходимые для вставки в рабочей базы данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-205">If you were deploying to a production environment, you would have to change the `Seed` method so that it only inserts data that you want to be inserted into your production database.</span></span> <span data-ttu-id="ab876-206">Например в текущей модели данных можно иметь реальные курсов, но вымышленной студентов в базе данных разработки.</span><span class="sxs-lookup"><span data-stu-id="ab876-206">For example, in your current data model you might want to have real courses but fictional students in the development database.</span></span> <span data-ttu-id="ab876-207">Можно написать `Seed` метод для загрузки в разработке и закомментируйте вымышленной учащихся перед развертыванием в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="ab876-207">You can write a `Seed` method to load both in development, and then comment out the fictional students before you deploy to production.</span></span> <span data-ttu-id="ab876-208">Или можно написать `Seed` для загрузки только курсы и вводить вымышленные студентов в тестовую базу данных вручную с помощью пользовательского интерфейса приложения.</span><span class="sxs-lookup"><span data-stu-id="ab876-208">Or you can write a `Seed` method to load only courses, and enter the fictional students in the test database manually by using the application's UI.</span></span>

### <a name="get-an-azure-account"></a><span data-ttu-id="ab876-209">Получить учетную запись Azure</span><span class="sxs-lookup"><span data-stu-id="ab876-209">Get an Azure account</span></span>

<span data-ttu-id="ab876-210">Вам потребуется учетная запись Azure.</span><span class="sxs-lookup"><span data-stu-id="ab876-210">You'll need an Azure account.</span></span> <span data-ttu-id="ab876-211">Если у вас его еще нет, но у вас есть подписка Visual Studio, вы можете [активация преимуществ подписки](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/).</span><span class="sxs-lookup"><span data-stu-id="ab876-211">If you don't already have one, but you do have a Visual Studio subscription, you can [activate your subscription benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/).</span></span> <span data-ttu-id="ab876-212">В противном случае можно создать бесплатную пробную учетную запись всего за несколько минут.</span><span class="sxs-lookup"><span data-stu-id="ab876-212">Otherwise, you can create a free trial account in just a couple of minutes.</span></span> <span data-ttu-id="ab876-213">Дополнительные сведения см. в разделе [бесплатная пробная версия](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="ab876-213">For details, see [Azure Free Trial](https://azure.microsoft.com/free/).</span></span>

### <a name="create-a-web-site-and-a-sql-database-in-azure"></a><span data-ttu-id="ab876-214">Создание веб-сайта и базы данных SQL в Azure</span><span class="sxs-lookup"><span data-stu-id="ab876-214">Create a web site and a SQL database in Azure</span></span>

<span data-ttu-id="ab876-215">Веб-приложения в Azure будет выполняться в общей среде размещения, это означает, что он работает на виртуальных машинах (ВМ), которые являются общими с другими клиентами Azure.</span><span class="sxs-lookup"><span data-stu-id="ab876-215">Your web app in Azure will run in a shared hosting environment, which means it runs on virtual machines (VMs) that are shared with other Azure clients.</span></span> <span data-ttu-id="ab876-216">Способ недорогих в общей среде размещения приступить к работе в облаке.</span><span class="sxs-lookup"><span data-stu-id="ab876-216">A shared hosting environment is a low-cost way to get started in the cloud.</span></span> <span data-ttu-id="ab876-217">Более поздней версии увеличивается веб-трафика, удовлетворяющее потребностям, запустив на выделенных виртуальных машин можно масштабировать приложение.</span><span class="sxs-lookup"><span data-stu-id="ab876-217">Later, if your web traffic increases, the application can scale to meet the need by running on dedicated VMs.</span></span> <span data-ttu-id="ab876-218">Дополнительные сведения о ценах параметры для службы приложений Azure, ознакомьтесь с документацией по [документации Azure](https://azure.microsoft.com/pricing/details/app-service/)</span><span class="sxs-lookup"><span data-stu-id="ab876-218">To learn more about Pricing Options for Azure App Service, read the documentation on [Azure Docs](https://azure.microsoft.com/pricing/details/app-service/)</span></span>

<span data-ttu-id="ab876-219">Используется для развертывания базы данных в базе данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="ab876-219">You'll deploy the database to Azure SQL Database.</span></span> <span data-ttu-id="ab876-220">База данных SQL является службой реляционных баз данных на основе облака, основанное на технологии SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ab876-220">SQL Database is a cloud-based relational database service that is built on SQL Server technologies.</span></span> <span data-ttu-id="ab876-221">Средств и приложений, работающих с SQL Server также работают с базой данных SQL.</span><span class="sxs-lookup"><span data-stu-id="ab876-221">Tools and applications that work with SQL Server also work with SQL Database.</span></span>

1. <span data-ttu-id="ab876-222">В [портала управления Azure](https://portal.azure.com), нажмите кнопку **New** на левой вкладке нажмите кнопку **все** в Новая колонка, а затем выберите **веб-приложения и SQL** в **Web** разделе и в конечном счете **создать**.</span><span class="sxs-lookup"><span data-stu-id="ab876-222">In the [Azure Management Portal](https://portal.azure.com), click **New** in the left tab, click **See all** in new blade, and then click **Web App & SQL** in the **Web** Section and finally **Create**.</span></span>

    ![Новая кнопка на портале управления](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/CreateWeb-Sql.png)

 <span data-ttu-id="ab876-224">**Новое веб-приложение и SQL - создание** откроется мастер.</span><span class="sxs-lookup"><span data-stu-id="ab876-224">The **New Web App & SQL - Create** wizard opens.</span></span>

2. <span data-ttu-id="ab876-225">В колонке, введите строку в **имя приложения** поле для использования в качестве уникальный URL-адрес для вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="ab876-225">In the blade, enter a string in the **App name** box to use as the unique URL for your application.</span></span> <span data-ttu-id="ab876-226">Полный URL-адрес будет состоять из, вводимая здесь плюс домена по умолчанию службы приложений Azure (. azurewebsites.net).</span><span class="sxs-lookup"><span data-stu-id="ab876-226">The complete URL will consist of what you enter here plus the default domain of Azure App Services (.azurewebsites.net).</span></span> <span data-ttu-id="ab876-227">Если **имя приложения** уже выполнены, мастер сообщит об этом красной *имя приложения Недоступно* сообщения.</span><span class="sxs-lookup"><span data-stu-id="ab876-227">If the **App name** is already taken, the Wizard will notify you of this with a red *The app name is not available* message.</span></span> <span data-ttu-id="ab876-228">Если **имя приложения** — доступны, вы получите Зеленый флажок.</span><span class="sxs-lookup"><span data-stu-id="ab876-228">If the **App name** is available, you will get a green checkmark.</span></span>

    ![Создать ссылку на базу данных на портале управления](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Create-WebApp.png)

3. <span data-ttu-id="ab876-230">В **подписки** раскрывающийся список, выберите подписку Azure, в котором нужно **службы приложений** должна находиться.</span><span class="sxs-lookup"><span data-stu-id="ab876-230">In the **Subscription** Dropdown, please choose the Azure Subscription in which you want the **App Service** to reside.</span></span>

4. <span data-ttu-id="ab876-231">В **группы ресурсов** текстовое поле, выберите группу ресурсов или создайте новую.</span><span class="sxs-lookup"><span data-stu-id="ab876-231">In the **Resource Group** text box, choose a Resource Group or create a new one.</span></span> <span data-ttu-id="ab876-232">Этот параметр указывает каком веб-сайте будет выполняться в центре обработки данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-232">This setting specifies which data center your web site will run in.</span></span> <span data-ttu-id="ab876-233">Дополнительные сведения о группах ресурсов ознакомиться с документацией по [Azure Docs](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview#resource-groups).</span><span class="sxs-lookup"><span data-stu-id="ab876-233">For more information about Resource Groups, read the documentation on [Azure Docs](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview#resource-groups).</span></span>
5. <span data-ttu-id="ab876-234">Создайте новый **план обслуживания приложений** , щелкнув *раздела службы приложений*, **создать новый**и заполните **план служб приложений** (может быть совпадает с именем Служба приложений), **расположение**, и **Ценовая категория** (отсутствует свободное параметр).</span><span class="sxs-lookup"><span data-stu-id="ab876-234">Create a new **App Service Plan** by clicking the *App Service section*, **Create New**, and fill in **App Service plan** (can be same name as App Service), **Location**, and **Pricing tier** (there is a free option).</span></span>

    ![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Create-AppService.png)
6. <span data-ttu-id="ab876-235">Нажмите кнопку **базы данных SQL**и выберите *создать* или выберите существующую базу данных</span><span class="sxs-lookup"><span data-stu-id="ab876-235">Click the **SQL Database**, and choose *Create New* or select an existing database</span></span>

    ![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Create-Database.png)

7. <span data-ttu-id="ab876-236">В **имя** введите имя для базы данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-236">In the **Name** box, enter a name for your database.</span></span>
8. <span data-ttu-id="ab876-237">Нажмите кнопку **целевой сервер** выберите **Создание нового сервера**.</span><span class="sxs-lookup"><span data-stu-id="ab876-237">Click the **Target Server** box, select **Create a new server**.</span></span> <span data-ttu-id="ab876-238">Кроме того Если вы ранее был создан сервер, этот сервер можно выбрать из списка доступных серверов.</span><span class="sxs-lookup"><span data-stu-id="ab876-238">Alternatively, if you previously created a server, you can select that server from list of available servers.</span></span>
9. <span data-ttu-id="ab876-239">Выберите **Ценовая категория** выберите *Free*.</span><span class="sxs-lookup"><span data-stu-id="ab876-239">Choose **Pricing tier** section, choose *Free*.</span></span> <span data-ttu-id="ab876-240">Если требуются дополнительные ресурсы, базу данных можно масштабировать в сторону в любой момент.</span><span class="sxs-lookup"><span data-stu-id="ab876-240">If additional resources are needed, the database can be scaled up at any time.</span></span> <span data-ttu-id="ab876-241">Дополнительные сведения о ценах для SQL Azure, ознакомьтесь с документацией по [Azure Docs](https://azure.microsoft.com/pricing/details/sql-database/).</span><span class="sxs-lookup"><span data-stu-id="ab876-241">To learn more on Azure SQL Pricing, read the documentation on [Azure Docs](https://azure.microsoft.com/pricing/details/sql-database/).</span></span>
10. <span data-ttu-id="ab876-242">Изменить [сортировки](https://docs.microsoft.com/sql/relational-databases/collations/collation-and-unicode-support) при необходимости.</span><span class="sxs-lookup"><span data-stu-id="ab876-242">Modify [collation](https://docs.microsoft.com/sql/relational-databases/collations/collation-and-unicode-support) as needed.</span></span>
11. <span data-ttu-id="ab876-243">Введите администратор **пользователя с правами администратора SQL** и **пароль администратора SQL**.</span><span class="sxs-lookup"><span data-stu-id="ab876-243">Enter an administrator **SQL Admin Username** and **SQL Admin Password**.</span></span> <span data-ttu-id="ab876-244">Если вы выбрали **новой базы данных SQL server**, не введя существующий имя и пароль для этой учетной записи, вводите новое имя и пароль, который вы определяете теперь для последующего использования при доступе к базе данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-244">If you selected **New SQL Database server**, you aren't entering an existing name and password here, you're entering a new name and password that you're defining now to use later when you access the database.</span></span> <span data-ttu-id="ab876-245">Если был выбран сервер, который вы создали ранее, будет введите учетные данные для этого сервера.</span><span class="sxs-lookup"><span data-stu-id="ab876-245">If you selected a server that you created previously, you'll enter credentials for that server.</span></span>
12. <span data-ttu-id="ab876-246">Можно включить сбор данных телеметрии для приложения службы с помощью Application Insights.</span><span class="sxs-lookup"><span data-stu-id="ab876-246">Telemetry collection can be enabled for App Service using Application Insights.</span></span> <span data-ttu-id="ab876-247">Application Insights с прямым конфигурации собирает ценные события, исключения, зависимостей, запроса и сведения о трассировке.</span><span class="sxs-lookup"><span data-stu-id="ab876-247">Application Insights with little configuration collects valuable event, exception, dependency, request, and trace information.</span></span> <span data-ttu-id="ab876-248">Чтобы узнать больше об Application Insights, Приступая к работе с [Azure Docs](https://azure.microsoft.com/services/application-insights/).</span><span class="sxs-lookup"><span data-stu-id="ab876-248">To learn more about Application Insights, get started in [Azure Docs](https://azure.microsoft.com/services/application-insights/).</span></span>
12. <span data-ttu-id="ab876-249">Нажмите кнопку **создать** в нижней части колонки для указания, что по завершении вы сможете.</span><span class="sxs-lookup"><span data-stu-id="ab876-249">Click **Create** at the bottom of the blade to indicate that you're finished.</span></span>
  
 <span data-ttu-id="ab876-250">На портале управления возвращается на страницу панели мониторинга и **уведомления** показывает колонки в верхней части страницы создания сайта.</span><span class="sxs-lookup"><span data-stu-id="ab876-250">The Management Portal returns to the Dashboards page, and the **Notifications** blade at the top of the page shows that the site is being created.</span></span> <span data-ttu-id="ab876-251">Через некоторое время (обычно меньше, чем через минуту) будет уведомление об успешном завершении развертывания.</span><span class="sxs-lookup"><span data-stu-id="ab876-251">After a while (typically less than a minute), there will be a notification that the Deployment succeeded.</span></span> <span data-ttu-id="ab876-252">На панели навигации слева новый **службы приложений** отображается в *службы приложений* раздел и новых **базы данных SQL** отображается в *баз данных SQL*  раздел.</span><span class="sxs-lookup"><span data-stu-id="ab876-252">In the navigation bar at the left, the new **App Service** appears in the *App Services* section and the new **SQL Database** appears in the *SQL Databases* section.</span></span>

### <a name="deploy-the-application-to-azure"></a><span data-ttu-id="ab876-253">Развертывание приложения в Azure</span><span class="sxs-lookup"><span data-stu-id="ab876-253">Deploy the application to Azure</span></span>

1. <span data-ttu-id="ab876-254">В Visual Studio щелкните правой кнопкой мыши проект в **обозревателе решений** и выберите **публикации** в контекстном меню.</span><span class="sxs-lookup"><span data-stu-id="ab876-254">In Visual Studio, right-click the project in **Solution Explorer** and select **Publish** from the context menu.</span></span>
  
    ![Публикация в контекстном меню проекта](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image10.png)
2. <span data-ttu-id="ab876-256">В **профиль** вкладке **веб-публикация** мастера, нажмите кнопку **службу приложений Microsoft Azure**.</span><span class="sxs-lookup"><span data-stu-id="ab876-256">In the **Profile** tab of the **Publish Web** wizard, click **Microsoft Azure App Service**.</span></span>
  
    ![Параметры импорта публикации](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-ChooseTarget.png)
3. <span data-ttu-id="ab876-258">Если вы не добавили ранее подписки Azure в Visual Studio, выполните действия на экране.</span><span class="sxs-lookup"><span data-stu-id="ab876-258">If you have not previously added your Azure subscription in Visual Studio, perform the steps on the screen.</span></span> <span data-ttu-id="ab876-259">При этом будет включен в Visual Studio для подключения к подписке Azure таким образом, список **службы приложений** будет содержать веб-сайте.</span><span class="sxs-lookup"><span data-stu-id="ab876-259">These steps enable Visual Studio to connect to your Azure subscription so that the list of **App Services** will include your web site.</span></span>
 
4. <span data-ttu-id="ab876-260">Выберите **подписки** вы добавили службы приложений, затем **план служб приложений** папку приложения службы является частью, и, наконец, **службы приложений** сам следуют **ОК**.</span><span class="sxs-lookup"><span data-stu-id="ab876-260">Select the **Subscription** you added the App Service to, then the **App Service Plan** folder your App Service is a part of, and finally the **App Service** itself followed by **Ok**.</span></span>

    ![Выберите службы приложений](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-AppService.png)
5. <span data-ttu-id="ab876-262">После настройки профиля **подключения** отображаются вкладки.</span><span class="sxs-lookup"><span data-stu-id="ab876-262">After the Profile has been configured, the **Connection** tab will be shown.</span></span> <span data-ttu-id="ab876-263">Нажмите кнопку **проверить подключение** чтобы убедиться в правильности настроек</span><span class="sxs-lookup"><span data-stu-id="ab876-263">Click **Validate Connection** to make sure that the settings are correct</span></span>

    ![Проверка подключения](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Connection.png)
7. <span data-ttu-id="ab876-265">После проверки подключения отображается рядом с зеленой галочкой **проверить подключение** кнопки.</span><span class="sxs-lookup"><span data-stu-id="ab876-265">When the connection has been validated, a green check mark is shown next to the **Validate Connection** button.</span></span> <span data-ttu-id="ab876-266">Нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="ab876-266">Click **Next**.</span></span>
  
    ![Успешно проверенные соединения](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-SettingsValidated.png)
8. <span data-ttu-id="ab876-268">Откройте **строку подключения к удаленному** раскрывающегося списка в разделе **SchoolContext** и выберите строку подключения для базы данных, вы создали.</span><span class="sxs-lookup"><span data-stu-id="ab876-268">Open the **Remote connection string** drop-down list under **SchoolContext** and select the connection string for the database you created.</span></span>
9. <span data-ttu-id="ab876-269">Выберите **обновление базы данных**.</span><span class="sxs-lookup"><span data-stu-id="ab876-269">Select **Update database**.</span></span>

    ![Вкладка "Параметры"](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Settings.png)

    <span data-ttu-id="ab876-271">Этот параметр задан, то процесс развертывания, чтобы автоматически настроить приложение *Web.config* файлов на целевом сервере, чтобы Code First использует `MigrateDatabaseToLatestVersion` класс инициализатора.</span><span class="sxs-lookup"><span data-stu-id="ab876-271">This setting causes the deployment process to automatically configure the application *Web.config* file on the destination server so that Code First uses the `MigrateDatabaseToLatestVersion` initializer class.</span></span>
10. <span data-ttu-id="ab876-272">Нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="ab876-272">Click **Next**.</span></span>
11. <span data-ttu-id="ab876-273">В **предварительного просмотра** щелкните **начать просмотр**.</span><span class="sxs-lookup"><span data-stu-id="ab876-273">In the **Preview** tab, click **Start Preview**.</span></span>
  
    ![StartPreview кнопки на вкладке «Предварительный просмотр»](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Preview.png)
  
 <span data-ttu-id="ab876-275">Вкладка отображает список файлов, которые будут скопированы на сервер.</span><span class="sxs-lookup"><span data-stu-id="ab876-275">The tab displays a list of the files that will be copied to the server.</span></span> <span data-ttu-id="ab876-276">Предварительного просмотра не требуется для публикации приложения, но полезна функция следует учитывать.</span><span class="sxs-lookup"><span data-stu-id="ab876-276">Displaying the preview isn't required to publish the application but is a useful function to be aware of.</span></span> <span data-ttu-id="ab876-277">В этом случае не нужно выполнять никаких действий со списком файлов, который отображается.</span><span class="sxs-lookup"><span data-stu-id="ab876-277">In this case, you don't need to do anything with the list of files that is displayed.</span></span> <span data-ttu-id="ab876-278">При последующем развертывании этого приложения в этом списке будут только измененные файлы.</span><span class="sxs-lookup"><span data-stu-id="ab876-278">The next time you deploy this application, only the files that have changed will be in this list.</span></span>
    <span data-ttu-id="ab876-279">![Выходной файл StartPreview](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-PreviewLoaded.png)</span><span class="sxs-lookup"><span data-stu-id="ab876-279">![StartPreview file output](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-PreviewLoaded.png)</span></span>

12. <span data-ttu-id="ab876-280">Нажмите кнопку **Опубликовать**.</span><span class="sxs-lookup"><span data-stu-id="ab876-280">Click **Publish**.</span></span>
 <span data-ttu-id="ab876-281">Visual Studio начинает процесс копирования файлов на сервере Azure.</span><span class="sxs-lookup"><span data-stu-id="ab876-281">Visual Studio begins the process of copying the files to the Azure server.</span></span>
13. <span data-ttu-id="ab876-282">**Вывода** окно показывает выполненные действия развертывания и сообщает успешного завершения развертывания.</span><span class="sxs-lookup"><span data-stu-id="ab876-282">The **Output** window shows what deployment actions were taken and reports successful completion of the deployment.</span></span>
  
    ![Успешное развертывание модуля создания отчетов в окне вывода](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-BuildOutput.png)
14. <span data-ttu-id="ab876-284">После успешного развертывания браузер по умолчанию автоматически открывается на URL-адрес развернутой веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="ab876-284">Upon successful deployment, the default browser automatically opens to the URL of the deployed web site.</span></span>
 <span data-ttu-id="ab876-285">Созданное приложение теперь работает в облаке.</span><span class="sxs-lookup"><span data-stu-id="ab876-285">The application you created is now running in the cloud.</span></span> 
  
    ![Students_index_page_with_paging](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Publish-Site.png)

<span data-ttu-id="ab876-287">На этом этапе вашей *SchoolContext* база данных создана в базе данных SQL Azure, так как вы выбрали **выполнять миграции Code First (запускается при запуске приложения)**.</span><span class="sxs-lookup"><span data-stu-id="ab876-287">At this point your *SchoolContext* database has been created in the Azure SQL Database because you selected **Execute Code First Migrations (runs on app start)**.</span></span> <span data-ttu-id="ab876-288">*Web.config* файл развернутого веб-сайте был изменен, чтобы [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) инициализатора запускается в первый раз, код считывает или записывает данные в базе данных (которая возникала При выборе **учащихся** вкладка):</span><span class="sxs-lookup"><span data-stu-id="ab876-288">The *Web.config* file in the deployed web site has been changed so that the [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) initializer runs the first time your code reads or writes data in the database (which happened when you selected the **Students** tab):</span></span>

![](https://asp.net/media/4367421/mig.png)

<span data-ttu-id="ab876-289">Процесс развертывания также создается новая строка подключения *(SchoolContext\_DatabasePublish*) для миграции Code First для обновления схемы базы данных и заполнения базы данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-289">The deployment process also created a new connection string *(SchoolContext\_DatabasePublish*) for Code First Migrations to use for updating the database schema and seeding the database.</span></span>

![Строка подключения Database_Publish](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image26.png)

<span data-ttu-id="ab876-291">Можно найти в файл Web.config на локальном компьютере в развернутой версии *ContosoUniversity\obj\Release\Package\PackageTmp\Web.config*. Доступ к развернутой *Web.config* самом файле по протоколу FTP.</span><span class="sxs-lookup"><span data-stu-id="ab876-291">You can find the deployed version of the Web.config file on your own computer in *ContosoUniversity\obj\Release\Package\PackageTmp\Web.config*. You can access the deployed *Web.config* file itself by using FTP.</span></span> <span data-ttu-id="ab876-292">Инструкции см. в разделе [ASP.NET веб-развертывания с помощью Visual Studio: развертывание обновления кода](xref:web-forms/overview/deployment/visual-studio-web-deployment/deploying-a-code-update).</span><span class="sxs-lookup"><span data-stu-id="ab876-292">For instructions, see [ASP.NET Web Deployment using Visual Studio: Deploying a Code Update](xref:web-forms/overview/deployment/visual-studio-web-deployment/deploying-a-code-update).</span></span> <span data-ttu-id="ab876-293">Следуйте инструкциям, которые начинаются с «Чтобы использовать средство FTP, необходимы три вещи: URL-адрес FTP, имя пользователя и пароль.»</span><span class="sxs-lookup"><span data-stu-id="ab876-293">Follow the instructions that start with "To use an FTP tool, you need three things: the FTP URL, the user name, and the password."</span></span>

> [!NOTE]
> <span data-ttu-id="ab876-294">Веб-приложение не реализует безопасности, поэтому любой пользователь находит URL-адрес можно изменить данные.</span><span class="sxs-lookup"><span data-stu-id="ab876-294">The web app doesn't implement security, so anyone who finds the URL can change the data.</span></span> <span data-ttu-id="ab876-295">Инструкции по защите веб-сайта см. в разделе [развернуть приложение безопасного ASP.NET MVC с членством, OAuth и базы данных SQL на Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data).</span><span class="sxs-lookup"><span data-stu-id="ab876-295">For instructions on how to secure the web site, see [Deploy a Secure ASP.NET MVC app with Membership, OAuth, and SQL Database to Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data).</span></span> <span data-ttu-id="ab876-296">Отключать других пользователей, с помощью сайта с помощью портала управления Azure или **обозревателя серверов** в Visual Studio, чтобы остановить сайт.</span><span class="sxs-lookup"><span data-stu-id="ab876-296">You can prevent other people from using the site by using the Azure Management Portal or **Server Explorer** in Visual Studio to stop the site.</span></span>


![](migrations-and-deployment-with-the-entity-framework-in-an-asp-net-mvc-application/_static/Stop-Service.png)

## <a name="advanced-migrations-scenarios"></a><span data-ttu-id="ab876-297">Сценарии миграции для дополнительных</span><span class="sxs-lookup"><span data-stu-id="ab876-297">Advanced Migrations Scenarios</span></span>

<span data-ttu-id="ab876-298">Если развертывание базы данных, выполнив миграцию автоматически, как показано в этом учебнике, и развертываются на веб-сайт, который выполняется на нескольких серверах, можно получить несколько серверов, при попытке выполнить миграцию в то же время.</span><span class="sxs-lookup"><span data-stu-id="ab876-298">If you deploy a database by running migrations automatically as shown in this tutorial, and you are deploying to a web site that runs on multiple servers, you could get multiple servers trying to run migrations at the same time.</span></span> <span data-ttu-id="ab876-299">Миграция атомарны, поэтому, если два сервера повторить выполнение того же миграции, один будет успешно, а другой не сможет (при условии, что не удалось выполнить дважды операции).</span><span class="sxs-lookup"><span data-stu-id="ab876-299">Migrations are atomic, so if two servers try to run the same migration, one will succeed and the other will fail (assuming the operations can't be done twice).</span></span> <span data-ttu-id="ab876-300">Чтобы избежать этих проблем в этом случае можно вызывать миграции вручную и настроить собственный код, чтобы это происходит только один раз.</span><span class="sxs-lookup"><span data-stu-id="ab876-300">In that scenario if you want to avoid those issues, you can call migrations manually and set up your own code so that it only happens once.</span></span> <span data-ttu-id="ab876-301">Дополнительные сведения см. в разделе [запущена и миграция скрипта из кода](http://romiller.com/2012/02/09/running-scripting-migrations-from-code/) в блоге Роуэном Миллер и [Migrate.exe](https://msdn.microsoft.com/data/jj618307) (для выполнения миграции из командной строки) на сайте MSDN.</span><span class="sxs-lookup"><span data-stu-id="ab876-301">For more information, see [Running and Scripting Migrations from Code](http://romiller.com/2012/02/09/running-scripting-migrations-from-code/) on Rowan Miller's blog and [Migrate.exe](https://msdn.microsoft.com/data/jj618307) (for executing migrations from the command line) on MSDN.</span></span>

<span data-ttu-id="ab876-302">Сведения о других сценариях миграции см. в разделе [миграций серию](https://blogs.msdn.com/b/adonet/archive/2014/03/12/migrations-screencast-series.aspx).</span><span class="sxs-lookup"><span data-stu-id="ab876-302">For information about other migrations scenarios, see [Migrations Screencast Series](https://blogs.msdn.com/b/adonet/archive/2014/03/12/migrations-screencast-series.aspx).</span></span>

## <a name="code-first-initializers"></a><span data-ttu-id="ab876-303">Инициализаторы первого кода</span><span class="sxs-lookup"><span data-stu-id="ab876-303">Code First Initializers</span></span>

<span data-ttu-id="ab876-304">В разделе «развертывание», вы видели [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) используется инициализатор.</span><span class="sxs-lookup"><span data-stu-id="ab876-304">In the deployment section you saw the [MigrateDatabaseToLatestVersion](https://msdn.microsoft.com/library/hh829476(v=vs.103).aspx) initializer being used.</span></span> <span data-ttu-id="ab876-305">Код сначала также предоставляет другие инициализаторы, включая [CreateDatabaseIfNotExists](https://msdn.microsoft.com/library/gg679221(v=vs.103).aspx) (по умолчанию), [DropCreateDatabaseIfModelChanges](https://msdn.microsoft.com/library/gg679604(v=VS.103).aspx) (с использованием более ранней версии) и [ DropCreateDatabaseAlways](https://msdn.microsoft.com/library/gg679506(v=VS.103).aspx).</span><span class="sxs-lookup"><span data-stu-id="ab876-305">Code First also provides other initializers, including [CreateDatabaseIfNotExists](https://msdn.microsoft.com/library/gg679221(v=vs.103).aspx) (the default), [DropCreateDatabaseIfModelChanges](https://msdn.microsoft.com/library/gg679604(v=VS.103).aspx) (which you used earlier) and [DropCreateDatabaseAlways](https://msdn.microsoft.com/library/gg679506(v=VS.103).aspx).</span></span> <span data-ttu-id="ab876-306">`DropCreateAlways` Инициализатор может быть полезна при настройке условий для модульных тестов.</span><span class="sxs-lookup"><span data-stu-id="ab876-306">The `DropCreateAlways` initializer can be useful for setting up conditions for unit tests.</span></span> <span data-ttu-id="ab876-307">Можно также написать собственную инициализаторы и инициализатор можно вызвать явным образом, если не нужно подождать, пока приложение для чтения и записи в базу данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-307">You can also write your own initializers, and you can call an initializer explicitly if you don't want to wait until the application reads from or writes to the database.</span></span> <span data-ttu-id="ab876-308">Во время этого учебника записывается в ноябре 2013 г. можно использовать только инициализаторы Create и DropCreate перед включением миграции.</span><span class="sxs-lookup"><span data-stu-id="ab876-308">At the time this tutorial is being written in November, 2013, you can only use the Create and DropCreate initializers before you enable migrations.</span></span> <span data-ttu-id="ab876-309">Сделать эти инициализаторы может использоваться с миграции также работает команда Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="ab876-309">The Entity Framework team is working on making these initializers usable with migrations as well.</span></span>

<span data-ttu-id="ab876-310">Дополнительные сведения об инициализаторах см. в разделе [инициализаторы основные сведения о базе данных в Entity Framework Code First](http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm) и Глава 6 книги [программирования платформы Entity Framework: Code First](http://shop.oreilly.com/product/0636920022220.do) с Джули Лерман и Миллер Роуэном.</span><span class="sxs-lookup"><span data-stu-id="ab876-310">For more information about initializers, see [Understanding Database Initializers in Entity Framework Code First](http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm) and chapter 6 of the book [Programming Entity Framework: Code First](http://shop.oreilly.com/product/0636920022220.do) by Julie Lerman and Rowan Miller.</span></span>

## <a name="summary"></a><span data-ttu-id="ab876-311">Сводка</span><span class="sxs-lookup"><span data-stu-id="ab876-311">Summary</span></span>

<span data-ttu-id="ab876-312">В этом учебнике вы знаете, как включить миграция и развертывание приложения.</span><span class="sxs-lookup"><span data-stu-id="ab876-312">In this tutorial you've seen how to enable migrations and deploy the application.</span></span> <span data-ttu-id="ab876-313">В следующем уроке вы начнете, просмотрев более сложные вопросы, развернув модели данных.</span><span class="sxs-lookup"><span data-stu-id="ab876-313">In the next tutorial you'll begin looking at more advanced topics by expanding the data model.</span></span>

<span data-ttu-id="ab876-314">Оставьте отзыв на том, как вам понравилось этого учебника и что можно улучшить.</span><span class="sxs-lookup"><span data-stu-id="ab876-314">Please leave feedback on how you liked this tutorial and what we could improve.</span></span> <span data-ttu-id="ab876-315">Можно также запросить новые разделы на [показать мне как с код](http://aspnet.uservoice.com/forums/228522-show-me-how-with-code).</span><span class="sxs-lookup"><span data-stu-id="ab876-315">You can also request new topics at [Show Me How With Code](http://aspnet.uservoice.com/forums/228522-show-me-how-with-code).</span></span>

<span data-ttu-id="ab876-316">Ссылки на другие ресурсы Entity Framework можно найти в [доступа к данным ASP.NET - рекомендуется использовать ресурсы](xref:whitepapers/aspnet-data-access-content-map).</span><span class="sxs-lookup"><span data-stu-id="ab876-316">Links to other Entity Framework resources can be found in [ASP.NET Data Access - Recommended Resources](xref:whitepapers/aspnet-data-access-content-map).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="ab876-317">[Назад](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/connection-resiliency-and-command-interception-with-the-entity-framework-in-an-asp-net-mvc-application)
[Вперед](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-a-more-complex-data-model-for-an-asp-net-mvc-application)</span><span class="sxs-lookup"><span data-stu-id="ab876-317">[Previous](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/connection-resiliency-and-command-interception-with-the-entity-framework-in-an-asp-net-mvc-application)
[Next](xref:mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-a-more-complex-data-model-for-an-asp-net-mvc-application)</span></span>
