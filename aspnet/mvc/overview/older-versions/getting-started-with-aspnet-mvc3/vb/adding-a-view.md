---
uid: mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-view
title: Добавление представления (VB) | Документы Microsoft
author: Rick-Anderson
description: Этот учебник поможет узнать основы создания MVC веб-приложения ASP.NET с помощью Microsoft Visual Web Developer 2010 Express пакетом обновления 1, являющийся...
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/12/2011
ms.topic: article
ms.assetid: d3633f64-5d3c-45c9-ae4b-cb1563e3739f
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-view
msc.type: authoredcontent
ms.openlocfilehash: c9675eb7776116ecbe910d5515abfe9b4391df22
ms.sourcegitcommit: 6784510cfb589308c3875ccb5113eb31031766b4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/08/2018
ms.locfileid: "30873356"
---
<a name="adding-a-view-vb"></a>Добавление представления (Visual Basic)
====================
по [Рик Андерсон](https://github.com/Rick-Anderson)

> Этот учебник поможет узнать основы создания MVC веб-приложения ASP.NET с помощью Microsoft Visual Web Developer 2010 Express пакетом обновления 1, которой — это бесплатная версия Microsoft Visual Studio. Прежде чем начать, убедитесь, что вы установили необходимые компоненты, перечисленные ниже. Все из них можно установить, щелкнув по следующей ссылке: [Web Platform Installer](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack). Кроме того можно установить отдельно предварительные требования, используя следующие ссылки:
> 
> - [Необходимые компоненты Visual Studio Web Developer Express SP1](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack)
> - [Обновление средств ASP.NET MVC 3](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=MVC3)
> - [SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(среда выполнения + средства поддержки)
> 
> Если вы используете Visual Studio 2010 вместо Visual Web Developer 2010, необходимо установить необходимые компоненты, щелкнув по следующей ссылке: [необходимых компонентов Visual Studio 2010](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).
> 
> Проект Visual Web Developer с VB.NET исходный код доступен по следующему адресу. [Загрузить версию VB.NET](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098). Если вы предпочитаете C#, переключитесь в [C# версии](../cs/adding-a-view.md) этого учебника.


В этом разделе мы собираемся изменить `HelloWorldController` класс, чтобы использовать файл шаблона представления, чтобы четко инкапсулировать процесс создания HTML ответов клиенту.

Давайте начнем с помощью шаблона представления с `Index` метод `HelloWorldController` класса. В настоящее время `Index` метод возвращает строку с сообщением, жестко закодирован в класс контроллера. Изменение `Index` метод для возврата `View` объекта, как показано ниже:

[!code-vb[Main](adding-a-view/samples/sample1.vb)]

Теперь добавим шаблона представления в свой проект, который можно вызывать, с `Index` метод. Для этого щелкните правой кнопкой мыши внутри `Index` метода и нажмите кнопку **добавить представление**.

[![IndexAddView](adding-a-view/_static/image2.png "IndexAddView")](adding-a-view/_static/image1.png)

**Добавить представление** откроется диалоговое окно. Оставьте значения по умолчанию и нажмите кнопку **добавить** кнопки.

[![3addView](adding-a-view/_static/image4.png "3addView")](adding-a-view/_static/image3.png)

*MvcMovie\Views\HelloWorld* папки и *MvcMovie\Views\HelloWorld\Index.vbhtml* создания файла. Вы увидите их в **обозревателе решений**:

[![SolnExpHelloWorldIndx](adding-a-view/_static/image6.png "SolnExpHelloWorldIndx")](adding-a-view/_static/image5.png)

Добавление HTML в `<h2>` тег. Измененный *MvcMovie\Views\HelloWorld\Index.vbhtml* файла показан ниже.

[!code-vbhtml[Main](adding-a-view/samples/sample2.vbhtml)]

Запустите приложение и перейдите к &quot;Здравствуй, мир!&quot; контроллера (`http://localhost:xxxx/HelloWorld`). `Index` Метод в контроллер не представляют большую нагрузку; он просто выполнившего инструкцию `return View()`, который указывает, мы хотим использовать файл шаблона представления для отображения ответа клиенту. Так как не был явно указан имя файла шаблона представления для использования, ASP.NET MVC по умолчанию с помощью *Index.vbhtml* файл представления в *\Views\HelloWorld* папки. На рисунке ниже показаны строки жестко запрограммированы в представлении.

[![3HelloWorld](adding-a-view/_static/image8.png "3HelloWorld")](adding-a-view/_static/image7.png)

Выглядит очень хорошо. Обратите внимание, что строка заголовка браузера отображается надпись &quot;индекс&quot; и большой заголовок на странице отображается надпись &quot;Мое приложение MVC.&quot; Изменим их.

## <a name="changing-views-and-layout-pages"></a>Изменение представлений и страниц макета

Во-первых изменим текст &quot;Мое приложение MVC.&quot; Этот текст является общим и отображается на каждой странице. Он фактически не отображаются только в одном месте в данном проекте, даже если он находится на каждой странице в приложении. Последовательно выберите пункты */представления/Общие* папки в **обозревателе решений** и откройте  *\_Layout.vbhtml* файла. Этот файл называется макет страницы и является общей &quot;оболочки&quot; , использовать другие страницы.

Примечание `@RenderBody()` строку кода в нижней части файла. `RenderBody` заполнитель, где все страницы, которые вы создаете отображаются, &quot;оболочку&quot; на странице макета. Изменение `<h1>` заголовок из **&quot;** Мое приложение MVC&quot; для &quot;приложения MVC фильма&quot;.

[!code-html[Main](adding-a-view/samples/sample3.html)]

Запустите приложение и обратите внимание на то, теперь отображается надпись &quot;приложения MVC фильма&quot;. Нажмите кнопку **о** ссылку и что страниц отображает &quot;приложения MVC фильма&quot;, также.

Полный  *\_Layout.vbhtml* файла показан ниже:

[!code-cshtml[Main](adding-a-view/samples/sample4.cshtml)]

Теперь изменим заголовка страницы индекса (представление).

[!code-vbhtml[Main](adding-a-view/samples/sample5.vbhtml)]

Откройте *MvcMovie\Views\HelloWorld\Index.vbhtml*. Есть два места для внесения изменений: во-первых, текст, расположенный в заголовке обозревателя, а затем в заголовке получателя ( `<h2>` элемент). Мы выполним их немного отличается, можно увидеть, какая часть кода изменяет какие-либо часть приложения.

Запустите приложение и перейдите к`http://localhost:xx/HelloWorld`. Обратите внимание, что основной и дополнительный заголовки браузера изменились. Это легко сделать существенные изменения в приложении с небольшими изменениями в представление. (Если изменения не отображаются, возможно, вы просматриваете кэшированное содержимое. В этом случае нажмите в браузере клавиши CTRL+F5 для принудительной загрузки ответа сервера.)

[![3_MyMovieList](adding-a-view/_static/image10.png "3_MyMovieList")](adding-a-view/_static/image9.png)

Наш небольшую &quot;данные&quot; (в этом случае &quot;Hello World!&quot; сообщение) задается жестко, хотя. Наше приложение MVC имеет V (представления) и у нас есть C (контроллеров), но не M (модель) еще. Вскоре, мы рассмотрим как создать базу данных и получения из него данных модели.

## <a name="passing-data-from-the-controller-to-the-view"></a>Передача данных из контроллера в представление

Прежде чем мы перейдите к базе данных и говорить о модели, менее, сначала поговорим о передаче информации из контроллера в представление. Мы хотим передать для отрисовки HTML-ответе клиенту требуются шаблона представления. Эти объекты обычно создаются и передает класс контроллера в представление шаблона, и они должны содержать только данные, которые требуется Просмотр шаблона — и больше нет.

Ранее с `HelloWorldController` класса `Welcome` метода действия `name` и `numTimes` параметров и затем выходных данных, значения параметров в браузере. Вместо этого не иметь отрисовки этот ответ непосредственно по-прежнему контроллера, давайте вместо этого мы будет размещаться эти данные в контейнере для представления. Можно использовать контроллеры и представления `ViewBag` объект для хранения этих данных. Будут автоматически передается шаблон представления и используется для отрисовки HTML-ответе, используя содержимого контейнера в качестве данных. Таким образом, контроллер отвечает за одно и Просмотр шаблона с другим, позволяющих поддерживать чистой &quot;Разделение областей ответственности&quot; в приложении.

Кроме того мы могли бы определить пользовательский класс, затем создание экземпляра этого объекта в собственную, заполнить данными и передачи в представление. Часто называют ViewModel, так как это пользовательскую модель для представления. Для небольших объемов данных Однако ViewBag прекрасно работает.

Вернитесь к *HelloWorldController.vb* изменение файла `Welcome` метод внутри на контроллере, чтобы поместить сообщение и NumTimes в ViewBag. ViewBag является динамическим объектом. Это означает, что можно поместить все, что требуется его. ViewBag не имеет определенных свойств пока помещен внутри него.

Полный `HelloWorldController.vb` новый класс в тот же файл.

[!code-vb[Main](adding-a-view/samples/sample6.vb)]

Теперь наши ViewBag содержит данные, которые будут передаваться представления автоматически. Еще раз в качестве альтернативы мы может пройдены в собственный объект следующим образом, если мы понравилось:

[!code-csharp[Main](adding-a-view/samples/sample7.cs)]

Теперь нам нужно `WelcomeView` шаблона! Запустите приложение, поэтому выполняется компиляция нового кода. Закройте браузер, щелкните правой кнопкой мыши внутри `Welcome` метода, а затем щелкните **добавить представление**.

Вот что вашей **добавить представление** диалоговое окно выглядит следующим образом.

[![3AddWelcomeView](adding-a-view/_static/image12.png "3AddWelcomeView")](adding-a-view/_static/image11.png)

Добавьте следующий код под `<h2>` элемент в новом <em>приветствия.</em> vbhtml-файл. Мы сделать цикл и сказать &quot;Hello&quot; столько раз, сколько пользователь говорит, мы должны!

[!code-vbhtml[Main](adding-a-view/samples/sample8.vbhtml)]

Запустите приложение и перейдите к `http://localhost:xx/HelloWorld/Welcome?name=Scott&numtimes=4`

Теперь данные получены из URL-адрес и автоматически передается контроллеру. Контроллер упаковывает данные в `Model` объекта и передает объект, в представление. Представление не отображает данные в виде HTML для пользователя.

[![3Hello_Scott_4](adding-a-view/_static/image14.png "3Hello_Scott_4")](adding-a-view/_static/image13.png)

Контейнер, который был тип из &quot;M&quot; для модели, но не тип базы данных. Итак, обобщим все полученные данные и попробуем создать базу данных фильмов.

> [!div class="step-by-step"]
> [Назад](adding-a-controller.md)
> [Вперед](adding-a-model.md)
