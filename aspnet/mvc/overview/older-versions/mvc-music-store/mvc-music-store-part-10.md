---
uid: mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-10
title: "Часть 10: Окончательный обновления навигации и разработки узла, в заключение | Документы Microsoft"
author: jongalloway
description: "Этот учебник ряд подробно описываются шаги, необходимые для построения образца приложения ASP.NET MVC Music Store. Часть 10 охватывает окончательного обновлений для навигации и S...."
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/21/2011
ms.topic: article
ms.assetid: 0c6e4c2f-fcdb-4978-9656-1990c6f15727
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-10
msc.type: authoredcontent
ms.openlocfilehash: 2a65e4b793b615c45cdf31166e0a000ae72ee534
ms.sourcegitcommit: 016f4d58663bcd442930227022de23fb3abee0b3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/12/2018
---
<a name="part-10-final-updates-to-navigation-and-site-design-conclusion"></a>Часть 10: Окончательный обновления навигации и разработки узла, в заключение
====================
по [Джон Гэллоуэй](https://github.com/jongalloway)

> MVC Music Store является учебное приложение, которое вводятся и описываются пошаговые способы использования Visual Studio и ASP.NET MVC для веб-разработки.  
>   
> MVC Music Store показана реализация хранилища упрощенных образец продает велосипеды через Интернет альбомы, которое реализует Администрирование сайта основные, вход пользователей и функциональные возможности корзины покупок.  
>   
> Этот учебник ряд подробно описываются шаги, необходимые для построения образца приложения ASP.NET MVC Music Store. Часть 10 охватывает окончательного обновлений для навигации и разработки узла, заключение.


Мы выполнили все основные функции для наш сайт, но еще есть некоторые возможности для добавления узла навигации на домашней странице и странице Выбор хранилища.

## <a name="creating-the-shopping-cart-summary-partial-view"></a>Создание сводки частичного представления покупательской корзины

Необходимо предоставить количество элементов в корзине пользователя на всем сайте.

![](mvc-music-store-part-10/_static/image1.png)

Мы легко можно реализовать путем создания частичного представления, который добавляется в нашем Site.master.

Как показано выше, контроллер ShoppingCart включает CartSummary методу действия, который возвращает частичного представления.

[!code-csharp[Main](mvc-music-store-part-10/samples/sample1.cs)]

Чтобы создать CartSummary частичного представления, правой кнопкой мыши папку представления и ShoppingCart и выберите Добавить представление. Имя представления CartSummary и установите флажок «Создать разделяемое представление», как показано ниже.

![](mvc-music-store-part-10/_static/image2.png)

Частичное представление CartSummary очень простые — это просто ссылку на представление индекса ShoppingCart, которое показывает количество элементов в корзине. Ниже приведен полный код для CartSummary.cshtml:

[!code-cshtml[Main](mvc-music-store-part-10/samples/sample2.cshtml)]

В любой страницы сайта, включая основной сайт, с помощью метода Html.RenderAction, можно включить частичного представления. RenderAction требует указать имя действия («CartSummary») и имя контроллера («ShoppingCart») как ниже.

[!code-cshtml[Main](mvc-music-store-part-10/samples/sample3.cshtml)]

Перед добавлением узла макета, также будет рассмотрено создание меню жанра, мы предоставим все наши обновления Site.master за один раз.

## <a name="creating-the-genre-menu-partial-view"></a>Создание частичного представления жанра меню

Можно сделать его намного проще для пользователей для перемещения по магазину путем добавления меню жанра, который содержит список всех жанров доступны в нашем хранилище.

![](mvc-music-store-part-10/_static/image3.png)

Мы будем придерживаться именно действия также создать разделяемое представление GenreMenu и затем мы можем добавить оба главного узла. Во-первых добавьте следующее действие контроллера GenreMenu StoreController:

[!code-csharp[Main](mvc-music-store-part-10/samples/sample4.cs)]

Это действие возвращает список жанров которых будет отображаться для частичного представления, который мы создадим Далее.

*Примечание: Мы добавили атрибут [ChildActionOnly] для этого действия контроллера, которое указывает, что нам нужен только это действие для использования из частичного представления. Этот атрибут не позволит выполняется путем перехода к /Store/GenreMenu действия контроллера. Это необязательно для частичных представлений, но рекомендуется, поскольку мы хотим убедиться, что наши действия контроллера, используются как мы реализуем. Мы также возвращается PartialView, а не представление, которое позволяет обработчик представлений знать, что его не следует использовать макет для этого представления, как он включен в других представлениях.*

Щелкните правой кнопкой мыши на действие контроллера GenreMenu и создать частичное представление с именем GenreMenu, который является строго типизированным с помощью класса данных представления жанра, как показано ниже.

![](mvc-music-store-part-10/_static/image4.png)

Обновите код представления для частичного представления GenreMenu для отображения элементов с помощью неупорядоченный список следующим образом.

[!code-cshtml[Main](mvc-music-store-part-10/samples/sample5.cshtml)]

## <a name="updating-site-layout-to-display-our-partial-views"></a>Обновление сайта макет для отображения нашей разделяемые представления

Макет узла можно добавить наш разделяемые представления (/представления/Общие/\_Layout.cshtml) путем вызова Html.RenderAction(). Мы добавим их в, а также некоторые дополнительные разметку, чтобы отобразить их, как показано ниже:

[!code-cshtml[Main](mvc-music-store-part-10/samples/sample6.cshtml)]

Теперь при запуске приложения, мы увидим сводки для покупок в верхней и жанр в левой части области переходов.

## <a name="update-to-the-store-browse-page"></a>Обновите страницу Обзор хранилища

На странице Обзор хранилища работает, но выглядит не очень хорошо. Мы можем обновить страницу, чтобы показать альбомов в улучшения макета путем изменения представления кода (см. в /Views/Store/Browse.cshtml) следующим образом:

[!code-cshtml[Main](mvc-music-store-part-10/samples/sample7.cshtml)]

Здесь мы выполняем используйте Url.Action вместо Html.ActionLink, чтобы мы сможем применить специальное форматирование к ссылке на включать иллюстрации альбома.

*Примечание: Мы отображение крышка универсального альбом эти альбомов. Эта информация хранится в базе данных и для редактирования в диспетчере хранилища. Мы приглашаем вас Добавление логотипа.*

Теперь если мы перейти жанра, мы увидим альбомов из сетки с иллюстрацией альбома.

![](mvc-music-store-part-10/_static/image5.png)

## <a name="updating-the-home-page-to-show-top-selling-albums"></a>Обновление домашней страницы для отображения наиболее продаваемых альбомы Top

Мы хотим компонентов наших наиболее продаваемых альбомов на домашней странице, чтобы увеличить продажи. Мы выполним некоторые обновления с нашей HomeController для обработки и добавить в некоторых дополнительных графических.

Во-первых мы добавим свойство навигации для нашего альбом класса, чтобы EntityFramework известно, что они связаны. Последние три строки из наших **альбом** класс теперь должна выглядеть следующим образом:

[!code-csharp[Main](mvc-music-store-part-10/samples/sample8.cs)]

*Примечание: Для этого потребуется добавлении с помощью инструкции для перевода в пространство имен System.Collections.Generic.*

Во-первых мы добавим поля storeDB и MvcMusicStore.Models, с помощью инструкций, как в нашем другие контроллеры. Далее мы добавим следующий метод HomeController, который запрашивает top наиболее продаваемых альбомы согласно OrderDetails нашей базы данных.

[!code-csharp[Main](mvc-music-store-part-10/samples/sample9.cs)]

Это закрытый метод, поскольку мы не хотим сделать ее доступной как действия контроллера. Предоставляются вместе в HomeController для простоты, но настоятельно рекомендуется переместить бизнес-логики в отдельные классы соответствующим образом.

С этим мы можем обновить действие контроллера индекс для запроса пяти наиболее успешных альбомы и возвращать их в представление.

[!code-csharp[Main](mvc-music-store-part-10/samples/sample10.cs)]

Полный код для обновленной HomeController — как показано ниже.

[!code-csharp[Main](mvc-music-store-part-10/samples/sample11.cs)]

Наконец необходимо обновить нашей Главная индекс представления так, чтобы его можно отобразить список альбомов путем обновления тип модели и добавление списка альбом нижней. Мы будет использовать эту возможность также добавить на страницу заголовок и раздел повышения роли.

[!code-cshtml[Main](mvc-music-store-part-10/samples/sample12.cshtml)]

Теперь при запуске приложения, мы рассмотрим наши обновленные Домашняя страница с верхней наиболее продаваемых альбомы и наши рекламные сообщения.

![](mvc-music-store-part-10/_static/image1.jpg)

## <a name="conclusion"></a>Заключение

Мы узнали, что ASP.NET MVC упрощает создание сложных веб-сайта с помощью доступа к базе данных, членство в AJAX, и т. д. довольно быстро. Надеемся, у этого учебника вы получили средства, необходимые для приступить к созданию собственного ASP.NET MVC приложений!


>[!div class="step-by-step"]
[Назад](mvc-music-store-part-9.md)
