---
uid: mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-7
title: "Часть 7: Членство и авторизации | Документы Microsoft"
author: jongalloway
description: "Этот учебник ряд подробно описываются шаги, необходимые для построения образца приложения ASP.NET MVC Music Store. Часть 7 охватывает членства и авторизации."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/13/2010
ms.topic: article
ms.assetid: c8511ebe-68bc-4240-87c3-d5ced84a3f37
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-7
msc.type: authoredcontent
ms.openlocfilehash: 064f2d6eca087fae8c796d1dde78d5079d3803ca
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="part-7-membership-and-authorization"></a>Часть 7: Членство и авторизации
====================
по [Джон Гэллоуэй](https://github.com/jongalloway)

> MVC Music Store является учебное приложение, которое вводятся и описываются пошаговые способы использования Visual Studio и ASP.NET MVC для веб-разработки.  
>   
> MVC Music Store показана реализация хранилища упрощенных образец продает велосипеды через Интернет альбомы, которое реализует Администрирование сайта основные, вход пользователей и функциональные возможности корзины покупок.  
>   
> Этот учебник ряд подробно описываются шаги, необходимые для построения образца приложения ASP.NET MVC Music Store. Часть 7 охватывает членства и авторизации.


Наш контроллера директор магазина в настоящее время доступен всем посетите наш сайт. Позволяет изменить этот параметр, чтобы ограничить разрешения для администраторов сайтов.

## <a name="adding-the-accountcontroller-and-views"></a>Добавление AccountController и представления

Одним из различий между полный шаблон веб-приложения ASP.NET MVC 3 и ASP.NET MVC 3 пустое веб-приложение является что пустой шаблон не включает контроллера учетных записей. Мы добавим контроллера учетных записей, скопировав несколько файлов из нового приложения ASP.NET MVC на основе полного шаблона веб-приложение ASP.NET MVC 3.

Создание нового приложения ASP.NET MVC с помощью полного шаблона веб-приложение ASP.NET MVC 3 и скопируйте следующие файлы в тех же каталогах, в данном проекте:

1. Скопируйте AccountController.cs в каталоге контроллеры
2. Скопируйте AccountModels в каталоге моделей
3. Создайте каталог учетную запись в каталоге представлений и скопируйте все четыре представления в

Измените пространство имен для классов контроллеров и модели, чтобы они начинаются с MvcMusicStore. Класс AccountController должен использовать пространство имен MvcMusicStore.Controllers и AccountModels класса следует использовать пространство имен MvcMusicStore.Models.

*Примечание: Эти файлы также доступны в MvcMusicStore Assets.zip загрузки, из которого мы наш сайт разработки файлы скопированы в начале этого учебника. Членство файлы расположены в каталоге кода.*

Обновленное решение должно выглядеть следующим образом:

![](mvc-music-store-part-7/_static/image1.png)

## <a name="adding-an-administrative-user-with-the-aspnet-configuration-site"></a>Добавление администратора с веб-сайт конфигурации ASP.NET

Прежде чем мы требуем авторизации в сайте, нам нужно будет создать пользователя с доступом. Самый простой способ создать пользователя является использование встроенных веб-конфигурации ASP.NET.

Запустите веб-сайта ASP.NET конфигурации, щелкнув следующий значок в обозревателе решений.

![](mvc-music-store-part-7/_static/image2.png)

Будет запущен веб-сайт конфигурации. Перейдите на вкладку "Безопасность" на начальном экране, а затем щелкните ссылку «Включение ролей» в центре экрана.

![](mvc-music-store-part-7/_static/image3.png)

Щелкните ссылку «Создание и управление роли».

![](mvc-music-store-part-7/_static/image4.png)

Введите в качестве имени роли «Администратор» и нажмите кнопку Добавить роль.

![](mvc-music-store-part-7/_static/image5.png)

Нажмите кнопку "Назад", а затем щелкните ссылку Создать пользователя с левой стороны.

![](mvc-music-store-part-7/_static/image6.png)

Заполните поля сведений пользователя в левой части экрана, используя следующие сведения:

| **Поле** | **Значение** |
| --- | --- |
| **Имя пользователя** | Администратор |
| **Пароль** | password123! |
| **Подтверждение пароля** | password123! |
| **Электронная почта** | (любой адрес электронной почты будут работать) |
| **Контрольный вопрос** | (любым) |
| **Ответ на контрольный вопрос** | (любым) |

*Примечание: Вы безусловно можно использовать любой пароль, которые будут отправлены. Параметры безопасности по умолчанию пароль требуется пароль, который имеет 7 символов и содержит один не буквенно-цифровых символов.*

Выберите роль администратора для этого пользователя и нажмите кнопку Создать пользователя.

![](mvc-music-store-part-7/_static/image7.png)

На этом этапе вы увидите сообщение, указывающее, что пользователь успешно создан.

![](mvc-music-store-part-7/_static/image8.png)

Теперь можно закрыть окно браузера.

## <a name="role-based-authorization"></a>Авторизация на основе ролей

Теперь можно ограничить доступ к StoreManagerController, с помощью атрибута [Authorize], указывающего, пользователь должен быть в роль администратора для доступа к любой действия контроллера в классе.

[!code-csharp[Main](mvc-music-store-part-7/samples/sample1.cs)]

*Примечание: Атрибут [Authorize] может быть помещен в методах определенное действие, а также на уровне класса контроллера.*

Теперь перехода /StoreManager появляется диалоговое окно Вход в систему:

![](mvc-music-store-part-7/_static/image9.png)

После входа в систему с нашей новой учетной записи администратора, мы можем перейти к экрану альбом изменять как до.

>[!div class="step-by-step"]
[Назад](mvc-music-store-part-6.md)
[Вперед](mvc-music-store-part-8.md)
