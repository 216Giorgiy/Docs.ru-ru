---
uid: mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-2
title: 'Часть 2: Контроллеры | Документы Microsoft'
author: jongalloway
description: Этот учебник ряд подробно описываются шаги, необходимые для построения образца приложения ASP.NET MVC Music Store. Вторая часть посвящена контроллеров.
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/21/2011
ms.topic: article
ms.assetid: 998ce4e1-9d72-435b-8f1c-399a10ae4360
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-2
msc.type: authoredcontent
ms.openlocfilehash: 680cdea388d9b01961bd626643c0fd91c9205ed7
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30878702"
---
<a name="part-2-controllers"></a>Часть 2: контроллеры
====================
по [Джон Гэллоуэй](https://github.com/jongalloway)

> MVC Music Store является учебное приложение, которое вводятся и описываются пошаговые способы использования Visual Studio и ASP.NET MVC для веб-разработки.  
>   
> MVC Music Store показана реализация хранилища упрощенных образец продает велосипеды через Интернет альбомы, которое реализует Администрирование сайта основные, вход пользователей и функциональные возможности корзины покупок.  
>   
> Этот учебник ряд подробно описываются шаги, необходимые для построения образца приложения ASP.NET MVC Music Store. Вторая часть посвящена контроллеров.


С традиционной веб-платформами URL-адреса обычно сопоставляются с файлов на диске. Например: запрос на URL-адрес, например «/ Products.aspx» или «/ Products.php» может быть обработан файл «Products.aspx» или «Products.php».

Веб-платформы MVC сопоставления URL-адресов серверный код в немного иначе. Вместо сопоставления URL-адреса для файлов, они вместо сопоставления URL-адресов в методы в классах. Эти классы называются «Контроллеры» и они отвечают за обработку входящих HTTP-запросов, обработка введенных пользователем данных, получения и сохранения данных и определения ответа для отправки обратно клиенту (отображения HTML-кода, загрузите файл, перенаправление на другой URL-адрес и т. д.).

## <a name="adding-a-homecontroller"></a>Добавление HomeController

Начнем нашего приложения MVC Music Store, добавив класс контроллера, который будет обрабатывать URL-адреса на домашнюю страницу веб-сайтов. Мы будем следовать соглашениям об именовании по умолчанию ASP.NET MVC и назовите его HomeController.

Щелкните правой кнопкой мыши папку «Контроллеры» в обозревателе решений и выберите пункт «Добавить» и «Контроллер...» команда:

![](mvc-music-store-part-2/_static/image1.jpg)

Откроется диалоговое окно «Добавить контроллер». Имя контроллера «HomeController» и нажмите кнопку Добавить.

![](mvc-music-store-part-2/_static/image1.png)

Это создаст новый файл HomeController.cs, с помощью следующего кода:

[!code-csharp[Main](mvc-music-store-part-2/samples/sample1.cs)]

Чтобы запустить быстро, давайте замените метод индекс простой метод, который возвращает просто строку. Мы выполним два изменения:

- Изменение метода для возврата строки вместо ActionResult
- Измените инструкцию return для возвращения «Hello из Home»

Метод должен выглядеть следующим образом:

[!code-csharp[Main](mvc-music-store-part-2/samples/sample2.cs)]

## <a name="running-the-application"></a>Запуск приложения

Теперь давайте запуска сайта. Мы можно запустить наш веб сервера и испытать сайта, с помощью любого из следующих действий:

- Выберите элемент меню отладки начать отладку ⇨
- Нажмите кнопку с зеленой стрелкой на панели инструментов ![](mvc-music-store-part-2/_static/image2.jpg)
- Используйте сочетание клавиш F5.

С помощью любого из приведенных выше пунктов компиляции проекта и затем вызвать ASP.NET Development Server, встроены в Visual Web Developer для запуска. Уведомление будет отображаться в нижнем углу экрана, чтобы указать, что ASP.NET Development Server начал а отображается номер порта работает в группе.

![](mvc-music-store-part-2/_static/image2.png)

Visual Web Developer будет автоматически откройте окно браузера, URL-адрес указывает на наш веб сервера. Это позволит быстро опробовать наш веб-приложения:

![](mvc-music-store-part-2/_static/image3.png)

Хорошо, была очень быстрый — мы создали новый веб-сайт, добавлена функция три строки, и у нас есть текст в браузере. Не rocket обработки и анализа, но это start.

*Примечание: Visual Web Developer включает сервер разработки ASP.NET, в котором будет выполняться веб-сайта на число случайных свободного «порт». На снимке экрана выше, что сайт работает в `http://localhost:26641/`, поэтому он использует порт 26641. Этот номер порта будет отличаться. Если говорить о like /Store/Browse URL-адреса в этом учебнике, будут рассмотрены после номера порта. При условии, что номер порта 26641, перехода или хранилища или обзора означает перехода `http://localhost:26641/Store/Browse`.*

## <a name="adding-a-storecontroller"></a>Добавление StoreController

Мы добавили простой HomeController, который реализует домашнюю страницу веб-сайтов. Теперь добавим другого контроллера, мы будем использовать для реализации возможности просмотра хранилища нашей музыки. Наш контроллера хранилище поддерживает три сценария:

- Страницы список жанров музыки в нашем music store
- Страница обзора, в котором перечислены все альбомы определенного жанра
- Веб-страницу и отображает сведения о конкретных музыкальный альбом

Мы начнем, добавив новый класс StoreController... Если это еще не сделано, остановите, работающим с приложением, либо закрыть браузер или с помощью команды отладки ⇨ остановить отладку элемента меню.

Теперь добавьте новый StoreController. Так же, как мы сделали с HomeController, мы сделаем это путем щелчка правой кнопкой мыши папку «Контроллеры» в обозревателе решений и выбрав команду Add -&gt;контроллера пункта меню

![](mvc-music-store-part-2/_static/image4.png)

Наш новый StoreController уже имеет метод «Индекс». Мы будем использовать этот метод «Индекс» для реализации нашу страницу списка со списком всех жанров в нашем music store. Кроме того, мы добавим два дополнительных методов для реализации в двух других сценариях мы хотим, чтобы наши StoreController для обработки: Обзор и сведения.

Эти методы (индексов, Обзор и сведения), в нашем контроллера, называются «Действия контроллера» и как вы уже видели с методом действия HomeController.Index (), их задания будет отвечать на запросы на URL-адрес и (в целом) определите, какое содержимое должны отправляться обратно в браузер или пользователь, вызвавший URL-адрес.

Мы начнем StoreController реализацию, изменив метод theIndex() возвращать строку «Hello из Store.Index()», и мы добавим аналогичные методы для Browse() и Details():

[!code-csharp[Main](mvc-music-store-part-2/samples/sample3.cs)]

Запустите проект и найдите следующие URL-адреса:

- / Store
- / Store/обзора
- / / Сведения о хранилище

Доступ к URL-адресов вызывать методы действий в рамках нашей контроллера и возвращать строку ответы:

![](mvc-music-store-part-2/_static/image5.png)

Это здорово, но они просто константных строк. Давайте сделать их динамическими, таким образом получить сведения из URL-адрес и отобразить их в выходные данные страницы.

Сначала мы изменим метод действия обзора для извлечения значения строки запроса URL-адреса. Мы можно сделать, добавив параметр «жанр» нашей метода действия. Когда мы делаем это ASP.NET MVC будет автоматически передавать все строки запроса или параметров отправки форм с именем «жанр» наш метод действия, при вызове.

[!code-csharp[Main](mvc-music-store-part-2/samples/sample4.cs)]

*Примечание: Используется вспомогательный метод HttpUtility.HtmlEncode чистку ввод данных пользователем. Это предотвращает добавление Javascript в нашем представления с помощью ссылки, например /Store/Browse пользователями? Жанр =&lt;сценарий&gt;window.location= "http://hackersite.com"&lt;/script&gt;.*

Теперь давайте найдите/Store/обзора? Жанр = Disco

![](mvc-music-store-part-2/_static/image6.png)

Теперь изменим на действие Details для чтения и отображения входной параметр с именем идентификатора. В отличие от наших предыдущему методу мы не внедрение значение идентификатора в качестве параметра строки запроса. Вместо этого мы будем внедрять непосредственно в самом URL-АДРЕСЕ. Например: /Store/Details/5.

ASP.NET MVC позволяет легко реализовать без необходимости настройки. Соглашение о маршрутизации ASP.NET MVC по умолчанию является считать параметр с именем «ID» в сегменте URL-адрес после имени метода действия. Если метод действия имеет параметр с именем идентификатор затем ASP.NET MVC будет автоматически передавать сегмента URL-адреса вам как параметр.

[!code-csharp[Main](mvc-music-store-part-2/samples/sample5.cs)]

Запустите приложение и перейдите к /Store/Details/5:

![](mvc-music-store-part-2/_static/image7.png)

Давайте повторим, мы использовали пока:

- Мы создали новый проект ASP.NET MVC в Visual Web Developer
- Мы обсуждали структура базовой папки приложения ASP.NET MVC
- Мы узнали, как запустить наш веб-сайт с помощью сервера разработки ASP.NET
- Мы создали два класса контроллера: HomeController и StoreController
- Мы добавили методы действий в нашей контроллеров, которые отвечают на запросы на URL-адрес и возвращают текст в браузере


> [!div class="step-by-step"]
> [Назад](mvc-music-store-part-1.md)
> [Вперед](mvc-music-store-part-3.md)
