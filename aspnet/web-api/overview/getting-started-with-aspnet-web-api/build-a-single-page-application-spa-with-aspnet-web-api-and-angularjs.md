---
uid: web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs
title: 'Практическое лабораторное занятие: Построить приложение на одной странице (SPA) с веб-API ASP.NET и Angular.js | Документы Microsoft'
author: rick-anderson
description: В традиционных веб-приложений клиент (браузер) инициирует связь с сервером путем запроса страницы. Затем сервер обрабатывает запрос...
ms.author: aspnetcontent
manager: wpickett
ms.date: 09/30/2015
ms.topic: article
ms.assetid: 719727b7-bef3-45ad-bfe9-ba5bcdb2305f
ms.technology: dotnet-webapi
ms.prod: .net-framework
msc.legacyurl: /web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs
msc.type: authoredcontent
ms.openlocfilehash: 9a748628d53878be380869ac5327de0111d2284d
ms.sourcegitcommit: 6784510cfb589308c3875ccb5113eb31031766b4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/08/2018
ms.locfileid: "26507263"
---
<a name="hands-on-lab-build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs"></a>Практическое лабораторное занятие: Построить приложение на одной странице (SPA) с веб-API ASP.NET и Angular.js
====================
По [Web лагеря команды](https://twitter.com/webcamps)

[Загрузите комплект учебных материалов лагеря Web](http://aka.ms/webcamps-training-kit)

> В традиционных веб-приложений клиент (браузер) инициирует связь с сервером путем запроса страницы. Затем сервер обрабатывает запрос и отправляет клиенту HTML-код страницы. В последующие взаимодействия с этой страницей, — например, пользователь переходит по ссылке или отправке формы с данными — новый запрос отправляется на сервер и снова запускает поток: сервер обрабатывает запрос и возвращает новую страницу в браузере в ответ на запрос нового действия Ed клиентом.
> 
> В приложениях для одной страницы (SPAs) вся страница загружается в браузере после начального запроса, но последующие действия осуществляются через запросы Ajax. Это означает, что браузер должен обновить только часть страницы, которая была изменена; Нет необходимости перезагрузить всей страницы. SPA подход уменьшает время, необходимое для реагирования на действия пользователя, в результате более гибкий работа приложения.
> 
> Архитектура SPA включает в себя определенные трудности, которые не существуют в традиционных веб-приложений. Однако платформы JavaScript новые технологии, такие как веб-API ASP.NET, как AngularJS и новых стилей, обеспечиваемые CSS3 упрощают действительно проектировать и создавать SPAs.
> 
> В этой лаборатории в наличии будет воспользоваться преимуществами этих технологий для реализации компьютерный фанат тест веб-сайт trivia зависимости от понятия SPA. Сначала будет реализовать уровень службы с веб-API ASP.NET для предоставления конечных точек, необходимые для получения головоломки вопросы и ответы сохранения. Затем вы создадите подробный и отвечать на запросы пользовательского интерфейса с помощью AngularJS и CSS3 влияние преобразования.
> 
> Все образцы кода и фрагменты кода включаются в Web лагеря комплект учебных материалов, доступных в [ http://aka.ms/webcamps-training-kit ](http://aka.ms/webcamps-training-kit).


## <a name="overview"></a>Обзор

<a id="Objectives"></a>
### <a name="objectives"></a>Цели

В этой практической вы узнаете, как:

- Создать службу ASP.NET Web API для отправки и получения данных JSON
- Создание быстро реагирующего пользовательского интерфейса с помощью AngularJS
- Улучшение пользовательского интерфейса с помощью преобразований CSS3

<a id="Prerequisites"></a>
### <a name="prerequisites"></a>Предварительные требования

Для завершения этой практической требуется следующее:

- [Visual Studio Express 2013 для Web](https://www.microsoft.com/visualstudio/) или выше

<a id="Setup"></a>
### <a name="setup"></a>Установка

Чтобы выполнить упражнения в этой практической, необходимо настроить среду.

1. Откройте проводник и найдите в лаборатории **источника** папки.
2. Щелкните правой кнопкой мыши **Setup.cmd** и выберите **Запуск от имени администратора** для запуска процесса установки, будет настроить среду и установить фрагменты кода Visual Studio для этой лабораторной работы.
3. Если отображается диалоговое окно контроля учетных записей, подтвердите действие для продолжения.

> [!NOTE]
> Убедитесь, что все зависимости для этой лабораторной работы вы вернули перед запуском программы установки.


<a id="CodeSnippets"></a>
### <a name="using-the-code-snippets"></a>Фрагменты кода

В документе лаборатории будет предложено вставлять блоки кода. Visual Studio к фрагментам кода, к которому можно получить из в Visual Studio 2013, чтобы избежать необходимости вручную добавить большая часть кода предоставляется для удобства.

> [!NOTE]
> Каждого упражнения сопровождается начальный решений, расположенный в **начать** папку расчетов, позволяющий выполнить каждого упражнения независимо от других. Имейте в виду, что фрагменты кода, которые добавляются во время упражнения, отсутствуют на их запуск решения и могут не работать до завершения этого упражнения. В исходном коде для упражнения, вы также найдете **окончания** папку, содержащую решение Visual Studio с кодом, полученный в результате выполнения действий в соответствующий упражнении. Эти решения можно использовать как рекомендации, если вам нужна дополнительная помощь, отвечая на этой практической.


* * *

<a id="Exercises"></a>
## <a name="exercises"></a>Упражнения

Данная практическая работа включает следующие упражнения:

1. [Создание веб-API](#Exercise1)
2. [Создание интерфейса SPA](#Exercise2)

Предполагаемое время для выполнения этого занятия: **60 минут**

> [!NOTE]
> При первом запуске Visual Studio, необходимо выбрать одну из коллекций предварительно определенных параметров. Каждая предопределенная коллекция соответствует конкретному стилю разработки и определяет макетов окон, поведение редактора, фрагменты кода IntelliSense и параметры диалогового окна. В этой лаборатории описаны действия, необходимые для выполнения данной задачи в Visual Studio при использовании **обычные параметры разработки** коллекции. При выборе другого набора параметров для среды разработки может быть отличия в этапах, которые следует принимать во внимание.


<a id="Exercise1"></a>
### <a name="exercise-1-creating-a-web-api"></a>Упражнение 1: Создание веб-API

Одним из ключевых элементов SPA является уровень служб. Он отвечает за обработку вызовы Ajax, отправленных с помощью пользовательского интерфейса и возврат данных в ответ на этот вызов. Извлеченные данные должны быть представлены в машиночитаемый формат для синтаксического анализа и на клиенте.

Платформа веб-API является частью стека ASP.NET и предназначен для упрощения реализации службы HTTP, как правило, отправки и получения данных в формате JSON или XML через RESTful API. В этом упражнении вы создадите веб-сайт для размещения приложения компьютерный фанат головоломку, а затем реализуйте внутренней службе для предоставления и сохранения данных тест, с помощью веб-API ASP.NET.

<a id="Ex1Task1"></a>
#### <a name="task-1--creating-the-initial-project-for-geek-quiz"></a>Задача 1 – Создание начального проекта для головоломки компьютерный фанат

В этой задаче будет приступить к созданию нового проекта ASP.NET MVC с поддержкой для ASP.NET Web API на основе **One ASP.NET** тип, который поставляется с Visual Studio проекта. **Один ASP.NET** объединяет все технологии ASP.NET и дает возможность комбинировать и сопоставлять их в случае необходимости. Затем добавьте классы модели Entity Framework и initializator базы данных для вставки вопросы теста.

1. Откройте **Visual Studio Express 2013 для Web** и выберите **файл | Создать проект...**  для запуска нового решения.

    ![Создание нового проекта](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image1.png "Создание нового проекта")

    *Создание нового проекта*
2. В **новый проект** выберите **веб-приложение ASP.NET** под **Visual C# | Web** вкладки. Убедитесь, что **.NET Framework 4.5** — флажок установлен, назовите его *GeekQuiz*, выберите **расположение** и нажмите кнопку **ОК**.

    ![Создание нового проекта веб-приложения ASP.NET](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image2.png "Создание нового проекта веб-приложения ASP.NET")

    *Создание нового проекта веб-приложения ASP.NET*
3. В **новый проект ASP.NET** выберите **MVC** шаблона и выберите **веб-API** параметр. Кроме того, убедитесь, что **проверки подлинности** включен режим **индивидуальные учетные записи**. Нажмите кнопку **ОК** , чтобы продолжить.

    ![Создание нового проекта из шаблона MVC, включая компоненты веб-API](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image3.png)

    *Создание нового проекта из шаблона MVC, включая компоненты веб-API*
4. В **обозревателе решений**, щелкните правой кнопкой мыши **моделей** папки **GeekQuiz** проект и выберите **добавить | Существующий элемент...** .

    ![Добавление существующего элемента](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image4.png "Добавление существующего элемента")

    *Добавление существующего элемента*
5. В **Добавление существующего элемента** диалоговом окне перейдите к **источника, средств и модели** папку и выберите все файлы. Нажмите кнопку **Добавить**.

    ![Добавление средств модели](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image5.png "добавление средств модели")

    *Добавление средств модели*

    > [!NOTE]
    > Добавив эти файлы, добавлении модели данных, контекст базы данных Entity Framework и инициализатора базы данных для приложения компьютерный фанат тест.
    > 
    > **Entity Framework (EF)** является объектно реляционного сопоставления (ORM), который позволяет создавать приложения для доступа к данным путем программирования с концептуальной моделью приложения а не напрямую с помощью реляционной схеме хранения. Дополнительные сведения об Entity Framework [здесь](../../../entity-framework.md).
    > 
    > Ниже приведено описание классов, которые вы только что добавили:
    > 
    > - **TriviaOption:** представляет отдельный параметр, связанного с вопросом головоломки
    > - **TriviaQuestion:** вопрос головоломки представляет и предоставляет связанные с ними параметры через **параметры** свойство
    > - **TriviaAnswer:** представляет параметр, выбранный пользователем в ответ на вопрос головоломки
    > - **TriviaContext:** представляет контекст базы данных Entity Framework приложения компьютерный фанат тест. Этот класс является производным от **DContext** и предоставляет **DbSet** свойства, которые представляют собой коллекции сущностей, описанных выше.
    > - **TriviaDatabaseInitializer:** реализацию платформы Entity Framework инициализатор для **TriviaContext** класс, который наследуется от **CreateDatabaseIfNotExists**. Поведение по умолчанию этого класса для создания базы данных только в том случае, если он не существует, вставка сущностей определяется в **начальное значение** метод.
6. Откройте **Global.asax.cs** и добавьте следующее в файл с помощью инструкции.

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample1.cs)]
7. Добавьте следующий код в начале **приложения\_запустить** метод, чтобы задать **TriviaDatabaseInitializer** как инициализатора базы данных.

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample2.cs)]
8. Изменить **Главная** контроллера для ограничения доступа для прошедших проверку пользователей. Чтобы сделать это, откройте **HomeController.cs** файла внутри **контроллеров** папки и добавьте **авторизовать** атрибут **HomeController**определения класса.

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample3.cs)]

    > [!NOTE]
    > **Авторизовать** фильтр проверяет, если пользователь прошел проверку. Если пользователь не прошел проверку, он возвращает код состояния HTTP 401 (не санкционировано) без вызова действия. Вы можете применить фильтр глобально, на уровне контроллера или на уровне отдельных действий.
9. Сейчас будет выполнена настройка макета веб-страниц и фирменной символики. Чтобы сделать это, откройте  **\_Layout.cshtml** файла внутри **представления | Общие** папки и обновить содержимое **&lt;заголовок&gt;** элемент, заменив *Мое приложение ASP.NET* с *компьютерный фанат тест* .

    [!code-cshtml[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample4.cshtml)]
10. В том же файле обновить панель навигации, удалив *о* и *контакт* ссылки и переименование *Главная* связать *воспроизведение*. Кроме того, переименование *имя_приложения* связать *головоломка компьютерный фанат*. HTML-код на панели навигации должен выглядеть как следующий код.

    [!code-cshtml[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample5.cshtml)]
11. Обновите нижний колонтитул страницы макета, заменив *Мое приложение ASP.NET* с *головоломка компьютерный фанат*. Для этого замените содержимое **&lt;нижний колонтитул&gt;** элемент с следующий выделенный код.

    [!code-html[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample6.html)]

<a id="Ex1Task2"></a>
#### <a name="task-2--creating-the-triviacontroller-web-api"></a>Задача 2 – Создание TriviaController веб-API

В предыдущей задаче создания начальной структуры компьютерный фанат тест веб-приложения. Теперь будет построен простой веб-API службы, которая взаимодействует с моделью данных, тест и предоставляет следующие действия:

- **GET/api/trivia**: извлекает следующий вопрос из списка головоломки ответа пользователем, прошедшим проверку.
- **POST/api/trivia**: сохраняет ответ головоломку, указанное пользователем, прошедшим проверку.

Формирование шаблонов ASP.NET средств, предоставляемых Visual Studio будет использовать для создания шаблона для класса контроллера веб-API.

1. Откройте **WebApiConfig.cs** файла внутри **приложения\_запустить** папки. Этот файл определяет конфигурацию службы веб-API, например сопоставление маршруты к действиям контроллера веб-API.
2. Добавьте следующий код с помощью инструкции в начало файла.

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample7.cs)]
3. Добавьте следующий выделенный код в **зарегистрировать** метод для настройки форматирования для получения данных JSON с помощью методов действия веб-API глобально.

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample8.cs)]

    > [!NOTE]
    > **CamelCasePropertyNamesContractResolver** автоматически преобразует имена свойств для *стиль camel* варианта, представляющее общие соглашения для имен свойств в JavaScript.
4. В **обозревателе решений**, щелкните правой кнопкой мыши **контроллеров** папки **GeekQuiz** проект и выберите **добавить | Новый элемент формирования шаблонов...** .

    ![Создание нового элемента формирования шаблонов](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image6.png "создания элемента формирования шаблонов")

    *Создание нового элемента формирования шаблонов*
5. В **Добавление формирования шаблонов** диалогового окна поле, убедитесь, что **Общие** узел выбран на панели слева. Выберите **контроллер 2 API веб - пустой** шаблонов в центральной области и нажмите кнопку **добавить**.

    ![При выборе шаблона пустой контроллер Web API 2](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image7.png "выбрав шаблон пустой контроллер Web API 2")

    *При выборе шаблона пустой контроллер Web API 2*

    > [!NOTE]
    > **Формирование шаблонов ASP.NET** — это платформа создания кода для веб-приложений ASP.NET. Visual Studio 2013 включает генераторы предустановленных кода для проектов MVC и веб-API. Формирование шаблонов следует использовать в проекте для быстрого добавления кода, взаимодействующего с моделями, чтобы сократить количество времени, необходимые для разработки стандартных данных операций.
    > 
    > Процесс формирования шаблонов также гарантирует, что все необходимые зависимости установлены в проекте. Например если начать с пустой проект ASP.NET и затем использовать формирование шаблонов для добавления контроллера веб-API, необходимые пакеты Web API NuGet и ссылки добавляются в проект автоматически.
6. В **добавления контроллера** диалоговом *TriviaController* в **имя контроллера** текстовое поле и нажмите кнопку **добавить**.

    ![Добавление контроллера Trivia](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image8.png "добавления контроллера Trivia")

    *Добавление контроллера Trivia*
7. **TriviaController.cs** затем добавляется файл **контроллеров** папки **GeekQuiz** проект, содержащий пустой **TriviaController** класса. Добавьте следующие операторы using в начале файла.

    (Фрагмент - кода *TriviaControllerUsings AspNetWebApiSpa - сервера Ex1 -*)

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample9.cs)]
8. Добавьте следующий код в начале **TriviaController** класса для определения, инициализации и dispose **TriviaContext** экземпляра в контроллере.

    (Фрагмент - кода *TriviaControllerContext AspNetWebApiSpa - сервера Ex1 -*)

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample10.cs)]

    > [!NOTE]
    > **Dispose** метод **TriviaController** вызывает **Dispose** метод **TriviaContext** экземпляр, который гарантирует, что все освобождение ресурсов, используемых объектом контекста при **TriviaContext** экземпляр уничтожается или сбора мусора. Сюда входят закрытие всех подключений к базе данных открывается с Entity Framework.
9. Добавьте следующий вспомогательный метод в конце **TriviaController** класса. Этот метод получает следующий вопрос тест из ответа указанным пользователем базы данных.

    (Фрагмент - кода *TriviaControllerNextQuestion AspNetWebApiSpa - сервера Ex1 -*)

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample11.cs)]
10. Добавьте следующие **получить** методом действия **TriviaController** класса. Этот метод действия вызывает **NextQuestionAsync** вспомогательный метод, определенный на предыдущем шаге, чтобы получить следующий вопрос для авторизованного пользователя.

    (Фрагмент - кода *TriviaControllerGetAction AspNetWebApiSpa - сервера Ex1 -*)

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample12.cs)]
11. Добавьте следующий вспомогательный метод в конце **TriviaController** класса. Этот метод сохраняет указанный ответ в базе данных и возвращает логическое значение, указывающее, будет ли на правильность ответа.

    (Фрагмент - кода *TriviaControllerStoreAsync AspNetWebApiSpa - сервера Ex1 -*)

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample13.cs)]
12. Добавьте следующие **Post** методом действия **TriviaController** класса. Этот метод действие связывает ответ на проверку подлинности пользователя и вызовы **StoreAsync** вспомогательный метод. Затем он отправляет ответ с логическое значение, возвращаемое вспомогательный метод.

    (Фрагмент - кода *TriviaControllerPostAction AspNetWebApiSpa - сервера Ex1 -*)

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample14.cs)]
13. Изменение контроллера веб-API для ограничения доступа к прошедшим проверку пользователям, добавив **авторизовать** атрибут **TriviaController** определения класса.

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample15.cs)]

<a id="Ex1Task3"></a>
#### <a name="task-3--running-the-solution"></a>Задача 3 – Запуск решения

В этой задаче вы проверите, что служба веб-API, созданного в предыдущей задаче работает надлежащим образом. Будет использовать Internet Explorer **средств разработчика F12** для записи сетевого трафика и просмотреть полный ответ от службы веб-API.

> [!NOTE]
> Убедитесь, что **Internet Explorer** выбран в **запустить** кнопку, расположенную на панели инструментов Visual Studio.
> 
> ![Параметр Internet Explorer](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image9.png)


1. Нажмите клавишу **F5** для запуска решения. **Входа** страница должна выглядеть в браузере.

    > [!NOTE]
    > Запускается при запуске приложения, MVC маршрут по умолчанию, которое по умолчанию сопоставляется **индекс** действие **HomeController** класса. Так как **HomeController** только пользователи, прошедшие проверку подлинности (Помните, что вы внутреннего класса с **авторизовать** атрибута в упражнении 1) и нет, пользователь не прошел проверку подлинности, но приложение перенаправляет первоначальный запрос на страницу входа.

    ![Запуск решения](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image10.png "запуск решения")

    *Запуск решения*
2. Нажмите кнопку **зарегистрировать** для создания нового пользователя.

    ![Регистрация нового пользователя](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image11.png "Регистрация нового пользователя")

    *Регистрация нового пользователя*
3. В **зарегистрировать** введите **имя пользователя** и **пароль**, а затем нажмите кнопку **зарегистрировать**.

    ![Страница «Регистрация»](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image12.png "страницы регистрации")

    *Страница «Регистрация»*
4. Приложение регистрирует новую учетную запись, и пользователь проверку подлинности и перенаправляется обратно на домашней странице.

    ![Пользователь прошел проверку подлинности](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image13.png "пользователь прошел проверку подлинности")

    *Пользователь прошел проверку подлинности*
5. В браузере, нажмите клавишу **F12** Открытие **средств разработчика** панель. Нажмите клавишу **CTRL + 4** или нажмите кнопку **сети** значок и нажмите кнопку с зеленой стрелкой, чтобы начать отслеживать сетевой трафик.

    ![Запуск записи сетевого трафика веб-API](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image14.png "записи сетевого трафика запуск веб-API")

    *Запуск записи сетевого трафика веб-API*
6. Добавление **api/trivia** URL-адрес в адресной строке браузера. Теперь будет проверять сведения об ответе от **получить** метода действия в **TriviaController**.

    ![Получение следующего вопрос данных через веб-API](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image15.png "получение следующего вопрос данных через веб-API")

    *Получение следующего вопрос данных через веб-API*

    > [!NOTE]
    > После завершения загрузки, будет предложено задать действие с помощью загруженного файла. Не закрывайте диалоговое окно для просмотра содержимого ответа с помощью окна инструментов для разработчиков.
7. Теперь будет проверять текст ответа. Чтобы сделать это, нажмите кнопку **сведения** и нажмите кнопку **текст ответа**. Можно проверить, что загруженные данные — это объект со свойствами **параметры** (который приведен список **TriviaOption** объекты), **идентификатор** и **заголовок** , которые соответствуют **TriviaQuestion** класса.

    ![Просмотр текста ответа API Web](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image16.png "Просмотр тексте ответа API Web")

    *Текст ответа API просмотра Web*
8. Вернитесь в Visual Studio и нажмите клавишу **SHIFT + F5** остановить отладку.

<a id="Exercise2"></a>
### <a name="exercise-2-creating-the-spa-interface"></a>Упражнение 2: Создание интерфейса SPA

В этом упражнении следует построить интерфейсный веб-части из компьютерный фанат тест, сосредоточившись на взаимодействие с одной страницы приложения с помощью **AngularJS**. Затем будет улучшить взаимодействие с пользователем с помощью CSS3 для выполнения широкие возможности анимации и предоставления визуального эффекта при переходе от одного вопроса к следующему при переключении контекста.

<a id="Ex2Task1"></a>
#### <a name="task-1--creating-the-spa-interface-using-angularjs"></a>Задача 1 – Создание интерфейса SPA, с помощью AngularJS

В этой задаче будут использованы **AngularJS** для реализации приложения компьютерный фанат тест на стороне клиента. **AngularJS** — это платформа открытым исходным кодом JavaScript, который прибавляет браузерных приложений с помощью *Model-View-Controller* возможностей (MVC), проведению обоих разработки и тестирования.

Начнем с установкой AngularJS консоли диспетчера пакетов Visual Studio. Затем вы создадите контроллера для обеспечения поведения приложения компьютерный фанат головоломки и представления для отображения головоломки вопросы и ответы, с помощью механизма шаблона AngularJS.

> [!NOTE]
> Дополнительные сведения о AngularJS посвящены [ [ http://angularjs.org/ ](http://angularjs.org/) ](http://angularjs.org/).


1. Откройте **Visual Studio Express 2013 для Web** и откройте **GeekQuiz.sln** решение находится в **источника/Ex2-CreatingASPAInterface/начало** папки. Кроме того можно продолжить с решением, полученный в предыдущем упражнении.
2. Откройте **консоль диспетчера пакетов** из **средства** | **диспетчер пакетов библиотеки**. Введите следующую команду, чтобы установить **AngularJS.Core** пакет NuGet.

    [!code-powershell[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample16.ps1)]
3. В **обозревателе решений**, щелкните правой кнопкой мыши **сценариев** папки **GeekQuiz** проект и выберите **добавить | Новая папка**. Назовите папку **приложения** и нажмите клавишу **ввод**.
4. Щелкните правой кнопкой мыши **приложения** папку только что созданного и выберите **добавить | Файл JavaScript**.

    ![Создание нового файла JavaScript](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image17.png)

    *Создание нового файла JavaScript*
5. В **указания имени элемента** диалоговом *головоломки контроллера* в **имя элемента** текстовое поле и нажмите кнопку **ОК**.

    ![Именование новый файл JavaScript](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image18.png)

    *Именование новый файл JavaScript*
6. В **головоломки controller.js** файл, добавьте следующий код для объявления и инициализации AngularJS **QuizCtrl** контроллера.

    (Фрагмент - кода *AngularQuizController AspNetWebApiSpa - Ex2 -*)

    [!code-javascript[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample17.js)]

    > [!NOTE]
    > Функции конструктора **QuizCtrl** контроллера требуется injectable параметр с именем **$scope**. Начальное состояние области должны быть настроены в функции конструктора путем присоединения свойства **$scope** объекта. Свойства содержат **модель представления**и время регистрируется контроллер будет доступен в шаблоне.
    > 
    > **QuizCtrl** контроллер определен в модуле с именем **QuizApp**. Модули являются единицами работы, позволяют разделения приложения на отдельных компонентов. Основные преимущества использования модулей, что код проще понять и облегчает тестирование, возможность повторного использования и удобства.
7. Теперь добавим поведение в область действия для реагирования на события, вызываемые из представления. Добавьте следующий код в конце **QuizCtrl** контроллера для определения **nextQuestion** функционировать в **$scope** объекта.

    (Фрагмент - кода *AngularQuizControllerNextQuestion AspNetWebApiSpa - Ex2 -*)

    [!code-javascript[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample18.js)]

    > [!NOTE]
    > Эта функция извлекает следующий вопрос из **Trivia** веб-API в предыдущем упражнении и присоединяет данные вопрос **$scope** объекта.
8. Вставьте следующий код в конце **QuizCtrl** контроллера для определения **sendAnswer** функционировать в **$scope** объекта.

    (Фрагмент - кода *AngularQuizControllerSendAnswer AspNetWebApiSpa - Ex2 -*)

    [!code-javascript[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample19.js)]

    > [!NOTE]
    > Эта функция отправляет ответ, выбранные пользователем для **Trivia** веб-API и сохраняет результат — т. е. Если на правильность ответа или нет — в **$scope** объекта.
    > 
    > **NextQuestion** и **sendAnswer** функции выше используют AngularJS **$http** объекта абстрактными обмена данными с веб-API через XMLHttpRequest Объект JavaScript из браузера. AngularJS поддерживает другой службы, которая предоставляет более высокий уровень абстракции для выполнения операций CRUD к ресурсу через API RESTful. AngularJS **$resource** объект имеет методы действий, которые предоставляют общие поведения без необходимости взаимодействовать с **$http** объекта. Рассмотрите возможность использования **$resource** объекта в сценариях, требующего модели CRUD (fore сведения см. в разделе [$resource документации](https://docs.angularjs.org/api/ngResource/service/$resource)).
9. Следующим шагом является создание шаблон AngularJS, который определяет представление для головоломки. Чтобы сделать это, откройте **Index.cshtml** файла внутри **представления | Главная** папки и замените содержимое следующим кодом.

    (Фрагмент - кода *GeekQuizView AspNetWebApiSpa - Ex2 -*)

    [!code-cshtml[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample20.cshtml)]

    > [!NOTE]
    > Шаблон AngularJS — декларативный спецификацией, которую использует сведения из модели и контроллера для преобразования разметки static в динамическое представление, которое пользователь видит в браузере. Ниже приведены примеры AngularJS элементы и атрибуты элементов, которые могут использоваться в шаблоне:
    > 
    > - **Ng приложения** директива указывает AngularJS элемент DOM, который представляет корневой элемент приложения.
    > - **Ng контроллера** директива присоединяет контроллер в модель DOM в той точке, где объявлен директивы.
    > - Запись в фигурных скобках **{{}}** обозначает привязки для свойства области, указанных в этом контроллере.
    > - **Щелчком ng** директива используется для вызова функции, определенные в области действия в ответ на щелчок мышью.
10. Откройте **Site.css** файла внутри **содержимого** папки и добавьте следующие выделенные стили в конце файла, чтобы обеспечить внешний вид и поведение для представления головоломки.

    (Фрагмент - кода *GeekQuizStyles AspNetWebApiSpa - Ex2 -*)

    [!code-css[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample21.css)]

<a id="Ex2Task2"></a>
#### <a name="task-2--running-the-solution"></a>Задача 2 – запуск решения

В этой задаче будет выполняться решения с помощью нового пользователя интерфейса вы созданного с помощью AngularJS, чтобы ответить на вопросы головоломки.

1. Нажмите клавишу **F5** для запуска решения.
2. Зарегистрируйте новую учетную запись. Чтобы сделать это, следуйте инструкциям регистрации в упражнении 1, задача 3.

    > [!NOTE]
    > При использовании решения из предыдущее упражнение, можно войти с учетной записью пользователя, созданную до.
3. **Главная** страница должна выглядеть, показывающая первый вопрос головоломка. Ответьте на вопрос, щелкнув один из вариантов. Это приведет к началу **sendAnswer** функцию, определенную ранее, который отправляет флажок для параметра **Trivia** веб-API.

    ![Ответить на вопрос о](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image19.png "ответы на вопросы")

    *Ответы на вопросы*
4. Щелкните одну из кнопок и появится ответ. Нажмите кнопку **следующий вопрос** для отображения на следующий вопрос. Это приведет к началу **nextQuestion** функции, определенной в контроллере.

    ![Запрос на следующий вопрос](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image20.png "запрос на следующий вопрос:")

    *Запрос на следующий вопрос:*
5. Должен появиться следующий вопрос. По-прежнему отвечая на вопросы неограниченное число раз. После завершения всех вопросов следует вернуть первый вопрос.

    ![Другой вопрос](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image21.png "другой вопрос")

    *Следующий вопрос*
6. Вернитесь в Visual Studio и нажмите клавишу **SHIFT + F5** остановить отладку.

<a id="Ex2Task3"></a>
#### <a name="task-3--creating-a-flip-animation-using-css3"></a>Задача 3 – Создание Переворачивающейся анимации с помощью CSS3

В этой задаче будет использовать свойства CSS3 для выполнения широкие возможности анимации, добавив переворачивающейся эффект после ответа на вопрос, и при получении следующий вопрос.

1. В **обозревателе решений**, щелкните правой кнопкой мыши **содержимого** папки **GeekQuiz** проект и выберите **добавить | Существующий элемент...** .

    ![Добавление существующего элемента в папку содержимого](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image22.png "Добавление существующего элемента в папку содержимого")

    *Добавление существующего элемента в папку содержимого*
2. В **Добавление существующего элемента** диалоговом окне перейдите к **источника и средств** папку и выберите **Flip.css**. Нажмите кнопку **Добавить**.

    ![Добавление файла Flip.css из средств](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image23.png "добавления файла Flip.css из ресурсов")

    *Добавление файла Flip.css из ресурсов*
3. Откройте **Flip.css** файл был только что добавлен и проверьте его содержимое.
4. Найдите **отражение преобразования** комментарий. Стили меньше этого комментария используйте CSS **перспективы** и **rotateY** преобразований для создания &quot;карт отразить&quot; эффект.

    [!code-css[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample22.css)]
5. Найдите **скрыть задняя сторона области во время отразить** комментарий. Стили, расположенные ниже этого комментария скрывает в задней части лиц, если они видны средство просмотра, установив **невидимых видимость** свойств CSS для *скрытые*.

    [!code-css[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample23.css)]
6. Откройте **BundleConfig.cs** файла внутри **приложения\_запустить** папки и добавьте ссылку на **Flip.css** файла в **&quot;~/Content/css&quot;** стиль пакета

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample24.cs)]
7. Нажмите клавишу **F5** для запуска решений и вход с использованием учетных данных.
8. Ответ на вопрос, щелкнув один из вариантов. Обратите внимание переворачивающейся силу во время перехода между представлениями.

    ![Ответы на вопросы с эффектом переворачивающейся](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image24.png "ответить на вопрос с эффектом зеркало")

    *Ответ на вопрос с переворачивающейся эффект*
9. Нажмите кнопку **следующий вопрос** для извлечения на следующий вопрос. Переворачивающейся эффект должен появиться еще раз.

    ![Получение на следующий вопрос с эффектом переворачивающейся](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image25.png "получение на следующий вопрос с эффектом зеркало")

    *Получение на следующий вопрос с эффектом зеркало*

* * *

<a id="Summary"></a>
## <a name="summary"></a>Сводка

Выполнив этой практической вы узнали, как:

- Создание контроллера веб-API ASP.NET с помощью формирования шаблонов ASP.NET
- Реализуйте действие получить Web API для извлечения следующий вопрос головоломки
- Реализация действия после Web API для хранения ответы на тест
- Установка AngularJS с помощью консоли диспетчера пакетов Visual Studio
- Реализуйте AngularJS шаблоны и контроллеры
- Использовать для выполнения эффектов анимации CSS3 переходов
