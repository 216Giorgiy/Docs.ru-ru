---
uid: web-api/overview/getting-started-with-aspnet-web-api/tutorial-your-first-web-api
title: "Приступая к работе с ASP.NET Web API 2 (C#)"
author: MikeWasson
description: "HTTP не только для предоставления веб-страниц. Это также мощную платформу для построения API, которые предоставляют службы и данных. Протокол HTTP является простой и гибкий и ubiq..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 11/28/2017
ms.topic: article
ms.technology: dotnet-webapi
ms.prod: .net-framework
msc.legacyurl: /web-api/overview/getting-started-with-aspnet-web-api/tutorial-your-first-web-api
msc.type: authoredcontent
ms.openlocfilehash: d881563cdb6449aada444ef0528061581113a925
ms.sourcegitcommit: 493a215355576cfa481773365de021bcf04bb9c7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2018
---
<a name="get-started-with-aspnet-web-api-2-c"></a>Приступая к работе с ASP.NET Web API 2 (C#)
====================
по [Mike Wasson](https://github.com/MikeWasson)

[Загрузка завершенного проекта](https://code.msdn.microsoft.com/Sample-code-of-Getting-c56ccb28)

HTTP не только для предоставления веб-страниц. HTTP также представляет собой мощную платформу для построения API, которые предоставляют службы и данных. Протокол HTTP является простой, гибкий и повсеместно. Практически на любой платформе, можно представить имеет библиотеку HTTP, поэтому службы HTTP может достигать широкий спектр клиентов, включая браузеры мобильных устройств и Классические приложения.
 
Веб-API ASP.NET — это платформа для построения веб-API на основе .NET Framework. В этом учебнике используется ASP.NET Web API для создания веб-API, который возвращает список продуктов.

 
 ## <a name="software-versions-used-in-the-tutorial"></a>Версии программного обеспечения, используемая в этом учебнике
  
 - [Visual Studio 2017](https://www.visualstudio.com/downloads/)
 - Веб-API 2

В разделе [создать веб-API ASP.NET Core и Visual Studio для Windows](https://docs.microsoft.com/aspnet/core/tutorials/first-web-api) для более новой версии этого учебника.

## <a name="create-a-web-api-project"></a>Создайте проект веб-API

В этом учебнике используется ASP.NET Web API для создания веб-API, который возвращает список продуктов. Интерфейсный веб-страница использует jQuery для отображения результатов.

![](tutorial-your-first-web-api/_static/image1.png)

Запустите Visual Studio и выберите **новый проект** из **запустить** страницы. Или из **файл** последовательно выберите пункты **New** и затем **проекта**.

В **шаблоны** выберите **установленные шаблоны** и разверните **Visual C#** узла. В разделе **Visual C#**выберите **Web**. В списке шаблонов проектов выберите **веб-приложение ASP.NET**. Назовите проект «ProductsApp» и нажмите кнопку **ОК**.

![](tutorial-your-first-web-api/_static/image2.png)

В **новый проект ASP.NET** диалогового окна выберите **пустой** шаблона. В разделе &quot;добавить папки и основные ссылки для&quot;, проверьте **веб-API**. Нажмите кнопку **ОК**.

![](tutorial-your-first-web-api/_static/image3.png)

> [!NOTE]
> Можно также создать проект веб-API с помощью &quot;веб-API&quot; шаблона. Шаблон веб-API ASP.NET MVC использует для предоставления API страницы справки. Я использую пустого шаблона в этом учебнике, так как требуется для отображения веб-API без MVC. В общем случае не нужно знать ASP.NET MVC для использования веб-API.


## <a name="adding-a-model"></a>Добавление модели

*Модель* — это объект, представляющий данные в приложении. Веб-API ASP.NET можно Автоматическая сериализация модели в JSON, XML или другой формат и создайте сериализованные данные в текст сообщения HTTP-ответа. При условии, что клиент может прочитать формат сериализации, может выполнить десериализацию объекта. Большинство клиентов может выполнить синтаксический анализ XML или JSON. Кроме того клиент может указать, какой формат ему, задав для заголовка Accept в сообщение HTTP-запроса.

Давайте начнем с создания простой модели, представляет продукт.

Если обозреватель решений не отображается, нажмите кнопку **представление** и выбрать пункт **обозревателе решений**. В обозревателе решений щелкните правой кнопкой мыши папку модели. В контекстном меню выберите **добавить** выберите **класса**.

![](tutorial-your-first-web-api/_static/image4.png)

Имя класса &quot;продукта&quot;. Добавьте следующие свойства для `Product` класса.

[!code-csharp[Main](tutorial-your-first-web-api/samples/sample1.cs)]

## <a name="adding-a-controller"></a>Добавление контроллера

В веб-API *контроллера* — это объект, который обрабатывает HTTP-запросы. Будет добавлен контроллер, который может возвращать список продуктов и один продукт с указанным идентификатором.

> [!NOTE]
> При использовании ASP.NET MVC, вы уже знакомы с контроллерами. Контроллеры веб-API аналогичны контроллеров MVC, но наследуют **ApiController** вместо класса **контроллера** класса.

В **обозревателе решений**, щелкните правой кнопкой мыши папку Controllers. Выберите **добавить** , а затем выберите **контроллера**.

![](tutorial-your-first-web-api/_static/image5.png)

В **Добавление формирования шаблонов** диалогового окна выберите **контроллер Web API - пустой**. Нажмите кнопку **Добавить**.

![](tutorial-your-first-web-api/_static/image6.png)

В **добавления контроллера** диалога, имя контроллера &quot;ProductsController&quot;. Нажмите кнопку **Добавить**.

![](tutorial-your-first-web-api/_static/image7.png)

Формирование шаблонов создает файл с именем ProductsController.cs в папке Controllers находится.

![](tutorial-your-first-web-api/_static/image8.png)

> [!NOTE]
> Не нужно поместить в папку с именем контроллеров контроллеров. Имя папки является лишь удобным способом для организации исходные файлы.


Если этот файл уже не открыт, дважды щелкните файл, чтобы открыть его. Замените код в этот файл следующее:

[!code-csharp[Main](tutorial-your-first-web-api/samples/sample2.cs)]

Для простоты, продукты, хранятся в массив фиксированной длины внутри класса контроллера. Конечно в реальном приложении будет запросов к базе данных или использование другого источника внешних данных.

Контроллер определяет два метода, которые возвращают продуктов:

- `GetAllProducts` Метод возвращает весь список продуктов, как **IEnumerable&lt;продукта&gt;**  типа.
- `GetProduct` Метод выполняет поиск одного продукта по его идентификатору.

Вот и все! У вас есть рабочий веб-API. Каждый метод в контроллере соответствует один или несколько URI-адресам:

| Метод контроллера | URI |
| --- | --- |
| GetAllProducts | / api/продуктов |
| GetProduct | /api/products/*id* |

Для `GetProduct` метода *идентификатор* в URI — это. Например, чтобы получить продукта с Идентификатором 5, URI имеет следующий вид `api/products/5`.

Дополнительные сведения о том, как веб-API направляет HTTP-запросов в методы контроллера см. в разделе [маршрутизации в ASP.NET Web API](../web-api-routing-and-actions/routing-in-aspnet-web-api.md).

## <a name="calling-the-web-api-with-javascript-and-jquery"></a>Вызов веб-API с помощью Javascript и jQuery

В этом разделе мы добавим HTML-страницы, использующего технологию AJAX для вызова веб-API. Мы будем использовать jQuery выполнять вызовы AJAX, так и для обновления страницы с результатами.

В обозревателе решений щелкните правой кнопкой мыши проект и выберите **добавить**, а затем выберите **новый элемент**.

![](tutorial-your-first-web-api/_static/image9.png)

В **Добавление нового элемента** диалогового окна выберите **Web** узле **Visual C#**и выберите **HTML-страницу** элемента. Назовите страницу &quot;index.html&quot;.

![](tutorial-your-first-web-api/_static/image10.png)

Замените все содержимое этого файла следующим кодом:

[!code-html[Main](tutorial-your-first-web-api/samples/sample3.html)]

Существует несколько способов получить jQuery. В этом примере используется [сети Microsoft Ajax CDN](../../../ajax/cdn/overview.md). Можно также загрузить его из [ http://jquery.com/ ](http://jquery.com/)и ASP.NET «Веб-API» шаблон проекта включает также jQuery.

### <a name="getting-a-list-of-products"></a>Получение списка продуктов

Чтобы получить список продуктов, отправить запрос HTTP GET для &quot;/api/продуктов&quot;.

JQuery [getJSON](http://api.jquery.com/jQuery.getJSON/) функция посылает запрос AJAX. Ответ содержит массив объектов JSON. `done` Функция задает обратный вызов, который вызывается, если запрос выполнен успешно. В обратный вызов мы обновлении DOM с сведения о продукте.

[!code-html[Main](tutorial-your-first-web-api/samples/sample4.html)]

### <a name="getting-a-product-by-id"></a>Получение продукта по Идентификатору

Для получения продуктов по Идентификатору, отправьте запрос HTTP GET для &quot;/api/продукты/*идентификатор*&quot;, где *идентификатор* идентификатор продукта.

[!code-javascript[Main](tutorial-your-first-web-api/samples/sample5.js)]

По-прежнему вызвать `getJSON` для отправки запроса AJAX, но на этот раз мы поместили идентификатор URI запроса. Ответ на этот запрос является JSON-представление за единицу продукта.

## <a name="running-the-application"></a>Запуск приложения

Нажмите клавишу F5, чтобы запустить отладку приложения. Веб-страница должна выглядеть следующим образом:

![](tutorial-your-first-web-api/_static/image11.png)

Чтобы получить продукта по Идентификатору, введите код и нажмите кнопку поиска:

![](tutorial-your-first-web-api/_static/image12.png)

Если введен недопустимый идентификатор, сервер возвращает ошибку HTTP:

![](tutorial-your-first-web-api/_static/image13.png)

## <a name="using-f12-to-view-the-http-request-and-response"></a>С помощью клавиши F12 для просмотра HTTP-запроса и ответа

При работе службы HTTP может быть очень удобны для сообщений запросов и разделе HTTP-запроса. Это можно сделать с помощью средств разработчика F12 в Internet Explorer 9. Internet Explorer 9, нажмите **F12** чтобы открыть средства. Нажмите кнопку **сети** вкладку и нажмите клавишу **начать захват**. Теперь вернитесь на веб-страницы и нажмите клавишу **F5** перезагрузить веб-странице. Internet Explorer захватывает HTTP-трафика между браузером и веб-сервера. Представление "Сводка" показывает весь сетевой трафик для страницы:

![](tutorial-your-first-web-api/_static/image14.png)

Найдите запись для относительного URI «api/продукты /». Выберите эту запись и нажмите кнопку **перейдите в подробном представлении**. В представлении «Подробности» есть вкладки, чтобы просмотреть запрос и ответ заголовки и текст. Например, если щелкнуть **заголовки запроса** вкладку, можно увидеть, что клиент запросил &quot;приложение/json&quot; в заголовке Accept.

![](tutorial-your-first-web-api/_static/image15.png)

Если щелкнуть вкладку текст ответа, вы увидите, как список продуктов был сериализован в JSON. Другие браузеры имеют одинаковые функции. Другим полезным средством является [Fiddler](http://www.fiddler2.com/fiddler2/), прокси-сервером отладки веб-узла. Можно использовать Fiddler для просмотра трафика HTTP, а также для создания запросов HTTP, которая предоставляет полный контроль над заголовков HTTP в запросе.

## <a name="see-this-app-running-on-azure"></a>Это приложение, работающее на платформе Azure см.

Вы действительно хотите см. по завершении узел, работающий как динамические веб-приложения? Можно развернуть полную версию приложения для учетной записи Azure, просто нажав кнопку ниже.

[![](http://azuredeploy.net/deploybutton.png)](https://deploy.azure.com/?WT.mc_id=deploy_azure_aspnet&repository=https://github.com/tfitzmac/WebAPI-ProductsApp#/form/setup)

Требуется учетная запись Azure для развертывания этого решения в Azure. Если у вас еще нет учетной записи, у вас есть следующие параметры:

- [Открыть учетную запись Azure бесплатно](https://azure.microsoft.com/pricing/free-trial/?WT.mc_id=A443DD604) -вы получаете кредиты можно использовать, чтобы испытать оплаты служб Azure и даже после того, они используются до можно хранить учетной записи, и используйте освободить служб Azure.
- [Активировать преимущества для подписчиков MSDN](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/?WT.mc_id=A443DD604) -подписка Your MSDN дает кредиты каждого месяца, можно использовать для оплаты служб Azure.

## <a name="next-steps"></a>Следующие шаги

- Более полный пример службы HTTP, который поддерживает такие действия, POST, PUT и DELETE и записывает в базе данных см. в разделе [с помощью веб-API 2 с Entity Framework 6](../data/using-web-api-with-entity-framework/part-1.md).
- Дополнительные сведения о создании гибкость и отвечать на запросы веб-приложений на основе службы HTTP см. в разделе [одностраничного приложения ASP.NET](../../../single-page-application/index.md).
- Сведения о развертывании веб-проекта Visual Studio для службы приложений Azure см. в разделе [создать веб-приложение ASP.NET в службе приложений Azure](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-get-started/).
