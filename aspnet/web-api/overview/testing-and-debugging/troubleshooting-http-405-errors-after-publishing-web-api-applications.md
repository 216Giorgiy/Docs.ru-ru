---
uid: web-api/overview/testing-and-debugging/troubleshooting-http-405-errors-after-publishing-web-api-applications
title: Устранение неполадок HTTP 405 ошибок после публикации веб-API 2 приложений | Документы Microsoft
author: rmcmurray
description: Этот учебник описывает устранение ошибок HTTP 405 после публикации приложения веб-API рабочий веб-сервер.
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/01/2014
ms.topic: article
ms.assetid: 07ec7d37-023f-43ea-b471-60b08ce338f7
ms.technology: dotnet-webapi
ms.prod: .net-framework
msc.legacyurl: /web-api/overview/testing-and-debugging/troubleshooting-http-405-errors-after-publishing-web-api-applications
msc.type: authoredcontent
ms.openlocfilehash: b87ae7420e1295030e90c30e97b1e331413ce263
ms.sourcegitcommit: f1436107b4c022b26f5235dddef103cec5aa6bff
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/15/2017
---
<a name="troubleshooting-http-405-errors-after-publishing-web-api-2-applications"></a>Устранение неполадок HTTP 405 ошибок после публикации веб-API 2 приложений
====================
по [Robert McMurray](https://github.com/rmcmurray)

> Этот учебник описывает устранение ошибок HTTP 405 после публикации приложения веб-API рабочий веб-сервер.
> 
> ## <a name="software-versions-used-in-the-tutorial"></a>Версии программного обеспечения, используемая в этом учебнике
> 
> 
> - [Internet Information Services (IIS)](https://www.iis.net/) (версии 7 или более поздней версии)
> - [Веб-API](../../index.md) (версии 1 или 2)


Веб-API приложения обычно используют несколько общих команд HTTP: GET, POST, PUT, DELETE, а иногда и ИСПРАВЛЕНИЯ. Таким образом, который разработчики запускаются в ситуациях, где эти глаголов реализуются другой модуль IIS на их рабочий сервер, который ведет к ситуации, где будет возвращать контроллер веб-API, который правильно работает в Visual Studio или на сервере разработки HTTP 405 ошибки при развертывании на рабочем сервере. К счастью легко устранена проблема, но гарантирует, что разрешение объяснение причины возникновения проблемы.

## <a name="what-causes-http-405-errors"></a>Какие HTTP 405 причины ошибки

Первым шагом к изучение Устранение ошибок HTTP 405 — понять, что фактически означает ошибку HTTP 405. Основной регулирующих документов для HTTP [RFC 2616](http://www.ietf.org/rfc/rfc2616.txt), который определяет код состояния HTTP 405 как ***метод запрещен***и более подробно этот код состояния, как состояние где &quot;метод указанный в строке запроса запрещено для ресурса, указанного в URI запроса.&quot; Другими словами HTTP-команда не допускается для конкретного URL-адреса, запрошенную HTTP-клиента.

Как краткий обзор ниже приведены некоторые из наиболее часто используемые методы HTTP, определен в RFC 2616, RFC 4918 и RFC 5789.

| Метод HTTP | Описание |
| --- | --- |
| **ПОЛУЧИТЬ** | Этот метод используется для извлечения данных из URI и он, вероятно, наиболее часто используемые метод HTTP. |
| **HEAD** | Этот метод является очень похоже на метод GET, за исключением того, что он не получать фактически не данные от URI запроса — он просто возвращает код состояния HTTP. |
| **ПОМЕСТИТЬ** | Этот метод обычно используется для отправки данных на новый универсальный код Ресурса; POST часто используется для отправки данных формы. |
| **PUT** | Этот метод обычно используется для отправки необработанные данные универсальный код Ресурса; PUT часто используется для отправки данных JSON или XML в приложениях Web API. |
| **УДАЛИТЬ** | Этот метод используется для удаления данных с помощью URI. |
| **ПАРАМЕТРЫ** | Этот метод обычно используется для получения списка HTTP-методов, которые поддерживаются для URI. |
| **КОПИРОВАНИЕ ПЕРЕМЕЩЕНИЕ** | Эти методы используются с WebDAV и их назначение описательные имена. |
| **MKCOL** | Этот метод используется с WebDAV и используется для создания коллекции (например, каталог) по указанному URI. |
| **PROPFIND PROPPATCH** | Эти методы используются с WebDAV, и они используются для запроса и задать свойства для URI. |
| **РАЗБЛОКИРОВАТЬ БЛОКИРОВКИ** | Эти методы используются с WebDAV, и они используются, чтобы заблокировать или разблокировать ресурс, указанный URI запроса при создании. |
| **ИСПРАВЛЕНИЕ** | Этот метод используется для изменения существующего ресурса HTTP. |

Если один из этих методов HTTP настроено для использования на сервере, сервер будет отвечать с состояния HTTP и других данных, которая подходит для запроса. (Например, метод GET может получать HTTP 200 ***ОК*** ответа, а также метод PUT может получать HTTP 201 ***Created*** ответа.)

Если метод HTTP не настроен для использования на сервере, сервер отвечает с HTTP 501 ***не реализован*** ошибки.

Тем не менее, когда метод HTTP будет настроен для использования на сервере, но оно было отключено для заданного URI, сервер отвечает с HTTP 405 ***метод запрещен*** ошибки.

## <a name="example-http-405-error"></a>Пример HTTP 405 ошибки

Следующий пример HTTP-запрос и ответ показаны ситуации, где HTTP-клиент пытается ПОМЕСТИТЬ значение в веб-API приложение на веб-сервере, а сервер возвращает ошибку HTTP, что состояния, которые метод PUT не допускается.


HTTP-запроса:


[!code-console[Main](troubleshooting-http-405-errors-after-publishing-web-api-applications/samples/sample1.cmd)]


HTTP-ответа:


[!code-console[Main](troubleshooting-http-405-errors-after-publishing-web-api-applications/samples/sample2.cmd)]


В этом примере HTTP-клиент отправил запрос JSON допустимый URL-адрес для веб-API приложения на веб-сервере, но сервер вернул сообщение об ошибке HTTP 405, которое указывает, что метод PUT не была разрешена для URL-адрес. Напротив, если URI запроса не соответствует маршрутов для приложения веб-API, сервер вернет ошибку HTTP 404 ***не удалось найти*** ошибки.

## <a name="resolving-http-405-errors"></a>Разрешение HTTP 405 ошибок

Существует несколько причин, почему определенные HTTP-команда может оказаться невозможным, но есть основной скрипт, начальные причина этой ошибки в службах IIS: несколько обработчиков определенные для одной команды или метода, и один из обработчиков блокирует ожидаемый обработчик из Обработка запроса. Посредством объяснение IIS обрабатывает обработчики от первой к последней на основе порядка обработчик операций в файлах applicationHost.config и web.config, где первое сочетание соответствующий путь, команда, ресурсов, т. д., будет использоваться для обработки запроса.

Следующий пример является фрагментом кода из файла applicationHost.config по использованию IIS server, который возвращает ошибку HTTP 405, при использовании метода PUT для отправки данных в приложении веб-API. В данном отрывке определены несколько обработчиков HTTP и каждый обработчик имеет другой набор методов HTTP, для которых настроен — последний элемент в списке обработчику статического содержимого, который является обработчиком по умолчанию, используемый, после которых chanc другие обработчики e, запрос на:

[!code-xml[Main](troubleshooting-http-405-errors-after-publishing-web-api-applications/samples/sample3.xml)]

В приведенном выше примере обработчик WebDAV и обработчик URL-адресов без расширений для ASP.NET (который используется для веб-API) четко определены для отдельных списков HTTP-методов. Обратите внимание, что обработчик ISAPI DLL настроена для всех методов HTTP, несмотря на то, что эта конфигурация не обязательно вызывает ошибку. Тем не менее параметры конфигурации, такие как это необходимо рассматривать при диагностике ошибок HTTP 405.

В приведенном выше примере обработчик ISAPI DLL не был проблемы; на самом деле проблема не был определен в файле applicationHost.config для сервера IIS — проблема вызвана записи, внесенные в файл web.config веб-API приложения, созданные в Visual Studio. В следующем фрагменте из файла web.config приложения представлен источника проблемы:

[!code-xml[Main](troubleshooting-http-405-errors-after-publishing-web-api-applications/samples/sample4.xml)]

В данном отрывке обработчик URL-адресов без расширений для ASP.NET переопределена для включения дополнительных методов HTTP, которые будут использоваться в приложении веб-API. Тем не менее поскольку для обработчика WebDAV определен такой же набор методов HTTP, то возникает конфликт. В этом конкретном случае обработчик WebDAV определен и загружен службами IIS, несмотря на то, что WebDAV отключен для веб-сайта, которая включает веб-API приложения. Во время обработки запроса HTTP PUT, IIS вызывает модуль WebDAV, так как он определен для команды PUT. При вызове модуля WebDAV, он проверяет свою конфигурацию и видит, что она отключена, так что она возвращает HTTP 405 ***метод запрещен*** ошибку для любого запроса, который напоминает запрос WebDAV. Чтобы устранить эту проблему, следует удалить WebDAV из списка модулей HTTP для веб-сайта, где определен веб-API приложения. В следующем примере показано, что, может выглядеть следующим образом:

[!code-xml[Main](troubleshooting-http-405-errors-after-publishing-web-api-applications/samples/sample5.xml)]

Этот сценарий часто встречающихся после публикации приложения из среды разработки в производственную среду, и это происходит потому, что список обработчиков и модулей, отличается от среды разработки и эксплуатации. Например если вы используете Visual Studio 2012 или 2013 разработки приложений веб-API, IIS Express 8 является стандартного веб-сервера для проверки. Этого веб-сервера разработки является упрощенной версией все функции IIS, входящий в серверный продукт, и этот веб-сервер разработки содержит несколько изменений, которые были добавлены для сценариев разработки. Например модуль WebDAV часто устанавливается на рабочий веб-сервер, на котором работает IIS, полную версию, несмотря на то, что он не может быть при фактическом использовании. Версию IIS (IIS Express), будет установлен модуль WebDAV, но записей для модуля WebDAV намеренно закомментированы, чтобы модуль WebDAV никогда не был загружен на сервер IIS Express, если конфигурации IIS Express параметры, чтобы добавить функциональными возможностями WebDAV в установку IIS Express. В результате веб-приложение может работать должным образом на компьютере разработчика, но могут возникнуть ошибки HTTP 405, при публикации веб-API приложения на веб-сервер в рабочей среде.

## <a name="summary"></a>Сводка

HTTP 405 ошибки возникают в том случае, если метод HTTP не разрешен веб-сервером для запрошенного URL-адреса. Эта проблема часто возникает при определенной обработчик был определен для определенной команды, и этот обработчик переопределяет обработчик, который предполагается, что для обработки запроса.

Если вы попадать в ситуацию, в которой появляется сообщение об ошибке HTTP 501, это означает, что конкретные функции не выполнена на сервере, это часто означает, что нет обработчика, заданных в параметрах IIS, которая согласуется с HTTP-запроса, который Указывает, возможно, что-то не был правильно установлен в системе, или что-то изменил параметры IIS таким образом, нет обработчиков определенный метод, поддержки конкретных HTTP. Разрешить эту проблему, потребуется переустановить любое приложение, которое пытается использовать метод HTTP, для которого он не имеет соответствующего модуля и определений обработчика.
