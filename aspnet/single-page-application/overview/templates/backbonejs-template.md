---
uid: single-page-application/overview/templates/backbonejs-template
title: "Шаблон магистрали | Документы Microsoft"
author: madskristensen
description: "Шаблон SPA Backbone.js"
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/04/2013
ms.topic: article
ms.assetid: 00aca413-f067-4108-9bd1-cf21e64a2646
ms.technology: 
ms.prod: .net-framework
msc.legacyurl: /single-page-application/overview/templates/backbonejs-template
msc.type: authoredcontent
ms.openlocfilehash: 3b8eabd3cefcb96dc40bbf6cc6e3ee81accb0d7c
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="backbone-template"></a>Шаблон магистрали
====================
по [Мэдс Kristensen](https://github.com/madskristensen)

> Шаблон SPA магистрали было написано с Кази Манзур Рашид
> 
> [Загрузите шаблон SPA Backbone.js](https://go.microsoft.com/fwlink/?LinkId=293631)


Шаблон Backbone.js SPA предназначен для начала работы быстрого создания интерактивные клиентские веб-приложений с помощью [Backbone.js.](http://backbonejs.org/)

Шаблон предоставляет начальной основу для разработки приложения Backbone.js в ASP.NET MVC. Без дополнительной настройки. Эта функциональная базового пользовательского имени входа, включая сброс пароля регистрации, входе в систему пользователя и подтверждения пользователя с помощью шаблонов базовых сообщений электронной почты.

Требования:

- [Обновления ASP.NET и 2012.2 средства Web](https://go.microsoft.com/fwlink/?LinkId=282650)

## <a name="create-a-backbone-template-project"></a>Создание проекта шаблона магистрали

Загрузите и установите шаблон, нажав кнопку «Загрузить» выше. Шаблон упаковывается в виде файла расширения Visual Studio (VSIX). Может потребоваться перезапустить Visual Studio.

В **шаблоны** выберите **установленные шаблоны** и разверните **Visual C#** узла. В разделе **Visual C#**выберите **Web**. В списке шаблонов проектов выберите **веб-приложение ASP.NET MVC 4**. Имя проекта и нажмите кнопку **ОК**.

![](backbonejs-template/_static/image1.png)

В **новый проект** мастера, выберите проект Backbone.js SPA.

![](backbonejs-template/_static/image2.png)

Нажмите Ctrl + F5, чтобы построить и запустить приложение без отладки, или нажмите клавишу F5 для запуска без отладки.

![](backbonejs-template/_static/image3.png)

Нажав кнопку «Моя учетная запись» появится страница входа:

![](backbonejs-template/_static/image4.png)

## <a name="walkthrough-client-code"></a>Пошаговое руководство: Код клиента

Давайте начинается со стороны клиента. Клиентские скрипты приложения находятся в папке ~/Scripts/application. Приложение создано [TypeScript](http://www.typescriptlang.org/) (TS-файлы) которые компилируются в код JavaScript (JS-файлов).

**Приложение**

`Application`определено в application.ts. Этот объект Инициализирует приложение и выступает в качестве корневого пространства имен. Хранит сведения о конфигурации и состоянии, общего для нескольких приложений, например, является ли пользователь выполнил вход.

`application.start` Метод создает модальные представления и присоединяет обработчики событий к событиям уровня приложения, например вход пользователя. Затем он создает маршрутизатора по умолчанию и проверяет, задано ли URL-адрес любого клиентского. Если нет, он перенаправляет на url-адрес по умолчанию (#! /).

**События**

События всегда являются важными при разработке слабо связанные компоненты. Приложения часто выполняют несколько операций в ответ на действия пользователя. Магистрали предоставляет встроенные события с компонентами, такими как модель, коллекции и представления. Вместо создания взаимозависимости между этими компонентами, шаблон использует модель «pub/sub»: `events` объект, определенный в events.ts, выступает в качестве концентратора событий для публикации и подписки на события приложения. `events` Объект является Singleton-классом. Следующий код показывает, как подписаться на событие и последующего инициирования события:

[!code-csharp[Main](backbonejs-template/samples/sample1.cs)]

**Маршрутизатор**

В Backbone.js маршрутизатор предоставляет методы для маршрутизации страницы на стороне клиента и подключить их к действия и события. Шаблон определяет одним маршрутизатором в router.ts. Маршрутизатор создает activable представления и сохраняет состояние при переключении представлений. (В следующем разделе описываются представления activable.) Первоначально проект имеет два представления фиктивный, дома и об. Она также содержит представления не найдено, который отображается, если маршрут не известен.

**Представления**

Представления определяются в ~/Scripts/application и представления. Существует два вида представления activable и представления модальное диалоговое окно. Activable представления вызываются маршрутизатором. При отображении activable представление всех представлений activable становятся неактивными. Создание представления activable, расширить представление с `Activable` объекта:

[!code-javascript[Main](backbonejs-template/samples/sample2.js)]

Расширение с помощью `Activable` добавляет два новых метода в представление `activate` и `deactivate`. Маршрутизатор вызывает эти методы для активации и отключить представления.

Модальные представления реализуются как [Twitter начальной загрузки](http://twitter.github.com/bootstrap/) модальные диалоговые окна. `Membership` И `Profile` представления являются модальным. Модель представления может быть вызвана любые события приложения. Например, в `Navigation` показано представление, щелкнув ссылку «Моя учетная запись», либо `Membership` представление или `Profile` представление, в зависимости от того, вошел ли пользователь. `Navigation` Присоединяет обработчики событий для всех дочерних элементов, имеющих click `data-command` атрибута. Вот HTML-разметка.

[!code-html[Main](backbonejs-template/samples/sample3.html)]

Ниже приведен код в navigation.ts для подключения событий:

[!code-csharp[Main](backbonejs-template/samples/sample4.cs)]

**Модели**

Модели определяются в ~/Scripts/application и моделей. Все модели имеют три основных действия: атрибуты по умолчанию, правила проверки и конечная точка стороне сервера. Ниже приведен типичный пример:

[!code-javascript[Main](backbonejs-template/samples/sample5.js)]

**Подключаемые модули**

Папка ~/Scripts/application/lib содержит несколько подключаемых модулей под рукой jQuery. В файле form.ts определяется подключаемый модуль для работы с данными в форме. Часто требуется для сериализации или десериализации данных формы и отображения ошибок проверки модели. Подключаемый модуль form.ts содержит методы, такие как `serializeFields`, `deserializeFields`, и `showFieldErrors`. Приведенный ниже показано, как сериализовать форму в модель.

[!code-javascript[Main](backbonejs-template/samples/sample6.js)]

Подключаемый модуль flashbar.ts предоставляет различные виды сообщений обратной связи пользователю. Методы, `$.showSuccessbar`, `$.showErrorbar` и `$.showInfobar`. В фоновом оповещения Twitter начальной загрузки используется для отображения хорошо анимированных сообщений.

Подключаемый модуль confirm.ts заменяет браузера подтверждения, несмотря на то, что API немного отличаются:

[!code-javascript[Main](backbonejs-template/samples/sample7.js)]

## <a name="walkthrough-server-code"></a>Пошаговое руководство: Серверного кода

Теперь давайте взглянем на стороне сервера.

**Контроллеры**

В приложение на одной странице серверов состоит лишь малую роль в пользовательском интерфейсе. Как правило сервер отображает начальную страницу и затем отправляет и получает данные JSON.

Шаблон имеет двух контроллеров MVC: `HomeController` подготавливает к просмотру начальной страницы и `SupportsController` используется для подтверждения новых учетных записей пользователей и сброс паролей. Все остальные контроллеры в шаблоне являются контроллерами веб-API ASP.NET, отправляющие и получающие данные JSON. По умолчанию контроллеры используют новый `WebSecurity` класса для выполнения задач, связанных с пользователем. Тем не менее они также имеют дополнительные конструкторы, которые позволяют передавать в делегаты для выполнения следующих задач. Это упрощает тестирование и позволяет заменить `WebSecurity` по-другому, используя контейнер IoC. Пример:

[!code-csharp[Main](backbonejs-template/samples/sample8.cs)]

## <a name="views"></a>Представления

Представления предназначены для модульной: каждый раздел страницы имеет свой собственный выделенный представление. В приложение на одной странице вполне включить представления, у которых нет любого соответствующего контроллера. Представления можно включить путем вызова `@Html.Partial('myView')`, но получится утомительным. Чтобы облегчить эту задачу, шаблон определяет вспомогательный метод `IncludeClientViews`, которая визуализируется всех представлений в указанной папке:

[!code-cshtml[Main](backbonejs-template/samples/sample9.cshtml)]

Если имя папки не указан, по умолчанию папка называется «ClientViews». Если представление клиента также использует разделяемые представления, имя частичного представления со знака подчеркивания (например, `_SignUp`). `IncludeClientViews` Метод исключает все представления, имена которых начинаются со знака подчеркивания. Чтобы включить частичного представления в представлении клиента, вызовите `Html.ClientView('SignUp')` вместо `Html.Partial('_SignUp')`.

**Отправка электронной почты**

Для отправки электронной почты, в шаблоне используется [почтовой](http://aboutcode.net/postal). Однако абстрагируется от остальной части кода с помощью почтового индекса `IMailer` интерфейс, поэтому можно легко заменить ее другой реализации. Шаблонов сообщений электронной почты находятся в папке представления или сообщений электронной почты. Адрес электронной почты отправителя указан в файле web.config в `sender.email` ключ **appSettings** раздела. Кроме того, когда `debug="true"` в файле web.config, приложение не требует подтверждения электронной почты пользователя, для ускорения разработки.

## <a name="github"></a>GitHub

Можно также найти шаблон Backbone.js SPA на [GitHub](https://github.com/kazimanzurrashid/AspNetMvcBackboneJsSpa).
