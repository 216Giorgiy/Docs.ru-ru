---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/distributed-caching
title: Распределенное кэширование (Создание реальных облачных приложений в Azure) | Документы Microsoft
author: MikeWasson
description: Построение реального мира облачными приложениями с помощью Azure электронная книга основан на разработанный Скотт Гатри презентации. Объясняет, 13 шаблоны и рекомендации, которые он может...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/20/2015
ms.topic: article
ms.assetid: 406518e9-3817-49ce-8b90-e82bc461e2c0
ms.technology: ''
ms.prod: .net-framework
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/distributed-caching
msc.type: authoredcontent
ms.openlocfilehash: 3600200f9bb705ccf66c859547668bdf8e89d97a
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="distributed-caching-building-real-world-cloud-apps-with-azure"></a>Распределенного кэширования (Создание реальных облачных приложений в Azure)
====================
по [Mike Wasson](https://github.com/MikeWasson), [Рик Андерсон](https://github.com/Rick-Anderson), [Tom Dykstra](https://github.com/tdykstra)

[Загрузка решение проект](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) или [Загрузите электронную](http://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)

> **Построение реального мира облачными приложениями с помощью Azure** электронная книга основана на представления, разработанный Скотт Гатри. Объясняются 13 шаблоны и рекомендации, которые помогут вам быть успешной разработки веб-приложений для облака. Сведения об электронных книг см. в разделе [первой главы](introduction.md).


Предыдущей главе рассмотрены обработки временных сбоев и упомянутых кэширования в рамках стратегии Размыкатель цепи. В этой главе содержится Дополнительные сведения о кэшировании, а также условия использовать его, Общие шаблоны для использования и как реализовать ее в Azure.

## <a name="what-is-distributed-caching"></a>Что является распределенное кэширование

Кэш обеспечивает высокой пропускной способностью и малой задержкой доступа к данным приложения с наиболее часто используемыми, сохраняя данные в памяти. Для облачного приложения чаще тип кэша — распределенного кэша, поэтому данные не хранятся в памяти для отдельных веб сервера, но в других ресурсов облака и кэшированных данных становится доступным для всех веб-серверов приложения (или других облачных виртуальных машин, ar e используется приложением).

![Схема, показывающая нескольких веб-серверов, доступ к серверам же кэша](distributed-caching/_static/image1.png)

При масштабировании приложения, добавив или удалив серверы или серверы заменяются из-за обновлений или сбоев, кэшированные данные остаются доступными для каждого сервера, на котором выполняется приложение.

Рекомендуется избегать использования большая задержка доступа к данным хранилища постоянных данных, кэширование может существенно повысить скорость реагирования приложения. Например получение данных из кэша намного быстрее, чем их извлечения из реляционной базы данных.

Дополнительное преимущество от кэширования уменьшается трафик в постоянное хранилище данных, что может привести к снижению затрат при наличии исходящих данных расходов для хранения постоянных данных.

## <a name="when-to-use-distributed-caching"></a>Когда следует использовать распределенное кэширование

Кэширование будет работать наилучшим образом для рабочих нагрузок приложений которого осуществляется чтение более чем записывать данные и если модель данных поддерживает организации ключ значение, которая используется для хранения и извлечения данных в кэше. Он также полезные сведения, если пользователи приложения имеют много общих данных; например кэш не предоставляет столько преимущества Если каждого пользователя, как правило, получает данные, которые уникальны для каждого пользователя. Например, кэширование может быть очень полезными — это каталог товаров, так как данные изменяются редко, и все клиенты хотели бы на тех же данных.

Преимущества кэширования становится все более измеримое более масштабирует приложения, как ограничения пропускной способности и задержки задержка на постоянное хранилище данных становятся более ограничение на общую производительность приложения. Тем не менее можно реализовать кэширование по другим причинам, чем также производительности. Для данных, не должен быть полностью актуальные, когда пользователь видит доступа к кэшу могут служить для Размыкатель цепи при на постоянное хранилище данных не отвечает или недоступен.

## <a name="popular-cache-population-strategies"></a>Заполнение стратегии популярных кэша

Чтобы иметь возможность получения данных из кэша, необходимо сначала сохранить ее наличие. Существует несколько стратегий для получения данных, необходимых в кэш:

- По требованию / отдельно от кэша

    Приложение пытается получить данные из кэша, и если кэш не имеет данных («промах»), приложение сохраняет данные в кэше, чтобы она будет доступна при очередном. При очередном приложение пытается получить те же данные, он находит что следует искать в кэше («hit»). Чтобы предотвратить получение кэшированных данных, которые изменились в базе данных, кэш недействительным при внесении изменений в хранилище данных.
- Принудительная отправка данных в фоновом режиме

    Фоновые службы Принудительная отправка данных в кэше по регулярному расписанию и приложение всегда получает из кэша. Этот подход работает отлично с высокой задержкой источников данных, не требующие всегда возвращают самые последние данные.
- Размыкатель цепи

    Приложение нормально взаимодействует непосредственно с на постоянное хранилище данных, но если проблем с доступностью на постоянное хранилище данных, приложение извлекает данные из кэша. Данные могли быть помещены в кэш с помощью принудительной стратегии фона данных или выделить кэша. Это является ошибкой обработки стратегии, а не стратегии повышению производительности.

Чтобы регулярное обновление данных в кэше, когда приложение создает обновлений, или удаляет данные связанных записей можно будет удалить. Если это нормально для вашего приложения для получения данных, немного устаревшая иногда можно положиться на можно настроить срок для установки ограничения на как старый кэш данных может быть.

Можно настроить абсолютный срок действия (количество времени с момента создания элемента кэша) или скользящий срок действия (количество времени со времени последнего обращения к элемента кэша). Абсолютный срок действия используется в том случае, если находятся в зависимости от механизма истечение срока действия кэша для предотвращения возникновения слишком устаревшие данные. В ее исправить приложение мы будем вручную удалить старый кэш элементы, и мы будем использовать скользящий срок действия для хранения текущих данных в кэше. Независимо от выбранного это политика срока кэша автоматически исключите самые старые элементы (как минимум недавно использованные или LRU), при достижении предела памяти кэша.

## <a name="sample-cache-aside-code-for-fix-it-app"></a>Пример кода отдельно от кэша для приложения ее исправить

В следующем примере кода мы проверяем кэша сначала при извлечении задачи ее исправить. Если задача находится в кэше, мы возвращаем Если объект не найден, мы получить его из базы данных и их сохранения в кэше. Изменения сделают Добавление кэширования `FindTaskByIdAsync` метод выделяются.

[!code-csharp[Main](distributed-caching/samples/sample1.cs?highlight=5,9-11,13-15,19)]

При обновлении или удалении задачи ее исправить необходимо сделать недействительным задача кэшированные (удаления). В противном случае будущее пытается считать, что задача будет продолжать получать старые данные из кэша.

[!code-csharp[Main](distributed-caching/samples/sample2.cs?highlight=7)]

Ниже приведены образцы, демонстрирующие простого кэширования кода; кэширование не был реализован в загружаемый проект ее исправить.

## <a name="azure-caching-services"></a>Службы кэширования Azure

Azure предлагает следующие службы кэширования: [кэш Azure Redis](https://msdn.microsoft.com/library/dn690523.aspx) и [управляемого кэша Azure](https://msdn.microsoft.com/library/dn386094.aspx). Кэш Azure Redis, основано на популярном [с открытым кодом кэша Redis](http://redis.io/) и кэширование является предпочтительным вариантом для большинства сценариев.

<a id="sessionstate"></a>
## <a name="aspnet-session-state-using-a-cache-provider"></a>Состояние сеанса ASP.NET с помощью поставщика кэша

Как упоминалось в [web разработки лучшие рекомендации главе](web-development-best-practices.md), рекомендуется избегать использования состояния сеанса. Если приложению требуется состояние сеанса, Далее рекомендуется избежать поставщика в памяти по умолчанию, поскольку не обеспечивают масштабирование (несколько экземпляров веб-сервера). Поставщик состояния сеанса ASP.NET SQL Server включает сайту, который выполняется на нескольких веб-серверов для использования состояния сеанса, но он приводит к затратам высокой задержкой, по сравнению с поставщиком данных в памяти. Если необходимо использовать состояние сеанса лучше использовать поставщик кэша, такие как [поставщика состояний сеансов для кэша Azure](https://msdn.microsoft.com/library/windowsazure/gg185668.aspx).

## <a name="summary"></a>Сводка

Было показано, как приложение исправить может реализовать кэширование позволяет улучшить время отклика и масштабируемость и предоставить приложению возможность продолжать отреагирует для операций чтения, когда база данных недоступна. В [следующей главе](queue-centric-work-pattern.md) мы покажем, как для дальнейшего повышения масштабируемости и сделать приложение продолжает реагировать для операций записи.

## <a name="resources"></a>Ресурсы

Дополнительные сведения о кэшировании см. следующие ресурсы.

Документация

- [Кэш Azure](https://msdn.microsoft.com/library/gg278356.aspx). Официальной документации MSDN о кэшировании в Azure.
- [Шаблоны и методики - руководство по Azure Майкрософт](https://msdn.microsoft.com/library/dn568099.aspx). См. руководство кэширование и шаблон отдельно от кэша.
- [Отказоустойчивость: Руководство по гибкой облачной архитектуре](https://msdn.microsoft.com/library/windowsazure/jj853352.aspx). Технический документ по Marc Mercuri, Ульрих Хоманн и Эндрю Таунхилл. В разделе на кэширование.
- [Советы и рекомендации по проектированию крупномасштабных служб в облачных службах Azure](https://msdn.microsoft.com/library/windowsazure/jj717232.aspx). W. Технический документ, Марк Симмс и Майкл Томасси. В разделе на распределенное кэширование.
- [Распределенное кэширование на путь к масштабируемости](https://msdn.microsoft.com/magazine/dd942840.aspx). Более старые статьи MSDN Magazine (2009 г.), но четко написанное введение в распределенное кэширование в целом; переходит в более подробно, чем кэширования разделы в безопасном и рекомендации для технических документах.

Видеоролики

- [Отказоустойчивость: Построение масштабируемых, надежных облачные службы](https://channel9.msdn.com/Series/FailSafe). Девять выпусков, Ульрих Хоманн, Marc Mercuri и Марк Симмс. Отображает представление уровня 400 процесс проектирования облачных приложений. Эта серия основное внимание уделяется теории и причин, почему; более подробные инструкции по см. в больших построение серии, Марк Симмс. В описании кэширования в серии 3, начиная с 1:24:14.
- [Построение Big: Уроках, извлеченных из клиентам Azure — часть I](https://channel9.msdn.com/Events/Build/2012/3-029). Simon Дэвис рассматриваются распределенного кэширования начиная с 46:00. Аналогично Безаварийность рядов, но переход в Дополнительные практические сведения. Представление было передано 31 октября 2012 г., он не распространяется на службы кэширования веб-приложений в службе приложений Azure, которая была введена в 2013.

Образец кода

- [Основы облачных служб в Azure](https://code.msdn.microsoft.com/Cloud-Service-Fundamentals-4ca72649). Образец приложения, который реализует распределенное кэширование. См. сопутствующие блога [Основы облачных служб — основы кэширование](https://blogs.msdn.com/b/windowsazure/archive/2013/10/03/cloud-service-fundamentals-caching-basics.aspx).

> [!div class="step-by-step"]
> [Назад](transient-fault-handling.md)
> [Вперед](queue-centric-work-pattern.md)
