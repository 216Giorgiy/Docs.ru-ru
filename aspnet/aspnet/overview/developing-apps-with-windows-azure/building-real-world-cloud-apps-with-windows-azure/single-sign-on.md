---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/single-sign-on
title: Единый вход (Создание реальных облачных приложений в Azure) | Документы Microsoft
author: MikeWasson
description: Построение реального мира облачными приложениями с помощью Azure электронная книга основан на разработанный Скотт Гатри презентации. Объясняет, 13 шаблоны и рекомендации, которые он может...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/12/2014
ms.topic: article
ms.assetid: 7d82d5e9-0619-4f22-9e03-32a6d52940a5
ms.technology: ''
ms.prod: .net-framework
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/single-sign-on
msc.type: authoredcontent
ms.openlocfilehash: 82f2f99154d94074b03d580a0f491053d6f53bde
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="single-sign-on-building-real-world-cloud-apps-with-azure"></a>Единый вход (Создание реальных облачных приложений в Azure)
====================
по [Mike Wasson](https://github.com/MikeWasson), [Рик Андерсон](https://github.com/Rick-Anderson), [Tom Dykstra](https://github.com/tdykstra)

[Загрузка решение проект](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) или [Загрузите электронную](http://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)

> **Построение реального мира облачными приложениями с помощью Azure** электронная книга основана на представления, разработанный Скотт Гатри. Объясняются 13 шаблоны и рекомендации, которые помогут вам быть успешной разработки веб-приложений для облака. Сведения об электронных книг см. в разделе [первой главы](introduction.md).


Существует много проблем безопасности, нужно принять во внимание при разработке приложения облака, но для этой серии мы сосредоточимся на несколько: единый вход. Люди вопрос часто уточните это: «основном создающему приложений для сотрудников компании; как разместить эти приложения в облаке и разрешить им использовать ту же модель безопасности, Мои сотрудники знать и использовать в локальной среде, когда они выполняются приложения, по-прежнему размещены за брандмауэром?» Одним из способов, мы можем добавить этот сценарий называется Azure Active Directory (Azure AD). Azure AD позволяет выполнять корпоративные бизнес приложения (LOB) доступны через Интернет, и позволяет внести эти приложения также бизнес-партнерами.

## <a name="introduction-to-azure-ad"></a>Введение в Azure AD

[Azure AD](https://docs.microsoft.com/azure/active-directory/) предоставляет [Active Directory](https://msdn.microsoft.com/library/windows/desktop/aa746492.aspx) в облаке. Ниже приведены основные функции:

- Она интегрируется с локальной Active Directory.
- Она позволяет единого входа вместе со своими приложениями.
- Он поддерживает открытых стандартах, таких как [SAML](http://en.wikipedia.org/wiki/SAML_2.0), [WS-Fed](http://en.wikipedia.org/wiki/WS-Federation), и [OAuth 2.0](http://oauth.net/2/).
- Он поддерживает Enterprise [Graph REST API](https://msdn.microsoft.com/library/hh974476.aspx).

Предположим, что у вас есть в локальную среду Windows Server Active Directory, который позволяет сотрудники могут входить в приложениях интрасети:

![](single-sign-on/_static/image1.png)

Azure AD позволяет выполнять является создайте каталог в облаке. Это бесплатная функция и легко настроить.

Может быть полностью независимым от вашей локальной Active Directory; можно поместить все, кто в его и проверку подлинности их в Интернет-приложений.

![Windows Azure Active Directory](single-sign-on/_static/image2.png)

Или его можно интегрировать с локальным AD.

![AD и WAAD интеграции](single-sign-on/_static/image3.png)

Теперь всех сотрудников, которые могут проходить проверку подлинности в локальной среде могут также проходить проверку подлинности в Интернете — без необходимости открывать брандмауэр или развертывание всех новых серверах в центре обработки данных. Можно продолжать пользоваться преимуществами все существующей среды Active Directory, известно, в настоящее время использует для предоставления единого входа к внутренним приложениям возможность.

После внесения этого подключения между AD и Azure AD, можно также включить веб-приложений и мобильных устройств для проверки подлинности ваших сотрудников в облаке и приложения сторонних производителей, таких как Office 365, SalesForce.com или Google apps для приема можно включить в учетные данные сотрудников. Если вы используете Office 365, уже настроек с помощью Azure AD, так как Office 365 использует Azure AD для проверки подлинности и авторизации.

![сторонние приложения](single-sign-on/_static/image4.png)

Преимущество этого подхода, каждый раз организации добавляет или удаляет пользователя, или пользователь изменяет пароль, использовать такой же процесс, используемых в настоящее время в локальной среде. Все из локальных AD изменения автоматически распространяются на облачной среде.

Если вашей компании с помощью или перемещения в Office 365, хорошо то, что у вас будет создан автоматически, так как Office 365 использует Azure AD для проверки подлинности Azure AD. Поэтому можно легко использовать в собственных приложениях же проверки подлинности, который использует Office 365.

## <a name="set-up-an-azure-ad-tenant"></a>Настройка клиента Azure AD

каталог Azure AD в Azure AD, называется [клиента](https://technet.microsoft.com/library/jj573650.aspx), и настройка клиента выполняется очень просто. Мы покажем, как это можно сделать на портале управления Azure для демонстрации основных принципов, но само собой подобно другим функциям портала можно также выполняется с помощью скрипта или API-Интерфейс управления.

На портале управления щелкните вкладку Active Directory.

![WAAD портала](single-sign-on/_static/image5.png)

Имеется один клиент Azure AD для учетной записи Azure автоматически, и можно щелкнуть **добавить** , расположенную в нижней части страницы, чтобы создать дополнительные каталоги. Может потребоваться одно для тестовой среды и одна для производства, например. Тщательно продумайте имя нового каталога. Если вы используете имя каталога и затем использовать свое имя еще раз для одного из пользователей, которые могут показаться сложными.

![Добавить каталог](single-sign-on/_static/image6.png)

Портал обеспечивает полную поддержку создание, удаление и управление пользователями в данной среде. Например, чтобы добавить пользователя перейдите на **пользователей** и нажмите кнопку **добавить пользователя** кнопки.

![Добавление кнопки пользователя](single-sign-on/_static/image7.png)

![Добавить пользовательское диалоговое окно](single-sign-on/_static/image8.png)

Можно создать нового пользователя, который существует только в этом каталоге или учетной записью Майкрософт может зарегистрировать в качестве пользователя в этом каталоге или регистра или пользователя из другого каталога Azure AD как пользователь в этом каталоге. (В реальном каталоге домена по умолчанию будет ContosoTest.onmicrosoft.com. Можно также использовать домен по собственному выбору, например contoso.com.)

![Пользовательские типы](single-sign-on/_static/image9.png)

![Добавить пользовательское диалоговое окно](single-sign-on/_static/image10.png)

Можно назначить роли пользователя.

![Профиль пользователя](single-sign-on/_static/image11.png)

И учетная запись создается временный пароль.

![Временный пароль](single-sign-on/_static/image12.png)

Пользователи, создании таким образом сразу же можно войти на веб-приложения с помощью этого облачного каталога.

Отлично подходит для корпоративного единого входа, однако является **Интеграция каталогов** вкладки:

![Вкладка интеграции каталогов](single-sign-on/_static/image13.png)

Если включена Интеграция каталогов и [Загрузите средство](https://social.technet.microsoft.com/wiki/contents/articles/19098.howto-install-the-windows-azure-active-directory-sync-tool-now-with-pictures.aspx), можно синхронизировать этот каталог облака с существующей локальной среде Active Directory, вы уже используете внутри организации. Затем все пользователи, которые хранятся в каталоге будут отображаться в этом каталоге облака. Облачных приложений теперь могут проходить проверку подлинности всех сотрудников компании с помощью существующих учетных данных Active Directory. И все это бесплатно — средство синхронизации и Azure AD.

Средство — мастер, который прост в использовании, как видно из этих снимках экрана. Они не полные инструкции лишь пример, показывающий, вы в основном процесс. Более подробные сведения инструкциями-в-it, см. по ссылкам в [ресурсов](#resources) в конце раздела.

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image14.png)

Нажмите кнопку **Далее**, а затем введите учетные данные Azure Active Directory.

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image15.png)

Нажмите кнопку **Далее**, а затем введите в локальной AD учетные данные.

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image16.png)

Нажмите кнопку **Далее**и укажите, следует ли хранить хэш паролей AD в облаке.

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image17.png)

Хэш пароля, которые могут храниться в облаке имеют одностороннее хэширование; Фактические пароли никогда не хранятся в Azure AD. Если принято решение не хранение хэш в облаке, вам придется использовать [служб федерации Active Directory](https://technet.microsoft.com/library/hh831502.aspx) (ADFS). Существуют также [другие факторы, которые необходимо учитывать при выборе ли использование служб федерации Active Directory](https://technet.microsoft.com/library/jj573653.aspx). ADFS требуется несколько дополнительных действий по настройке.

Если вы решили хранить хэш-коды в облаке, завершения и запускает средство синхронизации каталогов, при нажатии кнопки **Далее**.

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image18.png)

И в течение нескольких минут завершения.

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image19.png)

Необходимо выполнять на одном контроллере домена в организации, в Windows 2003 или более поздней версии. И перезагрузки. Когда закончите, все пользователи находятся в облаке и можно сделать единого входа из любой веб- или мобильного приложения, с помощью SAML, OAuth или WS-Fed.

Иногда мы получить ответы о том, как безопасный это — корпорация Майкрософт использует для своих собственных конфиденциальных деловых данных? И Да, мы делаем. Например, при переходе на внутренний узел Microsoft SharePoint на [ https://microsoft.sharepoint.com/ ](https://microsoft.sharepoint.com/), получить предложено выполнить вход.

![Вход в Office 365](single-sign-on/_static/image20.png)

Microsoft включения служб федерации Active Directory, поэтому при вводе идентификатора Microsoft, происходит перенаправление на страницу входа служб федерации Active Directory.

![Вход служб федерации Active Directory](single-sign-on/_static/image21.png)

И после ввода учетных данных, хранящихся в учетной записи внутренней Microsoft AD имеется доступ к этому приложению внутренней.

![Сайт MS SharePoint](single-sign-on/_static/image22.png)

Мы используем сервер входа в AD, главным образом, так как мы уже служб федерации Active Directory, прежде чем Azure AD стали доступны, но процесс входа в проходит через каталог Azure AD в облаке. Мы поместить наши важные документы, системы управления версиями, файлы управления производительностью, отчеты о продажах и многое другое, в облаке и защитите их с помощью этого точно того же решения.

## <a name="create-an-aspnet-app-that-uses-azure-ad-for-single-sign-on"></a>Создать приложение ASP.NET, которое использует Azure AD для единого входа

Visual Studio значительно упрощает создание приложения, использующего Azure AD для единого входа, как видно из несколько снимков экрана.

При создании нового приложения ASP.NET MVC или веб-формы, метод проверки подлинности по умолчанию — ASP.NET Identity. Чтобы изменить его в Azure AD, щелкните **изменение проверки подлинности** кнопки.

![Изменить проверку подлинности](single-sign-on/_static/image23.png)

Выберите учетные записи организации, введите имя домена и выберите единого входа.

![Настроить диалоговое окно проверки подлинности](single-sign-on/_static/image24.png)

Можно также приложение чтение или чтение и запись разрешения для каталога данных. Если сделать это, можно использовать [Azure Graph REST API](https://msdn.microsoft.com/library/windowsazure/hh974476.aspx) для поиска пользователей номер телефона, узнайте ли они в офисе, когда они последнего вошел в систему и т. д.

Это все, что нужно сделать — Visual Studio запрашивает учетные данные администратора для вашего клиента Azure AD, и затем настраивает проект и клиент Azure AD для нового приложения.

При запуске проекта, вы увидите страницу входа, и можно выполнить вход с учетными данными пользователя вашего каталога Azure AD.

![Вход учетной записи организации.](single-sign-on/_static/image25.png)

![Вход](single-sign-on/_static/image26.png)

При развертывании приложения в Azure, необходимо сделать всего выберите **включить проверку подлинности по организации** флажок и снова Visual Studio обеспечивает все конфигурации для вас.

![Веб-публикация](single-sign-on/_static/image27.png)

Эти снимки экрана берутся из полный Пошаговое руководство, в котором показано, как создать приложение, использующее проверку подлинности Azure AD: [разработка приложений ASP.NET с помощью Azure Active Directory](../../../../identity/overview/getting-started/developing-aspnet-apps-with-windows-azure-active-directory.md).

## <a name="summary"></a>Сводка

В этой главе показано, что Azure Active Directory, Visual Studio и ASP.NET, позволяют легко настроить единый вход в веб-приложений для пользователей вашей организации. Пользователи могут войти в Интернет-приложениях, использующих те же учетные данные, которые они используют для входа с помощью Active Directory во внутренней сети.

[Следующей главе](data-storage-options.md) просматривает параметры хранилища данных, доступных для облачного приложения.

<a id="resources"></a>
## <a name="resources"></a>Ресурсы

Дополнительные сведения см. в следующих ресурсах:

- [Документация по Azure Active Directory](https://docs.microsoft.com/azure/active-directory/). Страница портала Azure AD документацию на сайте windowsazure.com. Пошаговые руководства, см. **разработка** раздела.
- [Azure Multi-factor Authentication](https://docs.microsoft.com/azure/multi-factor-authentication/). Страница портала для получения сведений о многофакторной проверки подлинности в Azure.
- [Параметры проверки подлинности учетной записи организации](../../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#orgauthoptions). Объяснение параметров проверки подлинности Azure AD в диалоговом окне нового проекта Visual Studio 2013.
- [Рекомендации — федеративные удостоверения шаблон](https://msdn.microsoft.com/library/dn589790.aspx).
- [Практическое руководство: Установка средства синхронизации Azure Active Directory](https://social.technet.microsoft.com/wiki/contents/articles/19098.howto-install-the-windows-azure-active-directory-sync-tool-now-with-pictures.aspx).
- [Службы федерации Active Directory 2.0 Карта содержимого](https://social.technet.microsoft.com/wiki/contents/articles/2735.ad-fs-2-0-content-map.aspx). Ссылки на документацию о ADFS 2.0.
- [Авторизация на основе ролей и на основе ACL в приложении Windows Azure AD](https://code.msdn.microsoft.com/Role-Based-and-ACL-Based-86ad71a1). Образец приложения.
- [Блог Azure AD Graph API](https://blogs.msdn.com/b/aadgraphteam/).
- [Управление доступом в BYOD и Интеграция каталогов в гибридной инфраструктуре идентификации](https://channel9.msdn.com/Events/TechEd/NorthAmerica/2014/PCIT-B213#fbid=). Технический Ed 2014 сеанс видео по Bagdasaryan Гаяне.

> [!div class="step-by-step"]
> [Назад](web-development-best-practices.md)
> [Вперед](data-storage-options.md)
