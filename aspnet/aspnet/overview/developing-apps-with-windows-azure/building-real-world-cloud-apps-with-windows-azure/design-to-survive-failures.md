---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/design-to-survive-failures
title: Конструктор выдержать сбои (Создание реальных облачных приложений в Azure) | Документы Microsoft
author: MikeWasson
description: Построение реального мира облачными приложениями с помощью Azure электронная книга основан на разработанный Скотт Гатри презентации. Объясняет, 13 шаблоны и рекомендации, которые он может...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/12/2014
ms.topic: article
ms.assetid: 364ce84e-5af8-4e08-afc9-75a512b01f84
ms.technology: ''
ms.prod: .net-framework
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/design-to-survive-failures
msc.type: authoredcontent
ms.openlocfilehash: 01883cb0be3e7c7b5dc8d32b784ccb3a28652f1e
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="design-to-survive-failures-building-real-world-cloud-apps-with-azure"></a>Разработка выдержать сбои (Создание реальных облачных приложений в Azure)
====================
по [Mike Wasson](https://github.com/MikeWasson), [Рик Андерсон](https://github.com/Rick-Anderson), [Tom Dykstra](https://github.com/tdykstra)

[Загрузка решение проект](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) или [Загрузите электронную](http://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)

> **Построение реального мира облачными приложениями с помощью Azure** электронная книга основана на представления, разработанный Скотт Гатри. Объясняются 13 шаблоны и рекомендации, которые помогут вам быть успешной разработки веб-приложений для облака. Сведения об электронных книг см. в разделе [первой главы](introduction.md).


Одно из действий, вам нужно знать при создании любого типа приложения, но особенно тот, который будет выполняться в облаке, где большое число пользователей будет использоваться, является как разработать приложение таким образом, чтобы он правильно обрабатывать сбои и предоставления значение максимальной степени невозможно. При достаточном времени ход выполнения процесса для ошибок в любой среде или в любой программной системе. Определяет, как приложение обрабатывает эти ситуации как получит клиентов и сколько времени на обработку, анализ и устранение проблем.

## <a name="types-of-failures"></a>Типы сбоев

Существует два основных типа ошибки, которые необходимо обрабатывать по-разному.

- Временной самовосстановление сбоев, например периодических проблем подключения.
- Долгосрочными сбоев, требующих вмешательства.

Для временных сбоев можно реализовать политику повтора, чтобы убедиться, что в большинстве случаев приложение восстанавливает быстро и автоматически. Ваши клиенты заметить немного больше времени ответа, но в противном случае они не будут затронуты. Мы покажем, обрабатывать эти ошибки в некотором смысле [обработка временных сбоев главе](transient-fault-handling.md).

Для долгосрочными сбоев, можно реализовать мониторинг и запись функциональные возможности, уведомляющие о своевременно проблемы возникают, и что упрощает анализ основных причин. Мы покажем, некоторые способы остаются над таких ошибок в [мониторинг и данные телеметрии главе](monitoring-and-telemetry.md).

## <a name="failure-scope"></a>Ошибка области

Также необходимо обдумать области сбоя — ли на одном компьютере выполняется переход, всей службы, такие как базы данных SQL или хранилище или весь регион.

![Ошибка области](design-to-survive-failures/_static/image1.png)

### <a name="machine-failures"></a>Ошибки компьютеров

В Azure сервер автоматически заменяется на новый и хорошо спроектированной облачного приложения восстановления из подобного рода сбоев автоматически и быстро. Ранее мы подчеркнуть преимущества масштабируемости без сохранения состояния веб-уровня и простота восстановления после сбоя сервера является еще одним преимуществом отсутствие поддержки состояния. Простота восстановления также является одним из преимуществ платформа как услуга (PaaS) функций, таких как базы данных SQL и веб-приложениях службы приложений Azure. Сбои оборудования редки, но в случае, если эти службы, обработать их автоматически. даже не писать код для обработки ошибок компьютера, если вы используете одну из этих служб.

### <a name="service-failures"></a>Сбоев службы

Облачные приложения обычно используют несколько служб. Например приложение ее исправить использует службу базы данных SQL в службе хранилища и веб-приложение развертывается в службе приложений Azure. Что будет приложения? в случае сбоя одной из служб, от которых зависит Для некоторых служб сбоев понятное «к сожалению, повторите попытку позже» сообщение может быть лучше всего, это можно сделать. Однако во многих случаях можно сделать лучше. Например когда хранилище данных не работает, вы можно принимают пользовательский ввод, отображения «ваш запрос получен» и сохранения куда-нибудь еще входные данные временно; Затем при одну службу не вернется, вы сможете получить входные данные и обработать его.

[Ориентированное очереди рабочих шаблон](queue-centric-work-pattern.md) главе показано, как обрабатывать этот сценарий. Приложение ее исправить сохраняет задачи в базе данных SQL, но его не нужно перестать работать, если база данных SQL не работает. В этой главе мы рассмотрим, как хранение ввод данных пользователем для задачи в очереди и использовать рабочий процесс для чтения очереди и обновления задачи. Если SQL не работает, возможность создания ее исправить задач не влияет; рабочий процесс можно ожидать и обработки новых задач при доступности базы данных SQL.

### <a name="region-failures"></a>Сбои области

Регионы целиком может завершиться ошибкой. Стихийное бедствие может уничтожить центра обработки данных, он может получить сведенные по meteor, строки магистрали в центре обработки данных может сократить фармер, burying компанию с экскаватора, и т. д. Если приложение находится в центре обработки данных stricken что делать? Можно настроить приложение в Azure одновременно запускать в нескольких регионах, что в случае сбоя в одном, продолжить выполнение в другой области. Такие сбои являются крайне редко вхождений и большинства приложений не переходить по hoops, необходимо обеспечить бесперебойную работу службы через ошибки такого рода. В разделе ресурсы в конце раздела, сведения о том, как сохранить приложения даже через область сбоя.

Цель Azure — облегчают управление всех таких сбоев намного проще, и вы увидите, как мы стремимся сделать, в последующих главах некоторые примеры.

## <a name="slas"></a>Соглашения об уровне обслуживания

Пользователи часто рассмотрены соглашения об уровне обслуживания (SLA) в облачной среде. По сути это обещания. сделать компаний о том, как надежный их службы. 99,9% означает соглашения об уровне ОБСЛУЖИВАНИЯ, то следует ожидать, что служба работает без ошибок 99,9% времени. Это довольно стандартное значение для соглашения об уровне ОБСЛУЖИВАНИЯ и кажется очень большое значение, но могут не узнать, сколько времени вниз. 1% фактически сумм. Вот таблицу, которая показывает количество времени простоя различных процентных показателей соглашения об уровне ОБСЛУЖИВАНИЯ может считаться за год, месяц и недели.

![Соглашения об уровне ОБСЛУЖИВАНИЯ таблицы](design-to-survive-failures/_static/image2.png)

Поэтому 99,9% SLA означает службы может быть недоступен 8.76 часы года или 43,2 мин в месяц. Это более время простоя, чем необходимо учесть, большинство людей. Таким образом, разработчику требуется Имейте в виду, что возможна некоторое время простоя и обработать удобным способом. В некоторый момент кто-то собирается использовать ваше приложение и служба будет вниз нужно свести к минимуму отрицательное воздействие этого от клиента.

Единственное, необходимо знать о SLA, — какой промежуток времени, он ссылается на: часы сбрасываться еженедельно, ежемесячно или ежегодно? В Azure мы сброса часов ежемесячно, лучше автоматически годовой соглашения об уровне ОБСЛУЖИВАНИЯ, поскольку годовой соглашения об уровне ОБСЛУЖИВАНИЯ может скрыть неудачными месяцами путем их смещения с нескольких месяцев хорошо.

Конечно мы всегда быть ориентирована на сделать лучше, чем соглашения об уровне ОБСЛУЖИВАНИЯ; Обычно вы будете вниз значительно меньше, чем. Объект promise является то, что если мы находимся постоянно для превышает максимальное время простоя можно запросить вернуть деньги. Сумму денег, которую можно получить обратно, скорее всего, не покрывает полностью влияния на бизнес, превышения время простоя, но этот аспект соглашению об уровне ОБСЛУЖИВАНИЯ выступает в качестве политики применения и позволяет узнать, что мы серьезно он очень.

### <a name="composite-slas"></a>Составной соглашений об уровне обслуживания

Важно рассматривать при просмотре соглашений об уровне обслуживания, эффект использования нескольких служб в приложении, с каждой службы, имеющих отдельные соглашения об уровне ОБСЛУЖИВАНИЯ. Например приложение ее исправить использует веб-приложениях службы приложений Azure, хранилище Azure и базы данных SQL. Ниже приведены их номера соглашения об уровне ОБСЛУЖИВАНИЯ на дату, эта электронная книга записывается в декабря 2013 г.

![База данных SQL веб-сайта, хранения, соглашения об уровне ОБСЛУЖИВАНИЯ](design-to-survive-failures/_static/image3.png)

Каково максимальное время, характерные для приложения, в зависимости от этих службы соглашений об уровне обслуживания? Может показаться, что вниз времени будет равно худшее процент соглашения об уровне ОБСЛУЖИВАНИЯ или 99,9% в этом случае. Это было бы значение true, если все три службы не всегда удается одновременно, но не обязательно фактического выполнения. Каждая служба может завершиться ошибкой независимо друг от друга в разное время, поэтому следует вычислить составного соглашения об уровне ОБСЛУЖИВАНИЯ путем умножения отдельных номеров соглашения об уровне ОБСЛУЖИВАНИЯ.

![Составной соглашения об уровне ОБСЛУЖИВАНИЯ](design-to-survive-failures/_static/image4.png)

Поэтому приложение может не работать не только 43,2 мин месяц, но 3 раза этот период, 108 минут в месяц — и оставаться в пределах соглашения об уровне ОБСЛУЖИВАНИЯ Azure.

Эта проблема не является уникальным в Azure. Фактически мы предоставляем наиболее облака соглашений об уровне обслуживания, доступные облачные службы, и вы получите аналогичные проблемы обрабатывать при использовании любого поставщика облачных служб. Это подчеркивает является важность обдумывания способ разработки приложения для обработки сбоев неизбежно службы правильно, так как они могут оказаться достаточно часто, чтобы повлиять на клиентов или пользователей.

### <a name="cloud-slas-compared-to-enterprise-down-time-experience"></a>Облако соглашений об уровне обслуживания, по сравнению с enterprise простоя, взаимодействие

Иногда сообщают, «В моем приложении enterprise никогда не возникают эти неполадки.» Попросите сколько время простоя в месяц фактически которых, обычно говорят, «, он происходит время от времени.» И если задать частоту, они признать, «Иногда нам необходимо создать резервную копию или установите новый сервер или обновления программного обеспечения». Конечно, который подсчитывает как время простоя. Большинство приложений пока не будут особенно важных выключены фактически дольше, чем количество времени, запрещаемых нашей службы соглашений об уровне обслуживания. Но если сервера и инфраструктуры, и вы ответственность за его и управлять его, стремятся чувствовать себя меньше angst простоями. В облачной среде зависит от кого и вы не знаете происходящем, поэтому вы может получить более волнует его.

Когда предприятия достигает больше процент времени, чем получить из облака соглашения об уровне ОБСЛУЖИВАНИЯ, они сделать, расходов на аппаратное обеспечение гораздо больше money. Облачная служба может сделать это, но придется плату многое другое, для служб. Вместо этого воспользоваться преимуществами экономичное службы и разработки программного обеспечения, чтобы избежать сбоев вызвать Минимальное нарушение работы для ваших клиентов. Задание разработчик облачные приложения не очень много во избежание сбоя относительно избежать поломки и этого сосредоточиться на программное обеспечение, а не на оборудовании. В то время как приложения предприятия стремятся максимально увеличить среднее время безотказной работы свести к минимуму среднее время на восстановление стремиться облачных приложений.

### <a name="not-all-cloud-services-have-slas"></a>Не все облачные службы имеют соглашения об уровне обслуживания

Имейте в виду также не каждой облачной службы, даже, имеется соглашение об уровне ОБСЛУЖИВАНИЯ. Если приложение зависит от службы с помощью гарантии того времени, может быть гораздо больше времени, чем вы ожидаете вниз. Например при включении вход на сайт с помощью социальных сетей поставщика, например Facebook или Twitter, проверьте у поставщика услуг, чтобы узнать, если имеется соглашение об уровне ОБСЛУЖИВАНИЯ, и можно найти здесь нельзя. Но если служба проверки подлинности выходит из строя или не может поддерживать все запросы, которые выдавать его, ваши клиенты заблокированы на ваше приложение. Может быть недоступен, дней или более. Создатели одно новое приложение Ожидалась сотни миллионов загрузки и приняла зависимость от проверки подлинности Facebook — но не обращайтесь к Facebook перед переходом динамической и обнаруженные слишком поздно, возникла не соглашения об уровне ОБСЛУЖИВАНИЯ для этой службы.

### <a name="not-all-downtime-counts-toward-slas"></a>Не все засчитывается время простоя соглашения об уровне обслуживания

Некоторые облачных служб может отклонить службы намеренно в том случае, если ваше приложение использует их перезапись. Это называется *регулирования*. Если у службы имеется соглашение об уровне ОБСЛУЖИВАНИЯ, он должен состоянии условия, при которых может регулироваться, и макет приложения следует избегать этих условий и соответствующим образом реагировать на регулирование, если это происходит. Например выполнение запросов к службе начинает завершаться неудачно, когда превышают определенную длину в секунду, требуется убедитесь, что автоматические повторы не происходить так быстро, что они смогут причинить регулирования для продолжения. Мы еще более сказать о регулировании в [обработка временных сбоев главе](transient-fault-handling.md).

## <a name="summary"></a>Сводка

В этой главе попытался позволяют оценить, почему реального облачного приложения должно быть разработано выдержать сбои надлежащим образом. Начиная с [следующей главе](monitoring-and-telemetry.md), остальные шаблоны в этой серии более подробно о несколько стратегий, которые можно использовать для этого:

- Хорошо иметь [мониторинг и телеметрия](monitoring-and-telemetry.md), после чего можно узнать быстро об ошибках, требующие вмешательства, и имеется достаточно данных для их устранения.
- [Обработка временных сбоев](transient-fault-handling.md) путем реализации логики повторных попыток интеллектуальной, чтобы приложение автоматически восстанавливает ее можно и возвращается к [Размыкатель цепи](transient-fault-handling.md#circuitbreakers) логику, если не удается.
- Используйте [распределенное кэширование](distributed-caching.md) чтобы свести к минимуму проблемы пропускной способности, задержке и соединения с доступом к базе данных.
- Реализуйте свободные взаимозависимость через [шаблон ориентированное очереди рабочих](queue-centric-work-pattern.md), после чего интерфейс приложения можно продолжить работу, если серверной части не работает.

## <a name="resources"></a>Ресурсы

Дополнительные сведения см. в следующих главах электронных книг и следующие ресурсы.

Документация:

- [Отказоустойчивость: Руководство по гибкой облачной архитектуре](https://msdn.microsoft.com/library/windowsazure/jj853352.aspx). Технический документ по Marc Mercuri, Ульрих Хоманн и Эндрю Таунхилл. Версия веб-страницы серия видеоматериалов Безаварийность.
- [Советы и рекомендации по проектированию крупномасштабных служб в облачных службах Azure](https://msdn.microsoft.com/library/windowsazure/jj717232.aspx). Технический документ, Марк Симмс и Майкл Томасси.
- [Техническое руководство по непрерывности бизнеса Azure](https://msdn.microsoft.com/library/windowsazure/hh873027.aspx). Технический документ, Патрик Уиклайн и Джейсон рот.
- [Аварийное восстановление и высокий уровень доступности для приложений Azure](https://msdn.microsoft.com/library/windowsazure/dn251004.aspx). Технический документ, Michael McKeown, Kommalapati Хану и Джейсон рот.
- [Шаблоны и методики - руководство по Azure Майкрософт](https://msdn.microsoft.com/library/dn568099.aspx). Центр обработки данных несколькими см. руководство по развертыванию, Размыкатель цепи шаблон.
- [Поддержка Azure — соглашений об уровне обслуживания](https://azure.microsoft.com/support/legal/sla/).
- [Непрерывность бизнес-процессов в базе данных Azure SQL](https://msdn.microsoft.com/library/windowsazure/hh852669.aspx). Документацию по SQL функции базы данных высокого уровня доступности и аварийного восстановления.
- [Высокий уровень доступности и аварийное восстановление для SQL Server в виртуальных машинах Azure](https://msdn.microsoft.com/library/windowsazure/jj870962.aspx).

Видеоролики:

- [Отказоустойчивость: Построение масштабируемых, надежных облачные службы](https://channel9.msdn.com/Series/FailSafe). Девять выпусков, Ульрих Хоманн, Marc Mercuri и Марк Симмс. Представляет высокоуровневых концепциях и принципов архитектуры в виде очень доступна и интересные истории, полученными в результате Advisory Team Microsoft клиентов (CAT) опыт работы с фактических клиентов. Эпизодов 1 до 8 углубляться в глубину причинами разработки облачных приложений выдержать сбои. Также в описании дальнейших регулирования количества запросов в серии 2, начиная с 49:57 обсуждение точек и режимов сбоя в серии 2, начиная с 56:05 и обсуждение выключатели в серии 3, начиная с 40:55.
- [Построение Big: Уроках, извлеченных из клиентам Azure — часть II](https://channel9.msdn.com/Events/Build/2012/3-030). Марк Симмс рассказывает о разработке для сбоя и все данные инструментирования. Аналогично Безаварийность рядов, но переход в Дополнительные практические сведения.

> [!div class="step-by-step"]
> [Назад](unstructured-blob-storage.md)
> [Вперед](monitoring-and-telemetry.md)
