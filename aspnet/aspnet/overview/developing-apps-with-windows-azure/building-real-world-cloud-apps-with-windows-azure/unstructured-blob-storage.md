---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/unstructured-blob-storage
title: Хранилище неструктурированных BLOB-объектов (Создание реальных облачных приложений в Azure) | Документы Microsoft
author: MikeWasson
description: Построение реального мира облачными приложениями с помощью Azure электронная книга основан на разработанный Скотт Гатри презентации. Объясняет, 13 шаблоны и рекомендации, которые он может...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/30/2015
ms.topic: article
ms.assetid: 9f05ccb1-2004-4661-ad8b-c370e6c09c8e
ms.technology: ''
ms.prod: .net-framework
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/unstructured-blob-storage
msc.type: authoredcontent
ms.openlocfilehash: c2c82a579feb586287c40bb82eba53c5f84afaba
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
ms.locfileid: "30872576"
---
<a name="unstructured-blob-storage-building-real-world-cloud-apps-with-azure"></a>Хранилище неструктурированных BLOB-объектов (Создание реальных облачных приложений в Azure)
====================
по [Mike Wasson](https://github.com/MikeWasson), [Рик Андерсон](https://github.com/Rick-Anderson), [Tom Dykstra](https://github.com/tdykstra)

[Загрузка решение проект](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) или [Загрузите электронную](http://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)

> **Построение реального мира облачными приложениями с помощью Azure** электронная книга основана на представления, разработанный Скотт Гатри. Объясняются 13 шаблоны и рекомендации, которые помогут вам быть успешной разработки веб-приложений для облака. Сведения об электронных книг см. в разделе [первой главы](introduction.md).


В предыдущем разделе мы рассматривали схемы секционирования и объясняется, как приложение исправить образы хранятся в службе BLOB-объекта хранилища Azure и другие данные задач в базе данных SQL Azure. В этой главе мы выполнить более глубокий службы BLOB-объектов и показать его реализации в коде проекта ее исправить.

## <a name="what-is-blob-storage"></a>Что такое хранилище больших двоичных объектов

Службы хранилища больших двоичных объектов предоставляет способ для хранения файлов в облаке. Служба BLOB-объектов имеет ряд преимуществ по сравнению с хранение файлов в файловой системе локальной сети:

- Он имеет высокую степень масштабируемости. Можно хранить в одной учетной записи хранилища [сотни терабайт](https://msdn.microsoft.com/library/windowsazure/dn249410.aspx), и может иметь несколько учетных записей хранения. Некоторые из важнейших клиентам Azure хранить сотни петабайт. Microsoft SkyDrive использует хранилище больших двоичных объектов.
- Он является устойчивой. Автоматически архивируются каждый файл, хранить в службе BLOB-объектов.
- Он обеспечивает высокий уровень доступности. [Соглашения об уровне ОБСЛУЖИВАНИЯ для хранилища](https://go.microsoft.com/fwlink/p/?linkid=159705&amp;clcid=0x409) время работы обещания 99,9% или 99,99%, в зависимости от того, какой вариант геоизбыточность выберите.
- Он является компонентом платформы как службы (PaaS) Azure, это означает просто сохранять и извлекать файлы, оплата только фактический объем хранилища используется, и Azure автоматически отвечает за настройку и управление все виртуальные машины и диски, необходимые для Служба.
- С помощью API-интерфейса REST или на любом языке программирования API можно получить доступ к службе BLOB-объектов. Пакеты SDK доступны для .NET, Java, Ruby и другим пользователям.
- При сохранении файла в службе BLOB-объектов можно легко облегчить общедоступным через Интернет.
- Можно защитить файлы в большом двоичном объекте, службы, поэтому они могут быть доступны только для авторизованных пользователей, или можно предоставить временный доступ маркеры, которые становятся доступными пользователю только в течение ограниченного времени.

Каждый раз, когда вы создаете приложение для Azure, и вы хотите сохранить большой объем данных, в локальной среде перейдет в файлах, таких как изображения, видео, PDF-файлов, электронных таблиц, т. д. — Попробуйте службы BLOB-объектов.

## <a name="creating-a-storage-account"></a>Создание учетной записи хранения

Чтобы приступить к работе со службой BLOB-объекта создать учетную запись хранилища в Azure. На портале щелкните **New** -- **Data Services** -- **хранения** -- **быстрое создание**, а затем введите URL-адрес и местоположение центра обработки данных. Местоположение центра обработки данных должен быть таким же, как веб-приложения.

![Создать учетная запись хранения](unstructured-blob-storage/_static/image1.png)

Выберите основной регион место для хранения содержимого, а если выбрать [георепликации](https://blogs.msdn.com/b/windowsazurestorage/archive/2013/12/11/introducing-read-access-geo-replicated-storage-ra-grs-for-windows-azure-storage.aspx#_Geo_Redundant_Storage) вариант, Azure создает реплики всех данных в другом центре обработки данных в другой регион страны. Например при выборе Западная часть США центре обработки данных при сохранении файла его переходе в центр обработки данных Западная часть США, но в фоновом режиме Azure также копирование одного из других центрах обработки данных США. В случае сбоя одного региона, страны, данные будут по-прежнему безопасным.

Azure не будет реплицировать данные через границы политическим geo: Если в основном расположении в США, файлы реплицируются только в другой регион, в США; Если в основном расположении Австралия, файлы реплицируются только в другой центр обработки данных в Австралии.

Конечно также можно создать учетную запись хранилища с помощью выполнения команд с помощью сценария, как было показано ранее. Вот команду Windows PowerShell, чтобы создать учетную запись хранилища.

[!code-powershell[Main](unstructured-blob-storage/samples/sample1.ps1)]

После получения учетной записи хранилища может немедленно начать хранение файлов в службе BLOB-объектов.

## <a name="using-blob-storage-in-the-fix-it-app"></a>С помощью хранилища больших двоичных объектов в приложении исправить

Приложение исправить дает возможность отправки фотографий.

![Создание задачи ее исправить](unstructured-blob-storage/_static/image2.png)

При нажатии кнопки **создать решить**, приложение загружает указанный файл образа и сохраняет его в службе BLOB-объектов.

### <a name="set-up-the-blob-container"></a>Настроить контейнер больших двоичных объектов

Чтобы сохранить файл в службе BLOB-объектов, необходимо *контейнера* сохранить ее в. Контейнер больших двоичных объектов службы соответствует папке файловой системы. Скрипты создания среды, которые мы изучили, как в [автоматизировать все главе](automate-everything.md) создать учетную запись хранения, но они не создают контейнер. Таким образом назначение `CreateAndConfigure` метод `PhotoService` класс является создание контейнера, если он еще не существует. Этот метод вызывается из `Application_Start` метод в *Global.asax*.

[!code-csharp[Main](unstructured-blob-storage/samples/sample2.cs)]

Ключ имени и доступа к учетной записи хранилища хранятся в `appSettings` коллекцию *Web.config* правой кнопкой мыши и в код `StorageUtils.StorageAccount` метод использует эти значения для построения строки подключения и подключения:

[!code-csharp[Main](unstructured-blob-storage/samples/sample3.cs)]

`CreateAndConfigureAsync` Затем метод создает объект, представляющий службу BLOB-объект и объект, представляющий контейнер (папки) с именем «images» в службе BLOB-объектов:

[!code-csharp[Main](unstructured-blob-storage/samples/sample4.cs)]

Если контейнер с именем «images» еще не существует--которого будет иметь значение true, при первом запуске приложение запускается от учетной записи хранения — код создает контейнер и задает разрешения, чтобы сделать общедоступными. (По умолчанию новые контейнеры больших двоичных объектов являются личными и доступны только для пользователей, имеющих разрешение на доступ к вашей учетной записи хранилища.)

[!code-csharp[Main](unstructured-blob-storage/samples/sample5.cs)]

### <a name="store-the-uploaded-photo-in-blob-storage"></a>Переданная фотография в хранилище больших двоичных объектов хранилища

Для загрузки и сохранения файла изображения, приложение использует `IPhotoService` интерфейс и реализацию интерфейса в `PhotoService` класса. *PhotoService.cs* файл содержит весь код в ее исправить приложение, которое обращается к службе BLOB-объектов.

Следующий метод контроллера MVC вызывается, когда пользователь щелкает **создать решить**. В этом коде `photoService` ссылается на экземпляр `PhotoService` класса, и `fixittask` ссылается на экземпляр `FixItTask` класс сущностей, который хранит данные для новой задачи.

[!code-csharp[Main](unstructured-blob-storage/samples/sample6.cs?highlight=8)]

`UploadPhotoAsync` Метод в `PhotoService` класс хранит загруженный файл в службе BLOB-объекта и возвращает URL-адрес, который указывает новый большой двоичный объект.

[!code-csharp[Main](unstructured-blob-storage/samples/sample7.cs)]

Как и в `CreateAndConfigure` метода, код подключается к учетной записи хранилища и создает объект, представляющий контейнер больших двоичных объектов «изображения», за исключением того, здесь предполагается контейнере уже существует.

Затем он создает уникальный идентификатор для образа, который будет передаваться путем объединения новое значение GUID, с расширением файла:

[!code-csharp[Main](unstructured-blob-storage/samples/sample8.cs)]

Затем код использует объект контейнера больших двоичных объектов и новый уникальный идентификатор для создания большого двоичного объекта, задает атрибут для этого объекта, указывающее, файле какого типа она, а затем использует большой двоичный объект для хранения файла в хранилище больших двоичных объектов.

[!code-csharp[Main](unstructured-blob-storage/samples/sample9.cs)]

Наконец он получает URL-адрес, который ссылается на большой двоичный объект. Этот URL-адрес будет храниться в базе данных и может использоваться в ее исправить веб-страницы для отображения отправленного изображения.

[!code-csharp[Main](unstructured-blob-storage/samples/sample10.cs)]

Этот URL-адрес сохраняется в базе данных как один из столбцов в таблице FixItTask.

[!code-csharp[Main](unstructured-blob-storage/samples/sample11.cs?highlight=10)]

Только URL-адрес в базе данных и изображений в хранилище больших двоичных объектов приложение исправить сохраняют базы данных небольшой, масштабируемую и недорогое, пока изображения сохраняются, где хранятся требует больших затрат и может обрабатывать терабайт и петабайт. Одна учетная запись хранилища можно хранить сотни терабайт фотографий ее исправить, и вы платите только за то, что используется. Чтобы начать небольшой плательщики центов 9 первый ГБ и добавить дополнительные изображения для копеек дополнительных гигабайта.

### <a name="display-the-uploaded-file"></a>Отображение загруженный файл

Приложение исправить файл отображается в отправленного изображения при отображении сведения о задаче.

![Исправить сведения о задаче и фотография](unstructured-blob-storage/_static/image3.png)

Для отображения изображения, представление MVC должна быть выполнена всего включить `PhotoUrl` значение в формате HTML, отправляемого в браузер. Веб-сервера и базы данных не используются циклов для отображения изображения, они только применяете несколько байтов в URL-адрес изображения. В следующем коде Razor `Model` ссылается на экземпляр `FixItTask` класса сущностей.

[!code-cshtml[Main](unstructured-blob-storage/samples/sample12.cshtml?highlight=11)]

Если взглянуть на HTML-код страницы, отображающей появится URL-адрес, указывающий на изображение в хранилище больших двоичных объектов, что-нибудь следующим образом:

[!code-cshtml[Main](unstructured-blob-storage/samples/sample13.cshtml?highlight=11)]

## <a name="summary"></a>Сводка

Вы знаете, как приложение исправить образы хранятся в службе BLOB-объектов и только URL-адресов изображений в базе данных SQL. С помощью службы BLOB-объектов базы данных SQL сохраняет намного меньше, чем в противном случае бы, делает возможным Масштабирование до практически неограниченное количество задач и может выполняться без написания большого объема кода.

Имеются сотни терабайт в учетной записи хранилища и затраты на хранение выполняется гораздо быстрее, чем хранилище базы данных SQL, начиная с примерно 3 центов на гигабайт в месяц, а также издержки небольших транзакций. И имейте в виду, что вы платите, не для максимальной емкости, но только в течение интервала, который фактически хранятся, поэтому приложение будет готово для масштабирования, но вы платите не для всех, дополнительная емкость.

В [следующей главе](design-to-survive-failures.md) будет рассказано о важности использования облачного приложения может правильно обрабатывать сбои.

## <a name="resources"></a>Ресурсы

Дополнительные сведения см. следующие ресурсы:

- [Введение в хранилище больших двоичных ОБЪЕКТОВ](https://www.simple-talk.com/cloud/cloud-data/an-introduction-to-windows-azure-blob-storage-/). Блог Майка дерева.
- [Использование службы хранилища больших двоичных объектов Azure в .NET](https://docs.microsoft.com/azure/storage/blobs/storage-dotnet-how-to-use-blobs). Официальной документации на сайте MicrosoftAzure.com. Краткое введение в хранилище, следуют примеры кода, показывающий, как подключиться к хранилищу BLOB-объектов BLOB-объектов создавать контейнеры, отправка и загрузка больших двоичных объектов и т. д.
- [Отказоустойчивость: Построение масштабируемых, надежных облачные службы](https://channel9.msdn.com/Series/FailSafe). Серия видеоматериалов девять частей, Ульрих Хоманн, Marc Mercuri и Марк Симмс. Представляет высокоуровневых концепциях и принципов архитектуры в виде очень доступна и интересные истории, полученными в результате Advisory Team Microsoft клиентов (CAT) опыт работы с фактических клиентов. Сведения по службе хранилища Azure и больших двоичных объектов серии 5, начиная с 35:13 см.
- [Шаблоны и методики - руководство по Azure Майкрософт](https://msdn.microsoft.com/library/dn568099.aspx). Шаблон ключа Valet см. в разделе.

> [!div class="step-by-step"]
> [Назад](data-partitioning-strategies.md)
> [Вперед](design-to-survive-failures.md)
