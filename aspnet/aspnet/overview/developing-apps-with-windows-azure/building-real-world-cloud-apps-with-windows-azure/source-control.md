---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/source-control
title: Система управления версиями (Создание реальных облачных приложений в Azure) | Документы Microsoft
author: MikeWasson
description: Построение реального мира облачными приложениями с помощью Azure электронная книга основан на разработанный Скотт Гатри презентации. Объясняет, 13 шаблоны и рекомендации, которые он может...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/23/2015
ms.topic: article
ms.assetid: 2a0370d3-c2fb-4bf3-88b8-aad5a736c793
ms.technology: ''
ms.prod: .net-framework
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/source-control
msc.type: authoredcontent
ms.openlocfilehash: 0022458fa89a3be7ee8303750ad0e072df3b1bab
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2018
---
<a name="source-control-building-real-world-cloud-apps-with-azure"></a>Система управления версиями (Создание реальных облачных приложений в Azure)
====================
по [Mike Wasson](https://github.com/MikeWasson), [Рик Андерсон](https://github.com/Rick-Anderson), [Tom Dykstra](https://github.com/tdykstra)

[Загрузка решение проект](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) или [Загрузите электронную](http://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)

> **Построение реального мира облачными приложениями с помощью Azure** электронная книга основана на представления, разработанный Скотт Гатри. Объясняются 13 шаблоны и рекомендации, которые помогут вам быть успешной разработки веб-приложений для облака. Сведения об электронных книг см. в разделе [первой главы](introduction.md).


Системы управления версиями является обязательным для всех проектов разработки облака, не только в средах групп. Вы бы представить редактирования исходного кода или даже документ Word без управления версиями и автоматического резервного копирования и функция отмены предоставляет эти функции на уровне проекта, где они могут сохранять еще больше времени, когда что-то пойдет не так. С облачной службы системы управления версиями больше не нужно беспокоиться о сложной настройки, и можно использовать Visual Studio Online системы управления версиями бесплатно до 5 пользователей.

В первой части этой главы описываются три основных лучших решений, необходимо иметь в виду:

- [Считать исходный код сценариев автоматизации](#scripts) и версии их вместе с кодом приложения.
- [Никогда не проверять в секреты](#secrets) (конфиденциальных данных, таких как учетные данные) в репозиторий исходного кода.
- [Настройка источника ветви](#devops) включить рабочий процесс DevOps.

В оставшейся части раздела приводятся некоторые образцы реализации этих шаблонов в Visual Studio, Azure и Visual Studio Online:

- [Добавление скриптов в систему управления версиями в Visual Studio](#vsscripts)
- [Хранить конфиденциальные данные в Azure](#appsettings)
- [Используйте Git в Visual Studio и Visual Studio Online](#gittfs)

<a id="scripts"></a>
## <a name="treat-automation-scripts-as-source-code"></a>Считать сценариев автоматизации исходного кода

При работе над проектом облачной часто происходит изменение действия, и вы хотите иметь возможность быстро реагировать на ошибки, описанные в ваших клиентов. Быстро отвечать на запросы предполагает использование сценариев автоматизации, как описано в статье [автоматизировать все](automate-everything.md) главы. Все сценарии, которые можно использовать для создания среды, развернуть его, масштаб, он, т. д., должны быть синхронизированы с исходным кодом приложения.

Для сценариев синхронизации с кода, сохраните их в систему управления версиями. Затем в дальнейшем откат изменений или вносить быстрого исправления для рабочего кода, который отличается от разработки кода, не нужно тратить время, при попытке отследить, какие параметры были изменены или участников команды, которые имеют копии нужных вам версий. Вы будете уверены в том, скрипты, необходимые синхронизированы с базу кода, которая требуется для, и вы уверенным в том, все участники команды работают с помощью того же скриптов. Затем необходимо автоматизировать тестирование и развертывание исправления на производство или разработки новых компонентов, нужно ли соответствующий скрипт для кода, который должен быть обновлен.

<a id="secrets"></a>
## <a name="dont-check-in-secrets"></a>Не устанавливайте флажок в секретов

Обычно репозитория исходного кода доступен слишком много пользователей, для него необходимо соответствующим образом безопасное конфиденциальных данных, таких как пароли. Если скрипты полагаться на секретные данные, такие как пароли, параметризуются эти параметры, чтобы они не сохраняются в исходном коде и хранения конфиденциальных данных в другое место.

Например Azure позволяет загружать файлы, содержащие параметры публикации для автоматизации создания профилей публикации. Эти файлы содержат имена пользователей и пароли, которые имеют право управлять службами Azure. Если не использовать этот метод для создания профилей публикации, и при возврате эти файлы в систему управления версиями, любой пользователь с доступом в репозиторий, могут просматривать имена пользователей и пароли. Можно безопасно сохранить пароль в сам профиль публикации, так как он зашифрован и находится в *. pubxml.user* файл, который по умолчанию не включен в систему управления версиями.

<a id="devops"></a>
## <a name="structure-source-branches-to-facilitate-devops-workflow"></a>Структура ветвей источника для упрощения DevOps рабочего процесса

Как реализовать ветви в репозитории влияет на возможность разработки новых компонентов и устранения проблем в рабочей среде. Ниже приведен шаблон, что много среднего размера используйте команды.

![Структура ветвей источника](source-control/_static/image1.png)

Код, который находится в рабочей среде всегда совпадает с главную ветвь. Подразделов вне главного соответствуют разные этапы жизненного цикла разработки. Ветвь development — где реализации новых возможностей. Для небольшой группы может просто иметься master и разработки, но рекомендуется часто, что пользователи имеют промежуточной ветви между разработкой и master. Можно использовать промежуточного хранения для окончательного интеграционного тестирования перед обновлением перемещается в рабочую среду.

Для больших групп может быть различных ветвей для каждой новой функции; более мелкие группы может быть everyone возврата для ветви development в ветвь.

При наличии ветви для каждой функции, если функция A готовности объединении его изменения в исходном коде вверх в разработку ветвление и вниз в других ветвях компонентов. Этот исходный код процессом слияния может занять много времени и во избежание этой работы, при этом оставляя отдельных компонентов, некоторые команды реализации вызывается вместо *[компонентов переключает](http://en.wikipedia.org/wiki/Feature_toggle)* (также известный как *компонентов флаги*). Это означает, что весь код для всех функций находится в одной ветви, но можно включить или отключить каждого из компонентов с помощью параметров в коде. Предположим, например, компонент А — это новое поле для задач приложения ее исправить, а функция B добавляет функции кэширования. Код для обоих компонентов может быть в ветви development, но только отображения приложения будет новое поле, если переменная имеет значение true, и он будет использовать только кэширование, если задан другой переменной значение true. Компонент А не готова к повышению функций Б готова, вы можете повысить уровень весь код в рабочей среде с параметром компонент А off и функций Б переключиться. Можно завершить компонент А и повысить его уровень более поздней версии, с слияния исходного кода.

Ли использовать ветвей или переключатели для функций, разветвленную структуру следующим образом позволяет потока кода из среды разработки в производственную среду образом agile и repeatable.

Эта структура также позволяет быстро реагировать на отзывы клиентов. Если вы хотите внести быстрого исправления в рабочей среде, можно также сделать, эффективно agile способом. Можно создать ветвь из основной или промежуточной и готовности слияние справочника и вниз в ветви разработки и компонент.

![Ветви исправления](source-control/_static/image2.png)

Без разветвленную структуру следующим образом с его разделение производства и ветви development проблема производства может подвергнуть вы необходимости для повышения уровня нового кода компонент вместе с производства исправление на месте. Новый код функции может быть полностью протестированы и готовы к рабочей и может потребоваться выполнение большого объема работы резервное изменения, которые не готовы. Или, возможно, потребуется отложить исправление для тестирования изменений и подготовить их для развертывания.

Далее вы увидите примеры реализации этих трех шаблонов в Visual Studio, Azure и Visual Studio Online. Это примеры, а не подробные пошаговые инструкции инструкциями-в-it; Подробные инструкции, предоставляющих все необходимые контекста см. в разделе [ресурсов](#resources) в конце раздела.

<a id="vsscripts"></a>
## <a name="add-scripts-to-source-control-in-visual-studio"></a>Добавление скриптов в систему управления версиями в Visual Studio

Скрипты можно добавить в систему управления версиями в Visual Studio, включая их в папке решения Visual Studio (при условии, что проект находится в системе управления версиями). Вот один из способов сделать это.

Создайте папку для скриптов в папку решения (той же папке, которая содержит ваш *.sln* файла).

![Папка автоматизации](source-control/_static/image3.png)

Скопируйте файлы скриптов в папку.

![Автоматизация содержимого папки](source-control/_static/image4.png)

В Visual Studio добавьте в проект папку решения.

![Новый пункт меню папку решения](source-control/_static/image5.png)

И добавьте файлы скриптов в папку решения.

![Добавить существующий элемент меню](source-control/_static/image6.png)

![Диалоговое окно ''Добавление существующего элемента''](source-control/_static/image7.png)

Файлы скриптов теперь включены в проект и системы управления версиями отслеживает их изменения версии, а также соответствующие изменения в исходном коде.

<a id="appsettings"></a>
## <a name="store-sensitive-data-in-azure"></a>Хранить конфиденциальные данные в Azure

При запуске приложения на веб-сайте Azure для хранения их в Azure является одним из способов избежать хранения учетных данных в системе управления версиями.

Например приложение ее исправить хранит в его файле Web.config файла две строки подключения которых будут указаны пароли в рабочей среде и ключ, который предоставляет доступ к вашей учетной записи хранилища Azure.

[!code-xml[Main](source-control/samples/sample1.xml?highlight=2-3,11)]

Если поместить производства значения этих параметров в вашей *Web.config* файл, или если поместить их *Web.Release.config* файл, чтобы настроить преобразование файла Web.config для вставки их во время развертывания они будут сохранены в репозитории исходного. При вводе строки подключения базы данных в рабочей среде профиль публикации, пароль будет использоваться в вашей *.pubxml* файла. (Можно исключить *.pubxml* файла из системы управления версиями, но затем маршрутизировать подключения с доступом другие настройки развертывания.)

Azure предоставляет дополнительный для **appSettings** и строки подключения разделы *Web.config* файла. Вот соответствующая часть **конфигурации** вкладку веб-сайта на портале управления Azure:

![appSettings и connectionStrings портала](source-control/_static/image8.png)

При развертывании проекта на этот веб-сайт и приложение будет работать независимо от значения, сохраненные в Azure переопределяют любые значения, в файле Web.config.

Эти значения можно задать в Azure с помощью портала управления или сценариев. Сценарий автоматизации создания среды, в [автоматизировать все](automate-everything.md) главе создает базы данных SQL Azure, получает хранилища и строки подключения базы данных SQL и сохраняет эти секреты в параметры веб-сайта.

[!code-powershell[Main](source-control/samples/sample2.ps1)]

[!code-powershell[Main](source-control/samples/sample3.ps1)]

Обратите внимание, что скрипты параметризуются, чтобы фактические значения не сохраняются в репозитории источника.

При локальном запуске в среде разработки, приложение считывает локальный файл Web.config и подключение к строка указывает на базу данных LocalDB SQL Server, в *приложения\_данные* папку веб-проекта. При запуске приложения в Azure и приложение пытается прочитать эти значения из файла Web.config, что возвращается обратно и использует — это значения, хранимые для веб-сайта, не включенные возможности фактически файл Web.config.

<a id="gittfs"></a>
## <a name="use-git-in-visual-studio-and-visual-studio-online"></a>Используйте Git в Visual Studio и Visual Studio Online

Любой системы управления версиями можно использовать для реализации DevOps разветвленную структуру, представленного выше. Для распределенных команд [распределенные системы управления версиями](http://en.wikipedia.org/wiki/Distributed_revision_control) (DVCS) может работать лучше; для других команд [централизованной системы](http://en.wikipedia.org/wiki/Revision_control) может работать лучше.

[Git](http://git-scm.com/) является DVCS, который является становится популярным. Вы используете Git для системы управления версиями, после полной копии базы данных со всеми его журнала на локальном компьютере. Многие пользователи предпочитают, облегчающий продолжать работу, если вы не подключены к сети, можно продолжить выполнять фиксирует и отката, создайте и переключения ветки и т. д. Даже в том случае, если вы подключены к сети, это гораздо проще и быстрее создавать ответвления и переключение ветвей, что все локальные. Также можно сделать локальный фиксации или отката без необходимости оказывают влияние на других разработчиков. И позволяет выполнять пакетные фиксации перед их отправкой на сервер.

[Microsoft Visual Studio Online](https://www.visualstudio.com/)(VSO), ранее известные как Team Foundation Service предлагает оба Git и [управления версиями Team Foundation](https://msdn.microsoft.com/library/ms181237(v=vs.120).aspx) (TFVC; централизованной системы управления версиями). Здесь в корпорации Майкрософт в группе Azure некоторые команды используют централизованного система управления версиями, использование некоторых распределенных, а другие сочетания (централизованное для некоторых проектов и распределенных для других проектов). Служба VSO является бесплатным для пользователей до 5. Вы можете зарегистрироваться для план free [здесь](https://go.microsoft.com/fwlink/?LinkId=307137).

Visual Studio 2013 включает встроенные первого класса [Git поддержки](https://msdn.microsoft.com/library/hh850437.aspx); Вот быстром демонстрационную версию как это работает.

С проекта, открытого в Visual Studio 2013, щелкните правой кнопкой мыши решение в **обозревателе решений**и выберите **добавить решение в систему управления версиями**.

![Добавить решение в систему управления версиями](source-control/_static/image9.png)

Visual Studio спросит, следует использовать TFVC (централизованной системы управления версиями) или Git.

![Выбор системы управления версиями](source-control/_static/image10.png)

Установите Git при нажатии **ОК**, Visual Studio создает нового локального репозитория Git в папке решения. Новый репозиторий еще нет файлов; необходимо добавить их в репозиторий, выполнив фиксации Git. Щелкните правой кнопкой мыши решение в **обозревателе решений**, а затем нажмите кнопку **зафиксировать**.

![Фиксация](source-control/_static/image11.png)

Visual Studio автоматически все файлы проекта для фиксации этапы и выведет их имена в **Team Explorer** в **включенные изменения** области. (Если есть некоторые не следует включать в фиксации, можно выбрать, щелкните правой кнопкой мыши и нажмите кнопку **исключить**.)

![Командный обозреватель](source-control/_static/image12.png)

Введите комментарии для фиксации и нажмите кнопку **фиксации**, и Visual Studio выполняет фиксацию и отображает идентификатор фиксации

![Изменения Team Explorer](source-control/_static/image13.png)

Теперь при изменении некоторый код, чтобы оно отличается от имени в репозитории, можно легко просмотреть различия. Щелкните правой кнопкой мыши файл, который был изменен, выберите **сравнения с Unmodified**, и вы получаете отображения сравнения, показывающего незафиксированные изменения.

![Сравнение с неизмененной](source-control/_static/image14.png)

![Разница между отображением изменений](source-control/_static/image15.png)

Можно легко увидеть, какие изменения вы вносите и их возврата.

Предположим, что необходимо сделать ветвь — это можно сделать в Visual Studio слишком. В **Team Explorer**, нажмите кнопку **новой ветви**.

![Новая ветвь Team Explorer](source-control/_static/image16.png)

Введите имя ветви, нажмите кнопку **создать ветвь**, и если вы выбрали **извлечения ветви**, Visual Studio автоматически извлекает новой ветви.

![Новая ветвь Team Explorer](source-control/_static/image17.png)

Теперь можно вносить изменения в файлы и их возврата в этом филиале. И можно легко переключаться между ветвей и Visual Studio автоматически синхронизируется, файлы, какое значение вы переход извлечены. В этом примере заголовок веб-страницы в  *\_Layout.cshtml* было изменено на «Исправление 1» в HotFix1 ветви.

![Ветвь Hotfix1](source-control/_static/image18.png)

При переключении обратно в образце ветвление, содержимое  *\_Layout.cshtml* автоматически восстановить файла в главную ветвь.

![Главную ветвь](source-control/_static/image19.png)

Этот простой пример того, как можно быстро создать ветвь и отражение вперед и назад между ветвями. Эта функция позволяет высокой agile рабочий процесс, с помощью структуры ветвей и сценариев автоматизации представлены в [автоматизировать все](automate-everything.md) главы. Например, может быть работа в ветви Development в ветвь, создание ветви исправления из главного, перейдите в новую ветвь и внесите нужные изменения существует и зафиксировать их и затем переключитесь обратно в ветвь Development продолжить вы занимались.

Что вы уже видели здесь — при работе с локального репозитория Git в Visual Studio. В командной среде вы обычно также отправьте изменения общим хранилищем. Средства Visual Studio позволяют также пункты удаленный репозиторий Git. Для этой цели можно использовать GitHub.com или воспользуйтесь [Git в Visual Studio Online](https://msdn.microsoft.com/library/hh850437.aspx) интегрировать все другие Visual Studio Online возможности, например рабочих элементов и отслеживания ошибок.

Это не единственный способ, можно реализовать agile стратегии ветвления, конечно. Вы можете включить же гибкой рабочий процесс использует хранилище для централизованного исходных файлов.

## <a name="summary"></a>Сводка

Оценить успешность системы управления версиями на основе насколько быстро внести изменения и получить динамической безопасный и прогнозируемым образом. Если вы обнаружите Испуганные внести изменения, так как нужно сделать один или два ручного тестирования на нем дня, задайте себе вопрос самостоятельно должны делать process-wise или test-wise, чтобы можно было внести это изменение в минутах или в худшем случае больше чем один час. Стратегия выполнения этих процедур является реализация непрерывной интеграции и непрерывного доставки, который мы расскажем в [следующей главе](continuous-integration-and-continuous-delivery.md).

<a id="resources"></a>
## <a name="resources"></a>Ресурсы

[Visual Studio Online](https://www.visualstudio.com/) портал позволяет документации и технической поддержки, и можно зарегистрироваться для учетной записи. Если установлена Visual Studio 2012 и хотели бы использовать Git, см. раздел [Visual Studio Tools для Git](https://visualstudiogallery.msdn.microsoft.com/abafc7d6-dcaa-40f4-8a5e-d6724bdb980c).

Дополнительные сведения о (централизованной системы управления версиями) TFVC и Git распределенные системы управления версиями () см. в следующих ресурсах:

- [Системы управления версиями следует использовать: TFVC или Git?](https://msdn.microsoft.com/library/vstudio/ms181368.aspx#tfvc_or_git_summary) Документация MSDN содержит таблицу суммирования различия между TFVC и Git.
- [Также мне нравится Team Foundation Server и мне нравится Git, но может лучше?](https://blogs.msdn.com/b/visualstudiouk/archive/2013/08/05/well-i-like-team-foundation-server-and-i-like-git-but-which-is-better.aspx) Сравнение TFVC и Git.

Дополнительные сведения о стратегиях ветвления см. следующие ресурсы:

- [Построение конвейера выпуска с Team Foundation Server 2012](https://msdn.microsoft.com/library/dn449957.aspx). Шаблоны и методики Майкрософт документации. В главе 6 сведения о стратегиях ветвления. Функция представителей переключает через компонент ветвей и при использовании ветвей для функции помощникам, обеспечивая кратковременных (часы или дни в большинстве случаев).
- [Версия руководство по контролю](https://aka.ms/vsarsolutions). Руководство по стратегиях ветвления, ALM Rangers. Ветвление Strategies.pdf см. на вкладке «загрузки».
- [Разработки программного обеспечения с переключает функцию](https://msdn.microsoft.com/magazine/dn683796.aspx). В статье MSDN Magazine.
- [Функция переключателя](http://martinfowler.com/bliki/FeatureToggle.html). Переключает введение в компонент или функция флаги в блоге Martin Fowler.
- [Компонент vs переключает функцию ветвей](http://geekswithblogs.net/Optikal/archive/2013/02/10/152069.aspx). Другой записи блога о переключатели компонента, по Dylan Smith.

Дополнительные сведения об обработке конфиденциальные сведения, которые не будут храниться в репозиториев системы управления версиями см. следующие ресурсы:

- [Советы и рекомендации по развертыванию пароли и другие конфиденциальные данные, ASP.NET и службы приложений Azure](../../../../identity/overview/features-api/best-practices-for-deploying-passwords-and-other-sensitive-data-to-aspnet-and-azure.md).
- [Веб-сайты Azure: Как строки приложения и соединения работают строки](https://azure.microsoft.com/blog/2013/07/17/windows-azure-web-sites-how-application-strings-and-connection-strings-work/). Описание компонентов Azure, который переопределяет `appSettings` и `connectionStrings` данные в *Web.config* файла.
- [Пользовательские параметры конфигурации и приложения в веб-сайтов Azure - с (Stefan Schackow)](https://azure.microsoft.com/documentation/videos/configuration-and-app-settings-of-azure-web-sites/).

Сведения о других способах хранения конфиденциальные сведения из системы управления версиями см. в разделе [ASP.NET MVC: сохранить частных параметров из системы управления версиями](http://typecastexception.com/post/2014/04/06/ASPNET-MVC-Keep-Private-Settings-Out-of-Source-Control.aspx).

> [!div class="step-by-step"]
> [Назад](automate-everything.md)
> [Вперед](continuous-integration-and-continuous-delivery.md)
