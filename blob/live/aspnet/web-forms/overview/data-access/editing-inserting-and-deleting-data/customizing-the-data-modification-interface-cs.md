---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs
title: "Настройка интерфейса изменения данных (C#) | Документы Microsoft"
author: rick-anderson
description: "В этом учебнике мы рассмотрим способы настройки интерфейса изменяемого элемента управления GridView, заменив стандартные текстовые поля и CheckBox альтернатив..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/17/2006
ms.topic: article
ms.assetid: 22e99600-8d18-4a94-a20e-a3a62bb63798
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs
msc.type: authoredcontent
ms.openlocfilehash: fb0b20ab25d87eddc0b2f9da786db469b16f861a
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="customizing-the-data-modification-interface-c"></a><span data-ttu-id="85b3d-103">Настройка интерфейса изменения данных (C#)</span><span class="sxs-lookup"><span data-stu-id="85b3d-103">Customizing the Data Modification Interface (C#)</span></span>
====================
<span data-ttu-id="85b3d-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="85b3d-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="85b3d-105">[Загрузить пример приложения](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_20_CS.exe) или [скачать PDF](customizing-the-data-modification-interface-cs/_static/datatutorial20cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="85b3d-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_20_CS.exe) or [Download PDF](customizing-the-data-modification-interface-cs/_static/datatutorial20cs1.pdf)</span></span>

> <span data-ttu-id="85b3d-106">В этом учебнике мы рассмотрим способы настройки интерфейса изменяемого элемента управления GridView, заменив стандартные текстовые поля и CheckBox альтернативных ввода веб-элементов управления.</span><span class="sxs-lookup"><span data-stu-id="85b3d-106">In this tutorial we'll look at how to customize the interface of an editable GridView, by replacing the standard TextBox and CheckBox controls with alternative input Web controls.</span></span>


## <a name="introduction"></a><span data-ttu-id="85b3d-107">Вступление</span><span class="sxs-lookup"><span data-stu-id="85b3d-107">Introduction</span></span>

<span data-ttu-id="85b3d-108">Стояли и CheckBoxFields, используемым элементами управления GridView и DetailsView упростить процесс изменения данных из-за возможности для отображения только для чтения, для редактирования и вставляемые интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="85b3d-108">The BoundFields and CheckBoxFields used by the GridView and DetailsView controls simplify the process of modifying data due to their ability to render read-only, editable, and insertable interfaces.</span></span> <span data-ttu-id="85b3d-109">Эти интерфейсы может осуществляться без необходимости добавления дополнительных декларативная разметка и код.</span><span class="sxs-lookup"><span data-stu-id="85b3d-109">These interfaces can be rendered without the need for adding any additional declarative markup or code.</span></span> <span data-ttu-id="85b3d-110">Однако BoundField и в CheckBoxField интерфейсов не хватает подлежит, часто требуется в реальных сценариях.</span><span class="sxs-lookup"><span data-stu-id="85b3d-110">However, the BoundField and CheckBoxField's interfaces lack the customizability often needed in real-world scenarios.</span></span> <span data-ttu-id="85b3d-111">Чтобы настроить интерфейс для редактирования или вставляемые в GridView и DetailsView, нам нужно вместо этого использовать TemplateField.</span><span class="sxs-lookup"><span data-stu-id="85b3d-111">In order to customize the editable or insertable interface in a GridView or DetailsView we need to instead use a TemplateField.</span></span>

<span data-ttu-id="85b3d-112">В [предыдущего учебника](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) мы узнали, как настроить интерфейсы изменения данных путем добавления веб-элементов управления проверки.</span><span class="sxs-lookup"><span data-stu-id="85b3d-112">In the [preceding tutorial](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) we saw how to customize the data modification interfaces by adding validation Web controls.</span></span> <span data-ttu-id="85b3d-113">В этом учебнике мы рассмотрим процесс настройки фактические данные коллекции веб-элементов управления, заменив BoundField и стандартные текстовые поля в CheckBoxField и элементов управления CheckBox, альтернативный веб-элементами управления ввода.</span><span class="sxs-lookup"><span data-stu-id="85b3d-113">In this tutorial we'll look at how to customize the actual data collection Web controls, replacing the BoundField and CheckBoxField's standard TextBox and CheckBox controls with alternative input Web controls.</span></span> <span data-ttu-id="85b3d-114">В частности мы выполним сборку изменяемого элемента управления GridView, позволяющий продукта имя категории, поставщиков и неподдерживаемые состояние обновления.</span><span class="sxs-lookup"><span data-stu-id="85b3d-114">In particular, we'll build an editable GridView that allows a product's name, category, supplier, and discontinued status to be updated.</span></span> <span data-ttu-id="85b3d-115">При редактировании конкретной строки, категорию и поставщика поля будут отображаться как элементами управления DropDownList, содержащую набор доступных категорий и поставщиков для выбора.</span><span class="sxs-lookup"><span data-stu-id="85b3d-115">When editing a particular row, the category and supplier fields will render as DropDownLists, containing the set of available categories and suppliers to choose from.</span></span> <span data-ttu-id="85b3d-116">Кроме того, мы заменим CheckBoxField по умолчанию флажок элемента управления RadioButtonList, который предлагает два варианта: «Active» и «Больше».</span><span class="sxs-lookup"><span data-stu-id="85b3d-116">Furthermore, we'll replace the CheckBoxField's default CheckBox with a RadioButtonList control that offers two options: "Active" and "Discontinued".</span></span>


<span data-ttu-id="85b3d-117">[![Интерфейс редактирования элемента GridView включает элементами управления DropDownList и элементы управления RadioButton](customizing-the-data-modification-interface-cs/_static/image2.png)](customizing-the-data-modification-interface-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="85b3d-117">[![The GridView's Editing Interface Includes DropDownLists and RadioButtons](customizing-the-data-modification-interface-cs/_static/image2.png)](customizing-the-data-modification-interface-cs/_static/image1.png)</span></span>

<span data-ttu-id="85b3d-118">**Рис. 1**: редактирование интерфейса включает элементами управления DropDownList GridView и переключатели ([Просмотр полноразмерное изображение](customizing-the-data-modification-interface-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="85b3d-118">**Figure 1**: The GridView's Editing Interface Includes DropDownLists and RadioButtons ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image3.png))</span></span>


## <a name="step-1-creating-the-appropriateupdateproductoverload"></a><span data-ttu-id="85b3d-119">Шаг 1: Создание соответствующего`UpdateProduct`перегрузки</span><span class="sxs-lookup"><span data-stu-id="85b3d-119">Step 1: Creating the Appropriate`UpdateProduct`Overload</span></span>

<span data-ttu-id="85b3d-120">В этом учебнике мы построим изменяемого элемента управления GridView, позволяющий редактирование название продукта, категория, поставщик и неподдерживаемые состояния.</span><span class="sxs-lookup"><span data-stu-id="85b3d-120">In this tutorial we will build an editable GridView that permits editing of a product's name, category, supplier, and discontinued status.</span></span> <span data-ttu-id="85b3d-121">Таким образом, нам нужно `UpdateProduct` перегрузку, которая принимает пять входных параметров, эти четыре значения, а также `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-121">Therefore, we need an `UpdateProduct` overload that accepts five input parameters these four product values plus the `ProductID`.</span></span> <span data-ttu-id="85b3d-122">Как и в наших предыдущих перегрузки одного будет:</span><span class="sxs-lookup"><span data-stu-id="85b3d-122">Like in our previous overloads, this one will:</span></span>

1. <span data-ttu-id="85b3d-123">Получить сведения о продукте из базы данных для указанного `ProductID`,</span><span class="sxs-lookup"><span data-stu-id="85b3d-123">Retrieve the product information from the database for the specified `ProductID`,</span></span>
2. <span data-ttu-id="85b3d-124">Обновление `ProductName`, `CategoryID`, `SupplierID`, и `Discontinued` поля, и</span><span class="sxs-lookup"><span data-stu-id="85b3d-124">Update the `ProductName`, `CategoryID`, `SupplierID`, and `Discontinued` fields, and</span></span>
3. <span data-ttu-id="85b3d-125">Отправить запрос на обновление DAL через TableAdapter `Update()` метод.</span><span class="sxs-lookup"><span data-stu-id="85b3d-125">Send the update request to the DAL through the TableAdapter's `Update()` method.</span></span>

<span data-ttu-id="85b3d-126">Для краткости для этой конкретной перегрузки я не Проверка правила бизнеса, что гарантирует, что продукт, отмеченных как неподдерживаемые не только продукта, предоставляемой его поставщиком.</span><span class="sxs-lookup"><span data-stu-id="85b3d-126">For brevity, for this particular overload I've omitted the business rule check that ensures a product being marked as discontinued isn't the only product offered by its supplier.</span></span> <span data-ttu-id="85b3d-127">Можно добавить его в, если вы предпочитаете, или, в идеальном случае рефакторинга логическую схему отдельный метод.</span><span class="sxs-lookup"><span data-stu-id="85b3d-127">Feel free to add it in if you prefer, or, ideally, refactor out the logic to a separate method.</span></span>

<span data-ttu-id="85b3d-128">В следующем коде показан новый `UpdateProduct` перегрузки в `ProductsBLL` класса:</span><span class="sxs-lookup"><span data-stu-id="85b3d-128">The following code shows the new `UpdateProduct` overload in the `ProductsBLL` class:</span></span>


[!code-csharp[Main](customizing-the-data-modification-interface-cs/samples/sample1.cs)]

## <a name="step-2-crafting-the-editable-gridview"></a><span data-ttu-id="85b3d-129">Шаг 2: Дополнительно изменяемого элемента управления GridView</span><span class="sxs-lookup"><span data-stu-id="85b3d-129">Step 2: Crafting the Editable GridView</span></span>

<span data-ttu-id="85b3d-130">С `UpdateProduct` перегрузка добавлены все готово для создания нашей изменяемого элемента управления GridView.</span><span class="sxs-lookup"><span data-stu-id="85b3d-130">With the `UpdateProduct` overload added, we're ready to create our editable GridView.</span></span> <span data-ttu-id="85b3d-131">Откройте `CustomizedUI.aspx` страницы в `EditInsertDelete` папки и добавление элемента управления GridView в конструктор.</span><span class="sxs-lookup"><span data-stu-id="85b3d-131">Open the `CustomizedUI.aspx` page in the `EditInsertDelete` folder and add a GridView control to the Designer.</span></span> <span data-ttu-id="85b3d-132">Создайте новый элемент управления ObjectDataSource смарт-теге элемента GridView.</span><span class="sxs-lookup"><span data-stu-id="85b3d-132">Next, create a new ObjectDataSource from the GridView's smart tag.</span></span> <span data-ttu-id="85b3d-133">Настройка ObjectDataSource для получения сведений о продукте через `ProductBLL` класса `GetProducts()` метод и обновления данных с помощью продукта `UpdateProduct` перегрузку, мы только что создали.</span><span class="sxs-lookup"><span data-stu-id="85b3d-133">Configure the ObjectDataSource to retrieve product information via the `ProductBLL` class's `GetProducts()` method and to update product data using the `UpdateProduct` overload we just created.</span></span> <span data-ttu-id="85b3d-134">На вкладках INSERT и DELETE выберите (нет) из раскрывающихся списков.</span><span class="sxs-lookup"><span data-stu-id="85b3d-134">From the INSERT and DELETE tabs, select (None) from the drop-down lists.</span></span>


<span data-ttu-id="85b3d-135">[![Настройка с использованием перегрузки UpdateProduct только что созданный элемент управления ObjectDataSource](customizing-the-data-modification-interface-cs/_static/image5.png)](customizing-the-data-modification-interface-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="85b3d-135">[![Configure the ObjectDataSource to Use the UpdateProduct Overload Just Created](customizing-the-data-modification-interface-cs/_static/image5.png)](customizing-the-data-modification-interface-cs/_static/image4.png)</span></span>

<span data-ttu-id="85b3d-136">**На рисунке 2**: Настройка ObjectDataSource для использования `UpdateProduct` перегружать только что создали ([Просмотр полноразмерное изображение](customizing-the-data-modification-interface-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="85b3d-136">**Figure 2**: Configure the ObjectDataSource to Use the `UpdateProduct` Overload Just Created ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image6.png))</span></span>


<span data-ttu-id="85b3d-137">Как видно на протяжении учебники по модификации данных декларативного синтаксиса для ObjectDataSource, созданные с помощью Visual Studio назначает `OldValuesParameterFormatString` свойства `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-137">As we've seen throughout the data modification tutorials, the declarative syntax for the ObjectDataSource created by Visual Studio assigns the `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="85b3d-138">Это, конечно, не будет работать с нашей уровня бизнес-логики с момента наши методы не ожидается, что исходный `ProductID` значение для передачи.</span><span class="sxs-lookup"><span data-stu-id="85b3d-138">This, of course, won't work with our Business Logic Layer since our methods don't expect the original `ProductID` value to be passed in.</span></span> <span data-ttu-id="85b3d-139">Таким образом, как мы использовали в предыдущих учебниках, пора удалить это назначение свойства из декларативного синтаксиса, или вместо этого установить значение этого свойства в `{0}`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-139">Therefore, as we've done in previous tutorials, take a moment to remove this property assignment from the declarative syntax or, instead, set this property's value to `{0}`.</span></span>

<span data-ttu-id="85b3d-140">После этого изменения ObjectDataSource должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="85b3d-140">After this change, the ObjectDataSource's declarative markup should look like the following:</span></span>


[!code-aspx[Main](customizing-the-data-modification-interface-cs/samples/sample2.aspx)]

<span data-ttu-id="85b3d-141">Обратите внимание, что `OldValuesParameterFormatString` было удалено и нет `Parameter` в `UpdateParameters` коллекции для каждого входного параметра, наши `UpdateProduct` перегрузки.</span><span class="sxs-lookup"><span data-stu-id="85b3d-141">Note that the `OldValuesParameterFormatString` property has been removed and that there is a `Parameter` in the `UpdateParameters` collection for each of the input parameters expected by our `UpdateProduct` overload.</span></span>

<span data-ttu-id="85b3d-142">При ObjectDataSource настроена для обновления только подмножество значений продукта, в настоящий момент отображается GridView *всех* полей продукта.</span><span class="sxs-lookup"><span data-stu-id="85b3d-142">While the ObjectDataSource is configured to update only a subset of product values, the GridView currently shows *all* of the product fields.</span></span> <span data-ttu-id="85b3d-143">Теперь пора изменить GridView, чтобы:</span><span class="sxs-lookup"><span data-stu-id="85b3d-143">Take a moment to edit the GridView so that:</span></span>

- <span data-ttu-id="85b3d-144">Он включает только `ProductName`, `SupplierName`, `CategoryName` стояли и `Discontinued` CheckBoxField</span><span class="sxs-lookup"><span data-stu-id="85b3d-144">It only includes the `ProductName`, `SupplierName`, `CategoryName` BoundFields and the `Discontinued` CheckBoxField</span></span>
- <span data-ttu-id="85b3d-145">`CategoryName` И `SupplierName` поля будет отображаться перед (по левому краю) `Discontinued` CheckBoxField</span><span class="sxs-lookup"><span data-stu-id="85b3d-145">The `CategoryName` and `SupplierName` fields to appear before (to the left of) the `Discontinued` CheckBoxField</span></span>
- <span data-ttu-id="85b3d-146">`CategoryName` И `SupplierName` стояли `HeaderText` свойство имеет значение «Категория» и «Поставщик» соответственно</span><span class="sxs-lookup"><span data-stu-id="85b3d-146">The `CategoryName` and `SupplierName` BoundFields' `HeaderText` property is set to "Category" and "Supplier", respectively</span></span>
- <span data-ttu-id="85b3d-147">Включена поддержка редактирования (флажок Разрешить изменение в смарт-теге элемента GridView)</span><span class="sxs-lookup"><span data-stu-id="85b3d-147">Editing support is enabled (check the Enable Editing checkbox in the GridView's smart tag)</span></span>

<span data-ttu-id="85b3d-148">После внесения этих изменений конструктор будет выглядеть на рис. 3 с помощью декларативного синтаксиса элемента GridView, показано ниже.</span><span class="sxs-lookup"><span data-stu-id="85b3d-148">After these changes, the Designer will look similar to Figure 3, with the GridView's declarative syntax shown below.</span></span>


<span data-ttu-id="85b3d-149">[![Удалить ненужные поля из GridView](customizing-the-data-modification-interface-cs/_static/image8.png)](customizing-the-data-modification-interface-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="85b3d-149">[![Remove the Unneeded Fields from the GridView](customizing-the-data-modification-interface-cs/_static/image8.png)](customizing-the-data-modification-interface-cs/_static/image7.png)</span></span>

<span data-ttu-id="85b3d-150">**Рис. 3**: удалить ненужные поля из GridView ([Просмотр полноразмерное изображение](customizing-the-data-modification-interface-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="85b3d-150">**Figure 3**: Remove the Unneeded Fields from the GridView ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image9.png))</span></span>


[!code-aspx[Main](customizing-the-data-modification-interface-cs/samples/sample3.aspx)]

<span data-ttu-id="85b3d-151">На этом этапе завершена GridView поведение только для чтения.</span><span class="sxs-lookup"><span data-stu-id="85b3d-151">At this point the GridView's read-only behavior is complete.</span></span> <span data-ttu-id="85b3d-152">При просмотре данных, каждый продукт отображается в виде строки в GridView, показывающая название продукта, категории, поставщика и неподдерживаемые состояния.</span><span class="sxs-lookup"><span data-stu-id="85b3d-152">When viewing the data, each product is rendered as a row in the GridView, showing the product's name, category, supplier, and discontinued status.</span></span>


<span data-ttu-id="85b3d-153">[![Интерфейс только для чтения элемента GridView — завершено.](customizing-the-data-modification-interface-cs/_static/image11.png)](customizing-the-data-modification-interface-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="85b3d-153">[![The GridView's Read-Only Interface is Complete](customizing-the-data-modification-interface-cs/_static/image11.png)](customizing-the-data-modification-interface-cs/_static/image10.png)</span></span>

<span data-ttu-id="85b3d-154">**Рис. 4**: интерфейс только для чтения GridView является Complete ([Просмотр полноразмерное изображение](customizing-the-data-modification-interface-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="85b3d-154">**Figure 4**: The GridView's Read-Only Interface is Complete ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image12.png))</span></span>


> [!NOTE]
> <span data-ttu-id="85b3d-155">Как было сказано в [Обзор Вставка, обновление и удаление данных учебника](an-overview-of-inserting-updating-and-deleting-data-cs.md), жизненно важна, GridView, быть s состояния просмотра включена (по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="85b3d-155">As discussed in [An Overview of Inserting, Updating, and Deleting Data tutorial](an-overview-of-inserting-updating-and-deleting-data-cs.md), it is vitally important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="85b3d-156">Если задать GridView s `EnableViewState` свойства `false`, увеличивается риск того что параллельно работающие пользователи непреднамеренно удаление или изменение записей.</span><span class="sxs-lookup"><span data-stu-id="85b3d-156">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="85b3d-157">В разделе [предупреждение: проблемы параллелизма с ASP.NET 2.0 GridViews/DetailsView/FormViews, поддерживают редактирование или удаление и с состояние просмотра отключено](http://scottonwriting.net/sowblog/posts/10054.aspx) для получения дополнительной информации.</span><span class="sxs-lookup"><span data-stu-id="85b3d-157">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>


## <a name="step-3-using-a-dropdownlist-for-the-category-and-supplier-editing-interfaces"></a><span data-ttu-id="85b3d-158">Шаг 3: С помощью DropDownList для категорию и редактирования интерфейсы поставщика</span><span class="sxs-lookup"><span data-stu-id="85b3d-158">Step 3: Using a DropDownList for the Category and Supplier Editing Interfaces</span></span>

<span data-ttu-id="85b3d-159">Помните, что `ProductsRow` объект содержит `CategoryID`, `CategoryName`, `SupplierID`, и `SupplierName` свойства, которые предоставляют фактический идентификатор значения внешнего ключа в `Products` таблицы и соответствующие базы данных `Name` значения в `Categories` и `Suppliers` таблицы.</span><span class="sxs-lookup"><span data-stu-id="85b3d-159">Recall that the `ProductsRow` object contains `CategoryID`, `CategoryName`, `SupplierID`, and `SupplierName` properties, which provide the actual foreign-key ID values in the `Products` database table and the corresponding `Name` values in the `Categories` and `Suppliers` tables.</span></span> <span data-ttu-id="85b3d-160">`ProductRow` `CategoryID` И `SupplierID` можно оба считывать и записывать данные, тогда как `CategoryName` и `SupplierName` свойства помечены только для чтения.</span><span class="sxs-lookup"><span data-stu-id="85b3d-160">The `ProductRow`'s `CategoryID` and `SupplierID` can both be read from and written to, while the `CategoryName` and `SupplierName` properties are marked read-only.</span></span>

<span data-ttu-id="85b3d-161">Из-за состояния только для чтения `CategoryName` и `SupplierName` свойства, имели соответствующие стояли их `ReadOnly` свойство `true`, предотвращая внесение при редактировании строки эти значения.</span><span class="sxs-lookup"><span data-stu-id="85b3d-161">Due to the read-only status of the `CategoryName` and `SupplierName` properties, the corresponding BoundFields have had their `ReadOnly` property set to `true`, preventing these values from being modified when a row is edited.</span></span> <span data-ttu-id="85b3d-162">Хотя можно выбрать вариант `ReadOnly` свойства `false`, подготовки к просмотру `CategoryName` и `SupplierName` стояли как текстовые поля во время редактирования, такой подход приведет к исключение при попытке пользователя обновить продукт, так как она не `UpdateProduct` , принимающую `CategoryName` и `SupplierName` входные данные.</span><span class="sxs-lookup"><span data-stu-id="85b3d-162">While we can set the `ReadOnly` property to `false`, rendering the `CategoryName` and `SupplierName` BoundFields as TextBoxes during editing, such an approach will result in an exception when the user attempts to update the product since there is no `UpdateProduct` overload that takes in `CategoryName` and `SupplierName` inputs.</span></span> <span data-ttu-id="85b3d-163">На самом деле мы не хотим создать такие перегрузки по двум причинам:</span><span class="sxs-lookup"><span data-stu-id="85b3d-163">In fact, we don't want to create such an overload for two reasons:</span></span>

- <span data-ttu-id="85b3d-164">`Products` Таблица не содержит `SupplierName` или `CategoryName` поля, но `SupplierID` и `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-164">The `Products` table doesn't have `SupplierName` or `CategoryName` fields, but `SupplierID` and `CategoryID`.</span></span> <span data-ttu-id="85b3d-165">Таким образом мы хотим наш метод для передачи этих определенного значения идентификатора, не соответствующих таблиц подстановки значений.</span><span class="sxs-lookup"><span data-stu-id="85b3d-165">Therefore, we want our method to be passed these particular ID values, not their lookup tables' values.</span></span>
- <span data-ttu-id="85b3d-166">Поскольку требует от пользователя введите имя поставщика или категории не является идеальным, как пользователь знать доступные категории и поставщики и их правильное написание.</span><span class="sxs-lookup"><span data-stu-id="85b3d-166">Requiring the user to type in the name of the supplier or category is less than ideal, as it requires the user to know the available categories and suppliers and their correct spellings.</span></span>

<span data-ttu-id="85b3d-167">Отображать поля поставщика и категории, категории и имена поставщиков в режиме только для чтения (что происходит сейчас) и применимые параметры при редактировании список раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="85b3d-167">The supplier and category fields should display the category and suppliers' names when in read-only mode (as it does now) and a drop-down list of applicable options when being edited.</span></span> <span data-ttu-id="85b3d-168">С помощью раскрывающегося списка, конечный пользователь может быстро просмотреть, какие категории и поставщики доступны для выбора одного из и более легко можно их выбор.</span><span class="sxs-lookup"><span data-stu-id="85b3d-168">Using a drop-down list, the end user can quickly see what categories and suppliers are available to choose among and can more easily make their selection.</span></span>

<span data-ttu-id="85b3d-169">Чтобы обеспечить это поведение, нам нужно преобразовать `SupplierName` и `CategoryName` стояли в TemplateFields которого `ItemTemplate` выдает `SupplierName` и `CategoryName` значения, для которых `EditItemTemplate` использует элемента управления список Доступные категории и поставщиков.</span><span class="sxs-lookup"><span data-stu-id="85b3d-169">To provide this behavior, we need to convert the `SupplierName` and `CategoryName` BoundFields into TemplateFields whose `ItemTemplate` emits the `SupplierName` and `CategoryName` values and whose `EditItemTemplate` uses a DropDownList control to list the available categories and suppliers.</span></span>

## <a name="adding-thecategoriesandsuppliersdropdownlists"></a><span data-ttu-id="85b3d-170">Добавление`Categories`и`Suppliers`элементами управления DropDownList</span><span class="sxs-lookup"><span data-stu-id="85b3d-170">Adding the`Categories`and`Suppliers`DropDownLists</span></span>

<span data-ttu-id="85b3d-171">Запуск путем преобразования `SupplierName` и `CategoryName` стояли в TemplateFields по: щелкните ссылку Правка столбцов GridView смарт-теге; выбрав в списке в нижней левой; BoundField и нажав кнопку «Преобразовать это поле в Ссылка TemplateField».</span><span class="sxs-lookup"><span data-stu-id="85b3d-171">Start by converting the `SupplierName` and `CategoryName` BoundFields into TemplateFields by: clicking on the Edit Columns link from the GridView's smart tag; selecting the BoundField from the list in the lower left; and clicking the "Convert this field into a TemplateField" link.</span></span> <span data-ttu-id="85b3d-172">Процесс преобразования создаст TemplateField с обоими `ItemTemplate` и `EditItemTemplate`, как показано в приведенном ниже синтаксисе декларативных:</span><span class="sxs-lookup"><span data-stu-id="85b3d-172">The conversion process will create a TemplateField with both an `ItemTemplate` and an `EditItemTemplate`, as shown in the declarative syntax below:</span></span>


[!code-aspx[Main](customizing-the-data-modification-interface-cs/samples/sample4.aspx)]

<span data-ttu-id="85b3d-173">Поскольку BoundField был помечен как только для чтения, как `ItemTemplate` и `EditItemTemplate` содержат Web метки свойство `Text` свойство привязано к полю применяется данных (`CategoryName`, в приведенном выше синтаксисе).</span><span class="sxs-lookup"><span data-stu-id="85b3d-173">Since the BoundField was marked as read-only, both the `ItemTemplate` and `EditItemTemplate` contain a Label Web control whose `Text` property is bound to the applicable data field (`CategoryName`, in the syntax above).</span></span> <span data-ttu-id="85b3d-174">Нам нужно изменить `EditItemTemplate`, заменив управления DropDownList веб-управления Label.</span><span class="sxs-lookup"><span data-stu-id="85b3d-174">We need to modify the `EditItemTemplate`, replacing the Label Web control with a DropDownList control.</span></span>

<span data-ttu-id="85b3d-175">Как видно в предыдущих учебниках, шаблон можно изменить с помощью конструктора или непосредственно из декларативного синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="85b3d-175">As we've seen in previous tutorials, the template can be edited through the Designer or directly from the declarative syntax.</span></span> <span data-ttu-id="85b3d-176">Чтобы изменить его в конструкторе, щелкните ссылку Изменить шаблоны смарт-теге элемента GridView и выберите для работы с поля «Категория» `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-176">To edit it through the Designer, click on the Edit Templates link from the GridView's smart tag and choose to work with the Category field's `EditItemTemplate`.</span></span> <span data-ttu-id="85b3d-177">Удалите элемент управления Label и замените элемент управления DropDownList, присвоив свойству идентификатора DropDownList `Categories`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-177">Remove the Label Web control and replace it with a DropDownList control, setting the DropDownList's ID property to `Categories`.</span></span>


<span data-ttu-id="85b3d-178">[![Удалите TexBox и добавьте в шаблон EditItemTemplate DropDownList](customizing-the-data-modification-interface-cs/_static/image14.png)](customizing-the-data-modification-interface-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="85b3d-178">[![Remove the TexBox and Add a DropDownList to the EditItemTemplate](customizing-the-data-modification-interface-cs/_static/image14.png)](customizing-the-data-modification-interface-cs/_static/image13.png)</span></span>

<span data-ttu-id="85b3d-179">**Рис. 5**: удалите TexBox и добавьте DropDownList для `EditItemTemplate` ([Просмотр полноразмерное изображение](customizing-the-data-modification-interface-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="85b3d-179">**Figure 5**: Remove the TexBox and Add a DropDownList to the `EditItemTemplate` ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image15.png))</span></span>


<span data-ttu-id="85b3d-180">Далее нам нужно заполнить DropDownList с доступных категорий.</span><span class="sxs-lookup"><span data-stu-id="85b3d-180">We next need to populate the DropDownList with the available categories.</span></span> <span data-ttu-id="85b3d-181">Щелкните ссылку Выбор источника данных в смарт-теге DropDownList и создадим новый ObjectDataSource с именем `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-181">Click on the Choose Data Source link from the DropDownList's smart tag and opt to create a new ObjectDataSource named `CategoriesDataSource`.</span></span>


<span data-ttu-id="85b3d-182">[![Создать новый элемент управления ObjectDataSource CategoriesDataSource с именем](customizing-the-data-modification-interface-cs/_static/image17.png)](customizing-the-data-modification-interface-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="85b3d-182">[![Create a New ObjectDataSource Control Named CategoriesDataSource](customizing-the-data-modification-interface-cs/_static/image17.png)](customizing-the-data-modification-interface-cs/_static/image16.png)</span></span>

<span data-ttu-id="85b3d-183">**Рис. 6**: Создание нового элемента управления ObjectDataSource с именем `CategoriesDataSource` ([Просмотр полноразмерное изображение](customizing-the-data-modification-interface-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="85b3d-183">**Figure 6**: Create a New ObjectDataSource Control Named `CategoriesDataSource` ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image18.png))</span></span>


<span data-ttu-id="85b3d-184">Чтобы этот элемент управления ObjectDataSource возвращать все категории, привяжите его к `CategoriesBLL` класса `GetCategories()` метод.</span><span class="sxs-lookup"><span data-stu-id="85b3d-184">To have this ObjectDataSource return all of the categories, bind it to the `CategoriesBLL` class's `GetCategories()` method.</span></span>


<span data-ttu-id="85b3d-185">[![Привязать элемент управления ObjectDataSource CategoriesBLL GetCategories() методу](customizing-the-data-modification-interface-cs/_static/image20.png)](customizing-the-data-modification-interface-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="85b3d-185">[![Bind the ObjectDataSource to the CategoriesBLL's GetCategories() Method](customizing-the-data-modification-interface-cs/_static/image20.png)](customizing-the-data-modification-interface-cs/_static/image19.png)</span></span>

<span data-ttu-id="85b3d-186">**Рис. 7**: привязать элемент управления ObjectDataSource `CategoriesBLL` `GetCategories()` метод ([Просмотр полноразмерное изображение](customizing-the-data-modification-interface-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="85b3d-186">**Figure 7**: Bind the ObjectDataSource to the `CategoriesBLL`'s `GetCategories()` Method ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image21.png))</span></span>


<span data-ttu-id="85b3d-187">И наконец, настройте параметры DropDownList таким образом, что `CategoryName` будет отображаться в каждом DropDownList `ListItem` с `CategoryID` используется в качестве значения поля.</span><span class="sxs-lookup"><span data-stu-id="85b3d-187">Finally, configure the DropDownList's settings such that the `CategoryName` field is displayed in each DropDownList `ListItem` with the `CategoryID` field used as the value.</span></span>


<span data-ttu-id="85b3d-188">[![Отображается в поле «Категория» и код типа используется в качестве значения](customizing-the-data-modification-interface-cs/_static/image23.png)](customizing-the-data-modification-interface-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="85b3d-188">[![Have the CategoryName Field Displayed and the CategoryID Used as the Value](customizing-the-data-modification-interface-cs/_static/image23.png)](customizing-the-data-modification-interface-cs/_static/image22.png)</span></span>

<span data-ttu-id="85b3d-189">**Рис. 8**: У `CategoryName` отображаются поля и `CategoryID` используется в качестве значения ([Просмотр полноразмерное изображение](customizing-the-data-modification-interface-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="85b3d-189">**Figure 8**: Have the `CategoryName` Field Displayed and the `CategoryID` Used as the Value ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image24.png))</span></span>


<span data-ttu-id="85b3d-190">После внесения этих изменений декларативная разметка для `EditItemTemplate` в `CategoryName` TemplateField будет включать DropDownList и ObjectDataSource:</span><span class="sxs-lookup"><span data-stu-id="85b3d-190">After making these changes the declarative markup for the `EditItemTemplate` in the `CategoryName` TemplateField will include both a DropDownList and an ObjectDataSource:</span></span>


[!code-aspx[Main](customizing-the-data-modification-interface-cs/samples/sample5.aspx)]

> [!NOTE]
> <span data-ttu-id="85b3d-191">DropDownList в `EditItemTemplate` должен иметь состояние просмотра включено.</span><span class="sxs-lookup"><span data-stu-id="85b3d-191">The DropDownList in the `EditItemTemplate` must have its view state enabled.</span></span> <span data-ttu-id="85b3d-192">Чтобы декларативный синтаксис в DropDownList скоро мы добавим синтаксис привязки данных и команд привязки данных, например `Eval()` и `Bind()` может использоваться только в элементах управления состояние представления которого включен.</span><span class="sxs-lookup"><span data-stu-id="85b3d-192">We will soon add databinding syntax to the DropDownList's declarative syntax and databinding commands like `Eval()` and `Bind()` can only appear in controls whose view state is enabled.</span></span>


<span data-ttu-id="85b3d-193">Повторите эти шаги для добавления с именем DropDownList `Suppliers` для `SupplierName` в TemplateField `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-193">Repeat these steps to add a DropDownList named `Suppliers` to the `SupplierName` TemplateField's `EditItemTemplate`.</span></span> <span data-ttu-id="85b3d-194">Это будет включать в себя добавление DropDownList для `EditItemTemplate` и создания другой ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="85b3d-194">This will involve adding a DropDownList to the `EditItemTemplate` and creating another ObjectDataSource.</span></span> <span data-ttu-id="85b3d-195">`Suppliers` DropDownList ObjectDataSource, однако, должны быть настроены для вызова `SuppliersBLL` класса `GetSuppliers()` метод.</span><span class="sxs-lookup"><span data-stu-id="85b3d-195">The `Suppliers` DropDownList's ObjectDataSource, however, should be configured to invoke the `SuppliersBLL` class's `GetSuppliers()` method.</span></span> <span data-ttu-id="85b3d-196">Кроме того, настроить `Suppliers` DropDownList для отображения `CompanyName` поля и использовать `SupplierID` как значение его `ListItem` s.</span><span class="sxs-lookup"><span data-stu-id="85b3d-196">Additionally, configure the `Suppliers` DropDownList to display the `CompanyName` field and use the `SupplierID` field as the value for its `ListItem` s.</span></span>

<span data-ttu-id="85b3d-197">После добавления двух элементами управления DropDownList `EditItemTemplate` , загрузить страницу в браузере и нажмите кнопку Правка Креольская Cajun Seasoning продукта.</span><span class="sxs-lookup"><span data-stu-id="85b3d-197">After adding the DropDownLists to the two `EditItemTemplate` s, load the page in a browser and click the Edit button for the Chef Anton's Cajun Seasoning product.</span></span> <span data-ttu-id="85b3d-198">Как показано на рис. 9, продукта, категорию и поставщика столбцы отображаются как раскрывающиеся списки, содержащие доступные категории и поставщики для выбора.</span><span class="sxs-lookup"><span data-stu-id="85b3d-198">As Figure 9 shows, the product's category and supplier columns are rendered as drop-down lists containing the available categories and suppliers to choose from.</span></span> <span data-ttu-id="85b3d-199">Тем не менее, обратите внимание, что *первый* элементы обоих списков раскрывающегося списка выбираются по умолчанию (напитки категории) и экзотические жидкости как поставщик, хотя Seasoning Cajun Креольская Condiment, предоставляемые Cajun Новый Орлеан Преимуществах.</span><span class="sxs-lookup"><span data-stu-id="85b3d-199">However, note that the *first* items in both drop-down lists are selected by default (Beverages for the category and Exotic Liquids as the supplier), even though Chef Anton's Cajun Seasoning is a Condiment supplied by New Orleans Cajun Delights.</span></span>


<span data-ttu-id="85b3d-200">[![По умолчанию выбран первый элемент в раскрывающемся списке указаны](customizing-the-data-modification-interface-cs/_static/image26.png)](customizing-the-data-modification-interface-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="85b3d-200">[![The First Item in the Drop-Down Lists is Selected by Default](customizing-the-data-modification-interface-cs/_static/image26.png)](customizing-the-data-modification-interface-cs/_static/image25.png)</span></span>

<span data-ttu-id="85b3d-201">**Рис. 9**: по умолчанию выбран первый элемент в раскрывающемся списке указаны ([Просмотр полноразмерное изображение](customizing-the-data-modification-interface-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="85b3d-201">**Figure 9**: The First Item in the Drop-Down Lists is Selected by Default ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image27.png))</span></span>


<span data-ttu-id="85b3d-202">Кроме того, если нажать кнопку обновления, вы найдете, продукта `CategoryID` и `SupplierID` значения устанавливаются в значение `NULL`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-202">Furthermore, if you click Update, you'll find that the product's `CategoryID` and `SupplierID` values are set to `NULL`.</span></span> <span data-ttu-id="85b3d-203">Эти нежелательные поведения вызванные элементами управления DropDownList в `EditItemTemplate` не привязаны к полям данных из базовых данных продукта.</span><span class="sxs-lookup"><span data-stu-id="85b3d-203">Both of these undesired behaviors are caused because the DropDownLists in the `EditItemTemplate` s are not bound to any data fields from the underlying product data.</span></span>

## <a name="binding-the-dropdownlists-to-thecategoryidandsupplieriddata-fields"></a><span data-ttu-id="85b3d-204">Привязка элементами управления DropDownList для`CategoryID`и`SupplierID`полей данных</span><span class="sxs-lookup"><span data-stu-id="85b3d-204">Binding the DropDownLists to the`CategoryID`and`SupplierID`Data Fields</span></span>

<span data-ttu-id="85b3d-205">Для измененного продукта категорию и поставщика раскрывающиеся списки задать соответствующие значения и иметь эти значения, отправляемые МЕТОДА `UpdateProduct` метод после нажатия на кнопку обновления, нам нужно привязать элементами управления DropDownList `SelectedValue` свойства `CategoryID` и `SupplierID` полей данных, с помощью двухсторонней привязкой данных.</span><span class="sxs-lookup"><span data-stu-id="85b3d-205">In order to have the edited product's category and supplier drop-down lists set to the appropriate values and to have these values sent back to the BLL's `UpdateProduct` method upon clicking Update, we need to bind the DropDownLists' `SelectedValue` properties to the `CategoryID` and `SupplierID` data fields using two-way databinding.</span></span> <span data-ttu-id="85b3d-206">Для этого с `Categories` DropDownList, можно добавить `SelectedValue='<%# Bind("CategoryID") %>'` непосредственно к декларативного синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="85b3d-206">To accomplish this with the `Categories` DropDownList, you can add `SelectedValue='<%# Bind("CategoryID") %>'` directly to the declarative syntax.</span></span>

<span data-ttu-id="85b3d-207">Кроме того можно задать DropDownList привязки данных, изменив шаблон в конструкторе и щелкните ссылку изменить привязки данных в смарт-теге DropDownList.</span><span class="sxs-lookup"><span data-stu-id="85b3d-207">Alternatively, you can set the DropDownList's databindings by editing the template through the Designer and clicking the Edit DataBindings link from the DropDownList's smart tag.</span></span> <span data-ttu-id="85b3d-208">Далее, указывающий, что `SelectedValue` свойства должны быть привязаны к `CategoryID` поля двусторонняя привязка к данным (см. рис. 10).</span><span class="sxs-lookup"><span data-stu-id="85b3d-208">Next, indicate that the `SelectedValue` property should be bound to the `CategoryID` field using two-way databinding (see Figure 10).</span></span> <span data-ttu-id="85b3d-209">Повторите декларативной или конструктора процесса для привязки `SupplierID` поле данных `Suppliers` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="85b3d-209">Repeat either the declarative or Designer process to bind the `SupplierID` data field to the `Suppliers` DropDownList.</span></span>


<span data-ttu-id="85b3d-210">[![Привязка к свойству SelectedValue DropDownList двусторонняя привязка к данным с помощью CategoryID](customizing-the-data-modification-interface-cs/_static/image29.png)](customizing-the-data-modification-interface-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="85b3d-210">[![Bind the CategoryID to the DropDownList's SelectedValue Property Using Two-Way Databinding](customizing-the-data-modification-interface-cs/_static/image29.png)](customizing-the-data-modification-interface-cs/_static/image28.png)</span></span>

<span data-ttu-id="85b3d-211">**Рис. 10**: привязка `CategoryID` в элемент управления DropDownList `SelectedValue` свойства с помощью двусторонней привязки к данным ([Просмотр полноразмерное изображение](customizing-the-data-modification-interface-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="85b3d-211">**Figure 10**: Bind the `CategoryID` to the DropDownList's `SelectedValue` Property Using Two-Way Databinding ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image30.png))</span></span>


<span data-ttu-id="85b3d-212">После привязки были применены к `SelectedValue` свойства двумя элементами управления DropDownList, категорию и поставщика столбцы измененного продукта будет по умолчанию значения текущего продукта.</span><span class="sxs-lookup"><span data-stu-id="85b3d-212">Once the bindings have been applied to the `SelectedValue` properties of the two DropDownLists, the edited product's category and supplier columns will default to the current product's values.</span></span> <span data-ttu-id="85b3d-213">После нажатия на кнопку обновления, `CategoryID` и `SupplierID` значения выбранного раскрывающегося элемента списка будет передан `UpdateProduct` метод.</span><span class="sxs-lookup"><span data-stu-id="85b3d-213">Upon clicking Update, the `CategoryID` and `SupplierID` values of the selected drop-down list item will be passed to the `UpdateProduct` method.</span></span> <span data-ttu-id="85b3d-214">Рис. 11 показана учебника после добавления инструкции привязки данных; Обратите внимание, как элементы выбранного раскрывающегося списка для Seasoning Cajun Креольская правильно Condiment и преимуществах нового Орлеана Cajun.</span><span class="sxs-lookup"><span data-stu-id="85b3d-214">Figure 11 shows the tutorial after the databinding statements have been added; note how the selected drop-down list items for Chef Anton's Cajun Seasoning are correctly Condiment and New Orleans Cajun Delights.</span></span>


<span data-ttu-id="85b3d-215">[![По умолчанию выбраны текущей категории и значения поставщика продукта изменен](customizing-the-data-modification-interface-cs/_static/image32.png)](customizing-the-data-modification-interface-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="85b3d-215">[![The Edited Product's Current Category and Supplier Values are Selected by Default](customizing-the-data-modification-interface-cs/_static/image32.png)](customizing-the-data-modification-interface-cs/_static/image31.png)</span></span>

<span data-ttu-id="85b3d-216">**Рис. 11**: изменить текущий категорию и поставщика значений по умолчанию выбраны ([Просмотр полноразмерное изображение](customizing-the-data-modification-interface-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="85b3d-216">**Figure 11**: The Edited Product's Current Category and Supplier Values are Selected by Default ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image33.png))</span></span>


## <a name="handlingnullvalues"></a><span data-ttu-id="85b3d-217">Обработка`NULL`значения</span><span class="sxs-lookup"><span data-stu-id="85b3d-217">Handling`NULL`Values</span></span>

<span data-ttu-id="85b3d-218">`CategoryID` И `SupplierID` столбцы в `Products` таблица может быть `NULL`, но элементами управления DropDownList в `EditItemTemplate` не включают элемент списка для представления `NULL` значение.</span><span class="sxs-lookup"><span data-stu-id="85b3d-218">The `CategoryID` and `SupplierID` columns in the `Products` table can be `NULL`, yet the DropDownLists in the `EditItemTemplate` s don't include a list item to represent a `NULL` value.</span></span> <span data-ttu-id="85b3d-219">Это имеет два последствия:</span><span class="sxs-lookup"><span data-stu-id="85b3d-219">This has two consequences:</span></span>

- <span data-ttu-id="85b3d-220">Пользователь не может использовать наши интерфейс изменение поставщику или категории продуктов, отличным от`NULL` значение `NULL` один</span><span class="sxs-lookup"><span data-stu-id="85b3d-220">User cannot use our interface to change a product's category or supplier from a non-`NULL` value to a `NULL` one</span></span>
- <span data-ttu-id="85b3d-221">Если продукт имеет `NULL` `CategoryID` или `SupplierID`, нажав кнопку «Изменить» будет приведет к исключению.</span><span class="sxs-lookup"><span data-stu-id="85b3d-221">If a product has a `NULL` `CategoryID` or `SupplierID`, clicking the Edit button will result in an exception.</span></span> <span data-ttu-id="85b3d-222">Это вызвано `NULL` значения, возвращенного `CategoryID` (или `SupplierID`) в `Bind()` инструкция не соответствует значение в раскрывающемся списке (DropDownList приводит к возникновению исключения при его `SelectedValue` свойству присвоено значение *не* в его коллекцию элементов списка).</span><span class="sxs-lookup"><span data-stu-id="85b3d-222">This is because the `NULL` value returned by `CategoryID` (or `SupplierID`) in the `Bind()` statement does not map to a value in the DropDownList (the DropDownList throws an exception when its `SelectedValue` property is set to a value *not* in its collection of list items).</span></span>

<span data-ttu-id="85b3d-223">Чтобы обеспечить поддержку `NULL` `CategoryID` и `SupplierID` значения, необходимо добавить другой `ListItem` для каждого DropDownList для представления `NULL` значение.</span><span class="sxs-lookup"><span data-stu-id="85b3d-223">In order to support `NULL` `CategoryID` and `SupplierID` values, we need to add another `ListItem` to each DropDownList to represent the `NULL` value.</span></span> <span data-ttu-id="85b3d-224">В [иерархического фильтрации с DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) учебника, мы узнали, как добавить дополнительный `ListItem` для привязки к данным DropDownList, который участвующих параметр DropDownList `AppendDataBoundItems` свойства `true` и вручную, добавив дополнительный `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-224">In the [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) tutorial, we saw how to add an additional `ListItem` to a databound DropDownList, which involved setting the DropDownList's `AppendDataBoundItems` property to `true` and manually adding the additional `ListItem`.</span></span> <span data-ttu-id="85b3d-225">В этом с предыдущим учебником, тем не менее, мы добавили `ListItem` с `Value` из `-1`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-225">In that previous tutorial, however, we added a `ListItem` with a `Value` of `-1`.</span></span> <span data-ttu-id="85b3d-226">Логика привязки данных в ASP.NET, однако автоматически преобразует пустую строку для `NULL` значение и a наоборот.</span><span class="sxs-lookup"><span data-stu-id="85b3d-226">The databinding logic in ASP.NET, however, will automatically convert a blank string to a `NULL` value and vice-a-versa.</span></span> <span data-ttu-id="85b3d-227">Таким образом, в этом учебнике мы хотим `ListItem` `Value` быть пустой строкой.</span><span class="sxs-lookup"><span data-stu-id="85b3d-227">Therefore, for this tutorial we want the `ListItem`'s `Value` to be an empty string.</span></span>

<span data-ttu-id="85b3d-228">Запуск, задав обоих элементами управления DropDownList `AppendDataBoundItems` свойства `true`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-228">Start by setting both DropDownLists' `AppendDataBoundItems` property to `true`.</span></span> <span data-ttu-id="85b3d-229">Добавьте `NULL` `ListItem` , добавив следующий код `<asp:ListItem>` элемент для каждого DropDownList так выглядит декларативная разметка, такие как:</span><span class="sxs-lookup"><span data-stu-id="85b3d-229">Next, add the `NULL` `ListItem` by adding the following `<asp:ListItem>` element to each DropDownList so that the declarative markup looks like:</span></span>


[!code-aspx[Main](customizing-the-data-modification-interface-cs/samples/sample6.aspx)]

<span data-ttu-id="85b3d-230">Я решил «(нет)» используется как текстовое значение для этого `ListItem`, но его также быть пустая строка, при желании можно изменить.</span><span class="sxs-lookup"><span data-stu-id="85b3d-230">I've chosen to use "(None)" as the Text value for this `ListItem`, but you can change it to also be a blank string if you'd like.</span></span>

> [!NOTE]
> <span data-ttu-id="85b3d-231">Как мы видели в *иерархического фильтрации с DropDownList* учебнике `ListItem` s могут добавляться в DropDownList в конструкторе, щелкнув DropDownList `Items` в окне свойств (который Отображает `ListItem` редактор коллекции).</span><span class="sxs-lookup"><span data-stu-id="85b3d-231">As we saw in the *Master/Detail Filtering With a DropDownList* tutorial, `ListItem` s can be added to a DropDownList through the Designer by clicking on the DropDownList's `Items` property in the Properties window (which will display the `ListItem` Collection Editor).</span></span> <span data-ttu-id="85b3d-232">Тем не менее, не забудьте добавить `NULL` `ListItem` в этом учебнике посредством декларативного синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="85b3d-232">However, be sure to add the `NULL` `ListItem` for this tutorial through the declarative syntax.</span></span> <span data-ttu-id="85b3d-233">При использовании `ListItem` редактор коллекции будут исключаться созданный декларативный синтаксис `Value` параметр полностью, если назначенный пустые строки, создавая декларативной разметкой, например: `<asp:ListItem>(None)</asp:ListItem>`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-233">If you use the `ListItem` Collection Editor, the generated declarative syntax will omit the `Value` setting altogether when assigned a blank string, creating declarative markup like: `<asp:ListItem>(None)</asp:ListItem>`.</span></span> <span data-ttu-id="85b3d-234">Хотя это может выглядеть опасное, отсутствующее значение вызывает DropDownList для использования `Text` значение свойства на его месте.</span><span class="sxs-lookup"><span data-stu-id="85b3d-234">While this may look harmless, the missing Value causes the DropDownList to use the `Text` property value in its place.</span></span> <span data-ttu-id="85b3d-235">Что означает, что если это `NULL` `ListItem` — флажок установлен, значение «(нет)» будет предпринята попытка должна назначаться `CategoryID`, что приведет к возникновению исключения.</span><span class="sxs-lookup"><span data-stu-id="85b3d-235">That means that if this `NULL` `ListItem` is selected, the value "(None)" will be attempted to be assigned to the `CategoryID`, which will result in an exception.</span></span> <span data-ttu-id="85b3d-236">После явного задания `Value=""`, `NULL` присваивается значение `CategoryID` при `NULL` `ListItem` выбран.</span><span class="sxs-lookup"><span data-stu-id="85b3d-236">By explicitly setting `Value=""`, a `NULL` value will be assigned to `CategoryID` when the `NULL` `ListItem` is selected.</span></span>


<span data-ttu-id="85b3d-237">Повторите эти шаги для DropDownList поставщиков.</span><span class="sxs-lookup"><span data-stu-id="85b3d-237">Repeat these steps for the Suppliers DropDownList.</span></span>

<span data-ttu-id="85b3d-238">С этим дополнительных `ListItem`, теперь можно назначать интерфейс редактирования `NULL` значения с продуктом `CategoryID` и `SupplierID` поля, как показано на рис. 12.</span><span class="sxs-lookup"><span data-stu-id="85b3d-238">With this additional `ListItem`, the editing interface can now assign `NULL` values to a Product's `CategoryID` and `SupplierID` fields, as shown in Figure 12.</span></span>


<span data-ttu-id="85b3d-239">[![Выберите (нет) для присвоения значения NULL для категории продукта или поставщика](customizing-the-data-modification-interface-cs/_static/image35.png)](customizing-the-data-modification-interface-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="85b3d-239">[![Choose (None) to Assign a NULL Value for a Product's Category or Supplier](customizing-the-data-modification-interface-cs/_static/image35.png)](customizing-the-data-modification-interface-cs/_static/image34.png)</span></span>

<span data-ttu-id="85b3d-240">**Рис. 12**: параметр (нет), для назначения `NULL` значение для категории продукта или поставщика ([Просмотр полноразмерное изображение](customizing-the-data-modification-interface-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="85b3d-240">**Figure 12**: Choose (None) to Assign a `NULL` Value for a Product's Category or Supplier ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image36.png))</span></span>


## <a name="step-4-using-radiobuttons-for-the-discontinued-status"></a><span data-ttu-id="85b3d-241">Шаг 4: Использование переключатели неподдерживаемые состояния</span><span class="sxs-lookup"><span data-stu-id="85b3d-241">Step 4: Using RadioButtons for the Discontinued Status</span></span>

<span data-ttu-id="85b3d-242">В настоящее время продукта `Discontinued` поля данных выражается с помощью CheckBoxField, который отображает Снятый флажок для строк только для чтения и включен флажок для изменяемой строки.</span><span class="sxs-lookup"><span data-stu-id="85b3d-242">Currently the products' `Discontinued` data field is expressed using a CheckBoxField, which renders a disabled checkbox for the read-only rows and an enabled checkbox for the row being edited.</span></span> <span data-ttu-id="85b3d-243">Во время этого пользовательского интерфейса часто подходит, мы можно настраивать при необходимости с помощью TemplateField.</span><span class="sxs-lookup"><span data-stu-id="85b3d-243">While this user interface is often suitable, we can customize it if needed using a TemplateField.</span></span> <span data-ttu-id="85b3d-244">В этом учебнике изменим CheckBoxField в TemplateField, используется элемент управления RadioButtonList два варианта «Active» и «Неподдерживаемые» из которого пользователь может указать продукта `Discontinued` значение.</span><span class="sxs-lookup"><span data-stu-id="85b3d-244">For this tutorial, let's change the CheckBoxField into a TemplateField that uses a RadioButtonList control with two options "Active" and "Discontinued" from which the user can specify the product's `Discontinued` value.</span></span>

<span data-ttu-id="85b3d-245">Начните с преобразование `Discontinued` CheckBoxField в TemplateField, который создаст TemplateField с `ItemTemplate` и `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-245">Start by converting the `Discontinued` CheckBoxField into a TemplateField, which will create a TemplateField with an `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="85b3d-246">Шаблоны включают флажок с его `Checked` свойство привязано к `Discontinued` поля данных, единственное различие между ними выполняется, `ItemTemplate`флажок в `Enabled` свойству `false`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-246">Both templates include a CheckBox with its `Checked` property bound to the `Discontinued` data field, the only difference between the two being that the `ItemTemplate`'s CheckBox's `Enabled` property is set to `false`.</span></span>

<span data-ttu-id="85b3d-247">Замените флажок в обоих `ItemTemplate` и `EditItemTemplate` с элементом управления RadioButtonList установка обоих RadioButtonLists `ID` свойства `DiscontinuedChoice`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-247">Replace the CheckBox in both the `ItemTemplate` and `EditItemTemplate` with a RadioButtonList control, setting both RadioButtonLists' `ID` properties to `DiscontinuedChoice`.</span></span> <span data-ttu-id="85b3d-248">Далее означает, что RadioButtonLists следует каждого содержаться два переключателя, один с меткой «активный» со значением «False» и надписью «Неподдерживаемые» со значением «True».</span><span class="sxs-lookup"><span data-stu-id="85b3d-248">Next, indicate that the RadioButtonLists should each contain two radio buttons, one labeled "Active" with a value of "False" and one labeled "Discontinued" with a value of "True".</span></span> <span data-ttu-id="85b3d-249">Для этого можно либо ввести `<asp:ListItem>` элементов непосредственно с помощью декларативного синтаксиса или используйте `ListItem` редактор коллекции из конструктора.</span><span class="sxs-lookup"><span data-stu-id="85b3d-249">To accomplish this you can either enter the `<asp:ListItem>` elements in directly through the declarative syntax or use the `ListItem` Collection Editor from the Designer.</span></span> <span data-ttu-id="85b3d-250">На рисунке 13 показано `ListItem` редактор коллекции после двух переключателей кнопку параметры были указаны.</span><span class="sxs-lookup"><span data-stu-id="85b3d-250">Figure 13 shows the `ListItem` Collection Editor after the two radio button options have been specified.</span></span>


<span data-ttu-id="85b3d-251">[![Добавить](customizing-the-data-modification-interface-cs/_static/image38.png)](customizing-the-data-modification-interface-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="85b3d-251">[![Add](customizing-the-data-modification-interface-cs/_static/image38.png)](customizing-the-data-modification-interface-cs/_static/image37.png)</span></span>

<span data-ttu-id="85b3d-252">**Рис. 13**: Добавление RadioButtonList параметры «Снят с производства» и «Активный» ([Просмотр полноразмерное изображение](customizing-the-data-modification-interface-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="85b3d-252">**Figure 13**: Add "Active" and "Discontinued" Options to the RadioButtonList ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image39.png))</span></span>


<span data-ttu-id="85b3d-253">С момента RadioButtonList в `ItemTemplate` не должно быть доступно для редактирования, задайте его `Enabled` свойства `false`, покидая `Enabled` свойства `true` (по умолчанию) для RadioButtonList в `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="85b3d-253">Since the RadioButtonList in the `ItemTemplate` shouldn't be editable, set its `Enabled` property to `false`, leaving the `Enabled` property to `true` (the default) for the RadioButtonList in the `EditItemTemplate`.</span></span> <span data-ttu-id="85b3d-254">Это сделает переключатели в строке без изменения только для чтения, но разрешает пользователю изменять значения RadioButton для измененной строки.</span><span class="sxs-lookup"><span data-stu-id="85b3d-254">This will make the radio buttons in the non-edited row as read-only, but will allow the user to change the RadioButton values for the edited row.</span></span>

<span data-ttu-id="85b3d-255">Мы по-прежнему необходимо назначить элементы управления RadioButtonList `SelectedValue` свойства, чтобы выделить соответствующий переключатель основе продукта `Discontinued` поля данных.</span><span class="sxs-lookup"><span data-stu-id="85b3d-255">We still need to assign the RadioButtonList controls' `SelectedValue` properties so that the appropriate radio button is selected based upon the product's `Discontinued` data field.</span></span> <span data-ttu-id="85b3d-256">Как и в случае с элементами управления DropDownList, просмотренных ранее в этом учебнике, этот синтаксис привязки данных можно добавить непосредственно в декларативной разметкой или через ссылку изменить привязки данных в RadioButtonLists смарт-тегов.</span><span class="sxs-lookup"><span data-stu-id="85b3d-256">As with the DropDownLists examined earlier in this tutorial, this databinding syntax can either be added directly into the declarative markup or through the Edit DataBindings link in the RadioButtonLists' smart tags.</span></span>

<span data-ttu-id="85b3d-257">После добавления двух RadioButtonLists и настраивать их, `Discontinued` в TemplateField должна выглядеть как:</span><span class="sxs-lookup"><span data-stu-id="85b3d-257">After adding the two RadioButtonLists and configuring them, the `Discontinued` TemplateField's declarative markup should look like:</span></span>


[!code-aspx[Main](customizing-the-data-modification-interface-cs/samples/sample7.aspx)]

<span data-ttu-id="85b3d-258">Эти изменения `Discontinued` столбец был преобразован из списка флажков в список пар кнопка переключателей (см. рис. 14).</span><span class="sxs-lookup"><span data-stu-id="85b3d-258">With these changes, the `Discontinued` column has been transformed from a list of checkboxes to a list of radio button pairs (see Figure 14).</span></span> <span data-ttu-id="85b3d-259">При изменении продукта, соответствующий переключатель установлен и неподдерживаемые состояние продукта может быть обновлен, установив соответствующий переключатель команду Update.</span><span class="sxs-lookup"><span data-stu-id="85b3d-259">When editing a product, the appropriate radio button is selected and the product's discontinued status can be updated by selecting the other radio button and clicking Update.</span></span>


<span data-ttu-id="85b3d-260">[![Неподдерживаемые флажки были заменены пары кнопка переключателей](customizing-the-data-modification-interface-cs/_static/image41.png)](customizing-the-data-modification-interface-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="85b3d-260">[![The Discontinued CheckBoxes Have Been Replaced by Radio Button Pairs](customizing-the-data-modification-interface-cs/_static/image41.png)](customizing-the-data-modification-interface-cs/_static/image40.png)</span></span>

<span data-ttu-id="85b3d-261">**Рис. 14**: неподдерживаемые флажки были заменены переключатель кнопка пары ([Просмотр полноразмерное изображение](customizing-the-data-modification-interface-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="85b3d-261">**Figure 14**: The Discontinued CheckBoxes Have Been Replaced by Radio Button Pairs ([Click to view full-size image](customizing-the-data-modification-interface-cs/_static/image42.png))</span></span>


> [!NOTE]
> <span data-ttu-id="85b3d-262">Поскольку `Discontinued` столбца в `Products` базы данных не может иметь `NULL` значения, нам не нужно беспокоиться о записи `NULL` сведения в интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="85b3d-262">Since the `Discontinued` column in the `Products` database cannot have `NULL` values, we do not need to worry about capturing `NULL` information in the interface.</span></span> <span data-ttu-id="85b3d-263">IF, однако `Discontinued` столбец может содержать `NULL` значения, необходимо добавить третий переключатель в список с его `Value` пустой строкой (`Value=""`) точно так же, как и с категорию и поставщика элементами управления DropDownList.</span><span class="sxs-lookup"><span data-stu-id="85b3d-263">If, however, `Discontinued` column could contain `NULL` values we'd want to add a third radio button to the list with its `Value` set to an empty string (`Value=""`), just like with the category and supplier DropDownLists.</span></span>


## <a name="summary"></a><span data-ttu-id="85b3d-264">Сводка</span><span class="sxs-lookup"><span data-stu-id="85b3d-264">Summary</span></span>

<span data-ttu-id="85b3d-265">Хотя BoundField и CheckBoxField автоматически отображать интерфейсы только для чтения, правки и вставки, у которых отсутствует возможность настройки.</span><span class="sxs-lookup"><span data-stu-id="85b3d-265">While the BoundField and CheckBoxField automatically render read-only, editing, and inserting interfaces, they lack the ability for customization.</span></span> <span data-ttu-id="85b3d-266">Часто, хотя, нам нужно будет настроить правки или вставки интерфейса, возможно добавление элементов управления проверки (как было показано в предыдущем учебнике) или путем настройки пользовательского интерфейса сбора данных (как мы видели в этом учебнике).</span><span class="sxs-lookup"><span data-stu-id="85b3d-266">Often, though, we'll need to customize the editing or inserting interface, perhaps adding validation controls (as we saw in the preceding tutorial) or by customizing the data collection user interface (as we saw in this tutorial).</span></span> <span data-ttu-id="85b3d-267">Настройка интерфейса с TemplateField может быть суммирована следующим образом:</span><span class="sxs-lookup"><span data-stu-id="85b3d-267">Customizing the interface with a TemplateField can be summed up in the following steps:</span></span>

1. <span data-ttu-id="85b3d-268">Добавление TemplateField или преобразовать существующий BoundField или CheckBoxField в TemplateField</span><span class="sxs-lookup"><span data-stu-id="85b3d-268">Add a TemplateField or convert an existing BoundField or CheckBoxField into a TemplateField</span></span>
2. <span data-ttu-id="85b3d-269">Расширяют интерфейс, при необходимости</span><span class="sxs-lookup"><span data-stu-id="85b3d-269">Augment the interface as needed</span></span>
3. <span data-ttu-id="85b3d-270">Привязка поля данных для вновь добавленного веб-элементов управления с помощью двухсторонней привязкой данных</span><span class="sxs-lookup"><span data-stu-id="85b3d-270">Bind the appropriate data fields to the newly added Web controls using two-way databinding</span></span>

<span data-ttu-id="85b3d-271">Помимо использования встроенных элементов управления ASP.NET Web, можно также настроить шаблоны TemplateField специальными, скомпилированными серверных элементов управления и пользовательские элементы управления.</span><span class="sxs-lookup"><span data-stu-id="85b3d-271">In addition to using the built-in ASP.NET Web controls, you can also customize the templates of a TemplateField with custom, compiled server controls and User Controls.</span></span>

<span data-ttu-id="85b3d-272">Программирование довольны!</span><span class="sxs-lookup"><span data-stu-id="85b3d-272">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="85b3d-273">Об авторе</span><span class="sxs-lookup"><span data-stu-id="85b3d-273">About the Author</span></span>

<span data-ttu-id="85b3d-274">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи ASP/ASP.NET и основателя из [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Майкрософт с 1998 года.</span><span class="sxs-lookup"><span data-stu-id="85b3d-274">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="85b3d-275">Скотт — независимый консультант, trainer и записи.</span><span class="sxs-lookup"><span data-stu-id="85b3d-275">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="85b3d-276">Его последняя книга — [ *диспетчерами учат самостоятельно ASP.NET 2.0 в течение 24 часов*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="85b3d-276">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="85b3d-277">Он может быть достигнута по [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) или через его блог, который можно найти в [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="85b3d-277">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="85b3d-278">[Назад](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md)
[Вперед](implementing-optimistic-concurrency-cs.md)</span><span class="sxs-lookup"><span data-stu-id="85b3d-278">[Previous](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md)
[Next](implementing-optimistic-concurrency-cs.md)</span></span>
