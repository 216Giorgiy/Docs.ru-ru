---
uid: web-forms/overview/ajax-control-toolkit/htmleditor/how-do-i-use-the-html-editor-control-vb
title: "Использование управления редактора HTML (VISUAL BASIC) | Документы Microsoft"
author: microsoft
description: "HTMLEditor является элементом управления ASP.NET AJAX, который позволяет легко создавать и изменять данные HTML, с помощью кнопок на панели инструментов."
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/12/2009
ms.topic: article
ms.assetid: 32ec9321-7c8c-4b0f-8234-99acb56df6b5
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/ajax-control-toolkit/htmleditor/how-do-i-use-the-html-editor-control-vb
msc.type: authoredcontent
ms.openlocfilehash: a34b3dd53f031856906eca923b6ad6f43a0aaecc
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/10/2017
---
<a name="how-do-i-use-the-html-editor-control-vb"></a><span data-ttu-id="b58fc-104">Использование управления редактора HTML</span><span class="sxs-lookup"><span data-stu-id="b58fc-104">How do I use the HTML Editor Control?</span></span> <span data-ttu-id="b58fc-105">(VISUAL BASIC)</span><span class="sxs-lookup"><span data-stu-id="b58fc-105">(VB)</span></span>
====================
<span data-ttu-id="b58fc-106">по [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="b58fc-106">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="b58fc-107">HTMLEditor является элементом управления ASP.NET AJAX, который позволяет легко создавать и изменять данные HTML, с помощью кнопок на панели инструментов.</span><span class="sxs-lookup"><span data-stu-id="b58fc-107">HTMLEditor is an ASP.NET AJAX Control that allows you to easily create and edit HTML content via buttons in a toolbar.</span></span>


<span data-ttu-id="b58fc-108">Целью данного учебника является предоставляются общие сведения о управления редактора HTML, входящий в состав набора элементов управления AJAX.</span><span class="sxs-lookup"><span data-stu-id="b58fc-108">The goal of this tutorial is to provide you with an overview of the HTML Editor control included with the AJAX Control Toolkit.</span></span> <span data-ttu-id="b58fc-109">Редактор HTML включает параметры для изменения размера шрифта, выбрав шрифт, изменение цвета фона, изменяя цвет переднего плана, добавив ссылки, добавив изображения, изменение выравнивания текста и выполнение вырезания, копирования и вставки операции (см. рис. 1).</span><span class="sxs-lookup"><span data-stu-id="b58fc-109">The HTML Editor includes options for changing font size, selecting a font, changing background color, modifying the foreground color, adding links, adding images, changing text alignment, and performing cut, copy, and paste operations (see Figure 1).</span></span>


<span data-ttu-id="b58fc-110">[![Редактор HTML](how-do-i-use-the-html-editor-control-vb/_static/image1.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b58fc-110">[![The HTML Editor](how-do-i-use-the-html-editor-control-vb/_static/image1.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image1.png)</span></span>

<span data-ttu-id="b58fc-111">**На рисунке 01**: В редакторе HTML ([Просмотр полноразмерное изображение](how-do-i-use-the-html-editor-control-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="b58fc-111">**Figure 01**: The HTML Editor([Click to view full-size image](how-do-i-use-the-html-editor-control-vb/_static/image2.png))</span></span>


<span data-ttu-id="b58fc-112">Редактор HTML позволяет ввести содержимое с помощью режим конструктора или HTML можно ввести непосредственно.</span><span class="sxs-lookup"><span data-stu-id="b58fc-112">The HTML editor enables you to enter content using a design mode or you can enter HTML directly.</span></span> <span data-ttu-id="b58fc-113">Можно также настроить параметр, чтобы просмотреть содержимое HTML (см. рис. 2).</span><span class="sxs-lookup"><span data-stu-id="b58fc-113">You also are provided with the option to preview your HTML content (see Figure 2).</span></span>


<span data-ttu-id="b58fc-114">[![Проектирование, HTML и предварительного просмотра кнопок](how-do-i-use-the-html-editor-control-vb/_static/image2.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="b58fc-114">[![Design, HTML, and Preview buttons](how-do-i-use-the-html-editor-control-vb/_static/image2.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image3.png)</span></span>

<span data-ttu-id="b58fc-115">**На рисунке 02**: кнопки конструктора, HTML и предварительного просмотра ([Просмотр полноразмерное изображение](how-do-i-use-the-html-editor-control-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="b58fc-115">**Figure 02**: Design, HTML, and Preview buttons([Click to view full-size image](how-do-i-use-the-html-editor-control-vb/_static/image4.png))</span></span>


<span data-ttu-id="b58fc-116">В этом учебнике вы узнаете, как отобразить редактор HTML, Настройка кнопки панели инструментов, отображаются в редакторе HTML и как избежать межсайтовых сценариев атак.</span><span class="sxs-lookup"><span data-stu-id="b58fc-116">In this tutorial, you learn how to display the HTML Editor, how to customize the toolbar buttons that appear in the HTML Editor, and how to avoid Cross-Site Scripting Attacks.</span></span>

## <a name="displaying-the-html-editor"></a><span data-ttu-id="b58fc-117">Отображение редактора HTML</span><span class="sxs-lookup"><span data-stu-id="b58fc-117">Displaying the HTML Editor</span></span>

<span data-ttu-id="b58fc-118">Прежде чем использовать редактор HTML на странице ASP.NET, необходимо сначала добавить элемент управления ScriptManager на страницу.</span><span class="sxs-lookup"><span data-stu-id="b58fc-118">Before you can use the HTML Editor in an ASP.NET page, you must first add a ScriptManager control to the page.</span></span> <span data-ttu-id="b58fc-119">Элемент управления ScriptManager расположен под вкладки расширения AJAX в области элементов Visual Studio или Visual Web Developer Express.</span><span class="sxs-lookup"><span data-stu-id="b58fc-119">The ScriptManager control is located beneath the AJAX Extensions tab in the Visual Studio/Visual Web Developer Express toolbox.</span></span>

<span data-ttu-id="b58fc-120">Рекомендуется поместить элемент управления ScriptManager в верхней части страницы, перед другими элементами управления на странице.</span><span class="sxs-lookup"><span data-stu-id="b58fc-120">You should place the ScriptManager control at the top of the page before any other controls on the page.</span></span> <span data-ttu-id="b58fc-121">Например, можно поместить его сразу под открывающей серверную &lt;формы&gt; тег.</span><span class="sxs-lookup"><span data-stu-id="b58fc-121">For example, you can place it immediately below the opening server-side &lt;form&gt; tag.</span></span>

<span data-ttu-id="b58fc-122">В области элементов с остальной частью панели элементов управления AJAX расположен элемент управления HTML-редактора.</span><span class="sxs-lookup"><span data-stu-id="b58fc-122">The HTML Editor control is located in the toolbox with the rest of the AJAX Control Toolkit controls.</span></span> <span data-ttu-id="b58fc-123">Он называется управления редактора (см. рис. 3).</span><span class="sxs-lookup"><span data-stu-id="b58fc-123">It is named the Editor control (see Figure 3).</span></span>


<span data-ttu-id="b58fc-124">[![Элемент управления редактора HTML](how-do-i-use-the-html-editor-control-vb/_static/image3.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="b58fc-124">[![The HTML Editor control](how-do-i-use-the-html-editor-control-vb/_static/image3.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image5.png)</span></span>

<span data-ttu-id="b58fc-125">**На рисунке 03**: элемент управления в редакторе HTML ([Просмотр полноразмерное изображение](how-do-i-use-the-html-editor-control-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b58fc-125">**Figure 03**: The HTML Editor control([Click to view full-size image](how-do-i-use-the-html-editor-control-vb/_static/image6.png))</span></span>


<span data-ttu-id="b58fc-126">После перетаскивания редактора HTML на странице, можно установить его свойства в окне свойств.</span><span class="sxs-lookup"><span data-stu-id="b58fc-126">After you drag the HTML Editor onto a page, you can set its properties in the property sheet.</span></span> <span data-ttu-id="b58fc-127">Например обычно необходимо задать свойства ширины и высоты.</span><span class="sxs-lookup"><span data-stu-id="b58fc-127">For example, you normally want to set the Width and Height properties.</span></span> <span data-ttu-id="b58fc-128">Листинг 1 содержит источник для страницы ASP.NET, которая содержит HTML-редактора.</span><span class="sxs-lookup"><span data-stu-id="b58fc-128">Listing 1 contains the source for an ASP.NET page that contains an HTML editor.</span></span>

<span data-ttu-id="b58fc-129">**Листинг 1 - SimpleEditor.aspx**</span><span class="sxs-lookup"><span data-stu-id="b58fc-129">**Listing 1 - SimpleEditor.aspx**</span></span>

[!code-aspx[Main](how-do-i-use-the-html-editor-control-vb/samples/sample1.aspx)]

<span data-ttu-id="b58fc-130">Страницы в список 1 содержит элемент управления редактора HTML, элемент управления Button и текстовым элементом управления.</span><span class="sxs-lookup"><span data-stu-id="b58fc-130">The page in Listing 1 contains an HTML Editor control, a Button control, and a Literal control.</span></span> <span data-ttu-id="b58fc-131">При нажатии кнопки, содержимое редактора HTML отображается в управлении литералов (см. рис. 4).</span><span class="sxs-lookup"><span data-stu-id="b58fc-131">When you click the button, the contents of the HTML Editor appear in the Literal control (see Figure 4).</span></span>


<span data-ttu-id="b58fc-132">[![Отправка формы с помощью HTML-редактора](how-do-i-use-the-html-editor-control-vb/_static/image4.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b58fc-132">[![Submitting a form with an HTML Editor](how-do-i-use-the-html-editor-control-vb/_static/image4.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image7.png)</span></span>

<span data-ttu-id="b58fc-133">**На рисунке 04**: Отправка формы с редактором HTML ([Просмотр полноразмерное изображение](how-do-i-use-the-html-editor-control-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="b58fc-133">**Figure 04**: Submitting a form with an HTML Editor([Click to view full-size image](how-do-i-use-the-html-editor-control-vb/_static/image8.png))</span></span>


<span data-ttu-id="b58fc-134">Свойство содержимого HTML-редактор используется для получения HTML-содержимое, введенное в редакторе HTML.</span><span class="sxs-lookup"><span data-stu-id="b58fc-134">The HTML Editor Content property is used to retrieve the HTML content entered into the HTML Editor.</span></span> <span data-ttu-id="b58fc-135">Имейте в виду, что это HTML-содержимое может содержать JavaScript.</span><span class="sxs-lookup"><span data-stu-id="b58fc-135">Be aware that this HTML content can contain JavaScript.</span></span> <span data-ttu-id="b58fc-136">В следующем разделе мы рассмотрим, каким образом можно предотвратить атаки путем внедрения кода JavaScript.</span><span class="sxs-lookup"><span data-stu-id="b58fc-136">In the next section, we discuss how you can prevent JavaScript Injection Attacks.</span></span>

## <a name="customizing-the-html-editor-toolbar"></a><span data-ttu-id="b58fc-137">Настройка панели инструментов редактора HTML</span><span class="sxs-lookup"><span data-stu-id="b58fc-137">Customizing the HTML Editor Toolbar</span></span>

<span data-ttu-id="b58fc-138">Можно настроить только кнопки, которые отображаются в редакторе.</span><span class="sxs-lookup"><span data-stu-id="b58fc-138">You can customize exactly which buttons appear in the editor.</span></span> <span data-ttu-id="b58fc-139">Например может потребоваться удалить вкладки «HTML», чтобы запретить пользователям Переключение редактора HTML в режиме HTML.</span><span class="sxs-lookup"><span data-stu-id="b58fc-139">For example, you might want to remove the HTML tab to prevent users from switching the HTML Editor into HTML mode.</span></span> <span data-ttu-id="b58fc-140">Или, может потребоваться удалить раскрывающегося списка размер шрифта, чтобы запретить пользователям создавать чрезмерно большим текст на форуме сообщения post (см. рис. 5).</span><span class="sxs-lookup"><span data-stu-id="b58fc-140">Or, you might want to remove the font size dropdown list to prevent users from creating overly large text in a forum message post (see Figure 5).</span></span>


<span data-ttu-id="b58fc-141">[![Настраиваемый редактор HTML](how-do-i-use-the-html-editor-control-vb/_static/image5.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="b58fc-141">[![A customized HTML Editor](how-do-i-use-the-html-editor-control-vb/_static/image5.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image9.png)</span></span>

<span data-ttu-id="b58fc-142">**На рисунке 05**: A настроить редактор HTML ([Просмотр полноразмерное изображение](how-do-i-use-the-html-editor-control-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="b58fc-142">**Figure 05**: A customized HTML Editor([Click to view full-size image](how-do-i-use-the-html-editor-control-vb/_static/image10.png))</span></span>


<span data-ttu-id="b58fc-143">Настройка кнопок панели инструментов путем наследования от базового класса редактора новый редактор HTML.</span><span class="sxs-lookup"><span data-stu-id="b58fc-143">You customize the toolbar buttons by deriving a new HTML Editor from the base Editor class.</span></span> <span data-ttu-id="b58fc-144">Например пользовательский редактор в списке 2 содержит только кнопки панели инструментов для полужирным шрифтом или курсивом.</span><span class="sxs-lookup"><span data-stu-id="b58fc-144">For example, the custom editor in Listing 2 only contains toolbar buttons for bold and italic.</span></span> <span data-ttu-id="b58fc-145">Будут удалены все кнопки панели инструментов.</span><span class="sxs-lookup"><span data-stu-id="b58fc-145">All other toolbar buttons have been removed.</span></span> <span data-ttu-id="b58fc-146">Кроме того был удален из нижней части редактора HTML-вкладка (но вкладки конструктора и предварительного просмотра по-прежнему существуют).</span><span class="sxs-lookup"><span data-stu-id="b58fc-146">Furthermore, the HTML tab has been removed from the bottom of the editor (but the Design and Preview tabs are still there).</span></span>

<span data-ttu-id="b58fc-147">**2 — приложение вывод\_Code\CustomEditor.vb**</span><span class="sxs-lookup"><span data-stu-id="b58fc-147">**Listing 2 - App\_Code\CustomEditor.vb**</span></span>

[!code-vb[Main](how-do-i-use-the-html-editor-control-vb/samples/sample2.vb)]

<span data-ttu-id="b58fc-148">В приложение, необходимо добавить класс в списке 2\_кода папки, чтобы класс компилируются автоматически.</span><span class="sxs-lookup"><span data-stu-id="b58fc-148">You must add the class in Listing 2 to your App\_Code folder so that the class will be compiled automatically.</span></span> <span data-ttu-id="b58fc-149">Если приложение\_веб-сайта не существует папки с кодом, то можно просто добавить папку.</span><span class="sxs-lookup"><span data-stu-id="b58fc-149">If the App\_Code folder does not exist in your website then you can simply add the folder.</span></span>

<span data-ttu-id="b58fc-150">После создания специализированного редактора добавлением его на страницу ASP.NET так же при добавлении обычный HTML-редактор (см. список 3).</span><span class="sxs-lookup"><span data-stu-id="b58fc-150">After you create a custom editor, you can add it to an ASP.NET page in the same way as you add the normal HTML Editor (see Listing 3).</span></span>

<span data-ttu-id="b58fc-151">**Листинг 3 - ShowCustomEditor.aspx**</span><span class="sxs-lookup"><span data-stu-id="b58fc-151">**Listing 3 - ShowCustomEditor.aspx**</span></span>

[!code-aspx[Main](how-do-i-use-the-html-editor-control-vb/samples/sample3.aspx)]

## <a name="avoiding-cross-site-scripting-xss-attacks"></a><span data-ttu-id="b58fc-152">Избегайте использования атаки межузловых сценариев (XSS)</span><span class="sxs-lookup"><span data-stu-id="b58fc-152">Avoiding Cross-Site Scripting (XSS) Attacks</span></span>

<span data-ttu-id="b58fc-153">Каждый раз, когда принимать входные данные от пользователя и отобразите входа на веб-сайте, вы потенциально открыть веб-сайта к атакам межсайтовых сценариев (XSS).</span><span class="sxs-lookup"><span data-stu-id="b58fc-153">Whenever you accept input from a user, and redisplay that input on your website, you potentially open your website to Cross-Site Scripting (XSS) Attacks.</span></span> <span data-ttu-id="b58fc-154">В теории злоумышленнику удалось отправить код JavaScript, выполняемый, когда отобразится входных данных.</span><span class="sxs-lookup"><span data-stu-id="b58fc-154">In theory, a malicious hacker could submit JavaScript code that gets executed when the input is redisplayed.</span></span> <span data-ttu-id="b58fc-155">JavaScript может использоваться для кражи паролей пользователей или другую конфиденциальную информацию.</span><span class="sxs-lookup"><span data-stu-id="b58fc-155">The JavaScript could be used to steal user passwords or other sensitive information.</span></span>

<span data-ttu-id="b58fc-156">Как правило можно отказаться от атак с XSS с HTML-кодирование любые входные данные, получить от пользователя перед его отображением на веб-странице.</span><span class="sxs-lookup"><span data-stu-id="b58fc-156">Normally, you can defeat XSS attacks by HTML encoding whatever input you retrieve from a user before displaying it in a web page.</span></span> <span data-ttu-id="b58fc-157">Тем не менее, HTML-кодирование вывода редактор HTML будет не только кодирования &lt;сценарий&gt; тегов, он будет также закодировать все теги HTML.</span><span class="sxs-lookup"><span data-stu-id="b58fc-157">However, HTML encoding the output of the HTML Editor would not only encode &lt;script&gt; tags, it would also encode all HTML tags.</span></span> <span data-ttu-id="b58fc-158">Другими словами будут потеряны все форматирование, такие как тип шрифта, размер шрифта и цвет фона.</span><span class="sxs-lookup"><span data-stu-id="b58fc-158">In other words, you would lose all of the formatting such as the font type, font size, and background color.</span></span>

<span data-ttu-id="b58fc-159">Если выполняется сбор конфиденциальных сведений от пользователей — например, пароли, номера кредитных карт и номера социального страхования - следует не отображаются без кодировки содержимого, получаемые от пользователя с помощью редактора HTML.</span><span class="sxs-lookup"><span data-stu-id="b58fc-159">If you are collecting sensitive information from your users -- such as passwords, credit-card numbers, and social security numbers - then you should not display un-encoded content that you retrieve from a user with the HTML Editor.</span></span> <span data-ttu-id="b58fc-160">Редактор HTML следует использовать только в ситуациях, в которых не являются повторное отображение HTML-содержимого или HTML-содержимого передается на веб-сайт надежной стороной.</span><span class="sxs-lookup"><span data-stu-id="b58fc-160">You should use the HTML Editor only in situations in which you are not redisplaying the HTML content, or the HTML content is being submitted to your website by a trusted party.</span></span>

<span data-ttu-id="b58fc-161">Допустим, что вы создаете приложение блога.</span><span class="sxs-lookup"><span data-stu-id="b58fc-161">Imagine, for example, that you are creating a blog application.</span></span> <span data-ttu-id="b58fc-162">В этом случае имеет смысл использовать редактор HTML при создании сообщения в блогах.</span><span class="sxs-lookup"><span data-stu-id="b58fc-162">In this situation, it makes sense to use the HTML Editor when composing blog posts.</span></span> <span data-ttu-id="b58fc-163">Вы являетесь единственным, кто отправляет сообщение в блоге и, скорее всего, можно доверять самостоятельно не для отправки вредоносных JavaScript.</span><span class="sxs-lookup"><span data-stu-id="b58fc-163">You are the only one who submits a blog post and, presumably, you can trust yourself not to submit malicious JavaScript.</span></span> <span data-ttu-id="b58fc-164">Тем не менее он не имеет смысла при разрешении анонимным пользователям отправлять комментарии с помощью редактора HTML.</span><span class="sxs-lookup"><span data-stu-id="b58fc-164">However, it does not make sense to use the HTML Editor when allowing anonymous users to post comments.</span></span> <span data-ttu-id="b58fc-165">Вам следует особенно внимательно в ситуациях, в которых пользователи отправляют конфиденциальные сведения, например пароли.</span><span class="sxs-lookup"><span data-stu-id="b58fc-165">You should be especially careful in situations in which users submit sensitive information such as passwords.</span></span> <span data-ttu-id="b58fc-166">Возможно пользователь-злоумышленник может post комментарий, который содержит правой JavaScript для перехвата пароль.</span><span class="sxs-lookup"><span data-stu-id="b58fc-166">Potentially, a malicious user could post a comment that contains the right JavaScript for stealing a password.</span></span>

## <a name="summary"></a><span data-ttu-id="b58fc-167">Сводка</span><span class="sxs-lookup"><span data-stu-id="b58fc-167">Summary</span></span>

<span data-ttu-id="b58fc-168">В этом учебнике вам были предоставлены краткий обзор элемента управления редактора HTML, включенных в набор элементов управления AJAX.</span><span class="sxs-lookup"><span data-stu-id="b58fc-168">In this tutorial, you were provided with a brief overview of the HTML Editor control included in the AJAX Control Toolkit.</span></span> <span data-ttu-id="b58fc-169">Вы узнали, как использовать редактор HTML для принятия более информативного содержимого от пользователя и отправить содержимое на сервер.</span><span class="sxs-lookup"><span data-stu-id="b58fc-169">You learned how to use the HTML Editor to accept rich content from a user and submit the content to the server.</span></span> <span data-ttu-id="b58fc-170">Также мы рассмотрели, как можно настроить кнопки панели инструментов, которые отображаются в редакторе HTML.</span><span class="sxs-lookup"><span data-stu-id="b58fc-170">We also discussed how you can customize the toolbar buttons that are displayed by the HTML Editor.</span></span> <span data-ttu-id="b58fc-171">Наконец вы узнали, как во избежание межсайтовых сценариев атак при использовании редактора HTML для приема потенциально опасные входные данные.</span><span class="sxs-lookup"><span data-stu-id="b58fc-171">Finally, you learned how to avoid Cross-Site Scripting Attacks when using the HTML Editor to accept potentially malicious input.</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="b58fc-172">Назад</span><span class="sxs-lookup"><span data-stu-id="b58fc-172">Previous</span></span>](how-do-i-use-the-html-editor-control-cs.md)
